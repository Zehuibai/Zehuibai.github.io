# Estimands


```{r, include=FALSE, echo = FALSE,message = FALSE, error = FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = TRUE)

# <!-- ---------------------------------------------------------------------- -->
# <!--                    1. load the required packages                       -->
# <!-- ---------------------------------------------------------------------- --> 

## if(!require(psych)){install.packages("psych")}

packages<-c("tidyverse", "kableExtra", "gtsummary",
            "inTextSummaryTable",
            "Hmisc","htmltools","clinUtils")
ipak <- function(pkg){
  new.pkg <- pkg[!(pkg %in% installed.packages()[, "Package"])]
  if (length(new.pkg)) 
    install.packages(new.pkg, dependencies = TRUE)
  sapply(pkg, require, character.only = TRUE)
}
ipak(packages)
 
# <!-- ---------------------------------------------------------------------- -->
# <!--                        2. Basic system settings                        -->
# <!-- ---------------------------------------------------------------------- -->
# setwd(dirname(rstudioapi::getSourceEditorContext()$path))
```


  
## Introduction

### ICH E9 R1

**Specifying estimands is a regulatory requirement in the ICH E9 R1 Draft Addendum (ICH, 2017).**

The analysis of clinical trial data often encounters challenges due to post-randomization events that impact both treatment and outcomes. These events, which occur after the initial random assignment of treatments to participants, can complicate the interpretation of trial results by obscuring what outcomes should be measured and how to accurately measure them. Initially, clinical trial analyses focused on simple methods for handling incomplete data resulting from these events, prioritizing computational convenience. However, there has been a shift towards more sophisticated approaches, driven in part by the 2010 report from the National Research Council (NRC) which emphasized the importance of not just how to estimate outcomes, but what outcomes should be estimated.

This evolution continued with the 2017 International Council for Harmonisation's (ICH) E9(R1) Draft Addendum, which broadened the scope of analysis beyond missing data. This addendum addressed the challenges posed by a range of post-randomization events, including what are known as "intercurrent events," which are incidents linked to the treatment and outcomes of the study.

In real-world clinical settings, patients may discontinue treatments for various reasons, at different times, and at different rates. They might receive subsequent treatments or continue to participate in the trial, adding complexity to the data analysis. These variables create uncertainties not only in how to analyze the data but also in what comparisons should be made.

Post-randomization events can undermine the causal relationship established by randomization, especially if these events are related to the treatment and its outcomes. Examples include premature cessation of the assigned treatment, or the need to switch to or add a rescue treatment due to the initial treatment's inefficacy or toxicity. These situations can weaken the link between the assigned treatment group and the actual treatment received, introducing potential biases and confounding factors.

An over-reliance on the initial randomization, while disregarding subsequent events, might lead to inaccurate conclusions about the treatment's effects. This is because such an approach may measure the effect of being assigned to a treatment rather than the effect of the treatment itself. The relevance of post-randomization events depends on whether the analysis aims to understand the effect of the treatment as it was actually followed or as it would have been had it been followed strictly.

A strict "intention-to-treat" (ITT) approach, which ignores all post-randomization treatment changes and includes all outcomes regardless of treatment adherence, preserves the randomization structure and minimizes missing data. However, this method can confound the relationship between the treatment and outcomes, making it difficult to attribute effects to the initially randomized treatments. Hence, the ICH E9(R1) addendum and subsequent discussions, such as those in Chapter 3, emphasize the importance of clearly defining the treatment or regimen of interest.

Finally, accurately describing a treatment effect involves constructing an "estimand," which represents the specific clinical question being addressed. This process requires careful consideration of intercurrent events, such as treatment discontinuation, additional or alternative treatments, and terminal events like death, to ensure clarity and precision in the analysis.


* We can improve drug development, clarify and simplify analysis plans, and more clearly characterize the benefits and risks of potential medicines if we utilize clearly specified estimands
* The description of an estimand should reflect the clinical question of interest in respect of these intercurrent events, the choice of strategies can influence how more conventional attributes of a trial are reflected when describing the clinical question, for example the treatments, population or the variable (endpoint) of interest. 
* The statistical analysis of clinical trial data should be aligned to the estimand. 


### Estimand Framework

Central questions for drug development and licensing are to establish the existence, and to estimate the magnitude, of treatment effects: how the outcome of treatment compares to what would have happened to the same subjects under alternative treatment (i.e. had they not received the treatment, or had they received a different treatment).  An estimand is a precise description of the treatment effect reflecting the clinical question posed by a given clinical trial objective.  It summarises at a population level what the outcomes would be in the same patients under different treatment conditions being compared.  The targets of estimation are to be defined in advance of a clinical trial.  Once defined, a trial can be designed to enable reliable estimation of the targeted treatment effect.

  
```{r, echo=FALSE, fig.align="center", out.width = '100%',fig.cap="Figure: Study development process chart."}
knitr::include_graphics("./02_Plots/Estimand_Framework.png")
```

* **1a**: Identify who will use the trial results and what decisions they will make from those results. This is an essential first step because the estimand must align with the decision-maker(s) needs. Any one trial may need to address the diverse needs of multiple stakeholders, leading to the need for multiple objectives and estimands.
* **1b**: Define the general question of interest to the decision maker. This will typically include factors such as the interventions being compared, patient population, endpoint, and time scale.
* **2a**: List all the ICEs that are plausible to occur in the trial, noting their likelihood of occurrence. Doing this early in the process avoids overlooking aspects of the intervention effect that could cause confounding or bias in analysis
* **2b**: Define in detail the treatment regimen under investigation. The definition should include whether interest is exclusively in the initially randomized treatment or in treatment regimens that include the initially randomized treatment. It is therefore also necessary to specify whether each ICE is part of the regimen under investigation or is a departure from the intended regimen
* **2c**: There are four components needed to define an estimand: the population, the endpoint, the summary measure, and how ICEs will be handled. Each component is important. However, we are familiar with the first three, and therefore focus here is on handling ICEs. Based on the treatment regimen defined in 2B, specify the strategy to handle each type of ICE. The ICEs that are part of the regimen are handled using the treatment policy strategy. For those ICEs that are deviations from the treatment regimen, use the clinical question to determine which ICEs are outcomes (e.g., dropout due to adverse events is considered treatment failure). The remaining ICEs are confounding factors that may be problematic for the assessment of the outcome and treatment regimen of interest. To complete the definition of the estimand, define the population, endpoint, and summary measure considering the classifications of ICEs and chosen strategies to handle them. A  final step is to confirm that the estimand is aligned with the clinical objective and fits the stakeholder requirements.

The concept of an estimand in clinical research represents a precise definition of what is to be estimated from a trial to address a specific scientific question. An estimand framework helps align the trial design, conduct, and analyses with the objectives of the trial. It ensures that the study's findings are relevant and interpretable for decision-making by clinicians, regulators, and patients. Understanding the attributes of an estimand is crucial for the development and interpretation of clinical trials. Here's a detailed breakdown of each attribute:

#### 1. Treatment Condition of Interest {-}

This attribute defines the intervention(s) under study and the comparator(s). These can range from a single treatment to complex regimens involving multiple interventions, possibly including standard care additions or sequences of treatments. The definition should be clear whether the focus is on the direct effects of the interventions, their add-on effects, or the effects within a treatment sequence.

#### 2. Target Population {-}

The population attribute specifies the individuals to whom the research question is meant to apply. This can be the entire population enrolled in the trial, a specific subgroup identified by baseline characteristics, or a principal stratum defined by potential outcomes relative to intercurrent events. Identifying the target population helps in ensuring that the study findings are applicable and meaningful to those who would be receiving the intervention in a real-world setting.

#### 3. Variable (Endpoint) of Interest {-}

This involves specifying the outcome measure that will be used to assess the effect of the treatment. The definition of the variable should include considerations for how intercurrent events are handled, reflecting strategies such as treating certain events as treatment failures or successes, or focusing only on data collected while the patient was adherent to the treatment protocol. The variable should be directly relevant to the clinical question the trial seeks to answer.

#### 4. Intercurrent Events (ICEs) {-}

Intercurrent events are occurrences that take place after the initiation of treatment and can affect the interpretation or the very availability of the endpoint measurements. These events can complicate the analysis and interpretation of the trial outcomes, hence requiring careful consideration in the estimand strategy. Examples include treatment discontinuation, the initiation of an alternative therapy, death, and other significant health events not part of the endpoint itself. Strategies to address ICEs must be defined and aligned with the trial's objectives.

#### 5. Population-Level Summary {-}

The final attribute specifies how the outcomes (variables) will be summarized to compare the treatment conditions. This includes choosing an appropriate statistical measure such as risk difference, odds ratio, hazard ratio, or mean difference. The choice of summary measure should be informed by the nature of the variable, the study design, and the clinical question, ensuring that the summary provides a clear and interpretable comparison between the treatment conditions.

### Intercurrent Events (ICEs)

ICH E9 (R1) defines events that occur after randomization that alter the course of the randomized treatment as intercurrent (ICH, 2017). 
	
Therefore, ICEs are inherently connected to the definition of the treatment regimen. Some ICEs may not be a deviation from the treatment regimen of interest and therefore require no further consideration. Other ICEs are a deviation from the regimen of interest and must be dealt with in some manner, depending on the estimand of interest. 
	
ICH E9 (R1) provides several examples of ICEs: 

* use of an alternative treatment (e.g., a rescue medication, a medication prohibited by the protocol, or a subsequent line of therapy),
* discontinuation of treatment,
* treatment switching, 
terminal events such as death (ICH, 2017)

**Example**

To ground the discussion on identifying ICEs and to distinguish those that are deviations from the treatment of interest, we consider the following example of patient profiles in Table 3.1 from Ratitch et al. (2019a). We assume that the trial has three post-randomization visits. Patients have to take randomized treatment through visit 3 – the primary endpoint. The profiles in Table 3.1 describe treatment courses where various events may cause deviations from the initial randomized treatment.
	
Example Patient Profiles Depicting Various Intercurrent Events, X indicates adherence to the randomized treatment at an assessment, with all other symbols indicating ICEs that deviate from the randomized treatment.


|   | **    V1   ** | **    V2   ** | **    V3   ** | **    Treatment Received   **                                                                |
|---|---------------|---------------|---------------|----------------------------------------------------------------------------------------------|
| 1 |     X         |     X         |     X         |     Randomized   treatment alone through the end of study (ideal adherence)                  |
| 2 |     X         |     O         |     O         |     Randomized   treatment at V1; no treatment at V2, V3                                     |
| 3 |     X         |     ‡         |     ‡         |     Randomized   treatment at V1; randomized treatment + rescue at V2, V3                    |
| 4 |     X         |     +         |     +         |     Randomized   treatment at V1; rescue alone at V2, V3                                     |
| 5 |     X         |     ‡         |     +         |     Randomized   treatment at V1; randomized treatment + rescue at V2; rescue at V3          |
| 6 |     X         |     ‡         |     O         |     Randomized   treatment at V1; randomized treatment + rescue at V2; no treatment at V3    |
| 7 |     X         |     +         |     X         |     Randomized   treatment temporarily interrupted for rescue at V2                          |


### ITT Principle and  Treatment Regimen of Interest

- **Importance:** A clear definition is vital for all stakeholders, including researchers, clinicians, regulators, and payers. It sets expectations for the course of treatment, including dosages, concomitant medications, and rescue therapies.
- **Complexity:** Treatment regimens must account for initial treatments, dose adjustments, discontinuations due to adverse effects or lack of efficacy, and subsequent therapies.
- **Example:** A regimen may involve starting patients on an experimental drug or placebo, with provisions for discontinuation and subsequent management outlined.

The careful definition of treatment regimens and judicious application of ITT principles, whether traditional or modified, are foundational elements of clinical trial design and analysis. These methodologies serve to ensure that clinical trial outcomes are both scientifically robust and practically relevant, providing clear guidance for treatment decisions in real-world clinical settings. As clinical research continues to evolve, so too will the methodologies and frameworks used to define treatment regimens and analyze data, always with the goal of enhancing patient care and treatment outcomes.
 
- **Traditional ITT Approach:** Focuses on analyzing patients according to the treatment to which they were randomized, regardless of adherence or subsequent treatments. This approach helps to preserve the benefits of randomization, minimizing selection and treatment bias.
- **Components:**
  - **Inclusion of Patients:** All randomized patients are included in the analysis to maintain the causal link to randomization.
  - **Data Inclusion:** All data, including post-randomization events, are typically included, though this can introduce confounding.
- **Modified ITT Approach:** Adapts the traditional ITT principle to more accurately reflect the treatment effects of interest, especially in the presence of intercurrent events (ICEs) like rescue medication use.
  - **Adjustment for ICEs:** Inclusion of all randomized patients remains a constant, but the data included in the analysis may be modified to exclude post-rescue treatment data or other ICEs, aiming to reduce confounding and better isolate the effect of the initially randomized treatment.
  

## ICEs Strategies

Strategies for Addressing Intercurrent Events when Defining the Clinical Question of Interest

a. Composite variable strategies
b. While on treatment strategies
c. Hypothetical strategies
d. Principal stratum strategies
e. Principal stratum strategies
	

### Composite ICE Strategies
 
#### Considerations {-}
 
In composite strategies, the presence or absence of relevant intercurrent events is a component of the outcome variable (ICH, 2017). Composite variable strategies in clinical trials are designed to handle intercurrent events (ICEs) by incorporating them into the outcome measures. These strategies are a practical approach to ensure that the analysis remains robust in the face of deviations from the planned treatment regimen.

- **Composite Outcomes**: These are single measures that combine multiple individual endpoints into one. They are designed to capture a range of outcomes of interest and are particularly useful when any one of the components alone may not fully represent the therapeutic effect of the intervention.
- **Flexibility**: These strategies are adaptable to different trial designs and objectives. They allow for a comprehensive assessment of outcomes by considering all relevant events that occur during the study period.
- A key aspect of composite strategies is that the outcome definition results in no missing data due to intercurrent events although some data may still be missing due to other reasons (Mallinckrodt et al., 2019).
- **ICE as a Component**: The occurrence of an ICE is directly integrated into the outcome variable. This means the ICE itself is part of the composite measure. For instance, in a trial measuring the effectiveness of a heart disease medication, a composite outcome could be "myocardial infarction, stroke, or death."
- **Informative ICEs**: An ICE is considered informative about the patient's outcome. For example, if the ICE is treatment discontinuation due to adverse effects, it speaks to the tolerability of the treatment and is therefore an important part of the treatment's risk-benefit profile.
- **Surrogate Values**: When assigning surrogate values for ICEs in numerical outcomes, choosing an appropriate and justifiable value is critical. This decision can have significant effects on the data distribution and variance.
- **Statistical Methods**: Depending on the composite outcomes and the distribution of data, robust or nonparametric statistical methods might be necessary to handle skewed distributions or inflated variances.

#### Scenarios Application {-}

**Scenario 1:**

- Focus: Treatment regimen includes the initially randomized treatment, with or without rescue medication. In cases where ICEs are relevant to the trial's outcomes, such as early discontinuation, they are accounted for in the composite strategy. Patients who discontinue early might be categorized as failures, while those who adhere are categorized based on their clinical response.
- Strategy: Composite and treatment policy strategies are used. Patients who discontinue early are considered treatment failures, and rescue medication is incorporated into the treatment regimen of interest.

**Scenario 2:**

- Focus: Initially randomized treatment without rescue medication. In composite strategies, ICEs such as death or treatment discontinuation provide critical information about treatment outcomes, and further data collection after an ICE is usually not considered informative for the original treatment outcome measure.
- Strategy: Composite strategy is applied, where early discontinuation and rescue medication use lead to classification as treatment failures.

**Scenario 3:**

- **Binary Endpoints**: In a binary responder/non-responder model, patients who experience an ICE like premature treatment discontinuation may automatically be classified as non-responders.


### Treatment Policy ICE Strategies

#### Considerations {-}

The treatment policy strategy is a nuanced approach within the framework of clinical trials that aims to assess the effect of treatments by considering all randomized patients in the analysis, regardless of subsequent events that might typically be considered deviations from the study protocol. This strategy embodies a specific interpretation of the intention-to-treat (ITT) principle, focusing on preserving the benefits of randomization while addressing the complexities introduced by intercurrent events (ICEs).

- **Irrelevance of ICEs:** In this strategy, the occurrence of ICEs, such as discontinuing the study treatment, switching medications, or deviations from the prescribed treatment regimen, is considered irrelevant for the definition of the treatment effect. This means the analysis aims to capture the effect of being allocated to a treatment, not necessarily the effect of strictly following that treatment.

- **Use of Observed Data:** The strategy utilizes observed outcomes for all participants as planned, without trying to adjust for or impute data based on whether an ICE occurred. This approach is sometimes referred to as a "pure ITT approach" because it includes all randomized participants in the analysis, adhering to the principle of evaluating the effect of assignment to treatment rather than the effect of the treatment itself.

- **Preservation of Randomization:** One of the primary motivations for this strategy is the preservation of the benefits of randomization, which helps to minimize bias and confounding, thereby providing a more reliable estimate of treatment effect.

- **Limitations for Certain ICEs:** The strategy has limitations, especially when dealing with ICEs such as death, which inherently prevent the observation of the outcome of interest. In these cases, the treatment policy strategy cannot be applied as intended unless death is the primary outcome. For trials where few deaths are expected, the strategy might still be relevant by treating death as a missing outcome.

- **Broadened Treatment Regimens:** By including all randomized participants and ignoring deviations from the treatment regimen, this strategy essentially broadens the scope of treatment regimens under evaluation. This broad approach can sometimes dilute the specificity of the treatment effect being measured, potentially making the results less directly applicable to clinical practice.

- **Assumptions on Missing Data:** Like all strategies dealing with missing data and deviations from the protocol, the treatment policy strategy requires assumptions about the nature and impact of missing data. These assumptions can influence the robustness and validity of the study's findings.

- **Real-World Relevance:** There's an assumption that the treatment regimens followed within the trial context mirror those in real-world clinical practice. This assumption supports the generalizability of the trial findings but may not always hold true, especially in trials with strict protocols that differ from typical clinical settings.

#### Scenarios Application {-}


**Scenario 1:**Including Rescue Medication in the Treatment Regimen

- **Clinical Question:** The interest is in evaluating a treatment regimen that encompasses the initially randomized treatment, acknowledging that adding rescue medication may be part of the clinical reality for some patients. This scenario aims to assess the effectiveness of the initial treatment under more flexible, real-world conditions.
- **Handling Early Discontinuation:** A composite strategy is employed for early discontinuation, categorizing these patients as treatment failures. This approach simplifies the analysis by creating a binary outcome (success or failure), where failure includes not just lack of improvement but also inability to continue the treatment for whatever reason.
- **Handling Rescue Medication:** The use of rescue medication is integrated into the treatment regimen of interest, reflecting a treatment policy strategy. This approach recognizes that the addition of rescue medication is a part of the therapeutic strategy for some patients. The analysis does not penalize the initial treatment group for the use of rescue medication but instead considers it an integral part of the treatment pathway.


### Hypothetical ICE Strategies

#### Considerations {-}

Hypothetical strategies in clinical trials offer a framework to estimate the effects of treatments under conditions that deviate from the observed trial protocol due to intercurrent events (ICEs). These strategies create a counterfactual scenario that answers "what if" questions, such as what the outcomes would have been if patients had adhered to the treatment protocol without the need for rescue medication or if they had not discontinued the study. 

- **Defining the Hypothetical Condition:** Clearly specifying the hypothetical scenario is crucial. This includes detailing what is assumed to happen (e.g., no rescue medication is used) and what is not to happen (e.g., patients do not discontinue the treatment).

- **Addressing Scientific Questions:** These strategies are designed to answer specific scientific or medical questions that are relevant to understanding the treatment's efficacy or safety under idealized conditions. This can include assessing the drug's effect if taken as directed or the potential outcomes if alternative treatment regimens were followed.

- **Treatment Effect Estimation:** Hypothetical strategies are particularly useful in estimating the pure effect of a treatment, abstracting from the real-world issues of non-adherence or the need for rescue medication. This can provide a clearer picture of the drug's efficacy under ideal conditions.

- **Assessing Drug Risk:** These strategies also play a crucial role in assessing drug risk by estimating what adverse effects might have occurred if patients remained adherent to a treatment that increases risk factors (e.g., blood pressure).

- **Ethical Considerations:** While hypothetical strategies allow for the estimation of outcomes under idealized conditions, they are based on assumptions that may not fully reflect real-world behavior. Ethical considerations arise, especially when estimating outcomes in scenarios that cannot be ethically implemented in a trial (e.g., withholding rescue medication).

- **Sensitivity Analyses:** Given the reliance on assumptions, conducting sensitivity analyses is crucial to assess the robustness of the hypothetical scenario estimates. This can help understand how changes in the underlying assumptions may affect the estimated treatment effects

- **Assumption Validity:** The validity of hypothetical strategy results depends heavily on the assumptions made about how patients would behave or respond in the counterfactual scenario. These assumptions are not directly testable, making the interpretations of such analyses speculative to some degree.

- **Complexity in Implementation:** Implementing hypothetical strategies, especially reference-based imputation methods, can be technically challenging. It requires careful consideration of the statistical methods and assumptions about the missing data mechanism.




#### Scenarios Application {-}

**Scenario 1:**

- Focus: Initially randomized treatment with the aim to estimate what would have happened if patients had adhered to the treatment as directed.
- Strategy: Hypothetical or principal stratification strategies are used to estimate treatment effects as if ICEs (like early discontinuation or rescue medication use) did not occur.

### While-on Treatment ICE Strategies

#### Considerations {-}

"While on treatment" strategies are a set of analytical approaches used in clinical trials to address intercurrent events (ICEs) that affect the continuity of treatment in study participants. The central premise of this strategy is to focus on the data collected while the patients are receiving the treatment as per the study protocol, up until the occurrence of any ICE, such as discontinuation of treatment for any reason. 

- **Outcome Focus**: The primary interest is in the outcomes that occur while the patients are on the treatment. Any data after the occurrence of an ICE, which interrupts the planned treatment regimen, is not considered when evaluating the treatment effect.
- **Repeated Measures**: When outcomes are measured repeatedly over time, the analysis will consider all available data up until the ICE. For instance, if a patient's response to treatment is measured weekly and the patient drops out of the study in week 5, only the first five weeks of data will be used in the analysis.
- **Endpoint Determination**: The endpoint for the analysis might be set at the last available measurement before the ICE, instead of a pre-specified time point that applies to all patients. This allows for the assessment of treatment effect based on actual treatment exposure.
- **Clinical Relevance**: This strategy is particularly applicable when the duration of treatment is not a critical factor in the clinical outcome, or when the outcome's occurrence is assumed to be constant over the time of treatment exposure.
-  **Statistical Analysis**: Techniques like slope analysis using linear mixed models or two-stage slope analysis can be utilized to assess the rate of change over time while the patients are on treatment.
- **Missing Data**: A notable advantage of this strategy is that it inherently addresses the issue of missing data due to ICEs, as the analysis only considers the on-treatment period.
- **Timing of ICEs**: The strategy assumes that the timing of ICEs does not impact the treatment effect, which means that early or late occurrence of an ICE is not supposed to affect the outcome.
- **Constancy Assumption**: There's an underlying assumption that the rate of change in the outcome, or the hazard of an event, is constant over time. This needs to be verified for validity, as it may not hold true for all clinical outcomes.


#### Scenarios Application {-}

**Scenario 1:**

- **Palliative Treatments**: In cases where treatments are intended to alleviate symptoms, such as in terminal illnesses, the effectiveness of the treatment until the time of discontinuation due to death is of interest.
- **Constant Hazard**: If the event rate or the hazard is assumed to be consistent over the period of treatment, this strategy allows for an analysis that reflects the true treatment effect without the confounding influence of post-ICE data.

### Principal Stratification ICE Strategies

#### Considerations {-}

Principal stratification is a statistical technique used in causal inference to address the issue of intercurrent events (ICEs) in randomized clinical trials. It focuses on estimating the causal effect of a treatment within specific subgroups (strata) of participants, defined by their potential outcomes under different treatment scenarios. This approach is particularly useful for dealing with situations where not all participants adhere to the treatment protocol, or where events like death or the need for rescue medication may impact the analysis.

- **Strata Definition:** Principal strata are defined based on potential outcomes with respect to an ICE under different treatment conditions. For instance, strata might include patients who would adhere to treatment regardless of being in the experimental or control group, or patients who would survive under either treatment condition.

- **Estimating Causal Effects:** By focusing on these predefined strata, researchers can estimate the causal effect of a treatment within groups that are meaningful from a clinical perspective, such as the effect of a drug among those who would adhere to it in real-world settings.

- **Handling ICEs:** Principal stratification is particularly adept at handling ICEs like study discontinuation, use of rescue medication, or death, allowing for more nuanced analyses than simply treating these events as non-informative censoring or ignoring them.

- **Prescribing Guidance:** The results from principal stratification analyses can aid physicians in making more informed prescribing decisions, matching patient profiles to those of the trial subgroups for which positive effects were observed.

- **Treatment Candidates:** This approach can also help in identifying which patients are suitable candidates for a treatment, especially when considering the severity of illness and the likelihood of adherence.

- **Stratum Membership:** A key assumption is that it's possible to predict to which stratum a patient belongs based on observed covariates, despite the actual stratum membership being unobservable. This requires comprehensive modeling to ensure that all relevant factors are considered.

- **Causality Preservation:** The approach assumes that the causal effects estimated within strata are unbiased and that the probabilities of stratum memberships are accurately estimated, which is crucial for the validity of the conclusions drawn.

- **Clinical Practice Alignment:** Especially when accounting for adherence or rescue medication use, it's assumed that the decisions made in the trial context are reflective of those in real-world clinical practice. This alignment is essential for the applicability of the trial findings to actual patient care.

#### Scenarios Application {-}

**Scenario 1:**
- Focus: Initially randomized treatment with the aim to estimate what would have happened if patients had adhered to the treatment as directed.
- Strategy: Hypothetical or principal stratification strategies are used to estimate treatment effects as if ICEs (like early discontinuation or rescue medication use) did not occur.

**Scenario 2:**

- **Survivor Average Causal Effect (SACE):** In studies where death is an ICE, SACE estimates the effect of treatment on the quality of life among the subgroup of patients who would survive under either treatment.

- **Adherence:** In the context of study drug discontinuation, principal stratification can help understand the effect of a treatment among those who would adhere to the treatment protocol, providing insights into its efficacy under ideal adherence conditions.

- **Vaccine Trials:** For vaccines aiming to reduce symptom severity, the focus can be on the stratum of patients who would have become infected regardless of vaccination status, avoiding bias from analyzing only those who got infected.

## Missing Data

Incomplete data must be addressed in the analyses. However, addressing missing data requires unverifiable assumptions because we simply do not have the missing data about which the assumptions are made (Verbeke and Molenberghs, 2000). Despite the occurrence of incomplete data, evaluation of relevant estimands may be valid provided the statistical methods used are sensible. Carpenter and Kenward (2007) define a sensible analysis as one where:

1. The variation between the intervention effect estimated from the trial data and that in the population is random. In other words, trial results are not systematically biased.

2. As the sample size increases, the variation between the intervention effect estimated from the trial data and that in the population gets smaller and smaller. In other words, as the size of the trial increases, the estimated intervention effect more closely reflects the true value in the population. Such estimates are called consistent in statistical terminology.

3. The estimate of the variability between the trial intervention effect and the true effect in the population (i.e., the standard error) correctly reflects the uncertainty in the data.

When drawing inferences from incomplete data, it is important to recognize that the potential bias from missing data can either mask or exaggerate the true difference between treatments for the relevant estimand (Mallinckrodt et al., 2008; NRC, 2010). Moreover, the direction of bias has different implications in different scenarios. For example, underestimating treatment differences in efficacy is bias against an experimental treatment that is superior to control but is bias in favor of an experimental treatment that is inferior to control. This situation has particularly important inferential implications in non-inferiority testing. Underestimating treatment differences in safety is bias in favor of an experimental treatment that is less safe than control but is bias against the experimental drug that is safer than control (Mallinckrodt and Lipkovich, 2017).


### Estimators for What Would Have Happened in the Absence of Relevant Intercurrent Events

Typically, data after relevant intercurrent events are excluded from analyses (considered missing) either because they were not observed or the data that were observed are not relevant in estimating the estimand of interest. As such, methods commonly used in missing data situations are applicable. The choice of specific method depends on plausibility of assumptions. Therefore, missing data assumptions are central in choosing methods for hypothetical strategies. The distinction between missing at random (MAR) and missing not at random (MNAR) is particularly important (Mallinckrodt et al., 2019).

Methods valid under MAR include 

* maximum likelihood (ML), restricted ML, 
* multiple imputation (MI), 
* inverse probability weighting (IPW) (Molenberghs and Kenward, 2007). 

Some MNAR methods include the controlled imputation family of methods, selection models, shared parameter models, and a variety of pattern-mixture models (Verbeke and Molenberghs, 2000; Molenberghs and Kenward, 2007; Mallinckrodt and Lipkovich, 2017). Although no universally best approach exists, when modeling what would have happened if intercurrent events had not occurred, it is often reasonable to begin with approaches based on MAR and then use MNAR methods to assess sensitivity to departures from MAR.

* **Likelihood-Based Analyses**: These analyses can ignore the missing data process and still provide unbiased estimates if the missing data are either Missing Completely At Random (MCAR) or Missing At Random (MAR), and the model is correctly specified. For clinical trials, fitting a suitable likelihood-based repeated measures analysis is beneficial, especially when estimating scenarios like early termination of treatment or if patients had continued with the initially randomized medication.

* **Multiple Imputation (MI)**: MI, based on the MAR assumption, is a popular method for dealing with missing data. It involves creating multiple complete datasets by imputing missing values using a likelihood-based model, analyzing these datasets, and then combining the results. MI is flexible and particularly useful in scenarios where baseline covariates are missing, errors are not normally distributed, or inclusive modeling strategies are needed. Markov chain Monte Carlo (MCMC) sampling is a common technique used in MI for intermittent missing data.

* **Inverse Probability Weighting (IPW)**: IPW corrects for the bias introduced by non-random dropout or other ICEs. It weights the observed data by the inverse probability of the data not being missing, effectively creating a dataset that represents what the complete data might have looked like.

* **Considerations for Categorical and Time to Event Data**: Modeling considerations for categorical data differ from continuous outcomes, particularly in terms of inference. Separate models are needed for marginal and hierarchical inference in non-normal data due to differences in the link between the outcome variable means and covariates. Common time-to-event analysis methods, such as Kaplan-Meier and Cox regression, often assume censoring at random, meaning the censoring times are independent of the event times. This assumption allows for ignoring the censoring mechanism in the analysis.



### Estimators for Treatment Policies That Were Not Included in the Trial or Not Followed

Examples of estimands for this category include the difference between treatments regardless of adherence and without initiation of rescue medication. One specific example of this is what would have happened if patients took placebo after discontinuing the initially randomized study drug. Recently, a family of methods referred to as reference-based controlled imputation has emerged that are specific versions of pattern-mixture models designed to address these switches in treatment (see Mallinckrodt et al., 2019 and references therein). 

**Reference-Based Approaches Using Multiple Imputation**

In reference-based methods, the common idea is to construct a principled set of imputations that model specific changes in treatment. After relevant ICEs, values are multiply imputed by making qualitative reference to another arm in the trial. In other words, imputed post-ICE values have the statistical behavior of otherwise similar patients in a reference group. Initial implementations of reference-based imputation used MI (Carpenter, Roger, and Kenward, 2013). Reference-based imputations can be tailored to specific scenarios. These methods are designed to estimate the effects of treatment under specific scenarios and include jump to reference (J2R), copy reference (CR), and copy increment from reference (CIR).

* **Jump to Reference (J2R)**: In this approach, after an ICE, patients in the experimental arm are treated as if they received the reference arm treatment (e.g., placebo) immediately following the ICE. This method assumes that the treatment effect disappears as soon as there is a deviation from the intended treatment regimen.

* **Copy Reference (CR)**: Here, the treatment effect gradually diminishes after an ICE, in line with the correlation structure of the imputation model. It credits the drug arm for any benefit observed before the ICE, which then decreases over time.

* **Copy Increment from Reference (CIR)**: This method maintains the treatment effect observed at the time of the ICE by assuming the same rate of change or increments between visits as in the reference group.

Application in Multiple Imputation (MI): Traditional MI based on MAR involves regression on residuals. In reference-based imputation, this concept is adapted:

* **For J2R**, residuals are added to the reference arm mean.
* **In CR**, the residuals are determined by the deviation from the reference arm mean.
* **For CIR**, residuals are similar to MAR-based MI and J2R, but imputed values are added to hypothetical means to match the trajectory of the reference group.

**Likelihood and Bayesian Approaches to Reference-Based Imputation**

Likelihood and Bayesian Approaches: These approaches provide alternatives to MI-based reference imputation. Unlike MI that creates multiple completed data sets, likelihood and Bayesian methods use a single analysis where means estimated from the data implicitly impute for missing or irrelevant data. This is conceptually similar to the J2R MI approach but can have technical challenges in estimating uncertainty and might estimate slightly different estimands.


## Sensitivity Analyses

### General Considerations

ICH E9 (R1) Draft Addendum (ICH, 2017) states that the purpose of sensitivity analyses is to assess whether inferences based on an estimand are robust to limitations in the data and deviations from the assumptions used in the statistical model for the main estimator. The addendum further notes the statistical assumptions underpinning the main estimator should be  documented, and that one or more analyses focused on the same estimand should be prespecified as sensitivity analyses. The addendum recommends that sensitivity analysis should not alter many aspects of the main analysis s imultaneously. It is preferable to alter one aspect at a time in order to clearly identify how each assumption impacts robustness (ICH, 2017).

The addendum also draws distinction between testable and untestable assumptions. The focus of this chapter is mostly on untestable assumptions because this is where sensitivity analyses are needed. Assumptions such as normality or linearity are testable. When these assumptions are proven to be invalid, an alternative statistical method or model will clearly be needed and usually readily found. For example, if normality assumptions are violated, a nonparametric method can be used instead, and inferences can be based on the alternative analysis. Alternatively, data transformations can be considered. In contrast, with untestable assumptions, there is no objective basis upon which to select or compare models; therefore, the goal of sensitivity analyses is to quantify to what degree inferences from the primary analysis are influenced by plausible departures from assumptions (ICH, 2017).

The addendum notes that missing data require attention in sensitivity analysis because the assumptions underlying any method may be hard to justify and may not be testable (ICH, 2017). However, given that the addendum focuses heavily on extending previous discussions on missing data into the broader context of handling of intercurrent events, so too should sensitivity analyses move beyond assessing the impact of missing data assumptions to more broadly assessing sensitivity to methods of accounting for intercurrent events.


### Supplementary Analyses

The ICH E9 (R1) Draft Addendum distinguishes sensitivity analyses from supplementary analyses. It states that interpretation of trial results should focus on the primary estimand and primary estimator, whereas supplementary analyses targeting different estimands play a secondary role in order to more fully understand the treatment effects (ICH, 2017). Supplementary analyses can include different estimands that involve the primary endpoint and/or the primary estimand based on secondary endpoints.

**Example**: A common supplementary analysis could be augmenting a mean change analysis (e.g., average improvement in a symptom) with a responder rate analysis (e.g., percentage of patients showing clinically relevant improvements). Supplementary analyses can assess different aspects of the same clinical outcome. For instance, alongside analyzing symptom severity, additional analyses might focus on quality of life, functional outcomes, or related secondary symptoms (like changes in sleep disturbances in a pain treatment trial).

Supplementary analyses can also be used to explore the impact of data limitations, such as protocol violations. Historically, analysts compared results from the full analysis set with a per-protocol subset (patients with no meaningful protocol violations). However, the ICH E9 (R1) Draft Addendum cautions that per-protocol sets might introduce bias due to the loss of randomization and that many protocol violations can be handled as intercurrent events within the construction of the estimands.

### Accounting for Missing Data Assumptions

It is important to keep missing data sensitivity analyses within the overall context of assessing uncertainty in clinical trial results. This uncertainty arises from different sources: 

* (1) inherent imprecision in parameters of the model estimated from a finite sample
* (2) model selection (e.g., for the mean and covariance functions)
* (3) the level of uncertainty due to  incomplete data. 

Differentiating between Missing At Random (MAR) and Missing Not At Random (MNAR) is challenging in practice, as the fit of an MNAR model can be replicated by an MAR model. The primary strategy is to assume MAR for the main analysis and then focus on sensitivity analyses to explore the impact of deviations from this assumption. These analyses aim to understand how treatment effect inferences change with different assumptions about the missing data.

**Method**

* **Multiple MNAR Models Comparison**: Involves comparing results from various MNAR models, though this can be challenging due to potential model inaccuracies.

* **Adding Sensitivity Parameters**: A more preferred method is to add sensitivity parameters to the primary analysis model and vary them across a plausible range to assess departures from MAR.

* **Controlled-Imputation Methods**: These methods, such as reference-based imputation and delta adjustment, are favored for their transparent assumptions. Delta adjustment, for example, involves varying a sensitivity parameter (delta) across values that increasingly deviate from MAR. This "tipping-point approach" assesses whether the treatment effect remains significant despite plausible departures from MAR.

* **Delta Adjustment Application**: Delta adjustment can be applied to different types of outcomes (continuous, time-to-event, categorical) to assess treatment effects under varying assumptions. It helps ascertain the values of delta where the treatment effect maintains or loses its clinical relevance.

* **Reference-Based Imputation**: This approach is used to model scenarios like treatment discontinuation, assuming no treatment benefit post-discontinuation by imputing values as if the patient were in a placebo group. This method is applicable to various outcome types.

### Accounting for Intercurrent Events

**Sensitivity Analyses for Hypothetical Strategies:**

* Focus on assessing robustness against assumptions in hypothetical scenarios, like estimating treatment effects assuming all patients adhered to their initial treatment.
* Utilize methods like delta-adjustment to evaluate the impact of deviations from these assumptions.
* Can be applied to various hypothetical settings, including effectiveness assessments and assumptions about non-adherence.


**Sensitivity Analyses for Composite Strategies:**

* Consider how adherence decisions in trials compare to those in clinical practice.
* Moreover, for composite strategies, it is also useful to assess s ensitivity to the actual outcomes that are assigned. For example, if patients who discontinue study drug are arbitrarily assigned an unfavorable value for a continuous value, that value should be specified and justified in the protocol with prespecified sensitivity analyses that include alternative values. 
* Similar considerations apply to ranked outcomes. For example, one might assume that early discontinuation is a worse outcome than any observed outcome, but this is an assumption and sensitivity to it should be investigated. 
* Furthermore, if it is assumed that all patients with a relevant ICE are treatment failures, sensitivity should be assessed by varying the failure rate; it can be especially useful to use rates based on the placebo group rather than assuming failure for all patients with the ICE.

**Sensitivity Analyses for Principal Stratification Strategies:**

* Focus on the assumption that stratum memberships (e.g., adherence levels) are correctly estimated.
* Involve testing alternative models or varying stratum membership to assess treatment effect variability.

**Sensitivity Analyses for While-on-Treatment Strategies:**

* Assess the assumption of constant rates or hazards over time in treatment effects.
* Useful for outcomes summarized by rates or hazards that are assumed to be stable over the treatment period.

**Sensitivity Analyses for Treatment Policy Strategies:**

* Evaluate the realism of treatment regimens followed in trials compared to clinical practice.
* Consider hypothetical regimens for patients who deviate from the trial protocol.
* For example, impute values for patients discontinuing treatment as if they switched to standard care, reflecting real-world scenarios.
* Address inevitable missing data and its impact on the analysis.


## Application

### Early-Phase Trials

Estimands in early-phase clinical trials serve as a critical foundation for defining the specific questions that the trial aims to answer, particularly when it comes to establishing proof of concept or initial evidence of efficacy. These trials often differ in their focus and methodology compared to late-phase trials, and understanding these differences is key to designing effective early-phase studies. 

- **Proof of Concept:** Early-phase trials, especially Phase I and II trials, are primarily designed to establish whether a new treatment has enough promise to warrant further investigation. The estimands in these trials often focus on the initial treatment's effect without the extensive treatment policies or comparisons typical of Phase III trials.

- **Treatment Policies:** While confirmatory trials may extensively explore treatment policies, such as adherence and management of ICEs, early-phase trials might adopt simpler strategies focusing on immediate treatment effects.

- **Regulatory Stakeholders:** Some early-phase trials, particularly in fields like oncology, are designed with regulatory submissions in mind. These might adopt a primary estimand akin to those seen in confirmatory trials to meet specific regulatory requirements.

**Single-Arm Trials**

- **Lack of Concurrent Control:** Early-phase trials frequently use a single-arm design without a control group. In such settings, estimands are crafted to assess treatment effects without direct within-trial comparisons.
- **Historical Comparisons:** When trials lack a control arm, estimands may involve comparisons to historical data or predefined targets. This approach requires careful consideration to ensure the relevance and validity of the comparison.

**Handling Intercurrent Events (ICEs)**

- **Similar Considerations for ICEs:** Despite differences in design and objectives, the approach to handling ICEs in early-phase trials involves considerations similar to those in late-phase trials. However, the strategies employed (e.g., hypothetical or composite strategies) might be simplified or adapted to the trial's exploratory nature.
- **Comparisons with Historical Controls:** For trials using historical comparisons, strategies like hypothetical or composite approaches can facilitate clearer, more defined scenarios that aid in making like-for-like comparisons or in understanding the differences between the trial conditions and historical data.

### Real-World Evidence Studies

Estimands in Real-World Evidence (RWE) studies introduce a complex yet insightful dimension to clinical research, aiming to bridge the gap between controlled clinical trial conditions and the diverse scenarios encountered in everyday healthcare settings. The unique characteristics of RWE studies demand a nuanced approach to defining estimands, incorporating the realities of patient heterogeneity, varied treatment regimes, and the multifaceted nature of intercurrent events (ICEs) and endpoints.

#### Population {-}
- **Heterogeneity, Eligibility, and Representation:** RWE studies often encompass a broader and more heterogeneous patient population compared to traditional clinical trials (TCTs). This inclusivity enables a more comprehensive understanding of treatment effects across diverse demographic and clinical backgrounds, addressing the representativeness and applicability of study findings to real-world settings.

#### Treatment {-}
- **Adherence, Preferences, and Dynamic Regimes:** Treatment patterns in RWE studies can be complex, reflecting real-life variations in patient adherence, prescribing behaviors, and adjustments over time. This complexity underscores the importance of accurately capturing and considering these factors in study designs to ensure that estimands reflect true clinical practice.

#### Endpoints {-}
- **Surrogate Endpoints, Clinical Outcomes, and Survival:** The choice of endpoints in RWE studies may lean towards direct clinical outcomes and survival measures rather than surrogate endpoints, which are more common in TCTs. The selection is often dictated by the availability and reliability of data in real-world settings, necessitating careful consideration to ensure meaningful and actionable insights.


#### Intercurrent Events (ICEs) {-}
- **Drug-Induced, Behavioral, and Non-Behavioral Adherence:** ICEs in RWE studies encompass a wide range of events that can influence treatment outcomes, from adverse events and efficacy concerns to behavioral factors and systemic issues like changes in healthcare coverage. Understanding and categorizing these events is crucial for defining estimands that accurately reflect the complexities of real-world treatment experiences.

#### Population-Level Summary {-}
- **Choice of Summary Measures:** The selection of appropriate population-level summary measures in RWE studies is guided by the nature of the endpoint and the clinical question at hand. The measure should facilitate a clear and interpretable comparison of treatment effects, taking into account the statistical properties and the ease of interpretation for stakeholders.

#### Challenges and Considerations {-}
- **Causal Inference Framework:** The application of a causal inference framework in RWE studies helps in formalizing estimands and understanding the assumptions necessary for drawing valid conclusions from the data. However, the technical language and concepts may pose a barrier to non-quantitative stakeholders, highlighting the need for clear communication and education.
  
- **Data Quality and Integrity:** The reliability of RWE studies heavily depends on the quality of real-world data (RWD) and the robustness of study design and implementation. Ensuring high-quality data capture, particularly regarding treatment adherence and ICEs, is essential for generating credible and clinically meaningful RWE.

- **Stakeholder Engagement:** Engaging a broad range of stakeholders, including patients, healthcare providers, and policymakers, in the design and interpretation of RWE studies is critical. This engagement ensures that estimands are relevant to real-world clinical decisions and health policy considerations.

## Reference

* Mallinckrodt, Craig & Molenberghs, Geert & Lipkovich, Ilya & Ratitch, Bohdana. (2019). Estimands, Estimators and Sensitivity Analysis in Clinical Trials. 10.1201/9780429488825. 
* Chen, Jie & Scharfstein, Daniel & Wang, Hongwei & Yu, Binbing & Song, Yang & He, Weili & Scott, John & Lin, Xiwu & Lee, Hana. (2023). Estimands in Real-World Evidence Studies. 

