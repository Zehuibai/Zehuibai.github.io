<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title> Box Plot</title>

<script src="site_libs/header-attrs-2.28/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Zehui Bai</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="02-Clinical_Experience.html">
    <span class="fa fa-user"></span>
     
    Clinical Experience
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-sliders"></span>
     
    Sample Size
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="03-SSC-Everything-to-Know-About-Sample-Size-Determination.html">Everything to Know About Sample Size Determination</a>
    </li>
    <li>
      <a href="03-SSC-Choosing-the-Effect-Size-for-Sample-Size-Calculations.html">Choosing the Effect Size</a>
    </li>
    <li>
      <a href="03-SSC-Sample-Size-and-Power-for-Non-Parametric-Analysis.html">Sample Size and Power for Non-Parametric Analysis</a>
    </li>
    <li>
      <a href="03-SSC-Power-for-Complex-Hypotheses.html">Power for Complex Hypotheses</a>
    </li>
    <li>
      <a href="03-SSC-Alternatives-to-Power.html">Bayesian methods - Alternatives to Power</a>
    </li>
    <li>
      <a href="03-SSC-Sample-Size-for-Pilot-Studies.html">Sample Size for Pilot Studies</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-pencil-square-o"></span>
     
    Study Design
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="04-Design-Estimands.html">Estimands and Sensitivity Analyses</a>
    </li>
    <li>
      <a href="04-Design-Dose-Escalation-and-Stratification-Designs.html">Dose Escalation and Stratification Designs in Early Oncology Development</a>
    </li>
    <li>
      <a href="04-Design-Phase-I-Trials---Design-Considerations.html">Phase I Trials - Design Considerations</a>
    </li>
    <li>
      <a href="04-Design-Phase-II-Trials---Design-Considerations.html">Phase II Trials - Design Considerations</a>
    </li>
    <li>
      <a href="04-Design-Phase-III-Trials---Design-Considerations.html">Phase III Trials - Design Considerations</a>
    </li>
    <li>
      <a href="04-Design-Phase-IV-Trials---Design-Considerations.html">Phase IV Trials - Design Considerations for Post Marketing Surveillance</a>
    </li>
    <li>
      <a href="04-Design-Design-and-Monitoring-of-Adaptive-Clinical-Trials.html">Design and Monitoring of Adaptive Clinical Trials</a>
    </li>
    <li>
      <a href="04-Design-Design-and-Evaluation-of-Complex-Sequential-Trials.html">Design and Evaluation of Complex Sequential Analysis Trials</a>
    </li>
    <li>
      <a href="04-Design-Design-and-Evaluation-of-Diagnostic-Study.html">Design and Evaluation of Diagnostic Study</a>
    </li>
    <li>
      <a href="04-Design-Hierarchical-composite-endpoints.html">Hierarchical Composite Endpoints</a>
    </li>
    <li>
      <a href="04-Design-Externally-Controlled-Trials.html">Considerations for the Design and Conduct of Externally Controlled Trials</a>
    </li>
    <li>
      <a href="04-Design-Noninferiority-Trials.html">Noninferiority Trials</a>
    </li>
    <li>
      <a href="04-Design-Bioequivalence-and-Biosimilar-Trials.html">Bioequivalence and Biosimilar Trials</a>
    </li>
    <li>
      <a href="04-Design-Exploring-Survival-Analysis-Designs-for-Clinical-Trials.html">Exploring Survival Analysis Designs for Clinical Trials</a>
    </li>
    <li>
      <a href="04-Design-Projecting-How-Long-Your-Trial-Will-Take.html">Projecting How Long Your Trial Will Take</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-line-chart"></span>
     
    Data Visualization
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="05-Plot-Adverse-Event.html">Adverse Event Visualization</a>
    </li>
    <li>
      <a href="05-Plot-Laboratory-Data.html">Laboratory Data Visualization</a>
    </li>
    <li>
      <a href="05-Plot-Time-To-Event.html">Time to Event Data Visualization</a>
    </li>
    <li>
      <a href="05-Plot-PRO-Data.html">Patient Reported Outcome Data Visualization</a>
    </li>
    <li>
      <a href="05-Plot-SSC-and-Power-Calculation.html">Sample Size and Power Calculations Visualization</a>
    </li>
    <li>
      <a href="05-Plot-Correlation.html">Correlation Visualization</a>
    </li>
    <li>
      <a href="05-Plot-ScatterPlot.html">Scatter and Line Plot</a>
    </li>
    <li>
      <a href="05-Plot-BarPlot.html">Bar Chart</a>
    </li>
    <li>
      <a href="05-Plot-PieChart.html">Pie Chart</a>
    </li>
    <li>
      <a href="05-Plot-BoxPlot.html">Box Plot</a>
    </li>
    <li>
      <a href="05-Plot-Histogram.html">Histogram</a>
    </li>
    <li>
      <a href="05-Plot-Forest-Plot.html">Forest Plot</a>
    </li>
    <li>
      <a href="05-Plot-Flow-Chart.html">Flow Chart</a>
    </li>
    <li>
      <a href="05-Plot-Some-Interesting.html">Some Interesting Plots</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-line-chart"></span>
     
    Statistical Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="06-Analysis-Linear-Regression.html">Linear Regression</a>
    </li>
    <li>
      <a href="06-Analysis-Logistic-Regression.html">Logistic Regression</a>
    </li>
    <li>
      <a href="06-Analysis-Mixed-Model.html">Mixed Model</a>
    </li>
    <li>
      <a href="06-Analysis-MMRM.html">Mixed Model Repeated Measures</a>
    </li>
    <li>
      <a href="06-Analysis-GEE.html">Generalized Estimating Equation</a>
    </li>
    <li>
      <a href="06-Analysis-ANOVA.html">Analysis of Variance</a>
    </li>
    <li>
      <a href="06-Analysis-Survival-Analysis.html">Survival Analysis</a>
    </li>
    <li>
      <a href="06-Analysis-Survival-Competing-Risk.html">Survival Analysis - Competing Risk</a>
    </li>
    <li>
      <a href="06-Analysis-Missing-Data.html">Missing Data Analysis</a>
    </li>
    <li>
      <a href="06-Analysis-MI-Implementation.html">Multiple Imputation Analysis</a>
    </li>
    <li>
      <a href="06-Analysis-PK-and-PD.html">PK and PD Analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="07-CV.html">
    <span class="fa fa-file-pdf-o"></span>
     
    CV
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="mailto:zehuibai@outlook.com">
    <span class="fa fa-envelope-o"></span>
     
    Contact me
  </a>
</li>
<li>
  <a href="https://github.com/Zehuibai">
    <span class="fa fa-github"></span>
     
    GitHub
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore"><p><img src="logo.png"
style="width:3in" /><br />
Box Plot</p></h1>

</div>


<div id="grouped-boxplot" class="section level2">
<h2>Grouped Boxplot</h2>
<pre class="r"><code># create a data frame
variety=rep(LETTERS[1:7], each=40)
treatment=rep(c(&quot;high&quot;,&quot;low&quot;),each=20)
note=seq(1:280)+sample(1:150, 280, replace=T)
data=data.frame(variety, treatment ,  note)
 
# grouped boxplot
p0 &lt;- ggplot(data, aes(x=variety, y=note, fill=treatment)) + 
    geom_boxplot()

# One box per treatment
p1 &lt;- ggplot(data, aes(x=variety, y=note, fill=treatment)) + 
    geom_boxplot() +
    facet_wrap(~treatment)

# one box per variety
p2 &lt;- ggplot(data, aes(x=variety, y=note, fill=treatment)) + 
    geom_boxplot() +
    facet_wrap(~variety, scale=&quot;free&quot;)

grid.arrange(p0, p1, p2, ncol=2)</code></pre>
<p><img src="05-Plot-BoxPlot_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
</div>
<div id="ordered-boxplot" class="section level2">
<h2>Ordered Boxplot</h2>
<div id="basic-order-by-median" class="section level3">
<h3>Basic Order by Median</h3>
<pre class="r"><code>theme_set(theme_classic())

# Using number of observation per group
o1 &lt;- mpg %&gt;%
  mutate(class = fct_reorder(class, hwy, .fun=&#39;length&#39; )) %&gt;%
  ggplot( aes(x=class, y=hwy, fill=class)) + 
    geom_boxplot() +
    xlab(&quot;class&quot;) +
    labs(subtitle=&quot;Order by observation per group&quot;) +
    theme(legend.position=&quot;none&quot;) +
    xlab(&quot;&quot;) +
    xlab(&quot;&quot;)


# Using median
o2 &lt;-mpg %&gt;%
  mutate(class = fct_reorder(class, hwy, .fun=&#39;median&#39;)) %&gt;%
  ggplot( aes(x=reorder(class, hwy), y=hwy, fill=class)) + 
    geom_boxplot() +
    xlab(&quot;class&quot;) +
    labs(subtitle=&quot;Order by median&quot;) +
    theme(legend.position=&quot;none&quot;) +
    xlab(&quot;&quot;)

grid.arrange(o1,o2,ncol=2)</code></pre>
<p><img src="05-Plot-BoxPlot_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div>
<div id="cut-for-continuous-variable" class="section level3">
<h3>Cut for Continuous Variable</h3>
<pre class="r"><code>library(hrbrthemes)

# Start with the diamonds dataset, natively available in R:
diamonds %&gt;%
  
  # Add a new column called &#39;bin&#39;: cut the initial &#39;carat&#39; in bins
  mutate( bin=cut_width(carat, width=0.5, boundary=0) ) %&gt;%
  
  # plot
  ggplot( aes(x=bin, y=price) ) +
    geom_boxplot(fill=&quot;#69b3a2&quot;) +
    theme_ipsum() +
    xlab(&quot;Carat&quot;)</code></pre>
<p><img src="05-Plot-BoxPlot_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
</div>
<div id="color" class="section level2">
<h2>Color</h2>
<div id="basic-color-scale_fill_brewer" class="section level3">
<h3>Basic Color <code>scale_fill_brewer</code></h3>
<pre class="r"><code># Top Left: Set a unique color with fill, colour, and alpha
P1 &lt;- ggplot(mpg, aes(x=class, y=hwy)) + 
    geom_boxplot(color=&quot;red&quot;, fill=&quot;orange&quot;, alpha=0.2)
 
# Top Right: Set a different color for each group
P2 &lt;- ggplot(mpg, aes(x=class, y=hwy, fill=class)) + 
    geom_boxplot(alpha=0.3) +
    theme(legend.position=&quot;none&quot;)

# Bottom Left
P3 &lt;- ggplot(mpg, aes(x=class, y=hwy, fill=class)) + 
    geom_boxplot(alpha=0.3) +
    theme(legend.position=&quot;none&quot;) +
    scale_fill_brewer(palette=&quot;BuPu&quot;)
 
# Bottom Right
P4 &lt;- ggplot(mpg, aes(x=class, y=hwy, fill=class)) + 
    geom_boxplot(alpha=0.3) +
    theme(legend.position=&quot;none&quot;) +
    scale_fill_brewer(palette=&quot;Dark2&quot;)

## Alternative for P4
# ggplot(mpg, aes(x=class, y=hwy, fill=class)) + 
#   geom_boxplot(alpha=0.3) +
#   theme(legend.position=&quot;none&quot;) +
#   scale_fill_manual(values = c(&quot;compact&quot; = &quot;#F8766D&quot;, &quot;midsize&quot; = &quot;#7CAE00&quot;, &quot;suv&quot; = &quot;#00BFC4&quot;, &quot;2seater&quot; = &quot;#C77CFF&quot;, &quot;minivan&quot; = &quot;#FFA500&quot;, &quot;pickup&quot; = &quot;#00CC99&quot;, &quot;subcompact&quot; = &quot;#619CFF&quot;))
 
grid.arrange(P1, P2, P3, P4, ncol=2)</code></pre>
<p><img src="05-Plot-BoxPlot_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="highlighting-a-group" class="section level3">
<h3>Highlighting a group</h3>
<pre class="r"><code>library(&quot;hrbrthemes&quot;)
# Work with the natively available mpg dataset
mpg %&gt;% 

  # Add a column called &#39;type&#39;: do we want to highlight the group or not?
  mutate( type=ifelse(class==&quot;subcompact&quot;,&quot;Highlighted&quot;,&quot;Normal&quot;)) %&gt;%
  
  # Build the boxplot. In the &#39;fill&#39; argument, give this column
  ggplot( aes(x=class, y=hwy, fill=type, alpha=type)) + 
    geom_boxplot() +
    scale_fill_manual(values=c(&quot;#69b3a2&quot;, &quot;grey&quot;)) +
    scale_alpha_manual(values=c(1,0.1)) +
    theme_ipsum() +
    theme(legend.position = &quot;none&quot;) +
    xlab(&quot;&quot;)</code></pre>
<p><img src="05-Plot-BoxPlot_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="independent-color" class="section level3">
<h3>Independent Color</h3>
<pre class="r"><code>df &lt;- data.frame(
  Group = c(rep(&#39;B-cell\nlymphocytes&#39;,50), rep(&#39;Natural\nkiller cells&#39;, 50)),
  log2(matrix(rexp(200, rate=.1), ncol=2)))
colnames(df) &lt;- c(&#39;Group&#39;, &#39;Gene1&#39;, &#39;Gene2&#39;)

require(&quot;reshape2&quot;) 

df &lt;- melt(df, id.vars = c(&#39;Group&#39;))
colnames(df) &lt;- c(&#39;Group&#39;, &#39;Gene&#39;, &#39;Expression&#39;)

ggplot(data = df, aes(x = Group, y = Expression)) +
  
  geom_boxplot(
    position = position_dodge(width=0.5),
    outlier.shape = 17,
    outlier.colour = &#39;red2&#39;,
    outlier.size = 0.1,
    aes(fill = Group)) +
  scale_fill_manual(values = c( &#39;red&#39;, &#39;royalblue&#39;)) + # for boxplot
  
  #Add the scatter points (treats outliers same as &#39;inliers&#39;)
  geom_jitter(
    position = position_jitter(width = 0.3),
    size = 3.0,
    aes(colour = Group)) +
  scale_color_manual(values = c(&#39;pink&#39;, &#39;skyblue&#39;)) + # for scatter plot dots
  
  # facet by Gene
  facet_wrap(~ Gene, ncol = 2) +
  
  #Set the size of the plotting window
  theme_bw(base_size=24) +
  
  #Modify various aspects of the plot text and legend
  theme(
    legend.position = &#39;none&#39;,
    legend.background = element_rect(),
    plot.title = element_text(angle = 0, size = 16, face = &#39;bold&#39;, vjust = 1),
    plot.subtitle = element_text(angle = 0, size = 16, face = &#39;bold&#39;, vjust = 1),
    plot.caption = element_text(angle = 0, size = 16, face = &#39;bold&#39;, vjust = 1),
    
    axis.text.x = element_text(angle = 45, size = 16, face = &#39;bold&#39;, hjust = 1.10),
    axis.text.y = element_text(angle = 0, size = 16, face = &#39;bold&#39;, vjust = 0.5),
    axis.title = element_text(size = 16, face = &#39;bold&#39;),
    axis.title.x = element_text(size = 16, face = &#39;bold&#39;),
    axis.title.y = element_text(size = 16, face = &#39;bold&#39;),
    
    #Legend
    legend.key = element_blank(),       #removes the border
    legend.key.size = unit(1, &#39;cm&#39;),        #Sets overall area/size of the legend
    legend.text = element_text(size = 14, face = &#39;bold&#39;),   #Text size
    title=element_text(size = 14, face = &#39;bold&#39;),
    
    #facet wrap
    strip.text.x = element_text(size = 14, face = &#39;bold&#39;),
    strip.text.y = element_text(size = 14, face = &#39;bold&#39;, angle=0),
    strip.background = element_rect(fill = &#39;white&#39;), 
    strip.text = element_text(size = 14, face = &#39;bold&#39;, colour = &#39;black&#39;))+
  
  #Change the size of the icons/symbols in the legend
  guides(colour = guide_legend(override.aes = list(size = 2.5))) +
  
  #Set x- and y-axes labels
  xlab(&#39;Immune cell class&#39;) +
  ylab(&#39;Expression&#39;) +
  
  labs(title = &#39;Boxplot with each point and background color&#39;,
       subtitle = &#39;Guten morgen&#39;,
       caption = &#39;Data Visualization - Box Plot&#39;)</code></pre>
<p><img src="05-Plot-BoxPlot_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="backgroud" class="section level3">
<h3>Backgroud</h3>
<pre class="r"><code>value = runif(n = 1000) 
type = rep(c(&quot;a&quot;,&quot;b&quot;,&quot;c&quot;,&quot;d&quot;),250) 
type2 = rep(c(&quot;a&quot;,&quot;b&quot;),500) 
number = sample(1:4, 1000, replace=TRUE, prob=c(0.25, 0.25, 0.25, 0.25) )
feature = c(rep(&quot;small&quot;,500),rep(&quot;big&quot;,500))
nFac &lt;- 4 # define number of factors (types) here
rects &lt;- data.frame(xmin = head(seq &lt;- seq(0.5, nFac + .5, 1), -1), 
                  xmax = tail(seq, -1), rect_type = c(&quot;a&quot;, &quot;c&quot;)) #set your divisions here

allResults &lt;- data.frame(value,type,type2,number,feature, rects)

ggplot(allResults, aes(y=value, x=type)) + geom_boxplot(aes(fill = type, col=type2)) +
  geom_rect(aes(xmin = xmin, xmax = xmax, ymin = -Inf, ymax = Inf, fill = rect_type), alpha = 0.009) +
  ggtitle(&quot;comparison&quot;) + facet_grid(feature ~ number) +
  theme(legend.position = &quot;bottom&quot;,axis.text.x = element_text(angle = 90, hjust = 1)) +
  scale_y_continuous(breaks =  seq(0, 1, by = 0.05),limits = c(0,1))</code></pre>
<p><img src="05-Plot-BoxPlot_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
</div>
<div id="text" class="section level2">
<h2>Text</h2>
<div id="statidentity" class="section level3">
<h3>stat=“identity”</h3>
<pre class="r"><code>DummyA &lt;- readRDS(file = &quot;./01_Datasets/Cylinder_Baseline.rds&quot;)

ggplot(DummyA,aes(x=Subgroup,fill=Treatment))+
  geom_boxplot(aes(lower=`  Mean`-`  SD`,
                   upper=`  Mean`+`  SD`,
                   middle=`  Mean`,
                   ymin=`  Min`,
                   ymax=`  Max`),
               stat=&quot;identity&quot;)+
  geom_text(aes(label=`P-Value`, x=Subgroup, y=5.5),hjust=0.4)+
  coord_flip() +
  theme_bw() +
  theme(legend.position = &quot;bottom&quot;) +
  labs(x = &quot;Subgroups&quot;,
       y = &quot;Cylinder [D]&quot;,
       title = &quot;Subjective refraction Cylinder at Baseline&quot;)</code></pre>
<p><img src="05-Plot-BoxPlot_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code>DummyB &lt;- readRDS(file = &quot;./01_Datasets/MeanRotation.rds&quot; )
ggplot(DummyB, aes(x=Visit,fill=Treatment))+
  geom_boxplot(aes(lower=mean-SD,
                   upper=mean+SD,
                   middle=mean,
                   ymin=min,
                   ymax=max),
               stat=&quot;identity&quot;)+
  geom_text(aes(label=n, x=Visit, y=mean+1.5), vjust=1.3, color=&quot;white&quot;,
            position = position_dodge(0.8), size=3.5)+
  geom_text(aes(label=P,colour=label_color, x=Visit, y=25),hjust=0.4, size=3.5,show.legend = FALSE)+
  scale_fill_brewer(palette=&quot;Paired&quot;)+
  facet_wrap(.~ Subgroup, nrow = 2)+
  coord_flip() +
  theme_bw() +
  theme(legend.position = &quot;bottom&quot;) +
  labs(x = &quot;&quot;,
       y = &quot;Mean absolute rotation&quot;,
       title = &quot;Mean absolute rotation by visit&quot;,
       caption = &quot;Data Visualization - Box Plot&quot;)</code></pre>
<p><img src="05-Plot-BoxPlot_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
</div>
<div id="statistics-text" class="section level3">
<h3>Statistics Text</h3>
<pre class="r"><code>df &lt;- mtcars
df$cyl &lt;- as.factor(df$cyl)

get_box_stats &lt;- function(y, upper_limit = max(df$mpg) * 1.15) {
  return(data.frame(
    y = 0.95 * upper_limit,
    label = paste(
      &quot;Count =&quot;, length(y), &quot;\n&quot;,
      &quot;Mean =&quot;, round(mean(y), 2), &quot;\n&quot;,
      &quot;Median =&quot;, round(median(y), 2), &quot;\n&quot;
    )
  ))
}
 
ggplot(df, aes(x = cyl, y = mpg, fill = cyl)) +
  geom_boxplot() +
  scale_fill_manual(values = c(&quot;#00BFC4&quot;, &quot;#F8766D&quot;, &quot;#7CAE00&quot;)) +
  stat_summary(fun.data = get_box_stats, geom = &quot;text&quot;, hjust = 0.5, vjust = 0.9) +
  labs(
    title = &quot;Stat_summary() function&quot;,
    subtitle = &quot;with summary statistics&quot;,
    caption = &quot;Data Visualization - Box Plot&quot;,
    x = &quot;Number of cylinders&quot;,
    y = &quot;Miles per gallon&quot;
  ) +
  theme_classic()+
  theme(
    plot.title = element_text(color = &quot;#0099f8&quot;, size = 16, face = &quot;bold&quot;, hjust = 0.5),
    plot.subtitle = element_text(face = &quot;bold.italic&quot;, hjust = 0.5),
    plot.caption = element_text(face = &quot;italic&quot;)
  )</code></pre>
<p><img src="05-Plot-BoxPlot_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
</div>
<div id="jitter" class="section level2">
<h2>Jitter</h2>
<div id="basic-jitter" class="section level3">
<h3>Basic Jitter</h3>
<pre class="r"><code>library(hrbrthemes)
library(viridis)

# create a dataset
data &lt;- data.frame(
  name=c( rep(&quot;A&quot;,500), rep(&quot;B&quot;,500), rep(&quot;B&quot;,500), rep(&quot;C&quot;,20), rep(&#39;D&#39;, 100)  ),
  value=c( rnorm(500, 10, 5), rnorm(500, 13, 1), rnorm(500, 18, 1), rnorm(20, 25, 4), rnorm(100, 12, 1) )
)

# Plot
data %&gt;%
  ggplot( aes(x=name, y=value, fill=name)) +
    geom_boxplot() +
    scale_fill_viridis(discrete = TRUE, alpha=0.6) +
    geom_jitter(color=&quot;black&quot;, size=0.4, alpha=0.9) +
    theme_ipsum() +
    theme(
      legend.position=&quot;none&quot;,
      plot.title = element_text(size=11)
    ) +
    ggtitle(&quot;A boxplot with jitter&quot;) +
    xlab(&quot;&quot;)</code></pre>
<p><img src="05-Plot-BoxPlot_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="jitter-with-statistic-test" class="section level3">
<h3>Jitter with Statistic Test</h3>
<pre class="r"><code># library(&quot;ggpubr&quot;) 
data_D01 &lt;- read.csv(&quot;./01_Datasets/Boxplot_paired_dummy.csv&quot;,
                     sep=&quot;,&quot;,
                     header=TRUE)  %&gt;%
  mutate(Treatment=factor(Treatment,
                          level=c(&quot;Sham&quot;,&quot;Stim&quot;),
                          label=c(&quot;Control Group&quot;, &quot;Stimulation Group&quot;)))

data_D02_p2p1 &lt;- data_D01 %&gt;%
  group_by(ID, Treatment) %&gt;%
  get_summary_stats(p2p1, type = &quot;mean&quot;) 

data_D02_p2p1 %&gt;%
  ggboxplot(x = &quot;Treatment&quot;, y = &quot;mean&quot;,
            color = &quot;Treatment&quot;, palette = &quot;jco&quot;,
            add = &quot;jitter&quot;) +
  stat_compare_means() +
  labs(subtitle=&#39;Box plot of 1st average SO peak-to-peak amplitude using wilcoxon test&#39;, 
       x = &#39;Treatment&#39;, 
       y = &#39;1st average SO peak-to-peak amplitude&#39;)</code></pre>
<p><img src="05-Plot-BoxPlot_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<pre class="r"><code>data(&quot;ToothGrowth&quot;)
df &lt;- ToothGrowth 
my_comparisons &lt;- list( c(&quot;0.5&quot;, &quot;1&quot;), c(&quot;1&quot;, &quot;2&quot;), c(&quot;0.5&quot;, &quot;2&quot;) )
ggboxplot(df, x = &quot;dose&quot;, y = &quot;len&quot;,
                color = &quot;dose&quot;, palette =c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;, &quot;#FC4E07&quot;),
                add = &quot;jitter&quot;, shape = &quot;dose&quot;) + 
  stat_compare_means(comparisons = my_comparisons)+ # Add pairwise comparisons p-value
  stat_compare_means(label.y = 50)  </code></pre>
<p><img src="05-Plot-BoxPlot_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
</div>
<div id="paried-line" class="section level2">
<h2>Paried line</h2>
<pre class="r"><code>data_D02_p2p1 %&gt;%
  filter(ID != &quot;6359&quot;) %&gt;% 
  ggpaired(x = &quot;Treatment&quot;, y = &quot;mean&quot;,
           id = &quot;ID&quot;,
           color = &quot;Treatment&quot;,line.color = &quot;gray&quot;, 
           line.size = 0.4,
           palette = &quot;jco&quot;) +
  stat_compare_means(paired = TRUE, method = &quot;t.test&quot;)+
  labs(subtitle=&#39;Box plot of 1st average SO peak-to-peak amplitude using paried t-test&#39;, 
       x = &#39;Treatment&#39;, 
       y = &#39;1st average SO peak-to-peak amplitude&#39;)</code></pre>
<p><img src="05-Plot-BoxPlot_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
<div id="dot-box-plot" class="section level2">
<h2>Dot + Box Plot</h2>
<p>In addition to the information provided by the box plot, you can
provide clearer information in the form of summary statistics for each
group. These points are interlaced to make each point represent an
observation value.</p>
<pre class="r"><code># plot
g &lt;- ggplot(mpg, aes(reorder(manufacturer, cty, FUN = median) , cty))
g + geom_boxplot() + 
  geom_dotplot(binaxis=&#39;y&#39;, 
               stackdir=&#39;center&#39;, 
               position = &quot;dodge&quot;,
               dotsize = .5, 
               binwidth = 0.5,
               fill=&quot;red&quot;) +
  theme(axis.text.x = element_text(angle=65, vjust=0.6)) + 
  theme_bw() +
  labs(title=&quot;Box plot + Dot plot&quot;, 
       subtitle=&quot;City Mileage vs Class: Each dot represents 1 row in source data&quot;,
       caption=&quot;Source: mpg&quot;,
       x=&quot;Class of Vehicle&quot;,
       y=&quot;City Mileage&quot;)</code></pre>
<p><img src="05-Plot-BoxPlot_files/figure-html/Dot%20Box%20Plot-1.png" width="672" /></p>
</div>
<div id="violin-plot" class="section level2">
<h2>Violin Plot</h2>
<p>The violigogram is similar to the box pattern, but the density of the
group is displayed. There is no too much information like a box line
map.</p>
<pre class="r"><code>ggplot(mpg, aes(class, cty)) +
  geom_violin() + 
  labs(title=&quot;Violin plot&quot;, 
       subtitle=&quot;City Mileage vs Class of vehicle&quot;,
       caption=&quot;Source: mpg&quot;,
       x=&quot;Class of Vehicle&quot;,
       y=&quot;City Mileage&quot;) +
  theme_bw()</code></pre>
<p><img src="05-Plot-BoxPlot_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r"><code>df &lt;- ToothGrowth 
ggviolin(df, x = &quot;dose&quot;, y = &quot;len&quot;, fill = &quot;dose&quot;,
         palette = c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;, &quot;#FC4E07&quot;),
         add = &quot;boxplot&quot;, add.params = list(fill = &quot;white&quot;))+
  stat_compare_means(comparisons = my_comparisons, label = &quot;p.signif&quot;)+ # Add significance levels
  stat_compare_means(label.y = 50)                                      # Add global the p-value </code></pre>
<p><img src="05-Plot-BoxPlot_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<div id="ggstatsplot" class="section level3">
<h3>ggstatsplot</h3>
<p>ggstatsplot is an extension of ggplot2 package for creating graphics
with details from statistical tests included in the plots themselves and
targeted primarily at behavioral sciences community to provide a
one-line code to produce information-rich plots.</p>
<ul>
<li><a href="https://indrajeetpatil.github.io/ggstatsplot/articles/"
class="uri">https://indrajeetpatil.github.io/ggstatsplot/articles/</a></li>
<li>Patil, I. (2021). Visualizations with statistical details: The
‘ggstatsplot’ approach. Journal of Open Source Software, 6(61), 3167, <a
href="doi:10.21105/joss.03167"
class="uri">doi:10.21105/joss.03167</a></li>
<li>to check if a continuous variable differs across multiple
groups/conditions</li>
<li>to compare distributions visually and check for outliers</li>
</ul>
<pre class="r"><code>library(&quot;gapminder&quot;)
dplyr::glimpse(x = gapminder::gapminder)</code></pre>
<pre><code>## Rows: 1,704
## Columns: 6
## $ country   &lt;fct&gt; &quot;Afghanistan&quot;, &quot;Afghanistan&quot;, &quot;Afghanistan&quot;, &quot;Afghanistan&quot;, …
## $ continent &lt;fct&gt; Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, …
## $ year      &lt;int&gt; 1952, 1957, 1962, 1967, 1972, 1977, 1982, 1987, 1992, 1997, …
## $ lifeExp   &lt;dbl&gt; 28.801, 30.332, 31.997, 34.020, 36.088, 38.438, 39.854, 40.8…
## $ pop       &lt;int&gt; 8425333, 9240934, 10267083, 11537966, 13079460, 14880372, 12…
## $ gdpPercap &lt;dbl&gt; 779.4453, 820.8530, 853.1007, 836.1971, 739.9811, 786.1134, …</code></pre>
<pre class="r"><code># since the confidence intervals for the effect sizes are computed using
# bootstrapping, important to set a seed for reproducibility
# for reproducibility
set.seed(123)
library(&quot;ggstatsplot&quot;)

# plot
ggbetweenstats(
  data  = iris,
  x     = Species,
  y     = Sepal.Length,
  title = &quot;Distribution of sepal length across Iris species&quot;
)</code></pre>
<p><img src="05-Plot-BoxPlot_files/figure-html/test-1.png" width="672" /></p>
</div>
</div>
<div id="boxplot-legend" class="section level2">
<h2>Boxplot Legend</h2>
<pre class="r"><code>boxplot_framework &lt;- function(upper_limit,
                              family_font = &quot;serif&quot;,
                              lower_limit = 0,
                              logY = FALSE,
                              fill_var = NA,
                              fill = &quot;lightgrey&quot;, width = 0.6){

  update_geom_defaults(&quot;text&quot;,
                     list(size = 3,
                          family = family_font))

  n_fun &lt;- function(x, lY = logY){
    return(data.frame(y = ifelse(logY, 0.95*log10(upper_limit), 0.95*upper_limit),
                      label = length(x)))
  }

  prettyLogs &lt;- function(x){
    pretty_range &lt;- range(x[x &gt; 0])
    pretty_logs &lt;- 10^(-10:10)
    log_index &lt;- which(pretty_logs &lt; pretty_range[2] &amp;
                         pretty_logs &gt; pretty_range[1])
    log_index &lt;- c(log_index[1]-1,log_index,
                   log_index[length(log_index)]+1)
    pretty_logs_new &lt;-  pretty_logs[log_index]
    return(pretty_logs_new)
  }

  fancyNumbers &lt;- function(n){
    nNoNA &lt;- n[!is.na(n)]
    x &lt;-gsub(pattern = &quot;1e&quot;,replacement = &quot;10^&quot;,
             x = format(nNoNA, scientific = TRUE))
    exponents &lt;- as.numeric(sapply(strsplit(x, &quot;\\^&quot;), function(j) j[2]))

    base &lt;- ifelse(exponents == 0, &quot;1&quot;, ifelse(exponents == 1, &quot;10&quot;,&quot;10^&quot;))
    exponents[base == &quot;1&quot; | base == &quot;10&quot;] &lt;- &quot;&quot;
    textNums &lt;- rep(NA, length(n))
    textNums[!is.na(n)] &lt;- paste0(base,exponents)

    textReturn &lt;- parse(text=textNums)
    return(textReturn)
  }

  if(!is.na(fill_var)){
      basic_elements &lt;- list(stat_boxplot(geom =&#39;errorbar&#39;, width = width),
                            geom_boxplot(width = width),
                            stat_summary(fun.data = n_fun,
                                         geom = &quot;text&quot;,
                                         position = position_dodge(width),
                                         hjust =0.5,
                                         aes_string(group=fill_var)),
                            expand_limits(y = lower_limit),
                            theme_USGS_box())
  } else {
      basic_elements &lt;- list(stat_boxplot(geom =&#39;errorbar&#39;, width = width),
                            geom_boxplot(width = width, fill = fill),
                            stat_summary(fun.data = n_fun,
                                         geom = &quot;text&quot;, hjust =0.5),
                            expand_limits(y = lower_limit),
                            theme_USGS_box())
  }

  if(logY){
    return(c(basic_elements,
              scale_y_log10(limits = c(lower_limit, upper_limit),
                  expand = expand_scale(mult = c(0, 0)),
                  labels=fancyNumbers,
                  breaks=prettyLogs),
              annotation_logticks(sides = c(&quot;rl&quot;))))
  } else {
    return(c(basic_elements,
              scale_y_continuous(sec.axis = dup_axis(label = NULL,
                                                     name = NULL),
                                 expand = expand_scale(mult = c(0, 0)),
                                 breaks = pretty(c(lower_limit,upper_limit), n = 5),
                                 limits = c(lower_limit,upper_limit))))
  }
}


ggplot_box_legend &lt;- function(family = &quot;serif&quot;){

  # Create data to use in the boxplot legend:
  set.seed(100)

  sample_df &lt;- data.frame(parameter = &quot;test&quot;,
                        values = sample(500))

  # Extend the top whisker a bit:
  sample_df$values[1:100] &lt;- 701:800
  # Make sure there&#39;s only 1 lower outlier:
  sample_df$values[1] &lt;- -350

  # Function to calculate important values:
  ggplot2_boxplot &lt;- function(x){

    quartiles &lt;- as.numeric(quantile(x,
                                     probs = c(0.25, 0.5, 0.75)))

    names(quartiles) &lt;- c(&quot;25th percentile&quot;,
                          &quot;50th percentile\n(median)&quot;,
                          &quot;75th percentile&quot;)

    IQR &lt;- diff(quartiles[c(1,3)])

    upper_whisker &lt;- max(x[x &lt; (quartiles[3] + 1.5 * IQR)])
    lower_whisker &lt;- min(x[x &gt; (quartiles[1] - 1.5 * IQR)])

    upper_dots &lt;- x[x &gt; (quartiles[3] + 1.5*IQR)]
    lower_dots &lt;- x[x &lt; (quartiles[1] - 1.5*IQR)]

    return(list(&quot;quartiles&quot; = quartiles,
                &quot;25th percentile&quot; = as.numeric(quartiles[1]),
                &quot;50th percentile\n(median)&quot; = as.numeric(quartiles[2]),
                &quot;75th percentile&quot; = as.numeric(quartiles[3]),
                &quot;IQR&quot; = IQR,
                &quot;upper_whisker&quot; = upper_whisker,
                &quot;lower_whisker&quot; = lower_whisker,
                &quot;upper_dots&quot; = upper_dots,
                &quot;lower_dots&quot; = lower_dots))
  }

  # Get those values:
  ggplot_output &lt;- ggplot2_boxplot(sample_df$values)

  # Lots of text in the legend, make it smaller and consistent font:
  update_geom_defaults(&quot;text&quot;,
                     list(size = 3,
                          hjust = 0,
                          family = family))
  # Labels don&#39;t inherit text:
  update_geom_defaults(&quot;label&quot;,
                     list(size = 3,
                          hjust = 0,
                          family = family))

  # Create the legend:
  # The main elements of the plot (the boxplot, error bars, and count)
  # are the easy part.
  # The text describing each of those takes a lot of fiddling to
  # get the location and style just right:
  explain_plot &lt;- ggplot() +
    stat_boxplot(data = sample_df,
                 aes(x = parameter, y=values),
                 geom =&#39;errorbar&#39;, width = 0.3) +
    geom_boxplot(data = sample_df,
                 aes(x = parameter, y=values),
                 width = 0.3, fill = &quot;lightgrey&quot;) +
    geom_text(aes(x = 1, y = 950, label = &quot;500&quot;), hjust = 0.5) +
    geom_text(aes(x = 1.17, y = 950,
                  label = &quot;Number of values&quot;),
              fontface = &quot;bold&quot;, vjust = 0.4) +
    theme_minimal(base_size = 5, base_family = family) +
    geom_segment(aes(x = 2.3, xend = 2.3,
                     y = ggplot_output[[&quot;25th percentile&quot;]],
                     yend = ggplot_output[[&quot;75th percentile&quot;]])) +
    geom_segment(aes(x = 1.2, xend = 2.3,
                     y = ggplot_output[[&quot;25th percentile&quot;]],
                     yend = ggplot_output[[&quot;25th percentile&quot;]])) +
    geom_segment(aes(x = 1.2, xend = 2.3,
                     y = ggplot_output[[&quot;75th percentile&quot;]],
                     yend = ggplot_output[[&quot;75th percentile&quot;]])) +
    geom_text(aes(x = 2.4, y = ggplot_output[[&quot;50th percentile\n(median)&quot;]]),
              label = &quot;Interquartile\nrange&quot;, fontface = &quot;bold&quot;,
              vjust = 0.4) +
    geom_text(aes(x = c(1.17,1.17),
                  y = c(ggplot_output[[&quot;upper_whisker&quot;]],
                        ggplot_output[[&quot;lower_whisker&quot;]]),
                  label = c(&quot;Largest value within 1.5 times\ninterquartile range above\n75th percentile&quot;,
                            &quot;Smallest value within 1.5 times\ninterquartile range below\n25th percentile&quot;)),
                  fontface = &quot;bold&quot;, vjust = 0.9) +
    geom_text(aes(x = c(1.17),
                  y =  ggplot_output[[&quot;lower_dots&quot;]],
                  label = &quot;Outside value&quot;),
              vjust = 0.5, fontface = &quot;bold&quot;) +
    geom_text(aes(x = c(1.9),
                  y =  ggplot_output[[&quot;lower_dots&quot;]],
                  label = &quot;-Value is &gt;1.5 times and&quot;),
              vjust = 0.5) +
    geom_text(aes(x = 1.17,
                  y = ggplot_output[[&quot;lower_dots&quot;]],
                  label = &quot;&lt;3 times the interquartile range\nbeyond either end of the box&quot;),
              vjust = 1.5) +
    geom_label(aes(x = 1.17, y = ggplot_output[[&quot;quartiles&quot;]],
                  label = names(ggplot_output[[&quot;quartiles&quot;]])),
              vjust = c(0.4,0.85,0.4),
              fill = &quot;white&quot;, label.size = 0) +
    ylab(&quot;&quot;) + xlab(&quot;&quot;) +
    theme(axis.text = element_blank(),
          axis.ticks = element_blank(),
          panel.grid = element_blank(),
          aspect.ratio = 4/3,
          plot.title = element_text(hjust = 0.5, size = 10)) +
    coord_cartesian(xlim = c(1.4,3.1), ylim = c(-600, 900)) +
    labs(title = &quot;EXPLANATION&quot;)

  return(explain_plot)

}

ggplot_box_legend()</code></pre>
<p><img src="05-Plot-BoxPlot_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
