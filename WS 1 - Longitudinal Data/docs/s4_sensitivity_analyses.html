<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Longitudinal Data Modeling – s4_sensitivity_analyses</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Longitudinal Data Modeling</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./s1_visualization.html" rel="" target="">
 <span class="menu-text">Visualization</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./s2_inference_continuous.html" rel="" target="">
 <span class="menu-text">Inference from Continuous Data</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./s3_missingness.html" rel="" target="">
 <span class="menu-text">Missing Data Handling</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./s4_sensitivity_analyses.html" rel="" target="" aria-current="page">
 <span class="menu-text">Sensitivity Analyses</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./s5_inferences_binary.html" rel="" target="">
 <span class="menu-text">Inference from Binary Data</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://alex-lauer.github.io/GMDS-Summer-School/" rel="" target="">
 <span class="menu-text">Link to Solutions</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    <div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="s4_sensitivity_analyses.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></div>
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="sensitivity-analyses" class="level1">
<h1>Sensitivity Analyses</h1>
<p>Purpose: talk about sensitivity analyses with respect to missing data</p>
<ul>
<li>MMRM is an appropriate choice for the primary analysis in many longitudinal clinical trials under the missing at random (MAR) assumption.</li>
<li>MMRM can handle missing values. BUT: need of baseline and at least one post-baseline value.</li>
<li>No imputation for individual missing values but missing data is implicitly imputed.</li>
<li>Exploit the correlation between outcomes within subjects.</li>
<li>MAR: future outcomes for subjects who discontinued are assumed be similar to the future outcomes of subjects who continued if they had the same values of past (observed) outcomes, covariates,…</li>
</ul>
<section id="purpose-of-sensitivity-analyses" class="level2">
<h2 class="anchored" data-anchor-id="purpose-of-sensitivity-analyses">Purpose of sensitivity analyses</h2>
<ul>
<li>Consider sensivitiy analyses to check model assumptions e.g.&nbsp;assumption of MAR.</li>
<li>Comparing results from sensitivity analyses: how much inference rely on the assumptions.</li>
<li>Here, inference with regard to the treatment effect. Thus, investigate how treatment effects vary depending on assumptions (about missing data).</li>
<li>Uncertainty from incompleteness cannot be objectively evaluated from observed data so there is a need for missing data sensitivity analyses.</li>
</ul>
</section>
<section id="mmrm-vs.-mi" class="level2">
<h2 class="anchored" data-anchor-id="mmrm-vs.-mi">MMRM vs.&nbsp;MI</h2>
<ul>
<li>Flexibility in modeling treatment effects over time and the within-patient error correlation structure makes MMRM a widely useful analysis.</li>
<li>MMRM, MI: two major approaches to missing data with good statistical properties. Both rely on MAR assumption (for MI: standard implementation).</li>
<li>MMRM: missing values implicitly imputed, MI: missing values explicitly imputed.</li>
<li>MMRM vs.&nbsp;MI: approximately equivalent provided the variables used in the imputation model are the same as those included in the analysis model (level of equivalence will depend on the number of imputations)</li>
<li>MI: imputation model with at least those variables from the primary model, additional auxiliary variables can be used in the imputation model to improve the accuracy of the missing data prediction.</li>
<li>Handling missing not at random (MNAR) possible for MI (e.g.&nbsp;reference-based imputation) but not within MMRM.</li>
<li>MMRM does not work if missing baseline values are present. Missing baseline values can be imputed first. Additionally, at least one post-baseline value has to be observed. Alternative: LDA where baseline is part of the response vector.</li>
</ul>
<p>Note that, when implemented in similar manners, MI and MMRM have similar assumptions and yield similar results. Thus, MI implemented similarly to MMRM is not a sensitivity analysis!</p>
</section>
<section id="missing-covariates-baseline-data-only" class="level2">
<h2 class="anchored" data-anchor-id="missing-covariates-baseline-data-only">Missing covariates (baseline data) only</h2>
<ul>
<li>Missing baseline value of the outcome (and other covariates) is a common situation</li>
<li>MMRM not efficient or potential biased estimates as subjects with missing covariates are excluded from the analysis</li>
<li><span class="citation" data-cites="kayembe2022">(<a href="#ref-kayembe2022" role="doc-biblioref">Kayembe and Breukelen 2022</a>)</span> compared different methods e.g.&nbsp;unadjusted analysis, complete case, mean imputation, MI: mean imputation seems to be appropriate as long as the covariates are measured before randomization (produces unbiased treatment effect estimates with good coverage, easy to implement)</li>
</ul>
<p>Now, we consider the situation as in our data sets: baseline observed, no intermittent missing values, drop-outs = monotone missing pattern</p>
</section>
<section id="sensitivity-analyses---simple-approaches" class="level2">
<h2 class="anchored" data-anchor-id="sensitivity-analyses---simple-approaches">Sensitivity analyses - Simple approaches</h2>
<p>In general, these simple approaches are not recommended for use. Methods are of historic interest and provide a useful starting point. Here, we consider two simple approaches. We will apply these two methods in the practical part to compare results.</p>
<section id="last-observation-carried-forward-locf" class="level3">
<h3 class="anchored" data-anchor-id="last-observation-carried-forward-locf">Last observation carried forward (LOCF)</h3>
<p>For each subject, LOCF imputes missing values using the last observed value for that subject. Typically, under LOCF the repeated masures nature of the data is ignored and a single outcome for each subject is analyzed.</p>
<p>LOCF was used in the past, justified as it was thought that it provides conservative estimates. However, conditions under which LOCF yield conservative estimates and maintain control of Type I error rates are not straightforward and cannot be assured at the beginning of the trial. For example, LOCF is likely to overestimate treatment benefit if dop-out in the control gorup is more frequent.</p>
</section>
<section id="complete-case-cc" class="level3">
<h3 class="anchored" data-anchor-id="complete-case-cc">Complete case (CC)</h3>
<p>Other names: observed case/ completers analysis</p>
<p>Reduce the data set selecting only those subjects with observed outcome value(s).</p>
<p>Completers analysis may create selection bias, may cause overestimation of within group effects particularly at the last scheduled visit.</p>
</section>
</section>
<section id="sensitivity-analyses---handling-nonignorable-missingness-mnar" class="level2">
<h2 class="anchored" data-anchor-id="sensitivity-analyses---handling-nonignorable-missingness-mnar">Sensitivity analyses - Handling nonignorable missingness (MNAR)</h2>
<ul>
<li>Assumption of MAR is often reasonable, but possibility of data missing not at random (MNAR) is difficult to rule out.</li>
<li>Thus, analysis under MNAR needed.</li>
<li>Analysis under MNAR: these methods are heavily assumption driven and the assumptions are not testable as we do not have the missing data.</li>
<li>Consider a sensitivity analysis framework allowing assessment of robustness of results to the various assumptions.</li>
<li>MNAR methods: different possibilities e.g.&nbsp;class of pattern-mixture models. The pattern-mixture model allows missing outcomes to be imputed under a chosen scenario and in this way can be used to complete the data set and apply the primary analysis to this completed data set.</li>
<li>MI can be used to explore departures from MAR (for analysis under a MNAR assumption). This is referred to as controlled MI and includes delta-based MI and reference-based MI (belong to the class of pattern mixture models). Data is imputed under an alternative MNAR distribution that reflects a relevant scenario for the unobserved data. The imputed data sets are then analysed as with standard MI.</li>
</ul>
<section id="reference-based-multiple-imputation" class="level3">
<h3 class="anchored" data-anchor-id="reference-based-multiple-imputation">Reference-based multiple imputation</h3>
<ul>
<li>Has received increasing attention in clinical trials as it provides an attractive approach for a sensitivity analysis because missing data assumptions are framed in an intuitive way. The departure from MAR is captured in a qualitative way, making the formulation of the problem intuitive.</li>
<li>For example, a plausible MNAR mechanism in a placebo???controlled trial is to assume that subjects in the experimental arm who dropped out stop taking their treatment and have similar outcomes to those in the placebo arm.</li>
<li>Remember: MI under MAR assumes that the outcome distribution of patients with missing data is the same as the outcome distribution of patients with complete data, conditional on relevant covariates. However, if most patients withdraw from the study after treatment discontinuation, then this is not plausible, as patients who withdraw from the study treatment are expected to have a worse otucome than patients who stay on study treatment. Thus, <strong>addressing missing data under a MAR assumption estimates a hypothetical estimand and not a treatment policy estimand.</strong></li>
<li>Different options to handle missing outcome data for reference-based imputation were described <span class="citation" data-cites="carpenter2013">(<a href="#ref-carpenter2013" role="doc-biblioref">Carpenter and Kenward 2013</a>)</span>: e.g.&nbsp;jump to reference (J2R), copy reference (CR), copy increments in reference (CIR)</li>
</ul>
<p><strong>Jump to reference</strong> J2R assumes that after treatment discontinuation, the patient???s mean outcome distribution is that of a reference group, usually the control group. This is a very extreme assumption, as this implies that any efficacy of the drug vanishes immediately after discontinuation - may be plausible for symptomatic treatments.</p>
<p><strong>Copy reference</strong> CR assumes that the patient???s outcome distribution both before and after treatment discontinuation is the same as the distribution of the reference group. This has a milder effect than J2R: If a treatment-group patient has an outcome that is better than the reference group mean before treatment discontinuation, their imputed values after treatment discontinuation will also be better than the reference group mean.</p>
<p><strong>Copy increments in reference</strong> CIR assumes that after treatment discontinuation, the increments are the same as those from the reference group. This is much milder than J2R and CR and implies that benefit gained from the treatment before discontinuation is not lost.</p>
<p>The conventional approach to analyse data using these reference based approaches is MI, following the same steps as MI under MAR.</p>
<p>Software, R: e.g.&nbsp;the rbmi package supports reference-based strategies <span class="citation" data-cites="gowerpage2022">(<a href="#ref-gowerpage2022" role="doc-biblioref">Gower-Page and Wolbers 2022</a>)</span></p>
</section>
<section id="delta-based-multiple-imputation" class="level3">
<h3 class="anchored" data-anchor-id="delta-based-multiple-imputation">Delta-based multiple imputation</h3>
<ul>
<li>Impute data assuming all unobserved subjects having a poorer or better response than those observed, by adding or subtracting a delta parameter <span class="math inline">\(\delta\)</span> to the expected value of the e.g.&nbsp;MAR imputed values.</li>
<li>Delta can be implemented in all treatment groups, or in only one group, or may vary by treatment group or an alternative specified factor.</li>
<li>Choice of values for the sensitivity parameter <span class="math inline">\(\delta\)</span>: e.g.&nbsp;selection by content experts.</li>
<li>Steps: 1. missing values are imputed using standard MI procedure e.g.&nbsp;under MAR (but can also be under MNAR e.g.&nbsp;combinded with copy reference approach), 2. imputed values are shifted by adding some fixed value <span class="math inline">\(\delta\)</span> to reflect the MNAR mechanism, 3. analysis with standard statistical methods including Rubin’s rule to combine results</li>
</ul>
</section>
</section>
<section id="practical-part" class="level2">
<h2 class="anchored" data-anchor-id="practical-part">Practical part</h2>
<ul>
<li>Take the (<em>all2</em>) <em>high2</em> data set</li>
<li>Look at the MMRM and at the complete case (CC) analysis (refer to section Missing Data for the <em>all2</em> data set).</li>
<li>Apply additionally LOCF and compare results.</li>
<li>Try MNAR method reference-based MI with J2R and CIR by using the rbmi package. Compare with the other results.</li>
</ul>
<section id="set-up-to-use-rbmi" class="level3">
<h3 class="anchored" data-anchor-id="set-up-to-use-rbmi">Set-up to use rbmi</h3>
<p>Have a short look at the <code>rbmi()</code> package first.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rbmi)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ?rbmi</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">vignette</span>(<span class="at">topic =</span> <span class="st">"quickstart"</span>, <span class="at">package =</span> <span class="st">"rbmi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>starting httpd help server ... done</code></pre>
</div>
</div>
<p>The workflow is based on 4 core functions:</p>
<ul>
<li>draws() - fits the imputation models, different methods possible, we will use method_bayes() for MI based on Bayesian posterior parameter draws from MCMC sampling</li>
<li>impute() - creates multiple imputed data sets</li>
<li>analyse() - analyses each of the multiple imputed data sets, default = ancova, other options possible</li>
<li>pool() - combines the results across imputed data sets, for method_bayes (see above) pooling and inference is based on Rubin’s rule</li>
</ul>
<p>Implemented imputation strategies in rbmi:</p>
<ul>
<li>Missing at Random (MAR)</li>
<li>Jump to Reference (JR)</li>
<li>Copy Reference (CR)</li>
<li>Copy Increments in Reference (CIR)</li>
</ul>
<p>I will show how it looks like for the <em>all2</em> data set and you will then explore the methods using the <em>high2</em> data set.</p>
</section>
<section id="plenum---solution-for-all2-data-set" class="level3">
<h3 class="anchored" data-anchor-id="plenum---solution-for-all2-data-set">Plenum - Solution for all2 data set</h3>
<section id="complete-case" class="level4">
<h4 class="anchored" data-anchor-id="complete-case">1. Complete case</h4>
<p>Table: Adjusted means for the complete case data set (all2 data with drop-out, select completer)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>model_lsmeans_cc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> trt avisit emmean   SE df lower.CL upper.CL
 1   Week 2  -4.33 1.12 34    -6.61    -2.06
 2   Week 2  -5.47 1.09 34    -7.69    -3.26
 1   Week 4  -6.98 1.09 34    -9.19    -4.77
 2   Week 4  -9.12 1.06 34   -11.27    -6.97
 1   Week 8 -10.17 1.21 34   -12.63    -7.71
 2   Week 8 -13.10 1.18 34   -15.49   -10.71

Confidence level used: 0.95 </code></pre>
</div>
</div>
</section>
<section id="mmrm-unstructured-covariance" class="level4">
<h4 class="anchored" data-anchor-id="mmrm-unstructured-covariance">2. MMRM, unstructured covariance</h4>
<p>Table: Adjusted means for the all2 data set with drop-out analysed with MMRM</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>model_lsmeans_mmrm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> trt avisit emmean    SE   df lower.CL upper.CL
 1   Week 2  -4.10 0.900 47.0    -5.91    -2.29
 2   Week 2  -5.29 0.899 47.0    -7.10    -3.48
 1   Week 4  -6.42 0.974 46.5    -8.38    -4.46
 2   Week 4  -8.52 0.951 44.8   -10.43    -6.60
 1   Week 8  -9.73 1.142 40.4   -12.03    -7.42
 2   Week 8 -12.62 1.114 40.1   -14.88   -10.37

Confidence level used: 0.95 </code></pre>
</div>
</div>
</section>
<section id="locf" class="level4">
<h4 class="anchored" data-anchor-id="locf">3. LOCF</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>all2.locf <span class="ot">&lt;-</span> all2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(chgdrop)) <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(subject) <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>( <span class="at">drop=</span><span class="fu">max</span>(week) )</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>all2.locf<span class="ot">&lt;-</span>all2.locf <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(week<span class="sc">==</span>drop)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>ancova <span class="ot">&lt;-</span> <span class="fu">aov</span>(change <span class="sc">~</span> basval <span class="sc">+</span> trt, <span class="at">data =</span> all2.locf)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ancova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)  
basval       1    1.8    1.82   0.053 0.8185  
trt          1  114.2  114.20   3.342 0.0739 .
Residuals   47 1606.1   34.17                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>ancova<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)      basval        trt2 
-8.69460273  0.02497994 -3.02800963 </code></pre>
</div>
</div>
<p>Table: Mean values for change from baseline of LOCF analysis</p>
<div class="cell">
<div class="cell-output-display">

<div id="eetfhitrbm" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#eetfhitrbm table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#eetfhitrbm thead, #eetfhitrbm tbody, #eetfhitrbm tfoot, #eetfhitrbm tr, #eetfhitrbm td, #eetfhitrbm th {
  border-style: none;
}

#eetfhitrbm p {
  margin: 0;
  padding: 0;
}

#eetfhitrbm .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#eetfhitrbm .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#eetfhitrbm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#eetfhitrbm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#eetfhitrbm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eetfhitrbm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eetfhitrbm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eetfhitrbm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#eetfhitrbm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#eetfhitrbm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#eetfhitrbm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#eetfhitrbm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#eetfhitrbm .gt_spanner_row {
  border-bottom-style: hidden;
}

#eetfhitrbm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#eetfhitrbm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#eetfhitrbm .gt_from_md > :first-child {
  margin-top: 0;
}

#eetfhitrbm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#eetfhitrbm .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#eetfhitrbm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#eetfhitrbm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#eetfhitrbm .gt_row_group_first td {
  border-top-width: 2px;
}

#eetfhitrbm .gt_row_group_first th {
  border-top-width: 2px;
}

#eetfhitrbm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eetfhitrbm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#eetfhitrbm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#eetfhitrbm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eetfhitrbm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eetfhitrbm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#eetfhitrbm .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#eetfhitrbm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#eetfhitrbm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eetfhitrbm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eetfhitrbm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eetfhitrbm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eetfhitrbm .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eetfhitrbm .gt_left {
  text-align: left;
}

#eetfhitrbm .gt_center {
  text-align: center;
}

#eetfhitrbm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#eetfhitrbm .gt_font_normal {
  font-weight: normal;
}

#eetfhitrbm .gt_font_bold {
  font-weight: bold;
}

#eetfhitrbm .gt_font_italic {
  font-style: italic;
}

#eetfhitrbm .gt_super {
  font-size: 65%;
}

#eetfhitrbm .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#eetfhitrbm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#eetfhitrbm .gt_indent_1 {
  text-indent: 5px;
}

#eetfhitrbm .gt_indent_2 {
  text-indent: 10px;
}

#eetfhitrbm .gt_indent_3 {
  text-indent: 15px;
}

#eetfhitrbm .gt_indent_4 {
  text-indent: 20px;
}

#eetfhitrbm .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="<strong>Characteristic</strong>"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>Arm 1</strong>, N = 25<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>"><strong>Arm 1</strong>, N = 25<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>Arm 2</strong>, N = 25<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>"><strong>Arm 2</strong>, N = 25<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">change</td>
<td headers="stat_1" class="gt_row gt_center">-8.20 (5.50)</td>
<td headers="stat_2" class="gt_row gt_center">-11.24 (6.06)</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="3"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> Mean (SD)</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</section>
<section id="j2r-imputation" class="level4">
<h4 class="anchored" data-anchor-id="j2r-imputation">4. J2R imputation</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the names of key variables in the data set</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>set_mi<span class="ot">&lt;-</span><span class="fu">set_vars</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">subjid =</span> <span class="st">"subject"</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">visit =</span> <span class="st">"avisit"</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">"chgdrop"</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="st">"group"</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">covariates =</span> <span class="fu">c</span>(<span class="st">"basval * avisit"</span>, <span class="st">"group * avisit"</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>vars_an<span class="ot">&lt;-</span>set_mi</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>vars_an<span class="sc">$</span>covariates <span class="ot">&lt;-</span> <span class="st">"basval"</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the imputation strategy for each subject with at least one missing observation</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>dat_ice <span class="ot">&lt;-</span> all2 <span class="sc">%&gt;%</span> </span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(subject, avisit) <span class="sc">%&gt;%</span> </span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(chgdrop)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(subject) <span class="sc">%&gt;%</span> </span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(subject, avisit) <span class="sc">%&gt;%</span> </span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">strategy =</span> <span class="st">"JR"</span>)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the imputation method</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>method <span class="ot">&lt;-</span> <span class="fu">method_bayes</span>(</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">burn_in =</span> <span class="dv">200</span>,</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">burn_between =</span> <span class="dv">5</span>,</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_samples =</span> <span class="dv">100</span>,</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">072407</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>draw_all2<span class="ot">&lt;-</span><span class="fu">draws</span>(<span class="at">data=</span>all2, <span class="at">data_ice =</span> dat_ice, <span class="at">vars=</span>set_mi, <span class="at">method=</span>method, <span class="at">ncores =</span> <span class="dv">1</span>, <span class="at">quiet =</span> <span class="cn">FALSE</span>)</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>imputeObj <span class="ot">&lt;-</span> rbmi<span class="sc">::</span><span class="fu">impute</span>(</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>  draw_all2,</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">references =</span> <span class="fu">c</span>(<span class="st">"Arm 1"</span> <span class="ot">=</span> <span class="st">"Arm 1"</span>, <span class="st">"Arm 2"</span> <span class="ot">=</span> <span class="st">"Arm 1"</span>)</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>imputed_all2 <span class="ot">&lt;-</span> <span class="fu">extract_imputed_dfs</span>(imputeObj)</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>anaObj <span class="ot">&lt;-</span> <span class="fu">analyse</span>(</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>  imputeObj,</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">vars =</span> vars_an</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Table: Estimates from jump to reference J2R imputation</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>poolObj <span class="ot">&lt;-</span> <span class="fu">pool</span>(anaObj)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(poolObj)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       parameter        est        se        lci        uci         pval
1     trt_Week 2  -1.189928 1.2864325  -3.780746  1.4008900 3.598958e-01
2 lsm_ref_Week 2  -4.125036 0.9088264  -5.955372 -2.2947002 4.178855e-05
3 lsm_alt_Week 2  -5.314964 0.9088264  -7.145300 -3.4846279 5.199440e-07
4     trt_Week 4  -1.891611 1.3620669  -4.640571  0.8573493 1.722385e-01
5 lsm_ref_Week 4  -6.431208 0.9825242  -8.416838 -4.4455792 8.018843e-08
6 lsm_alt_Week 4  -8.322819 0.9686135 -10.278514 -6.3671240 9.691334e-11
7     trt_Week 8  -2.224522 1.6819701  -5.630171  1.1811279 1.939313e-01
8 lsm_ref_Week 8  -9.635725 1.2325842 -12.138382 -7.1330688 3.578224e-09
9 lsm_alt_Week 8 -11.860247 1.1666594 -14.219452 -9.5010426 1.465037e-12</code></pre>
</div>
</div>
</section>
<section id="change-from-j2r-to-cir" class="level4">
<h4 class="anchored" data-anchor-id="change-from-j2r-to-cir">5. Change from J2R to CIR</h4>
<p>Use the additional argument update_strategies in the impute function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>dat_ice_CIR <span class="ot">&lt;-</span> dat_ice <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">strategy =</span> <span class="fu">ifelse</span>(strategy <span class="sc">==</span> <span class="st">"JR"</span>, <span class="st">"CIR"</span>, strategy))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>imputeObj_CIR <span class="ot">&lt;-</span> rbmi<span class="sc">::</span><span class="fu">impute</span>(</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  draw_all2,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">references =</span> <span class="fu">c</span>(<span class="st">"Arm 1"</span> <span class="ot">=</span> <span class="st">"Arm 1"</span>, <span class="st">"Arm 2"</span> <span class="ot">=</span> <span class="st">"Arm 1"</span>),</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">update_strategy =</span> dat_ice_CIR</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>anaObj_CIR <span class="ot">&lt;-</span> <span class="fu">analyse</span>(</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  imputeObj_CIR,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">vars =</span> vars_an</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Table: Estimates from copy increments in reference CIR imputation</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>poolObj_CIR <span class="ot">&lt;-</span> <span class="fu">pool</span>(anaObj_CIR)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(poolObj_CIR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       parameter        est        se        lci        uci         pval
1     trt_Week 2  -1.189928 1.2864325  -3.780746  1.4008900 3.598958e-01
2 lsm_ref_Week 2  -4.125036 0.9088264  -5.955372 -2.2947002 4.178855e-05
3 lsm_alt_Week 2  -5.314964 0.9088264  -7.145300 -3.4846279 5.199440e-07
4     trt_Week 4  -2.014066 1.3705302  -4.780689  0.7525565 1.492051e-01
5 lsm_ref_Week 4  -6.421132 0.9876309  -8.417393 -4.4248703 9.451951e-08
6 lsm_alt_Week 4  -8.435198 0.9659215 -10.384762 -6.4856335 5.656836e-11
7     trt_Week 8  -2.623617 1.6330444  -5.927634  0.6803994 1.162804e-01
8 lsm_ref_Week 8  -9.638166 1.1777005 -12.024453 -7.2518789 8.026285e-10
9 lsm_alt_Week 8 -12.261783 1.1899788 -14.674825 -9.8487422 2.641684e-12</code></pre>
</div>
</div>
</section>
<section id="summary-of-results-all2-data-set" class="level4">
<h4 class="anchored" data-anchor-id="summary-of-results-all2-data-set">Summary of results <em>all2</em> data set</h4>
<p>Take the figure from the missingness part to better understand what we have found here.</p>
<table class="table">
<caption>Estimates for all methods</caption>
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;">Mean</th>
<th style="text-align: center;">Diff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Completers, Arm 1</td>
<td style="text-align: center;">-10.17</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td>Completers, Arm 2</td>
<td style="text-align: center;">-13.10</td>
<td style="text-align: center;">-2.93</td>
</tr>
<tr class="odd">
<td>MMRM, Arm 1</td>
<td style="text-align: center;">-9.73</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td>MMRM, Arm 2</td>
<td style="text-align: center;">-12.62</td>
<td style="text-align: center;">-2.89</td>
</tr>
<tr class="odd">
<td>LOCF, Arm 1</td>
<td style="text-align: center;">-8.20</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td>LOCF, Arm 2</td>
<td style="text-align: center;">-11.24</td>
<td style="text-align: center;">-3.03</td>
</tr>
<tr class="odd">
<td>J2R , Arm 1</td>
<td style="text-align: center;">-9.66</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td>J2R , Arm 2</td>
<td style="text-align: center;">-11.87</td>
<td style="text-align: center;">-2.21</td>
</tr>
<tr class="odd">
<td>CIR , Arm 1</td>
<td style="text-align: center;">-9.65</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td>CIR , Arm 2</td>
<td style="text-align: center;">-12.26</td>
<td style="text-align: center;">-2.61</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="test-from-all2-to-high2-data-set" class="level3">
<h3 class="anchored" data-anchor-id="test-from-all2-to-high2-data-set">Test: From <em>all2</em> to <em>high2</em> data set</h3>
<p>Now, you can first of all repeat the analysis on the <em>all2</em> data set to see if you can manage it. Or you go directly to the next step and apply methods to the <em>high2</em> data set.</p>
<p>One starting point for the <em>high2</em> data set as the structure is a little bit different:</p>
<p>First, fill in missing visits. This was not necessary in the <em>all2</em> data set. This can be done with the expand_locf function of the rbmi package. Note, <em>change</em> is the outcome variable and not <em>chgdrop</em> as in <em>all2</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>high2 <span class="ot">&lt;-</span> high2 <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>high2_expand <span class="ot">&lt;-</span> <span class="fu">expand_locf</span>(</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  high2,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">subject =</span> <span class="fu">levels</span>(high2<span class="sc">$</span>subject),  </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">avisit =</span> <span class="fu">levels</span>(high2<span class="sc">$</span>avisit),</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">vars =</span> <span class="fu">c</span>(<span class="st">"basval"</span>,<span class="st">"trt"</span>,<span class="st">"group"</span>),</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">c</span>(<span class="st">"subject"</span>),</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">order =</span> <span class="fu">c</span>(<span class="st">"subject"</span>, <span class="st">"avisit"</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Exploring missing data</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_miss</span>(high2_expand)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="s4_sensitivity_analyses_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_miss_var</span>(high2_expand <span class="sc">%&gt;%</span> <span class="fu">filter</span>(group<span class="sc">==</span><span class="st">"Arm 1"</span>), </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">facet =</span> avisit, </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">show_pct =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="s4_sensitivity_analyses_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_miss_var</span>(high2_expand <span class="sc">%&gt;%</span> <span class="fu">filter</span>(group<span class="sc">==</span><span class="st">"Arm 2"</span>), </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">facet =</span> avisit, </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">show_pct =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="s4_sensitivity_analyses_files/figure-html/unnamed-chunk-13-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="complete-case-1" class="level4">
<h4 class="anchored" data-anchor-id="complete-case-1">1. Complete case</h4>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> trt avisit emmean    SE  df lower.CL upper.CL
 1   Week 1  -1.91 0.595 127    -3.08   -0.731
 2   Week 1  -1.97 0.550 127    -3.06   -0.885
 1   Week 2  -4.08 0.756 126    -5.58   -2.585
 2   Week 2  -4.47 0.702 127    -5.86   -3.080
 1   Week 4  -5.85 0.764 127    -7.36   -4.336
 2   Week 4  -6.99 0.706 127    -8.38   -5.591
 1   Week 6  -7.09 0.749 127    -8.57   -5.607
 2   Week 6  -8.51 0.692 127    -9.88   -7.138
 1   Week 8  -6.96 0.811 127    -8.56   -5.352
 2   Week 8  -8.67 0.750 127   -10.16   -7.191

Confidence level used: 0.95 </code></pre>
</div>
</div>
</section>
<section id="mmrm-unstructured-covariance-1" class="level4">
<h4 class="anchored" data-anchor-id="mmrm-unstructured-covariance-1">2. MMRM, unstructured covariance</h4>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> trt avisit emmean    SE  df lower.CL upper.CL
 1   Week 1  -1.61 0.458 197    -2.52   -0.711
 2   Week 1  -1.66 0.459 197    -2.56   -0.752
 1   Week 2  -3.24 0.609 191    -4.44   -2.036
 2   Week 2  -3.89 0.613 193    -5.10   -2.681
 1   Week 4  -4.52 0.656 182    -5.81   -3.223
 2   Week 4  -5.98 0.656 182    -7.27   -4.684
 1   Week 6  -5.12 0.718 168    -6.53   -3.701
 2   Week 6  -7.48 0.715 166    -8.89   -6.067
 1   Week 8  -5.24 0.785 149    -6.79   -3.686
 2   Week 8  -7.76 0.762 139    -9.26   -6.251

Confidence level used: 0.95 </code></pre>
</div>
</div>
</section>
<section id="locf-1" class="level4">
<h4 class="anchored" data-anchor-id="locf-1">3. LOCF</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>high2_expand.locf <span class="ot">&lt;-</span> high2_expand <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(change)) <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(subject) <span class="sc">%&gt;%</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>( <span class="at">drop=</span><span class="fu">max</span>(week) )</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>high2_expand.locf<span class="ot">&lt;-</span>high2_expand.locf <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(week<span class="sc">==</span>drop)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>ancova <span class="ot">&lt;-</span> <span class="fu">aov</span>(change <span class="sc">~</span> basval <span class="sc">+</span> trt, <span class="at">data =</span> high2_expand.locf)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ancova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value  Pr(&gt;F)   
basval        1    483   483.3   9.709 0.00211 **
trt           1    241   241.4   4.851 0.02880 * 
Residuals   197   9805    49.8                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>ancova<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)      basval        trt2 
  0.3536399  -0.2648315  -2.2086854 </code></pre>
</div>
</div>
<p>Table: Mean values for change from baseline of LOCF analysis</p>
<div class="cell">
<div class="cell-output-display">

<div id="vikgwikfwo" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#vikgwikfwo table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vikgwikfwo thead, #vikgwikfwo tbody, #vikgwikfwo tfoot, #vikgwikfwo tr, #vikgwikfwo td, #vikgwikfwo th {
  border-style: none;
}

#vikgwikfwo p {
  margin: 0;
  padding: 0;
}

#vikgwikfwo .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vikgwikfwo .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vikgwikfwo .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vikgwikfwo .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vikgwikfwo .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vikgwikfwo .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vikgwikfwo .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vikgwikfwo .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vikgwikfwo .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vikgwikfwo .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vikgwikfwo .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vikgwikfwo .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vikgwikfwo .gt_spanner_row {
  border-bottom-style: hidden;
}

#vikgwikfwo .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vikgwikfwo .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vikgwikfwo .gt_from_md > :first-child {
  margin-top: 0;
}

#vikgwikfwo .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vikgwikfwo .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vikgwikfwo .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vikgwikfwo .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vikgwikfwo .gt_row_group_first td {
  border-top-width: 2px;
}

#vikgwikfwo .gt_row_group_first th {
  border-top-width: 2px;
}

#vikgwikfwo .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vikgwikfwo .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vikgwikfwo .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vikgwikfwo .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vikgwikfwo .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vikgwikfwo .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vikgwikfwo .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vikgwikfwo .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vikgwikfwo .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vikgwikfwo .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vikgwikfwo .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vikgwikfwo .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vikgwikfwo .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vikgwikfwo .gt_left {
  text-align: left;
}

#vikgwikfwo .gt_center {
  text-align: center;
}

#vikgwikfwo .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vikgwikfwo .gt_font_normal {
  font-weight: normal;
}

#vikgwikfwo .gt_font_bold {
  font-weight: bold;
}

#vikgwikfwo .gt_font_italic {
  font-style: italic;
}

#vikgwikfwo .gt_super {
  font-size: 65%;
}

#vikgwikfwo .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vikgwikfwo .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vikgwikfwo .gt_indent_1 {
  text-indent: 5px;
}

#vikgwikfwo .gt_indent_2 {
  text-indent: 10px;
}

#vikgwikfwo .gt_indent_3 {
  text-indent: 15px;
}

#vikgwikfwo .gt_indent_4 {
  text-indent: 20px;
}

#vikgwikfwo .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="<strong>Characteristic</strong>"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>Arm 1</strong>, N = 100<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>"><strong>Arm 1</strong>, N = 100<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>Arm 2</strong>, N = 100<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>"><strong>Arm 2</strong>, N = 100<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">change</td>
<td headers="stat_1" class="gt_row gt_center">-4.22 (6.38)</td>
<td headers="stat_2" class="gt_row gt_center">-6.72 (7.90)</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="3"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> Mean (SD)</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</section>
<section id="j2r-imputation-1" class="level4">
<h4 class="anchored" data-anchor-id="j2r-imputation-1">4. J2R imputation</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the names of key variables in the data set</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>set_mi<span class="ot">&lt;-</span><span class="fu">set_vars</span>(</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">subjid =</span> <span class="st">"subject"</span>,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">visit =</span> <span class="st">"avisit"</span>,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="st">"change"</span>,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="st">"group"</span>,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">covariates =</span> <span class="fu">c</span>(<span class="st">"basval * avisit"</span>, <span class="st">"group * avisit"</span>)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>vars_an<span class="ot">&lt;-</span>set_mi</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>vars_an<span class="sc">$</span>covariates <span class="ot">&lt;-</span> <span class="st">"basval"</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the imputation strategy for each subject with at least one missing observation</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>dat_ice <span class="ot">&lt;-</span> high2_expand <span class="sc">%&gt;%</span> </span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(subject, avisit) <span class="sc">%&gt;%</span> </span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(change)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(subject) <span class="sc">%&gt;%</span> </span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(subject, avisit) <span class="sc">%&gt;%</span> </span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">strategy =</span> <span class="st">"JR"</span>)</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the imputation method</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>method <span class="ot">&lt;-</span> <span class="fu">method_bayes</span>(</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">burn_in =</span> <span class="dv">200</span>,</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">burn_between =</span> <span class="dv">5</span>,</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_samples =</span> <span class="dv">100</span>,</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">072407</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>draw_high2_expand<span class="ot">&lt;-</span><span class="fu">draws</span>(<span class="at">data=</span>high2_expand, <span class="at">data_ice =</span> dat_ice, <span class="at">vars=</span>set_mi, <span class="at">method=</span>method, <span class="at">ncores =</span> <span class="dv">1</span>, <span class="at">quiet =</span> <span class="cn">FALSE</span>)</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>imputeObj <span class="ot">&lt;-</span> rbmi<span class="sc">::</span><span class="fu">impute</span>(</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>  draw_high2_expand,</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">references =</span> <span class="fu">c</span>(<span class="st">"Arm 1"</span> <span class="ot">=</span> <span class="st">"Arm 1"</span>, <span class="st">"Arm 2"</span> <span class="ot">=</span> <span class="st">"Arm 1"</span>)</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>imputed_high2_expand <span class="ot">&lt;-</span> <span class="fu">extract_imputed_dfs</span>(imputeObj)</span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>anaObj <span class="ot">&lt;-</span> <span class="fu">analyse</span>(</span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>  imputeObj,</span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">vars =</span> vars_an</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Table: Estimates from jump to reference J2R imputation</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>poolObj <span class="ot">&lt;-</span> <span class="fu">pool</span>(anaObj)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(poolObj)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        parameter         est        se       lci        uci         pval
1      trt_Week 1 -0.04272539 0.6513099 -1.327240  1.2417894 9.477641e-01
2  lsm_ref_Week 1 -1.64363730 0.4593710 -2.549610 -0.7376649 4.367614e-04
3  lsm_alt_Week 1 -1.68636270 0.4593710 -2.592335 -0.7803903 3.118171e-04
4      trt_Week 2 -0.56992013 0.8733074 -2.293096  1.1532554 5.148426e-01
5  lsm_ref_Week 2 -3.31268012 0.6131345 -4.522404 -2.1029566 2.023442e-07
6  lsm_alt_Week 2 -3.88260025 0.6200592 -5.106212 -2.6589881 2.772190e-09
7      trt_Week 4 -1.24725634 0.9408037 -3.104301  0.6097887 1.866906e-01
8  lsm_ref_Week 4 -4.55155161 0.6629053 -5.860032 -3.2430717 1.152780e-10
9  lsm_alt_Week 4 -5.79880795 0.6663404 -7.114195 -4.4834207 2.753285e-15
10     trt_Week 6 -1.70672432 1.0335987 -3.747568  0.3341192 1.005981e-01
11 lsm_ref_Week 6 -5.19235287 0.7271162 -6.627972 -3.7567339 2.786779e-11
12 lsm_alt_Week 6 -6.89907719 0.7562247 -8.393431 -5.4047230 4.832113e-16
13     trt_Week 8 -1.72142767 1.1185316 -3.931215  0.4883593 1.258714e-01
14 lsm_ref_Week 8 -5.30861260 0.8134583 -6.916855 -3.7003698 1.147909e-09
15 lsm_alt_Week 8 -7.03004027 0.8171570 -8.645779 -5.4143020 1.519834e-14</code></pre>
</div>
</div>
</section>
<section id="cr-imputation" class="level4">
<h4 class="anchored" data-anchor-id="cr-imputation">5. CR imputation</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>dat_ice_CR <span class="ot">&lt;-</span> dat_ice <span class="sc">%&gt;%</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">strategy =</span> <span class="fu">ifelse</span>(strategy <span class="sc">==</span> <span class="st">"JR"</span>, <span class="st">"CR"</span>, strategy))</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>imputeObj_CR <span class="ot">&lt;-</span> rbmi<span class="sc">::</span><span class="fu">impute</span>(</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  draw_high2_expand,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">references =</span> <span class="fu">c</span>(<span class="st">"Arm 1"</span> <span class="ot">=</span> <span class="st">"Arm 1"</span>, <span class="st">"Arm 2"</span> <span class="ot">=</span> <span class="st">"Arm 1"</span>),</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">update_strategy =</span> dat_ice_CR</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>anaObj_CR <span class="ot">&lt;-</span> <span class="fu">analyse</span>(</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  imputeObj_CR,</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">vars =</span> vars_an</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Table: Estimates from copy increments in reference CR imputation</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>poolObj_CR <span class="ot">&lt;-</span> <span class="fu">pool</span>(anaObj_CR)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(poolObj_CR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        parameter         est        se       lci        uci         pval
1      trt_Week 1 -0.04272539 0.6513099 -1.327240  1.2417894 9.477641e-01
2  lsm_ref_Week 1 -1.64363730 0.4593710 -2.549610 -0.7376649 4.367614e-04
3  lsm_alt_Week 1 -1.68636270 0.4593710 -2.592335 -0.7803903 3.118171e-04
4      trt_Week 2 -0.56759918 0.8689359 -2.282001  1.1468026 5.144382e-01
5  lsm_ref_Week 2 -3.29268009 0.6124023 -4.500929 -2.0844308 2.286124e-07
6  lsm_alt_Week 2 -3.86027926 0.6116150 -5.066951 -2.6536076 2.006222e-09
7      trt_Week 4 -1.25504934 0.9383983 -3.107106  0.5970075 1.828184e-01
8  lsm_ref_Week 4 -4.53971218 0.6596020 -5.841448 -3.2379761 9.920190e-11
9  lsm_alt_Week 4 -5.79476153 0.6613572 -7.100023 -4.4895005 1.620378e-15
10     trt_Week 6 -1.84350067 1.0284066 -3.874288  0.1872865 7.490327e-02
11 lsm_ref_Week 6 -5.19290296 0.7322118 -6.639082 -3.7467244 4.162868e-11
12 lsm_alt_Week 6 -7.03640363 0.7325057 -8.483175 -5.5896322 1.716342e-17
13     trt_Week 8 -1.89556177 1.1140972 -4.097188  0.3060646 9.096551e-02
14 lsm_ref_Week 8 -5.34060252 0.8285363 -6.980116 -3.7010886 2.174328e-09
15 lsm_alt_Week 8 -7.23616429 0.7883131 -8.794109 -5.6782193 3.806874e-16</code></pre>
</div>
</div>
</section>
<section id="cir-imputation" class="level4">
<h4 class="anchored" data-anchor-id="cir-imputation">6. CIR imputation</h4>
<p>Use the additional argument update_strategies in the impute function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>dat_ice_CIR <span class="ot">&lt;-</span> dat_ice <span class="sc">%&gt;%</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">strategy =</span> <span class="fu">ifelse</span>(strategy <span class="sc">==</span> <span class="st">"JR"</span>, <span class="st">"CIR"</span>, strategy))</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>imputeObj_CIR <span class="ot">&lt;-</span> rbmi<span class="sc">::</span><span class="fu">impute</span>(</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  draw_high2_expand,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">references =</span> <span class="fu">c</span>(<span class="st">"Arm 1"</span> <span class="ot">=</span> <span class="st">"Arm 1"</span>, <span class="st">"Arm 2"</span> <span class="ot">=</span> <span class="st">"Arm 1"</span>),</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">update_strategy =</span> dat_ice_CIR</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>anaObj_CIR <span class="ot">&lt;-</span> <span class="fu">analyse</span>(</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  imputeObj_CIR,</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">vars =</span> vars_an</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Table: Estimates from copy increments in reference CIR imputation</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>poolObj_CIR <span class="ot">&lt;-</span> <span class="fu">pool</span>(anaObj_CIR)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(poolObj_CIR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        parameter         est        se       lci         uci         pval
1      trt_Week 1 -0.04272539 0.6513099 -1.327240  1.24178939 9.477641e-01
2  lsm_ref_Week 1 -1.64363730 0.4593710 -2.549610 -0.73766488 4.367614e-04
3  lsm_alt_Week 1 -1.68636270 0.4593710 -2.592335 -0.78039028 3.118171e-04
4      trt_Week 2 -0.59370495 0.8652051 -2.300688  1.11327818 4.934487e-01
5  lsm_ref_Week 2 -3.31016751 0.6107925 -4.515231 -2.10510358 1.858699e-07
6  lsm_alt_Week 2 -3.90387245 0.6131567 -5.113675 -2.69407009 1.525078e-09
7      trt_Week 4 -1.30521947 0.9399264 -3.160483  0.55004438 1.667362e-01
8  lsm_ref_Week 4 -4.54415889 0.6612575 -5.849315 -3.23900302 1.094861e-10
9  lsm_alt_Week 4 -5.84937837 0.6646077 -7.161268 -4.53748825 1.440661e-15
10     trt_Week 6 -1.95953532 1.0158040 -3.965042  0.04597113 5.542434e-02
11 lsm_ref_Week 6 -5.17405265 0.7257053 -6.607187 -3.74091840 3.216919e-11
12 lsm_alt_Week 6 -7.13358797 0.7274177 -8.570175 -5.69700135 4.541636e-18
13     trt_Week 8 -2.06003358 1.1160556 -4.265940  0.14587245 6.696562e-02
14 lsm_ref_Week 8 -5.30927178 0.8206544 -6.933036 -3.68550713 1.886190e-09
15 lsm_alt_Week 8 -7.36930536 0.7879631 -8.926768 -5.81184259 1.535541e-16</code></pre>
</div>
</div>
</section>
<section id="summary-of-results-high2_expand-data-set" class="level4">
<h4 class="anchored" data-anchor-id="summary-of-results-high2_expand-data-set">Summary of results <em>high2_expand</em> data set</h4>
<p>Take the figure from the missingness part to better understand what we have found here.</p>
<table class="table">
<caption>Estimates for all methods</caption>
<thead>
<tr class="header">
<th>Group</th>
<th style="text-align: center;">Mean</th>
<th style="text-align: center;">Diff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Completers, Arm 1</td>
<td style="text-align: center;">-6.96</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td>Completers, Arm 2</td>
<td style="text-align: center;">-8.67</td>
<td style="text-align: center;">-1.71</td>
</tr>
<tr class="odd">
<td>MMRM, Arm 1</td>
<td style="text-align: center;">-5.24</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td>MMRM, Arm 2</td>
<td style="text-align: center;">-7.76</td>
<td style="text-align: center;">-2.52</td>
</tr>
<tr class="odd">
<td>LOCF, Arm 1</td>
<td style="text-align: center;">-4.22</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td>LOCF, Arm 2</td>
<td style="text-align: center;">-6.72</td>
<td style="text-align: center;">-2.50</td>
</tr>
<tr class="odd">
<td>J2R, Arm 1</td>
<td style="text-align: center;">-5.31</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td>J2R, Arm 2</td>
<td style="text-align: center;">-7.03</td>
<td style="text-align: center;">-1.72</td>
</tr>
<tr class="odd">
<td>CR, Arm 1</td>
<td style="text-align: center;">-5.34</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td>CR, Arm 2</td>
<td style="text-align: center;">-7.24</td>
<td style="text-align: center;">-1.90</td>
</tr>
<tr class="odd">
<td>CIR, Arm 1</td>
<td style="text-align: center;">-5.31</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td>CIR, Arm 2</td>
<td style="text-align: center;">-7.37</td>
<td style="text-align: center;">-2.06</td>
</tr>
</tbody>
</table>



</section>
</section>
</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-carpenter2013" class="csl-entry" role="listitem">
Carpenter, Roger, J. R., and M. G. Kenward. 2013. <span>“Analysis of Longitudinal Trials with Protocol Deviation: A Framework for Relevant, Accessible Assumptions, and Inference via Multiple Imputation.”</span> <em>Journal of Biopharmaceutical Statistics</em>, October. <a href="https://doi.org/10.1080/10543406.2013.834911">https://doi.org/10.1080/10543406.2013.834911</a>.
</div>
<div id="ref-gowerpage2022" class="csl-entry" role="listitem">
Gower-Page, Noci, C., and M. Wolbers. 2022. <span>“Rbmi: A r Package for Standard and Reference-Based Multiple Imputation Methods.”</span> <em>Journal of Open Source Software</em>, June. <a href="https://doi.org/10.21105/joss.04251">https://doi.org/10.21105/joss.04251</a>.
</div>
<div id="ref-kayembe2022" class="csl-entry" role="listitem">
Kayembe, Jolani, M. T., and G. J. P. van Breukelen. 2022. <span>“Imputation of Missing Covariates in Randomized Controlled Trials with Continuous Outcomes: Simple, Unbiased and Efficient Methods.”</span> <em>Journal of Biopharmaceutical Statistics</em>, September. <a href="https://doi.org/10.1080/10543406.2021.2011898">https://doi.org/10.1080/10543406.2021.2011898</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>