<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title> Patient Reported Outcome Visualization</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Zehui Bai</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="02-Clinical_Experience.html">
    <span class="fa fa-user"></span>
     
    Clinical Experience
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-sliders"></span>
     
    Sample Size
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="03-SSC-Everything-to-Know-About-Sample-Size-Determination.html">Everything to Know About Sample Size Determination</a>
    </li>
    <li>
      <a href="03-SSC-Choosing-the-Effect-Size-for-Sample-Size-Calculations.html">Choosing the Effect Size</a>
    </li>
    <li>
      <a href="03-SSC-Biosimilar-Trials.html">Statistical Considerations for the Design and Analysis of Biosimilar Trials</a>
    </li>
    <li>
      <a href="03-SSC-Sample-Size-and-Power-for-Non-Parametric-Analysis.html">Sample Size and Power for Non-Parametric Analysis</a>
    </li>
    <li>
      <a href="03-SSC-Power-for-Complex-Hypotheses.html">Power for Complex Hypotheses</a>
    </li>
    <li>
      <a href="03-SSC-Alternatives-to-Power.html">Bayesian methods - Alternatives to Power</a>
    </li>
    <li>
      <a href="03-SSC-Sample-Size-for-Pilot-Studies.html">Sample Size for Pilot Studies</a>
    </li>
    <li>
      <a href="03-SSC-Case-Continuous-Endpoint.html">Sample Size Determination for Continuous Endpoint</a>
    </li>
    <li>
      <a href="03-SSC-Case-Categorical-Endpoint.html">Sample Size Determination for Categorical Endpoint</a>
    </li>
    <li>
      <a href="03-SSC-Sample-Size-Determination-for-Counts-and-Rates.html">Sample Size Determination for Counts and Rates</a>
    </li>
    <li>
      <a href="03-SSC-Case-Survival-Endpoint.html">Sample Size Determination for Survival Endpoint</a>
    </li>
    <li>
      <a href="03-SSC-Case-Repeated-Measures.html">Sample Size Determination for Repeated Measures</a>
    </li>
    <li>
      <a href="03-SSC-IA-Sequential-Design.html">Statistical Considerations for Group Sequential Design</a>
    </li>
    <li>
      <a href="03-SSC-IA-Adaptive-Design.html">Statistical Considerations for Adaptive Design</a>
    </li>
    <li>
      <a href="03-SSC-Multiple-Test.html">Sample Size for Multiple Test</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-pencil-square-o"></span>
     
    Study Design
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="04-Design-General-Consideration.html">General Consideration</a>
    </li>
    <li>
      <a href="04-Design-Estimands-Framework.html">Estimands Framework</a>
    </li>
    <li>
      <a href="04-Design-Estimands-Practice.html">Estimands and Sensitivity Analyses</a>
    </li>
    <li>
      <a href="04-Design-Phase-I-Trials---Design-Considerations.html">Phase I Trials - Design Considerations</a>
    </li>
    <li>
      <a href="04-Design-Phase-II-Trials---Design-Considerations.html">Phase II Trials - Design Considerations</a>
    </li>
    <li>
      <a href="04-Design-Phase-III-Trials---Design-Considerations.html">Phase III Trials - Design Considerations</a>
    </li>
    <li>
      <a href="04-Design-Phase-IV-Trials---Design-Considerations.html">Phase IV Trials - Design Considerations for Post Marketing Surveillance</a>
    </li>
    <li>
      <a href="04-Design-Complex-Sequential-Trials.html">Complex Sequential Analysis Trials</a>
    </li>
    <li>
      <a href="04-Design-Adaptive-Clinical-Trials.html">Adaptive Clinical Trials</a>
    </li>
    <li>
      <a href="04-Design-Bayesian-Clinical-Trials.html">Bayesian Clinical Trials</a>
    </li>
    <li>
      <a href="04-Design-Dose-Escalation-and-Stratification-Designs.html">Dose Escalation and Stratification Designs in Early Oncology Development</a>
    </li>
    <li>
      <a href="04-Design-Single-Arm-Clinical-Trials.html">Single Arm Clinical Trials</a>
    </li>
    <li>
      <a href="04-Design-Diagnostic-Study-Design-and-Evaluation.html">Diagnostic Study-Design and Evaluation</a>
    </li>
    <li>
      <a href="04-Design-Diagnostic-Study-MRMC.html">Diagnostic Study-Multireader Multicase (MRMC)</a>
    </li>
    <li>
      <a href="04-Design-Vaccine-Design.html">Vaccine Trials</a>
    </li>
    <li>
      <a href="04-Design-Externally-Controlled-Trials.html">Externally Controlled Trials</a>
    </li>
    <li>
      <a href="04-Design-Noninferiority-Trials.html">Noninferiority Trials</a>
    </li>
    <li>
      <a href="04-Design-Bioequivalence-and-Biosimilar-Trials.html">Bioequivalence and Biosimilar Trials</a>
    </li>
    <li>
      <a href="04-Design-Exploring-Survival-Analysis-Designs-for-Clinical-Trials.html">Exploring Survival Analysis Designs for Clinical Trials</a>
    </li>
    <li>
      <a href="04-Design-Hierarchical-composite-endpoints.html">Hierarchical Composite Endpoints</a>
    </li>
    <li>
      <a href="04-Design-Regulatory-Submission.html">Regulatory Submission from Stats Perspective</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-line-chart"></span>
     
    Data Visualization
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="05-Plot-Time-To-Event.html">Time to Event Data Visualization</a>
    </li>
    <li>
      <a href="05-Plot-PRO-Data.html">Patient Reported Outcome Data Visualization</a>
    </li>
    <li>
      <a href="05-Plot-SSC-and-Power-Calculation.html">Sample Size and Power Calculations Visualization</a>
    </li>
    <li>
      <a href="05-Plot-Correlation.html">Correlation Visualization</a>
    </li>
    <li>
      <a href="05-Plot-Model-Table.html">Clinical Data and Model visualization</a>
    </li>
    <li>
      <a href="05-Plot-ScatterPlot.html">Scatter and Line Plot</a>
    </li>
    <li>
      <a href="05-Plot-BarPlot.html">Bar Chart</a>
    </li>
    <li>
      <a href="05-Plot-PieChart.html">Pie Chart</a>
    </li>
    <li>
      <a href="05-Plot-BoxPlot.html">Box Plot</a>
    </li>
    <li>
      <a href="05-Plot-Histogram.html">Histogram</a>
    </li>
    <li>
      <a href="05-Plot-Forest-Plot.html">Forest Plot</a>
    </li>
    <li>
      <a href="05-Plot-Flow-Chart.html">Flow Chart</a>
    </li>
    <li>
      <a href="05-Plot-Some-Interesting.html">Some Interesting Plots</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-calculator"></span>
     
    Statistical Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="06-Analysis-Linear-Regression.html">Linear Regression</a>
    </li>
    <li>
      <a href="06-Analysis-Logistic-Regression.html">Logistic Regression</a>
    </li>
    <li>
      <a href="06-Analysis-Mixed-Model.html">Mixed Model</a>
    </li>
    <li>
      <a href="06-Analysis-MMRM.html">Mixed Model Repeated Measures</a>
    </li>
    <li>
      <a href="06-Analysis-GEE.html">Generalized Estimating Equation</a>
    </li>
    <li>
      <a href="06-Analysis-ANOVA.html">Analysis of Variance</a>
    </li>
    <li>
      <a href="06-Analysis-Survival-Analysis.html">Survival Analysis</a>
    </li>
    <li>
      <a href="06-Analysis-Survival-Competing-Risk.html">Survival Analysis - Competing Risk</a>
    </li>
    <li>
      <a href="06-Analysis-Missing-Data.html">Missing Data Analysis</a>
    </li>
    <li>
      <a href="06-Analysis-MI-Implementation.html">Multiple Imputation Analysis</a>
    </li>
    <li>
      <a href="06-Analysis-SSD.html">Safety Signal Detection and Evaluation</a>
    </li>
    <li>
      <a href="06-Analysis-Meta-Analysis.html">Meta Analysis</a>
    </li>
    <li>
      <a href="06-Analysis-PK-and-PD.html">PK and PD Analysis</a>
    </li>
    <li>
      <a href="06-Analysis-Time-Series-Analysis.html">Time Series Analysis</a>
    </li>
    <li>
      <a href="06-Analysis-SEM.html">Structural Equation Modeling</a>
    </li>
    <li>
      <a href="06-Analysis-Factor-Analysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="06-Analysis-Propensity-Score.html">Propensity Score Analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-bar-chart"></span>
     
    Machine Learning
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="07-ML-Bayesian-Theory.html">Bayesian Theory</a>
    </li>
    <li>
      <a href="07-ML-Bayesian-Analysis.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="07-ML-Regularization-Penalized-Regression.html">Regularization Penalized Regression</a>
    </li>
    <li>
      <a href="07-ML-Loss-Regression.html">Loss Functions in Machine Learning</a>
    </li>
    <li>
      <a href="07-ML-PCA.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="07-ML-KNN.html">K-Nearest Neighbors</a>
    </li>
    <li>
      <a href="07-ML-SVM.html">Support Vector Machine</a>
    </li>
    <li>
      <a href="07-ML-Tree-Models.html">Tree Models</a>
    </li>
    <li>
      <a href="07-ML-LDA.html">Linear Discriminant Analysis</a>
    </li>
    <li>
      <a href="07-ML-Cluster-Analysis.html">Cluster Analysis</a>
    </li>
    <li>
      <a href="07-ML-Neural-Networks.html">Neural Network</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-stethoscope"></span>
     
    Clinical Analysis (ADaM)
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="08-Clinical-Disposition-Baseline.html">Disposition and Baseline</a>
    </li>
    <li>
      <a href="08-Clinical-Efficacy.html">Efficacy Analysis</a>
    </li>
    <li>
      <a href="08-Clinical-Pharmacokinetics-Analysis.html">Pharmacokinetics Analysis</a>
    </li>
    <li>
      <a href="08-Clinical-Adverse-Event.html">Adverse Event Visualization</a>
    </li>
    <li>
      <a href="08-Clinical-Laboratory-Data.html">Laboratory Data Visualization</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="08-CV.html">
    <span class="fa fa-file-pdf-o"></span>
     
    CV
  </a>
</li>
<li>
  <a href="mailto:zehuibai@outlook.com">
    <span class="fa fa-envelope-o"></span>
     
    Contact me
  </a>
</li>
<li>
  <a href="https://github.com/Zehuibai">
    <span class="fa fa-github"></span>
     
    GitHub
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore"><p><img src="logo.png"
style="width:3in" /><br />
Patient Reported Outcome Visualization</p></h1>

</div>


<div id="histogram" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Histogram</h1>
<p>In data analysis, especially when dealing with questionnaire data,
<code>geom_histogram()</code> in <code>ggplot2</code> can be an
essential tool for visualizing the distribution of responses. Histograms
are particularly effective for showing the frequency of score
occurrences across a range of values, making them ideal for summarizing
the results from questionnaires where responses are often scaled (e.g.,
Likert scales from 1 to 5).</p>
<ol style="list-style-type: decimal">
<li><p><strong>Data Structure Preparation</strong>: Your dataset should
contain numeric or ordinal scale responses to questionnaire items. Each
response is treated as an individual data point.</p></li>
<li><p><strong>Plotting with <code>geom_histogram()</code></strong>:</p>
<ul>
<li><strong>Bin Settings</strong>: By default,
<code>geom_histogram()</code> will attempt to create 30 bins of equal
width, but for questionnaire data, you might set the
<code>binwidth</code> to 1 if your data are integers representing
something like a Likert scale. This will create a bin for each possible
score, aligning perfectly with the questionnaire’s scoring system.</li>
<li><strong>Aesthetic Mapping</strong>: Map the x-axis to your
questionnaire score variable. Optionally, you can fill the bars based on
another variable, such as different groups or demographics within your
survey population, to compare distributions across categories.</li>
<li><strong>Position Adjustment</strong>: If you are filling based on a
factor (like age group or gender), using <code>position = "dodge"</code>
will place the groups side by side for easier comparison, rather than
the default stacking.</li>
</ul></li>
<li><p><strong>Customizations and Improvements</strong>:</p>
<ul>
<li><strong>Labels and Titles</strong>: Adding clear labels for the
x-axis and y-axis, as well as a descriptive title, can help in
immediately understanding the plot’s purpose. For instance, x could be
“Questionnaire Score” and y “Frequency of Responses”.</li>
<li><strong>Theme Adjustments</strong>: Customize the plot appearance
using <code>theme()</code> to improve readability and presentation
quality. For example, adjusting text size, changing the legend position,
or modifying background colors.</li>
</ul></li>
<li><p><strong>Statistical Overlays</strong>:</p>
<ul>
<li><strong>Adding Mean/Mode Lines</strong>: You can overlay additional
information such as a vertical line showing the mean or mode of the
distribution using <code>geom_vline()</code>, which can provide insights
into the central tendency of the responses.</li>
<li><strong>Annotations</strong>: Annotate specific features of the
histogram, like notable peaks or unusual gaps, to draw attention to
important aspects of the data.</li>
</ul></li>
<li><p><strong>Analysis Interpretation</strong>:</p>
<ul>
<li>Histograms allow you to quickly grasp the distribution of responses,
identify common and outlier responses, and assess the skewness or
symmetry of the data.</li>
<li>By comparing histograms from different demographic groups, you can
explore how opinions or behaviors differ across these groups,
potentially guiding more detailed statistical tests or reporting
insights.</li>
</ul></li>
</ol>
<div id="general" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> General</h2>
<pre class="r"><code>data &lt;- data.frame(
  Group = c(rep(&quot;Active Treatment&quot;, 200), rep(&quot;Placebo&quot;, 200)),
  Time = c(rep(&quot;Baseline&quot;, 100), rep(&quot;Week 16&quot;, 100), rep(&quot;Baseline&quot;, 100), rep(&quot;Week 16&quot;, 100)),
  DLQI_Score = c(sample(0:30, 100, replace = TRUE), sample(0:30, 100, replace = TRUE),
                 sample(0:30, 100, replace = TRUE), sample(0:30, 100, replace = TRUE))
)
 

# Create the plot
plot1 &lt;- ggplot(data, aes(x = DLQI_Score, fill = Time)) +
  geom_histogram(stat = &quot;count&quot;, binwidth = 1, position = position_dodge(width = 0.9)) +
  facet_wrap(~ Group, scales = &quot;free_y&quot;) +
  labs(
    title = &quot;Improved Quality of life after 16 weeks of treatment&quot;,
    x = &quot;Total DLQI Score&quot;,
    y = &quot;Patients&quot;
  ) +
  scale_fill_brewer(palette = &quot;Set1&quot;, labels = c(&quot;Baseline&quot;, &quot;Week 16&quot;)) +
  theme_minimal() +
  theme(
    legend.title = element_blank(),
    plot.title = element_text(hjust = 0.5)
  )
# Print the plot
print(plot1)</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-1-1.png" width="960" /></p>
<pre class="r"><code>plot2 &lt;- ggplot(data, aes(x = DLQI_Score, fill = Time)) +
  geom_histogram(stat = &quot;count&quot;, binwidth = 1, position = position_dodge(width = 0.9)) +
  facet_grid(Group ~ ., scales = &quot;free_y&quot;, space = &quot;free_y&quot;) +
  labs(
    title = &quot;Improved Quality of life after 16 weeks of treatment&quot;,
    x = &quot;Total DLQI Score&quot;,
    y = &quot;Patients&quot;
  ) +
  scale_fill_brewer(palette = &quot;Set1&quot;, labels = c(&quot;Baseline&quot;, &quot;Week 16&quot;)) +
  theme_minimal() +
  theme(
    legend.title = element_blank(),
    plot.title = element_text(hjust = 0.5),
    strip.background = element_blank(),
    strip.text = element_text(face = &quot;bold&quot;)
  )

# Print the plot
print(plot2)</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-1-2.png" width="960" /></p>
<pre class="r"><code>plot3 &lt;- ggplot(data, aes(x = DLQI_Score, fill = Time)) +
  geom_histogram(stat = &quot;count&quot;, binwidth = 1, position = position_dodge(width = 0.9)) +
  facet_grid(Time ~ Group, scales = &quot;free_y&quot;, space = &quot;free&quot;) +  # Adjust faceting
  labs(
    title = &quot;Improved Quality of life after 16 weeks of treatment&quot;,
    x = &quot;Total DLQI Score&quot;,
    y = &quot;Patients&quot;
  ) +
  scale_fill_brewer(palette = &quot;Set1&quot;, labels = c(&quot;Baseline&quot;, &quot;Week 16&quot;)) +
  theme_minimal() +
  theme(
    legend.title = element_blank(),
    plot.title = element_text(hjust = 0.5),
    strip.background = element_rect(fill = &quot;gray90&quot;),
    strip.text = element_text(face = &quot;bold&quot;)
  )

# Print the plot
print(plot3)</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-1-3.png" width="960" /></p>
</div>
<div id="clean-design-1" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Clean Design 1</h2>
<pre class="r"><code>dql &lt;- read.csv(&quot;./01_Datasets/ww2020_dlqi.csv&quot;)

attach(dql)
# View(dql)
# summary(dql)

# Load Library 
# library(ggthemes)
# library(ggcharts)

# Select relevant variables
dql_renamed &lt;-
  dql %&gt;%
  select(
    TRT, VISIT, DLQI_SCORE
    )

# Rename treatment levels
dql_renamed$TRT[dql_renamed$TRT==&quot;A&quot;] &lt;- &quot;Placebo&quot;
dql_renamed$TRT[dql_renamed$TRT==&quot;B&quot;] &lt;- &quot;Active Treatment&quot;

# Seperate visits

# Baseline visit
totalbaseline &lt;- 
  dql_renamed %&gt;% 
  filter(VISIT==&quot;Baseline&quot;)

# Construct a histogram for each treatment arm at baseline visit
(d &lt;- 
  ggplot(
    data = totalbaseline,
    aes(
      x = DLQI_SCORE
      ))
  + geom_histogram(
    binwidth = 1.5,
    color = &quot;grey&quot;,
    fill = &quot;deeppink3&quot;
    ) +
  facet_grid(~ TRT)
  + theme_ng(grid = &quot;X&quot;)
  + labs(
    x = &quot;DLQI Score&quot;,
    y = &quot;Count&quot;,
    title = &quot;Total DLQI Score&quot;,
    subtitle = &quot;At Baseline&quot;,
    caption = &quot;Samah Abdelaal&quot;)
  + theme(
    axis.title.x = element_blank(),
    plot.title = element_text(size = 20,
                              face = &quot;bold&quot;),
    plot.subtitle = element_text(size = 18),
    plot.caption = element_text(size = 15,
                                face = &quot;bold.italic&quot;)
    ))</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-2-1.png" width="960" /></p>
<pre class="r"><code># Week 16 visit
totalweek16 &lt;- 
  dql_renamed %&gt;% 
  filter(VISIT==&quot;Week 16&quot;)

(e &lt;- 
  ggplot(
    data = totalweek16,
    aes(
      x = DLQI_SCORE
      )
    )
  + geom_histogram(
    binwidth = 1.5,
    color = &quot;grey&quot;,
    fill = &quot;deeppink3&quot;
    ) +
  facet_grid(~ TRT)
  + theme_ng(grid = &quot;X&quot;)
  + labs(
    x = &quot;DLQI Score&quot;,
    y = &quot;Count&quot;,
    subtitle = &quot;At Week 16&quot;
    ) +
  theme(
    plot.subtitle = element_text(size = 18)
    ))</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-2-2.png" width="960" /></p>
<pre class="r"><code># Compine plots
library(gridExtra)

gridExtra::grid.arrange(d, e, nrow = 2)</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-2-3.png" width="960" /></p>
</div>
<div id="clean-design-2" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Clean Design 2</h2>
<pre class="r"><code>dql &lt;- read.csv(&quot;./01_Datasets/ww2020_dlqi.csv&quot;)

attach(dql)
# View(dql)
# summary(dql)

# Load Library
# library(tidyverse)
# library(ggplot2)
# library(ggthemes)
# library(ggcharts)

# Select relevant variables
dql_renamed &lt;-
  dql %&gt;%
  select(
    TRT, VISIT, DLQI_SCORE
    )

# Rename treatment levels
dql_renamed$TRT[dql_renamed$TRT==&quot;A&quot;] &lt;- &quot;Placebo&quot;
dql_renamed$TRT[dql_renamed$TRT==&quot;B&quot;] &lt;- &quot;Active Treatment&quot;

# Seperate treatments

# Active
totalB &lt;- 
  dql_renamed %&gt;% 
  filter(TRT==&quot;Active Treatment&quot;)

# Construct a histogram for each treatment arm at baseline visit
(d &lt;- 
  ggplot(
    data = totalB,
    aes(
      x = DLQI_SCORE
      ))
  + geom_histogram(
    binwidth = 1,
    color = &quot;grey&quot;,
    fill = &quot;deeppink3&quot;
    ) +
  facet_grid(~ VISIT)
  + theme_ng(grid = &quot;X&quot;)
  + labs(
    x = &quot;Total DLQI Score&quot;,
    y = &quot;Patients&quot;,
    title = &quot;Improved Quality of life after 16 weeks of treatment&quot;,
    subtitle = &quot;Active Treatment&quot;)
  + theme(
    axis.title.x = element_blank(),
    axis.text.x = element_blank(),
    plot.title = element_text(size = 17,
                              face = &quot;bold&quot;),
    plot.subtitle = element_text(size = 15, color = &quot;deeppink3&quot;)
    ))</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-3-1.png" width="960" /></p>
<pre class="r"><code># Week 16 visit
totalA &lt;- 
  dql_renamed %&gt;% 
  filter(TRT==&quot;Placebo&quot;)

(e &lt;- 
  ggplot(
    data = totalA,
    aes(
      x = DLQI_SCORE
      )
    )
  + geom_histogram(
    binwidth = 1,
    color = &quot;grey&quot;,
    fill = &quot;green4&quot;
    ) +
  facet_grid(~ VISIT)
  + theme_ng(grid = &quot;X&quot;)
  + labs(
    x = &quot;Total DLQI Score&quot;,
    y = &quot;Patients&quot;,
    subtitle = &quot;Placebo&quot;,
    caption = &quot;Lower score equals better quality of life&quot;
    ) +
  theme(
    strip.text.x = element_blank(),
    plot.subtitle = element_text(size = 15, color = &quot;green4&quot;),
    plot.caption = element_text(size = 12,
                                face = &quot;italic&quot;)
    ))</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-3-2.png" width="960" /></p>
<pre class="r"><code># Compine plots
# library(gridExtra)

gridExtra::grid.arrange(d, e, nrow = 2, heights = c(1.5,1))</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-3-3.png" width="960" /></p>
</div>
</div>
<div id="cgi-s" class="section level1" number="2">
<h1><span class="header-section-number">2</span> CGI-S</h1>
<div id="barplot-for" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Barplot for</h2>
<p>The clinical global impression – severity scale (CGI-S) is a 7-point
scale that requires the clinician to rate the severity of the patient’s
illness at the time of assessment, relative to the clinician’s past
experience with patients who have the same diagnosis. The challenge was
to provide data visualisations to show this data and also to provide
comparisons between the different groups (e.g. based on response
differences or odds ratios for the different response categories) using
Clinical Global Impression Data.</p>
<pre class="r"><code>plot.fun &lt;- function(dat, name, v.just = 1.5, gci.s = &quot;&lt;=3&quot;, y.max = 100,
                     title.text = &quot;The &lt;span style = &#39;color: #08519C&#39;&gt;Active&lt;/span&gt; and
         &lt;span style = &#39;color: #BDD7E7&#39;&gt;Comparator&lt;/span&gt; result in similar clinical global impression&quot;,
                     col.ann = c(rep(c(&quot;black&quot;, &quot;black&quot;, &quot;white&quot;), 2)),
                     title.h.just = 0.6) {
  require(ggplot2)
  require(ggtext)
  require(RColorBrewer)
  ggplot(dat, aes(y=Value, x=VISITNUM, fill=Treatment)) + 
    geom_bar(position=&quot;dodge&quot;, stat=&quot;identity&quot;) +
    ylab(&quot;&quot;) + xlab (&quot;&quot;) +
    ylim(-12, y.max) +
    theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
          panel.background = element_blank(), axis.line = element_blank(),
          axis.ticks = element_blank(),# axis.text = element_text(size = 12),
          axis.text.x = element_blank(),
          axis.text.y = element_blank(),
          plot.subtitle = element_text(size = 15, color = &quot;grey40&quot;, hjust = 0.14),
          plot.caption = element_text(color = &quot;grey60&quot;, size = 12, hjust = 0.85),
          plot.title = element_markdown(color = &quot;grey40&quot;, size = 20,
                                        face = &quot;bold&quot;, hjust = title.h.just),
          plot.margin = margin(0.3, 0.2, -0.38, -0.2, &quot;in&quot;)) +
    annotate(&quot;text&quot;, x=1, y=-4, label= &quot;Week 12&quot;, size = 4.25, color = &quot;grey40&quot;) +
    annotate(&quot;text&quot;, x=2, y=-4, label= &quot;Week 52&quot;, size = 4.25, color = &quot;grey40&quot;) +
    # annotate(&quot;text&quot;, x=3, y=-4, label= &quot;Week 24&quot;, size = 4.25, color = &quot;grey40&quot;) +
    # annotate(&quot;text&quot;, x=2.27, y=-12,
    #          label= &quot;Good glycemic control is defined as Glucose values within a range of 72 and 140 mg/dL.&quot;,
    #          size = 3.5, color = &quot;grey60&quot;) +
    scale_fill_manual(breaks = c(&quot;Active&quot;, &quot;Comparator&quot;, &quot;Placebo&quot;),
                      values = c(brewer.pal(n = 5, name = &quot;Blues&quot;)[c(5, 2)], &quot;grey90&quot;)) +
    geom_text(aes(label=val.t), vjust = v.just, size = 4, position = position_dodge(.9),
              col = col.ann) +
    labs(title = title.text,
         subtitle = paste0(&quot;Bars show the relative frequency of subjects with CGI-S&quot;, gci.s))#,
  # caption = &quot;Good glycemic control is defined as Glucose values within a range of 72 and 140 mg/dL.&quot;)
  # ggsave(name, width = 12, height = 6, units = &quot;in&quot;, dpi = 150)
}

dat &lt;- read.csv(&quot;./01_Datasets/CGI_S_3_groups_csv.csv&quot;)
dat$X1 &lt;- (dat$X1 + dat$X2 + dat$X3) / dat$Total.sample.size * 100
# dat$X1 &lt;- (dat$X1) / dat$Total.sample.size * 100
dat &lt;- dat[, 1:3]
names(dat) &lt;- c(&quot;VISITNUM&quot;, &quot;Treatment&quot;, &quot;Value&quot;)
dat$val.t &lt;- paste(format(round(dat$Value, 1), nsmall = 1), &quot;%&quot;)
dat$VISITNUM &lt;- as.factor(dat$VISITNUM)
plot.fun(dat, &quot;barplot_3.png&quot;)</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-4-1.png" width="960" /></p>
<pre class="r"><code>dat &lt;- read.csv(&quot;./01_Datasets/CGI_S_3_groups_csv.csv&quot;)
dat$X1 &lt;- (dat$X1 + dat$X2) / dat$Total.sample.size * 100
# dat$X1 &lt;- (dat$X1) / dat$Total.sample.size * 100
dat &lt;- dat[, 1:3]
names(dat) &lt;- c(&quot;VISITNUM&quot;, &quot;Treatment&quot;, &quot;Value&quot;)
dat$val.t &lt;- paste(format(round(dat$Value, 1), nsmall = 1), &quot;%&quot;)
dat$VISITNUM &lt;- as.factor(dat$VISITNUM)
plot.fun(dat, &quot;barplot_2.png&quot;, gci.s = &quot;&lt;=2&quot;, y.max = 70,
         title.text = &quot;The &lt;span style = &#39;color: #08519C&#39;&gt;Active&lt;/span&gt; results
         in better clinical global impression than the
         &lt;span style = &#39;color: #BDD7E7&#39;&gt;Comparator&lt;/span&gt;&quot;,
         title.h.just = 1.25)</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-4-2.png" width="960" /></p>
<pre class="r"><code>dat &lt;- read.csv(&quot;./01_Datasets/CGI_S_3_groups_csv.csv&quot;)
dat$X1 &lt;- (dat$X1) / dat$Total.sample.size * 100
# dat$X1 &lt;- (dat$X1) / dat$Total.sample.size * 100
dat &lt;- dat[, 1:3]
names(dat) &lt;- c(&quot;VISITNUM&quot;, &quot;Treatment&quot;, &quot;Value&quot;)
dat$val.t &lt;- paste(format(round(dat$Value, 1), nsmall = 1), &quot;%&quot;)
dat$VISITNUM &lt;- as.factor(dat$VISITNUM)
plot.fun(dat, &quot;barplot_1.png&quot;, v.just = -0.5, gci.s = &quot;=1&quot;, y.max = 50,
         title.text = &quot;The &lt;span style = &#39;color: #08519C&#39;&gt;Active&lt;/span&gt; results
         in better clinical global impression than the
         &lt;span style = &#39;color: #BDD7E7&#39;&gt;Comparator&lt;/span&gt;&quot;,
         col.ann = c(rep(c(&quot;black&quot;, &quot;black&quot;, &quot;black&quot;), 2)),
         title.h.just = 1.25)</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-4-3.png" width="960" /></p>
</div>
</div>
<div id="cgi-i" class="section level1" number="3">
<h1><span class="header-section-number">3</span> CGI-I</h1>
<p>The <strong>Clinical Global Impressions-Improvement (CGI-I)</strong>
scale is a widely used tool in clinical trials and practice to evaluate
the overall change in a patient’s clinical condition over time, as
perceived by the clinician. It is often used in conjunction with
patient-reported outcomes (PROs) to assess the relevance and clinical
significance of observed changes.</p>
<ol style="list-style-type: decimal">
<li><strong>Purpose</strong>:
<ul>
<li>The CGI-I measures the degree of improvement (or worsening) in a
patient’s condition compared to baseline, from the clinician’s
perspective.</li>
<li>It provides an overall, global impression, considering all available
information, including clinical observations and patient-reported
experiences.</li>
</ul></li>
<li><strong>Scale</strong>:
<ul>
<li>CGI-I is typically a 7-point scale, where:
<ul>
<li>1 = Very much improved</li>
<li>2 = Much improved</li>
<li>3 = Minimally improved</li>
<li>4 = No change</li>
<li>5 = Minimally worse</li>
<li>6 = Much worse</li>
<li>7 = Very much worse</li>
</ul></li>
</ul></li>
<li><strong>Relation to Clinically Meaningful Differences</strong>:
<ul>
<li><strong>Clinically meaningful differences</strong> help define
thresholds where changes in outcomes are considered significant or
relevant to patients and clinicians.</li>
<li>By comparing changes in PROs (like pain scores or quality of life
measures) to the CGI-I ratings, researchers can determine what magnitude
of change on the PRO corresponds to meaningful improvement in the
clinician’s eyes.</li>
<li>For instance, if a 4-point decrease in a symptom severity score
consistently aligns with a “Much improved” (rating of 2) on the CGI-I,
this threshold can guide interpretation of treatment effects.</li>
</ul></li>
<li><strong>Utility in Research</strong>:
<ul>
<li><strong>Anchor-Based Methodology</strong>: CGI-I often serves as an
anchor in defining clinically meaningful changes in PROs because it
reflects a holistic and intuitive judgment from the clinician.</li>
<li><strong>Validation</strong>: PRO instruments may be validated by
examining how well their scores correlate with CGI-I ratings.</li>
</ul></li>
</ol>
<div id="line-graphs" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Line graphs</h2>
<p><img src="02_Plots/Visualization/PRO/Line.png" /></p>
</div>
<div id="stacked-bar-chart" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Stacked Bar
Chart</h2>
<p><em>Annotation (circling Site 4 in red) and sorting (Site 4 in the
upper left hand corner) to make clear that Site 4 is a visual outlier.
The visual idiom is a stacked bar chart, one color for each
questionnaire. Stacked barcharts are limited when comparing any of the
components except the one on the bottom. For the purpose of this data
viz challenge, it was only necessary to compare the totals, ie the
heights of the stacked bars. This is easy to do for the stacked bars
from a visual perception point of view. But the colors for the different
components (Q1, Q2, Q3 and Q4) can be distracting.</em></p>
<pre class="r"><code>data &lt;- read.csv(&quot;./01_Datasets/PROdata.csv&quot;)

# Convert data to long format for easier plotting with ggplot2
data_long &lt;- data %&gt;%
  pivot_longer(cols = starts_with(&quot;Q&quot;), names_to = &quot;Question&quot;, values_to = &quot;Score&quot;)

# Calculate average scores by SITE, TRT, and Question
avg_scores &lt;- data_long %&gt;%
  group_by(SITE, TRT, Question) %&gt;%
  summarise(Average_Score = mean(Score, na.rm = TRUE)) %&gt;%
  ungroup()

# Plot
ggplot(avg_scores, aes(x = TRT, y = Average_Score, fill = Question)) +
  geom_bar(stat = &quot;identity&quot;, position = &quot;stack&quot;) +
  facet_wrap(~ SITE, ncol = 2) +
  labs(
    title = &quot;Average Scores by Site and Treatment Group&quot;,
    subtitle = &quot;Site 04 is the only site with lower average scores for active and higher for control across all PROs&quot;,
    x = &quot;Treatment Group&quot;,
    y = &quot;Average Score&quot;,
    fill = &quot;PRO&quot;
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5)
  )</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-5-1.png" width="960" /></p>
</div>
<div id="slope-plots" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Slope Plots</h2>
<p>Leverage visual analytics to identify data issues. Consider 4
questions on a Likert scale. 5 rating levels (Strongly disagree,
Disagree, Neutral, Agree, Strongly Agree) coded as 1, 2, 3, 4 and 5,
respectively. The higher the number the better. 400 Subjects (200
active, 200 control).</p>
<p><em>We can clearly see that Site 4 is a visual outlier. The Active
data for Site 4 looks like it belongs with the Control data from the
other sites and likewise the Contorl data for Site 4 looks like it
belo9ngs with the Active data from the other sites. Color and a useful
title are used to highlight the difference.</em></p>
<pre class="r"><code>PROdata.vert &lt;- read.csv(&quot;./01_Datasets/PROdata.csv&quot;)

PROdata.slopes &lt;- PROdata.vert %&gt;%
  mutate(total=Q1+Q2+Q3+Q4) %&gt;%
  group_by(SITE, TRT) %&gt;%
  summarise(total.score = sum(total, na.rm = TRUE)) %&gt;%
  ungroup()

# apply a plot to a data set where this works

# library(ggrepel)

p &lt;- ggplot(PROdata.slopes, aes(
  x = TRT,
  y = total.score,
  group = SITE 
)) +
  geom_line(
    size = 0.75,
    color = &quot;grey&quot; 
  ) +
  geom_point(
    size = 2.5,
    #color = unhcr_pal(n = 1, &quot;pal_blue&quot;)
    color = &quot;grey&quot; 
  ) +
  labs(
    title = &quot;Total Scores By Site&quot;,
    caption = &quot;Site 04 is Visual Outlier&quot;
  ) +
  geom_text_repel(
    data = PROdata.slopes |&gt; filter(TRT==&quot;Active&quot;),
    aes(label = paste(SITE, TRT,&quot;=&quot;, total.score)),
    size = 8 / .pt,
    hjust = 1,
    direction = &quot;y&quot;,
    nudge_x = -0.3,
  ) + 
  geom_text_repel(
    data = PROdata.slopes |&gt; filter(TRT==&quot;Control&quot;),
    aes(label = paste(SITE, TRT,&quot;=&quot;, total.score)),
    size = 8 / .pt,
    hjust = 1,
    direction = &quot;y&quot;,
    nudge_x = 0.5,
  ) +
 # Make Site 04 appear in blue
  geom_line(
    data=PROdata.slopes |&gt; filter(SITE==&quot;SITE04&quot;),
    size = 0.75,
    color = &quot;blue&quot; 
  ) +
  geom_point(
    data=PROdata.slopes |&gt; filter(SITE==&quot;SITE04&quot;),
    size = 2.5,
    #color = unhcr_pal(n = 1, &quot;pal_blue&quot;)
    color = &quot;blue&quot; 
  ) + 
  xlab(&quot;Treatment&quot;) + ylab(&quot;Total Scores (Q1 + Q2 + Q3 + Q4)&quot;)

p</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-6-1.png" width="960" /></p>
<pre class="r"><code># ggsave(plot=p, ofile(&quot;slopes.png&quot;))</code></pre>
</div>
<div id="cumulative-distribution-plot" class="section level2"
number="3.4">
<h2><span class="header-section-number">3.4</span> Cumulative
distribution plot</h2>
<p><img src="02_Plots/Visualization/PRO/Cumulative1.png" /></p>
<p><img src="02_Plots/Visualization/PRO/Cumulative2.png" /></p>
</div>
<div id="exploring-uncertainty" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Exploring
Uncertainty</h2>
<p>This graph is formed in two panels, with the left panel showing the
Cumulative Distribution Function (CDF) plots of percentage change from
baseline in score, grouped by the anchor measure. A measure of
variability has been added to the plot, derived using bootstrapping
methods. The right panel is showing 95% CIs and 95% Prediction Intervals
of scores for each category.</p>
<p>CDF plots used for comparing distributions are sometimes
superimposed, so this approach may have been useful. However the
confidence envelopes couldn’t then be shown simultaneously, so there’d
need to be a way of interactively selecting one category at a time. Use
of percentage change was discussed – absolute changes are often
preferable in a scenario where clinical meaningful changes are being
assessed.</p>
<p><img
src="02_Plots/Visualization/PRO/plot_par_nonpar%20-%20Paolo%20Eusebi.png" /></p>
<pre><code># {r,echo = T,message = FALSE, error = FALSE, warning = FALSE}
# Data and packages ----
# library(readr)
# library(ggplot2)
# library(dplyr)
# library(cowplot)
# library(ggpubr)

# urlfile &lt;- &quot;https://raw.githubusercontent.com/VIS-SIG/Wonderful-Wednesdays/master/data/2021/2021-10-13/WWW_example_minimal_clinical_improvement.csv&quot;

df &lt;- read_csv(&quot;./01_Datasets/WWW_example_minimal_clinical_improvement.csv&quot;) %&gt;%
  mutate(change=`total score follow up`-`total score baseline`,
         change_pct=(`total score follow up`-`total score baseline`)*100/`total score baseline`) %&gt;%
  rename(CGI_I=`CGI-I`)

# Bootstrapping ECDFs ----
set.seed(1234)
nboot &lt;- 100
boot &lt;- NULL
for (i in 1:nboot){
  d &lt;- df[sample(seq_len(nrow(df)), nrow(df), replace=T), ]
  d$sim &lt;- i
  boot &lt;- rbind(boot, d)
}

res1 &lt;- boot %&gt;%
  group_by(CGI_I, sim) %&gt;%
  summarise(change_pct_median=mean(change_pct)) %&gt;%
  ungroup() %&gt;%
  group_by(CGI_I) %&gt;%
  summarise(boot_median = median(change_pct_median),
            boot_lo95ci = quantile(change_pct_median, 0.025),
            boot_hi95ci = quantile(change_pct_median, 0.975)) 
res1

res2 &lt;- boot %&gt;%
  group_by(CGI_I) %&gt;%
  summarise(boot_lo95pi = quantile(change_pct, 0.025),
            boot_hi95pi = quantile(change_pct, 0.975)) 
res2

res3 &lt;- df %&gt;%
  group_by(CGI_I) %&gt;%
  summarise(n = n(),
            mean = mean(change_pct),
            sd = sd(change_pct),
            lo95pi = mean - 1.96*sd,
            hi95pi = mean + 1.96*sd,
            lo95ci = mean - 1.96*(sd/sqrt(n)),
            hi95ci = mean + 1.96*sd/sqrt(n)) 
res3

chg &lt;- res1 %&gt;%
  left_join(res2) %&gt;%
  left_join(res3)
chg

no_chg &lt;- res1 %&gt;%
  left_join(res3) %&gt;%
  filter(CGI_I==4) %&gt;%
  select(lo95ci, hi95ci, lo95pi, hi95pi) %&gt;%
  right_join(tibble(id=1:7), by = character())
no_chg

# Final plot ----
## CDFs
p1 &lt;- ggplot() +
  stat_ecdf(aes(x=change_pct, group=as.factor(sim)), data = boot, colour = alpha(&quot;deepskyblue4&quot;, 0.2)) +
  stat_ecdf(aes(x=change_pct), data = df, size = 1.25, color = &quot;orange2&quot;) +
  scale_x_continuous(limits = c(-80, 80)) +
  facet_grid(rows = vars(CGI_I))+
  labs(title = &quot;Cumulative Distribution Functions of Score % Changes&quot;,
       subtitle = &quot;Empirical CDF (Orange) with 1000 Bootstrap Samples (Blue)&quot;,
       y = &quot;Cumulative Distribution Function&quot;,
       x = &quot;Change %&quot;) +
  theme_minimal() +
  theme(strip.text = element_blank(),
        panel.grid.minor.y = element_blank(),
        panel.grid.major.y = element_blank(),
        plot.title = element_text(size = 18, face = &quot;bold&quot;),
        plot.subtitle = element_text(size = 12)) 
p1


labels_cgii &lt;- as_labeller(c(`1` = &quot;1\nVery Much\nImproved&quot;, 
                             `2` = &quot;2\nMuch\nImproved&quot;,
                             `3` = &quot;3\nMinimally\nImproved&quot;, 
                             `4` = &quot;4\nNo Change&quot;,
                             `5` = &quot;5\nMinimally\nWorse&quot;,
                             `6` = &quot;6\nMuch\nWorse&quot;, 
                             `7` = &quot;7\nVery Much\nWorse&quot;))

## Forest plot
p2 &lt;- ggplot(data=chg) +
  
  geom_rect(data=no_chg, aes(ymin=0, ymax=1,
                             xmin=lo95ci, xmax=hi95ci),
            fill=&quot;orange2&quot;, alpha=0.025) +
  
  geom_point(aes(x = boot_median, y=0.6),
             size = 4, color = &quot;deepskyblue4&quot;) +
  geom_errorbarh(aes(xmin = boot_lo95ci, xmax = boot_hi95ci, y = 0.6), 
                 height = 0.1, size=1.25, color = &quot;deepskyblue4&quot;) +
  geom_errorbarh(aes(xmin = boot_lo95pi, xmax = boot_hi95pi, y = 0.6), 
                 height = 0.0, size=0.75, color = &quot;deepskyblue4&quot;, linetype=&quot;dotted&quot;) +
  
  geom_point(aes(x = mean, y = 0.4), 
             size = 4, color = &quot;orange2&quot;) +
  geom_errorbarh(aes(xmin = lo95ci, xmax = hi95ci, y = 0.4), 
                 height = 0.1, size=1.25, color = &quot;orange2&quot;) +
  geom_errorbarh(aes(xmin = lo95pi, xmax = hi95pi, y = 0.4), 
                 height = 0.0, size=0.75, color = &quot;orange2&quot;, linetype=&quot;dotted&quot;) +

  facet_grid(rows = vars(CGI_I), labeller = labels_cgii)+
  ylim(0, 1) +
  theme_minimal() +
  labs(title = &quot;Estimates, 95% Confidence Intervals and 95% Prediction Intervals&quot;,
       subtitle = &quot;Parametric (Orange) and with 1000 Bootstrap Samples (Blue)&quot;,
       x = &quot;Change %&quot;, 
       y = &quot;&quot;) +
  theme(strip.text.y = element_text(size = 14, angle = 0),
        axis.text.y = element_blank(),
        panel.grid.major.y = element_blank(),
        panel.grid.minor.y = element_blank(),
        plot.title = element_text(size = 18, face = &quot;bold&quot;),
        plot.subtitle = element_text(size = 12)) +
  coord_cartesian(xlim = c(-50, 50), ylim=c(0,1), expand=F, clip = &quot;on&quot;)
p2


## Legend
dummy1 &lt;- chg[chg$CGI_I==4,]
dummy2 &lt;- chg[chg$CGI_I==5,]

tl&lt;-0.015 # tip.length
l1 &lt;- ggplot(data=dummy2) +
  labs(title = &quot;Legend&quot;) +
  geom_rect(data=dummy1, aes(ymin=0, ymax=1, xmin=lo95ci, xmax=hi95ci),
            fill=&quot;orange2&quot;, alpha = 0.15) +  
  geom_bracket(xmin=dummy1$lo95ci, xmax=dummy1$hi95ci,
               y.position = 0, 
               label = &quot;95% CI - No Change&quot;, tip.length = c(-tl, -tl)) + 
  geom_point(aes(x = boot_median, y=0.75), 
             size = 4, color = &quot;deepskyblue4&quot;) +
  geom_errorbarh(aes(xmin = boot_lo95ci, xmax = boot_hi95ci, y = 0.75),
                 height = 0.1, size=1.25, color = &quot;deepskyblue4&quot;) +
  geom_errorbarh(aes(xmin = boot_lo95pi, xmax = boot_hi95pi, y = 0.75), 
                 height = 0.0, size=0.75, color = &quot;deepskyblue4&quot;, linetype=&quot;dotted&quot;) +
  geom_bracket(xmin=dummy2$lo95ci, xmax=dummy2$hi95ci, y.position = 0.35,
               label = &quot;95% Confidence Interval&quot;, tip.length = c(tl, tl)) +
  geom_bracket(xmin=dummy2$mean, xmax=dummy2$mean, y.position = 0.3,
               label = &quot;Estimate&quot;, tip.length = c(tl, tl)) +
  geom_bracket(xmin=dummy2$lo95pi, xmax=dummy2$hi95pi, y.position = 0.15, vjust = 4,
               label = &quot;95% Prediction Interval&quot;, tip.length = c(-tl, -tl)) +
  geom_point(aes(x = mean, y = 0.25), 
             size = 4, color = &quot;orange2&quot;) +
  geom_errorbarh(aes(xmin = lo95ci, xmax = hi95ci, y = 0.25), 
                 height = 0.1, size=1.25, color = &quot;orange2&quot;) +
  geom_errorbarh(aes(xmin = lo95pi, xmax = hi95pi, y = 0.25), 
                 height = 0.0, size=0.75, color = &quot;orange2&quot;, linetype=&quot;dotted&quot;) +
  geom_bracket(xmin=dummy2$boot_lo95ci, xmax=dummy2$boot_hi95ci,
               y.position = 0.85,
               label = &quot;95% Confidence Interval (Bootstrap)&quot;, tip.length = c(tl, tl)) +
  geom_bracket(xmin=dummy2$boot_median, xmax=dummy2$boot_median,
               y.position = 0.8,
               label = &quot;Estimate (Bootstrap)&quot;, tip.length = c(tl, tl)) +
  geom_bracket(xmin=dummy2$boot_lo95pi, xmax=dummy2$boot_hi95pi, 
               y.position = 0.65, vjust = 4,
               label = &quot;95% Prediction Interval (Bootstrap)&quot;, tip.length = c(-tl, -tl)) + 
  coord_cartesian(xlim = c(-30, 50), ylim=c(0,1)) +
  theme_void() +
  theme(plot.title = element_text(size = 18, face = &quot;bold&quot;),
        plot.subtitle = element_text(size = 12))
l1

pnull &lt;- ggplot() +
  coord_cartesian(xlim = c(-30, 50), ylim=c(0,1)) +
  theme_void()
  
legend &lt;- plot_grid(l1, pnull, ncol=1,
                    rel_heights = c(0.5, 0.5))

## Title
title &lt;- ggdraw() + 
  draw_label(
    &quot;Exploring uncertainty of minimally clinically relevant changes&quot;,
    fontface = &#39;bold&#39;, size = 36,
    x = 0,
    hjust = 0
  ) +
  theme(
    plot.margin = margin(0, 0, 0, 7)
  )
title

plot_row &lt;- plot_grid(p1, p2, pnull , legend, nrow=1, rel_widths = c(3, 3, 0.25, 1.25))
g2 &lt;- plot_grid(title, plot_row, ncol = 1, rel_heights = c(0.1, 1))
g2
f&lt;-1.7
# ggsave(file=&quot;plot_par_nonpar.pdf&quot;, g2, width = 16*f, height = 9*f)</code></pre>
</div>
<div id="spaghetti-and-distribution-plot" class="section level2"
number="3.6">
<h2><span class="header-section-number">3.6</span> Spaghetti and
Distribution Plot</h2>
<p>The upper part of the graph is showing the distribution of the score
values within each CGI-I category, using density plots of scores on an
absolute scale. Distributions are shown separately for baseline and
follow-up visits within each category, rather than change from baseline.
Individual patient and mean changes are shown using slope plots.</p>
<p>The lower part of the graph shows the distribution of change from
baseline values, with a measure of variability being derived using
bootstrapping methods. Colour has been used to show paired mean
differences outside a +/- 10 unit range.</p>
<p>In general, the graph contains a lot of information and takes some
time to understand. However the graph tells a clear story in terms of
the distribution of score across different categories, and shows clearly
that the Minimally Improved category does not seem to be well
differentiated from No Change category.</p>
<p><img
src="02_Plots/Visualization/PRO/ww_mci%20-%20Agustin%20Calatroni.png" /></p>
</div>
<div id="distribution-plot-by-category-i" class="section level2"
number="3.7">
<h2><span class="header-section-number">3.7</span> Distribution Plot by
Category I</h2>
<p>This graph includes stacked density plots, sometimes known as a
ridgeline plot. This graph type is useful where there are approximately
4-8 categories with a natural ordering, which is the case in this
example. The graph is also showing patient level data as transparent
dots on the X axis, and reference lines have been added. There is a lot
of overplotting of the dots, so the opacity of dots is representing the
data density at each value on the X-axis.</p>
<pre class="r"><code>WW_data &lt;- read.csv(&quot;./01_Datasets/WWW_example_minimal_clinical_improvement.csv&quot;)

# library(tidyverse)
# library(ggplot2)
# library(dplyr)
# library(ggridges)
# library(gt)
# library(psych)

#####
#1 - calculate SEM 
#The Standard Error of Measurement (SEM) quantifies 
#the precision of the individual measurements 
#and gives an indication of the absolute reliability

#2 - calculate SDC
#The SEM can be used to calculate the Minimal Detectable Change (MDC)
#which is the minimal amount of change that a measurement 
#must show to be greater than the within subject variability
#and measurement error, also referred to as the sensitivity to change

pre_post &lt;- WW_data[,c(1:2)]
sd_baseline &lt;- sd(WW_data$total.score.baseline, na.rm = T)

icc &lt;- ICC(pre_post)#0.032 - reliability for SEM

sem_baseline &lt;- psychometric::SE.Meas(sd_baseline, 0.032)

#Smallest detectable change(SDC)/Minimal detectable change (MDC)
#SEM*1.92*sqrt(2)
sdc &lt;- sem_baseline*1.96*sqrt(2)
sdc_comp &lt;- sdc*-1

WW_data &lt;- rename(WW_data, baseline = total.score.baseline, followup = total.score.follow.up, CGI = CGI.I)
WW_data &lt;- within(WW_data, CHG &lt;- followup-baseline)
WW_data &lt;- within(WW_data, {
            CGI_cat &lt;- NA
            CGI_cat[CGI==1] &lt;- &quot;Very much improved&quot;
            CGI_cat[CGI==2] &lt;- &quot;Much improved&quot;
            CGI_cat[CGI==3] &lt;- &quot;Minimally improved&quot;
            CGI_cat[CGI==4] &lt;- &quot;No change&quot;
            CGI_cat[CGI==5] &lt;- &quot;Minimally worse&quot;
            CGI_cat[CGI==6] &lt;- &quot;Much worse&quot;
            CGI_cat[CGI==7] &lt;- &quot;Very much worse&quot;
            })

WW_data &lt;- WW_data &lt;- WW_data %&gt;% 
  filter(!is.na(CGI_cat))

WW_data$CGI_cat &lt;- factor(WW_data$CGI_cat, levels = c(&quot;Very much improved&quot;,
                                   &quot;Much improved&quot;,
                                   &quot;Minimally improved&quot;,
                                   &quot;No change&quot;,
                                   &quot;Minimally worse&quot;,
                                   &quot;Much worse&quot;,
                                   &quot;Very much worse&quot;
                                   ))

gg &lt;- ggplot(WW_data, aes(x = CHG, 
                    y = CGI_cat)) +
  stat_density_ridges(
    geom = &quot;density_ridges_gradient&quot;,
    quantile_lines = TRUE,
    quantiles = 2, scale = 1, rel_min_height = 0.01,
    jittered_points = TRUE) +
  scale_x_continuous(breaks=seq(-40,40,10),
                     limits = c(-40,40)) +
  ylab(&quot;CGI-I Response&quot;) + xlab(&quot;Change in PRO Score&quot;) +
  labs(title = &quot;Minimally Improved &amp; Minimally Worse CGI-I Categories\nAre Not Differentiated From No change&quot;,
       subtitle = &quot;Smoothed Distributions with Individual Patients (dots) and Means (|) \nReference Lines Display Smallest Detectable Change of PRO Score&quot;,
       caption = &quot;Smallest Detectable Change defined by Standard Error of Measurement of PRO Score at Baseline&quot;) +
  theme(
    plot.title = element_text(color = &quot;black&quot;, size = 15),
    plot.subtitle = element_text(color = &quot;black&quot;, size = 10),
    plot.caption = element_text(color = &quot;black&quot;, size = 8)
  )

#theme_ridges(font_size = 12)

#Build ggplot and extract data
d &lt;- ggplot_build(gg)$data[[1]]

# Add geom_ribbon for shaded area
rcc &lt;- gg +
  geom_ribbon(
    data = transform(subset(d, x &gt;= sdc), CGI_cat = group),
    aes(x, ymin = ymin, ymax = ymax, group = group),
    fill = &quot;red&quot;,
    alpha = 0.2, 
    show.legend = TRUE) +
  geom_ribbon(
    data = transform(subset(d, x &lt;= sdc_comp), CGI_cat = group),
    aes(x, ymin = ymin, ymax = ymax, group = group),
    fill = &quot;green&quot;,
    alpha = 0.2,
    show.legend = TRUE) +
  geom_vline(xintercept =sdc, linetype=&quot;dashed&quot;) +
  geom_vline(xintercept =sdc_comp, linetype=&quot;dashed&quot;)+
  annotate(&quot;segment&quot;, x = -15, xend = -35, y = 0.7, yend = 0.7, colour = &quot;black&quot;, size=0.5, arrow=arrow(length = unit(0.03, &quot;npc&quot;))) +
  annotate(&quot;segment&quot;, x = 15, xend = 35, y = 0.7, yend = 0.7, colour = &quot;black&quot;, size=0.5, arrow=arrow(length = unit(0.03, &quot;npc&quot;))) +
  geom_text(aes(x = -30, y = 0.45, label = &quot;Improvement&quot;), 
             hjust = 0, 
             vjust = 0,
             colour = &quot;black&quot;, 
             size = 2.5) +
  geom_text(aes(x = 20, y = 0.45, label = &quot;Deterioration&quot;), 
            hjust = 0, 
            vjust = 0,
            colour = &quot;black&quot;, 
            size = 2.5) + 
  ylab(&quot;CGI-I Response&quot;) + xlab(&quot;Change in PRO Score&quot;)
  
rcc</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-7-1.png" width="960" /></p>
<pre class="r"><code># ggsave(&quot;reliable_clinical_change_plot_red_green_v0_2.png&quot;, plot = rcc, device = png)</code></pre>
</div>
<div id="dot-plot" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Dot plot</h2>
<p>This graph used a different approach, showing only the patient-level
data within each category as a scatter plot, with added jittering. The
trend between categories is clear, and the number of patients can be
compared between groups visually. It was noted that some people find it
hard to compare distributions from scatter plots, so a hybrid of scatter
plot and a elements showing the distribution, e.g. boxplot or density
plot, may have been useful. However the author of the graph mentioned
that this graph was intended to be used at the first step of an
assessment, to answer the question “is CGI a good enough measure to
investigate the meaningful change threshold”</p>
<pre class="r"><code># library(tidyverse)
# library(ggridges)
# library(polycor)
# library(grid)

# Clear environment
# rm(list=ls())

# Colour scheme
Turquoise100 &lt;- &quot;#00a3e0&quot;
Turquoise75 &lt;- &quot;#40bae8&quot;
Turquoise50 &lt;- &quot;#7fd1ef&quot;
Turquoise25 &lt;- &quot;#bfe8f7&quot;
Blue100 &lt;- &quot;#005587&quot;
Blue50 &lt;- &quot;#7FAAC3&quot;
Green100 &lt;- &quot;#43b02a&quot;
Green100a &lt;- rgb(67, 176, 42, alpha = 0.5 * 255, maxColorValue = 255)
Green50 &lt;- &quot;#a1d794&quot;
Purple100 &lt;-&quot;#830065&quot;
Purple100a &lt;- rgb(131, 0, 101, alpha = 0.5 * 255, maxColorValue = 255)
Purple50 &lt;- &quot;#c17fb2&quot;
 
dat &lt;- read.csv(&quot;./01_Datasets/WWW_example_minimal_clinical_improvement.csv&quot;)

# glimpse(dat)

dat$USUBJID &lt;- c(1:nrow(dat)) #MAKE A NEW SUBJECT ID COLUMN

dat &lt;- dat %&gt;%
  rename(&quot;Time1&quot; = `total.score.baseline`, &quot;Time2&quot; = `total.score.follow.up`, &quot;CGI&quot; =`CGI.I`) %&gt;% #RENAME COLUMNS
  mutate(CHANGE = Time2 - Time1) # MAKE CHANGE SCORES. NEGATIVE SCORE IS IMPROVEMENT
dat$CGI &lt;- as.factor(dat$CGI)  
  
corr &lt;- round(polyserial(dat$CHANGE, dat$CGI),3)

#CREATE A PLOT SHOWING TH CORRELATION BETWEEN THE ANCHOR AND PRO MEASURE
p &lt;- ggplot(dat, aes(x=CGI, y=CHANGE)) +
  geom_jitter(width = 0.15, height = 0.5,alpha = 0.6) + 
  ggtitle(&quot;The CGI-I is Appropriate for Meaningful Change Derivation&quot;, subtitle = &quot;A correlation between an anchor and a COA change score of &gt;0.37 is recommended&quot;)+      
  labs(x=&quot;CGI-I Score at Time 2&quot;, y = &quot;COA Change Score from Baseline&quot;)+
  scale_y_continuous(breaks=-40:+40*10) +         # SET TICK EVERY 10
  scale_x_discrete(labels=c(&quot;1\nVery much improved&quot;, &quot;2&quot;, &quot;3&quot;,&quot;4\nNo change&quot;, &quot;5&quot;, &quot;6&quot;,&quot;7\nVery much worse&quot;)) +
  theme(panel.background = element_blank(), axis.line = element_blank(),
        axis.text=element_text(size=16),
        axis.title=element_text(size=16),
        legend.text=element_text(size=16),
        legend.title=element_text(size=16),
        plot.title = element_text(size=22, face=&quot;bold&quot;),
        plot.subtitle = element_text(size=16, face=&quot;bold&quot;)) +
  annotate(&quot;text&quot;, x=6, y=-35, label=paste(&quot;polyserial correlation = &quot;, corr), size=4, hjust=0)
p</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-8-1.png" width="960" /></p>
</div>
</div>
<div id="eortc-qlq-c30" class="section level1" number="4">
<h1><span class="header-section-number">4</span> EORTC QLQ-C30</h1>
<p>The EORTC QLQ-C30 is a 30-item questionnaire that has been designed
for use in a wide range of cancer patient populations and is a reliable
and valid measure of the quality of life in cancer patients. It includes
a number of different scales, but this challenge is focussed on the
global health and quality of life scale (QL).</p>
<div id="line-graphs-1" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Line graphs</h2>
<pre class="r"><code># library(dplyr)
# library(tidyr)
# library(ggplot2)
# library(forcats)
# library(scales)

d0 &lt;- read.csv2(&quot;./01_Datasets/ww eortc qlq-c30 missing.csv&quot;, sep=&quot;,&quot;) %&gt;%
  as_tibble() 
# d0
d1 &lt;- d0 %&gt;%
  pivot_longer(cols=starts_with(&quot;WEEK&quot;), names_to = &quot;AVISIT&quot;, values_to = &quot;AVAL&quot;) %&gt;%
  mutate(AVAL=as.numeric(AVAL)) %&gt;%
  select(USUBJID, ARM, LASTVIS, AGE:AVAL)
# d1  

d2 &lt;- d1 %&gt;%
  group_by(ARM, LASTVIS, AVISIT) %&gt;%
  dplyr::summarize(AVAL = mean(AVAL, na.rm=TRUE)) %&gt;%
  mutate(LASTVISC=as.factor(paste(&quot;Week&quot;, sprintf(&quot;%02.f&quot;, LASTVIS))),
         AVISITN = as.numeric(gsub(&quot;WEEK&quot;,&quot;&quot;,AVISIT))) %&gt;%
  mutate(LASTVISC=fct_reorder(LASTVISC, LASTVIS))


cc &lt;- scales::seq_gradient_pal(&quot;yellow&quot;, &quot;blue&quot;, &quot;Lab&quot;)(seq(0,1,length.out=14))
show_col(cc)</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-9-1.png" width="960" /></p>
<pre class="r"><code>breaks &lt;- sort(names(table(d2$LASTVISC)))
labels &lt;- breaks

ggplot(data=d2, aes(x=AVISITN, y=AVAL, group=LASTVISC, color=LASTVISC)) +
  geom_line() +
  geom_point() +
  scale_y_continuous(breaks = round(seq(0, 100, 8.333333333),2),
                     limits = c(0, 100)) +
  scale_x_continuous(breaks = seq(0, 48, 3), labels = paste(&quot;Wk&quot;, seq(0, 48, 3))) +

  scale_color_manual(values = cc, labels=labels, breaks=breaks) +
  facet_grid(cols=vars(ARM)) +
  labs(title = &quot;Dropout is associated with worsening in quality of life&quot;,
     y = &quot;EORTC QLQ-C30 QL [0-100]&quot;,
     x = &quot;Week on treatment&quot;) +
  theme(plot.background = element_rect(fill=&quot;black&quot;),
        panel.background = element_rect(fill=&quot;black&quot;),
        legend.background = element_rect(fill=&quot;black&quot;),
        legend.box.background = element_rect(fill=&quot;black&quot;),
        legend.key = element_blank(),
        legend.text = element_text(colour=&quot;grey&quot;),
        panel.grid = element_line(colour=&quot;grey5&quot;),
        panel.grid.minor = element_blank(),
        strip.background = element_blank(),
        plot.title=element_text(colour = &quot;grey&quot;, size = 14, face = &quot;bold&quot;),
        strip.text = element_text(colour = &quot;grey50&quot;, size = 10),
        axis.text = element_text(angle = 90))</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-9-2.png" width="960" /></p>
<pre class="r"><code># ggsave(filename = &quot;line_plot.png&quot;, device = &quot;png&quot;, width = 12, height = 6)</code></pre>
</div>
<div id="missing-patter" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Missing Patter</h2>
<p><img src="02_Plots/Visualization/PRO/Missing1.png" /></p>
<pre class="r"><code># library(dplyr)
# library(tidyr)
# library(ggplot2)
# library(forcats)
# library(scales)
# library(ggalluvial)
# library(RColorBrewer)

df &lt;- read.csv2(&quot;./01_Datasets/ww eortc qlq-c30 missing.csv&quot;, sep=&quot;,&quot;)  %&gt;%
  as_tibble() 
# df
df_1 &lt;- df %&gt;%
  pivot_longer(cols=starts_with(&quot;WEEK&quot;), names_to = &quot;AVISIT&quot;, values_to = &quot;AVAL&quot;) %&gt;%
  select(USUBJID, ARM, LASTVIS, AGE:AVAL) %&gt;%
  mutate(AVAL=as.factor(if_else(AVAL==&quot;&quot;, &quot;Missing&quot;, AVAL)))
# df_1  
levels(df_1$AVAL) &lt;- c(as.character(rev(round(seq(0, 100, 8.333333333), 1))), &quot;Missing&quot;)

cc &lt;- scales::div_gradient_pal(low = &quot;#a50026&quot;, mid=&quot;#ffffbf&quot;, high = &quot;#313695&quot;, &quot;Lab&quot;)(seq(0,1,length.out=13))

colors &lt;- c(cc, &quot;#D3D3D3&quot;)
show_col(colors)</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-10-1.png" width="960" /></p>
<pre class="r"><code>ggplot(df_1,
       aes(
         x = AVISIT,
         stratum = AVAL,
         alluvium = USUBJID,
         fill = AVAL,
         label = AVAL
       )) +
  scale_fill_manual(values = colors) +
  scale_x_discrete(labels = paste(&quot;Wk&quot;, seq(0, 48, 3))) +

  geom_flow(stat = &quot;alluvium&quot;, 
            lode.guidance = &quot;frontback&quot;,
            color = &quot;darkgray&quot;) +
  geom_stratum() +
  labs(title = &quot;Quality of Life - Missing data depends on age and treatment received&quot;) +
  facet_wrap(AGEGR~ARM, nrow = 4, scales = &quot;free_y&quot;, strip.position = c(&quot;left&quot;)) +
  # facet_grid(cols = vars(ARM), rows = vars(AGEGR), scales = &quot;free&quot;) +
  theme_bw() +
  guides(fill = guide_legend(nrow = 1, reverse = T)) +
  theme(
    #panel.background = element_blank(),
    #axis.text.y = element_blank(),
    legend.title = element_blank(),
    axis.title.x = element_blank(),
    legend.position = &quot;bottom&quot;,
    strip.text = element_text(size = 12),
    axis.text = element_text(angle = 90),
    legend.direction = &quot;horizontal&quot;
  ) </code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-10-2.png" width="960" /></p>
<pre class="r"><code># ggsave(filename = &quot;sankey_chart.png&quot;, device = &quot;png&quot;, width = 16, height = 9)</code></pre>
</div>
<div id="individual-patient-trajectories" class="section level2"
number="4.3">
<h2><span class="header-section-number">4.3</span> Individual Patient
Trajectories</h2>
<p>EORTC QLQ-C30 is quality of life (QoL) questionnaire designed for use
in cancer patients Each item is rated on a 4-point response scale
ranging from 1 (“Not at all”) to 4 (“Very much”) or a 7-point scale
ranging from 1 (“Very poor”) to 7 (“Excellent”).</p>
<p>Higher scores represent better outcomes for the global health scale
(QL) and the functional scales (PF, RF, EF, CF, SF), whereas higher
scores represent higher severe symptoms for the symptom scales/items
(FA, NV, PA, DY, SL, AP, CO, DI, FI). The overall QLQ-C30 score is
calculated using scoring rules to a range of 0-100.</p>
<p>This figure of change from baseline in QLQ-C30 over time is showing
patient-level data as individual lines. Although this is technically a
spaghetti plot, a lot of over-plotting occurs due to the discrete nature
of the score values. Where this occurs, the opacity of the lines depends
on the number of lines that are superimposed, so the figure gives an
good general impression of the overall trend. In the left panel (control
group), there seem to be more darker lines in the lower half of the
plot, showing a worsening of QoL, while the opposite is true in the
right panel (experimental group). The figure also includes a
superimposed line plot of mean over time (+/- standard error), which
shows a similar trend of improvement in global health status in the
experimental group and a worsening in the control group.</p>
<p>The use of faint grey gridlines is quite effective. The possibility
of using a greyscale for the patient-level data was discussed, because
the colour isn’t coding any information and this would make the line
plot of mean over time stand out, but it was agreed this would make the
patient-level data difficult to distinguish against the gridlines. Some
design improvements were suggested, making some of the labels a little
larger, and there is also some scope for decluttering the graph,
e.g. removing the Y-axis label from the right panel.</p>
<pre class="r"><code># library(tidyverse)
# library(lubridate)
# library(dplyr)
# library(ggplot2)
# library(readxl)
# library(cowplot)
# library(gridExtra)
# library(patchwork)
# library(reshape2)
# library(grid)

# ww eortc qlq-c30.csv
# X &lt;- read.csv(url(&quot;https://raw.githubusercontent.com/VIS-SIG/Wonderful-Wednesdays/master/data/2022/2022-09-14/ww%20eortc%20qlq-c30.csv&quot;))
X &lt;- read.csv(&quot;./01_Datasets/ww eortc qlq-c30.csv&quot;)

X[X==0] &lt;- NA;
X1 &lt;- X[1:(nrow(X)/2), ]; # standard
Xe &lt;- X[(nrow(X)/2+1):nrow(X),]; # experimental

X1 &lt;-  X1 %&gt;%
  group_by(USUBJID) %&gt;%
  mutate(QL_diff = QL - QL[1], PF_diff = PF - PF[1], RF_diff = RF - RF[1], EF_diff = EF - EF[1])
X1_a &lt;- X1 #save for second plot

Xe &lt;-  Xe %&gt;%
  group_by(USUBJID) %&gt;%
  mutate(QL_diff = QL - QL[1], PF_diff = PF - PF[1], RF_diff = RF - RF[1], EF_diff = EF - EF[1])
Xe_a &lt;- Xe #save for second plot

#need to replace NA&#39;s with 0&#39;s again when finding the mean
X1$QL_diff[is.na(X1$QL_diff)] &lt;- 0 #We will only use QL in the plot below, but can use any sub-scale.
X1$PF_diff[is.na(X1$PF_diff)] &lt;- 0
X1$RF_diff[is.na(X1$RF_diff)] &lt;- 0
X1$EF_diff[is.na(X1$EF_diff)] &lt;- 0
Xe$QL_diff[is.na(Xe$QL_diff)] &lt;- 0
Xe$PF_diff[is.na(Xe$PF_diff)] &lt;- 0
Xe$RF_diff[is.na(Xe$RF_diff)] &lt;- 0
Xe$EF_diff[is.na(Xe$EF_diff)] &lt;- 0

A &lt;- aggregate(X1[, 20:23], list(X1$AVISITN), mean)
colnames(A) &lt;- c(&quot;AVISITN&quot;, &quot;QL_mean&quot;, &quot;PF_mean&quot;, &quot;RF_mean&quot;, &quot;EF_mean&quot;)
B &lt;- aggregate(X1[, 20:23], list(X1$AVISITN), sd)
B &lt;- B[, 2:ncol(B)]/sqrt(100)
colnames(B) &lt;- c(&quot;QL_se&quot;, &quot;PF_se&quot;, &quot;RF_se&quot;, &quot;EF_se&quot;)
A &lt;- data.frame(A, B)

Ae &lt;- aggregate(Xe[, 20:23], list(Xe$AVISITN), mean)
colnames(Ae) &lt;- c(&quot;AVISITN&quot;, &quot;QL_mean&quot;, &quot;PF_mean&quot;, &quot;RF_mean&quot;, &quot;EF_mean&quot;)
Be &lt;- aggregate(Xe[, 20:23], list(Xe$AVISITN), sd)
Be &lt;- Be[, 2:ncol(Be)]/sqrt(100)
colnames(Be) &lt;- c(&quot;QL_se&quot;, &quot;PF_se&quot;, &quot;RF_se&quot;, &quot;EF_se&quot;)
Ae &lt;- data.frame(Ae, Be)

# library(plyr) #call this library here, not before.

A = A[c(1,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,9),] 
A[nrow(A)+nrow(X1)-nrow(A),] &lt;- NA;
A1 &lt;- cbind(X1_a, A);

Ae = Ae[c(1,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,9),] 
Ae[nrow(Ae)+nrow(Xe)-nrow(Ae),] &lt;- NA;
A1e &lt;- cbind(Xe_a, Ae);

X1count &lt;- X1[complete.cases(X1$QL),] #To count dropout rate/N (number) per visit
Xecount &lt;- Xe[complete.cases(Xe$QL),]
X1count &lt;- count(X1count, &quot;AVISITN&quot;)
Xecount &lt;- count(Xecount, &quot;AVISITN&quot;)

#Standard treatment plot
GG1&lt;-ggplot(data=A1, aes(x=AVISITN...19, y=QL_diff, group=USUBJID, color=&quot;red&quot;)) +
  geom_line(size=1, alpha=0.15, color=&quot;tomato&quot;)+guides(color = &quot;none&quot;)+
  xlab(&quot;Visit Number&quot;)+ylab(&quot;Change from Baseline&quot;)+
  scale_x_continuous(breaks=0:17)+
  scale_y_continuous(breaks=seq(-55, 55, by=10))+
  geom_hline(yintercept=c(-6,0,6), linetype=&#39;dotted&#39;, col = &#39;black&#39;)+
  geom_line(aes(x=AVISITN...24, y = QL_mean, colour = &quot;Standard&quot;),size=1) + 
  geom_point(aes(x=AVISITN...24, y = QL_mean, colour = &quot;Standard&quot;),size=2)+
  geom_errorbar(aes(ymin=QL_mean-QL_se, ymax=QL_mean+QL_se, colour = &quot;Standard&quot;),width=25, position=position_dodge(0))+
  scale_colour_manual(values=&quot;violet&quot;)+
  annotate(geom = &quot;text&quot;, x = 1:17, y = -68, label = X1count$freq, size = 3)+
  coord_cartesian(ylim = c(-55, 55), expand = FALSE, clip = &quot;off&quot;)+theme_bw()

GG1 &lt;- GG1+theme(axis.text=element_text(size=8), axis.title=element_text(size=10),panel.grid.minor.x = element_blank(),panel.grid.minor.y = element_blank())

#Experimental treatment plot
GG2&lt;-ggplot(data=A1e, aes(x=AVISITN...19, y=QL_diff, group=USUBJID, color=&quot;red&quot;)) +
  geom_line(size=1, alpha=0.15, color=&quot;dodgerblue&quot;)+guides(color = &quot;none&quot;)+
  xlab(&quot;Visit Number&quot;)+ylab(&quot;&quot;)+
  scale_x_continuous(breaks=0:17)+
  scale_y_continuous(breaks=seq(-55, 55, by=10))+
  geom_hline(yintercept=c(-6,0,6), linetype=&#39;dotted&#39;, col = &#39;black&#39;)+
  geom_line(aes(x=AVISITN...24, y = QL_mean, colour = &quot;Experimental&quot;),size=1) + 
  geom_point(aes(x=AVISITN...24, y = QL_mean, colour = &quot;Experimental&quot;),size=2)+
  geom_errorbar(aes(ymin=QL_mean-QL_se, ymax=QL_mean+QL_se, colour = &quot;Experimental&quot;),width=25, position=position_dodge(0))+
  scale_colour_manual(values=&quot;aquamarine4&quot;)+
  annotate(geom = &quot;text&quot;, x = 1:17, y = -68, label = Xecount$freq, size = 3)+
  coord_cartesian(ylim = c(-55, 55), expand = FALSE, clip = &quot;off&quot;)+theme_bw()

GG2 &lt;- GG2+theme(axis.text=element_text(size=8), axis.title=element_text(size=10),panel.grid.minor.x = element_blank(),panel.grid.minor.y = element_blank())

#Combining two plots
p1 &lt;- plot_grid(GG1, GG2, labels=c(&quot;Standard&quot;, &quot;Experimental&quot;),hjust = -1.0, vjust = 0.5,label_size = 8)
title &lt;- ggdraw() + draw_label(&quot;This looks nothing like real QLQ-C30 Global Heath Status data, real individual patient data has much more variability&quot;, size=15)
subtitle &lt;- ggdraw() + draw_label(&quot;Higher Values &amp; Positive Change from Baseline values for QLQ-C30 Global Heath Status indicate better Quality of Life&quot;, size=10)
footnote &lt;- ggdraw() + draw_label(&quot;Individual patient data with arithmetic mean (+/- SE) overlaid. \n Horizontal Reference lines indicate the Minimal Important Change (MIC), at the group level, of -6 and 6 based on the 2012 Cocks publication.\n Line opacity is proportional to the number of patients, with more transparent lines indicating less patients. Total number of patients remaining per visit is given below the x-axis.&quot;, fontface=&#39;italic&#39;, size=10)

#plot results
plot_grid(title, subtitle, p1, footnote, ncol=1, rel_heights=c(0.1, 0.1, 1, 0.4, -0.1))</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-11-1.png" width="960" /></p>
</div>
<div id="top-four-domains-trajectories-dashboard" class="section level2"
number="4.4">
<h2><span class="header-section-number">4.4</span> Top four domains
Trajectories Dashboard</h2>
<p><a
href="https://agstn.github.io/qlq-c30/qlq-c30_flexdashboard.html">App</a></p>
<p>First tab: This tab focuses on only the top four domains, in terms of
treatment effect. The left panel is showing patient-level data,
similarly to the first entry, although data have been jittered to avoid
over-plotting. The middle panel shows point estimates, credible
intervals and posterior distributions for each treatment and timepoint
from from a Bayesian MMRM model. Posterior distributions for the
treatment differences are shown in the right panel, with cutpoints added
to the density plots to indicate clinically-meaningful threshold
values.The graph includes a lot of information but is highly effective
in showing trends in the data.</p>
<p>Second tab: this shows the treatment differences for all domains,
including point estimates, credible intervals and Bayesian posterior
distributions. The domains are sorted in terms of treatment effect, so
it is very clear which domains are driving the overall treatment effect.
Shading has been used to represent different parts of the posterior
distribution curve with respect to the threshold values.</p>
<p>Further tabs give the user a more focused view of what we saw in the
first tab, i.e. patient-level data, results of the MMRM and treatment
differences, for a single domain, e.g. quality of life, functional
scales, symptoms and financial difficulties.</p>
<p>The consistent colour-coding across all panels is helpful, and the
colours are similar with respect to their intensity. For the second tab,
representing time on the vertical axis is unsual and possibly counter
intuitive, but an alternative design may have difficult to implement.
Also in the second tab, annotations hadn’t been added to show which
direction represents a benefit for each of the scales (which was present
on the first tab and was very helpful). But overall this package of
graphs provides a rich source of information and clearly shows the
important features of the data.</p>
<p><img src="02_Plots/Visualization/PRO/Dashboard.PNG" /></p>
</div>
</div>
<div id="sdq-12" class="section level1" number="5">
<h1><span class="header-section-number">5</span> SDQ-12</h1>
<p>The dataset includes item level data for a 12 item (question)
Simulated Disease Questionnaire (SDQ-12) at four different timepoints
and for 2000 patients. Each item is scored on a 0-3 scale (0
representing worst possible health state/most severe symptoms, 3
representing best possible health state and no symptoms), and a sum
score is also calculated by adding all item responses. Each of the 12
items has been simulated to represent a distinct symptom</p>
<div id="item-response-distribution-plot" class="section level2"
number="5.1">
<h2><span class="header-section-number">5.1</span> Item Response
Distribution Plot</h2>
<p>This visualization displays the distribution of the individual items
over each of the four days available in the data. Each horizontal bar is
coloured in varying shades of blue with darker shades indicating higher
levels of severity in the corresponding item for that day.</p>
<p>The visualization allows the viewer to quickly identify the greater
severities observed on Day 4, and to compare the individual items on
each day. This provides a nice overview of the data which is quick and
easy to understand. The use of darker shades to represent darker colours
is intuitive.</p>
<pre class="r"><code>library(tidyverse)
library(mirt)
library(ggpubr)

library(forcats)
library(psych)
library(polycor)
library(GPArotation)
library(xtable)
library(lavaan)
library(lavaanPlot)

library(WrightMap)
library(data.table)
library(ggcorrplot)
library(lme4)
library(Matrix) 
library(stringr)
library(hrbrthemes)
library(viridis)
library(gmodels)
library(pander)
library(rtf)
library(difR)

#Clear environment
rm(list=ls())

#Colour scheme
Turquoise100 &lt;- &quot;#00a3e0&quot;
Turquoise75 &lt;- &quot;#40bae8&quot;
Turquoise50 &lt;- &quot;#7fd1ef&quot;
Turquoise25 &lt;- &quot;#bfe8f7&quot;
Blue100 &lt;- &quot;#005587&quot;
Blue50 &lt;- &quot;#7FAAC3&quot;
Green100 &lt;- &quot;#43b02a&quot;
Green50 &lt;- &quot;#a1d794&quot;
Purple100 &lt;-&quot;#830065&quot;
Purple50 &lt;- &quot;#c17fb2&quot;

Names &lt;- c(
  &#39;Dry Cough&#39;,
  &#39;Loss of Smell&#39;,
  &#39;Skin Rash&#39;,
  &#39;Fever&#39;,
  &#39;Headache&#39;,
  &#39;Short of Breath&#39;,
  &#39;Diarrhoea&#39;,
  &#39;Sore Throat&#39;,
  &#39;Fatigue&#39;,
  &#39;Runny Nose&#39;,
  &#39;Ocular Issues&#39;,
  &#39;Loss of Taste&#39;)

 
 
dat &lt;-read.csv(&quot;./01_Datasets/sdq_raw.csv&quot;)

### Make dataset for each timepoint ====
dat_t1 &lt;- dat %&gt;%
  select(c(ends_with(&quot;T1&quot;))) %&gt;%
  select(-c(starts_with(&quot;PGIC&quot;)))

colnames(dat_t1) &lt;- Names

dat_t2 &lt;- dat %&gt;%
  select(c(ends_with(&quot;T2&quot;))) %&gt;%
  select(-c(starts_with(&quot;PGIC&quot;)))

colnames(dat_t2) &lt;- Names

dat_t3 &lt;- dat %&gt;%
  select(c(ends_with(&quot;T3&quot;))) %&gt;%
  select(-c(starts_with(&quot;PGIC&quot;)))

colnames(dat_t3) &lt;- Names

dat_t4 &lt;- dat %&gt;%
  select(c(ends_with(&quot;T4&quot;))) %&gt;%
  select(-c(starts_with(&quot;PGIC&quot;)))

colnames(dat_t4) &lt;- Names

# Start data manip =========

myplot &lt;- function(df, timepoint,graphname){

Resp_Dist &lt;&lt;- df %&gt;% #set the dataset
  apply(2, table) %&gt;% # tabulate response distributions
  as.data.frame() %&gt;% #apply on the above line makes a matrix. This converts to a dataframe.
  mutate(Response = as.factor(c(0:3))) #Here we make sure that we have a column labelling the response options
#select(Response, starts_with(&quot;item&quot;)) #And move response to the front of the dataset

colnames(Resp_Dist) &lt;&lt;- c(Names,&quot;Response&quot;)

#Make a staked barchart for one of the timepoints
#First transpose the dataset to long format
Resp_Dist &lt;&lt;- Resp_Dist %&gt;%
  pivot_longer(cols = c(1:12), names_to = &quot;Item&quot;, values_to = &quot;Frequency&quot;) %&gt;% #this is the line which makes a long dataset. here we are selecting all columns (ie columns relating to time 3) and keeping the item names in a new variable called &quot;item&quot; and the number that select each response option in a new variable called  &quot;Frequency&quot;
  mutate(Item = as.factor(Item)) %&gt;% #make item a factor rather than just a character variable. important for plotting
  mutate(Response = as.factor(if_else(Response == 0, &quot;Severe&quot;, 
                                      (if_else(Response == 1, &quot;Moderate&quot;, 
                                               (if_else(Response == 2, &quot;Mild&quot;,
                                                        &quot;None&quot;)))))))


Resp_Dist$Response &lt;- factor(Resp_Dist$Response, levels = c(&quot;Severe&quot;, &quot;Moderate&quot;, &quot;Mild&quot;, &quot;None&quot;))


Plot_Resp_Dist &lt;&lt;- ggplot(data=Resp_Dist, mapping = aes(fill = Response, x=reorder(Item, desc(Item)), y=Frequency)) + #start with a ggplot statement
  geom_bar(aes(fill=factor(Response)),position=&quot;fill&quot;, stat=&quot;identity&quot;)+ #tell it you want a bar chart. position &quot;fill&quot; makes it a stacked bar chart
  scale_fill_manual(name = &quot;Response Option&quot;,values=c(Turquoise100, Turquoise75, Turquoise50, Turquoise25), guide = guide_legend(reverse = TRUE)) + #set the colours. Reverse makes sure that the bars are 0-3 rather than 3-0
  theme_classic() + #just removes gridlines etc 
  ggtitle(paste(timepoint))+ 
  labs(y= &quot;Frequency of response option use&quot;, x = NULL) +
  scale_y_continuous(labels = scales::percent) + #makes the axis percent
  coord_flip() + #flips to a horizontal chart 
  theme(panel.background = element_blank(), axis.line = element_blank(),
        axis.text=element_text(size=10),
        axis.title=element_text(size=10),
        legend.text=element_text(size=10),
        legend.title=element_text(size=10),
        plot.title = element_text(size=16, face=&quot;bold&quot;),
        plot.subtitle = element_text(size=14, face=&quot;bold&quot;),
        legend.position=&quot;right&quot;)

#view plot
Plot_Resp_Dist

assign(graphname, Plot_Resp_Dist, envir = .GlobalEnv)

}
DAY1 &lt;- vector(mode = &quot;list&quot;, length = 9)
myplot(dat_t1, &quot;Day 1&quot;, &quot;DAY1&quot;)

DAY2 &lt;- vector(mode = &quot;list&quot;, length = 9)
myplot(dat_t2, &quot;Day 2&quot;, &quot;DAY2&quot;)

DAY3 &lt;- vector(mode = &quot;list&quot;, length = 9)
myplot(dat_t3, &quot;Day 3&quot;, &quot;DAY3&quot;)

DAY4 &lt;- vector(mode = &quot;list&quot;, length = 9)
myplot(dat_t4, &quot;Day 4&quot;, &quot;DAY4&quot;)

DAY1</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-12-1.png" width="960" /></p>
<pre class="r"><code>DAY2</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-12-2.png" width="960" /></p>
<pre class="r"><code>DAY3</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-12-3.png" width="960" /></p>
<pre class="r"><code>DAY4</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-12-4.png" width="960" /></p>
<pre class="r"><code>Response_Distributions &lt;- ggarrange(DAY1, DAY2, DAY3, DAY4, common.legend = TRUE, legend = &quot;bottom&quot;)

Response_Distributions &lt;- annotate_figure(Response_Distributions, 
                top = text_grob(&quot;Symptom severity increased each day&quot;, color = &quot;black&quot;, face = &quot;bold&quot;, size = 20),
                bottom = NULL,
                left = &quot;SDQ-12 item name&quot;,
                right = NULL)

Response_Distributions</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-12-5.png" width="960" /></p>
<pre class="r"><code># png(filename = &quot;Response Distributions.png&quot;,  width = 920, height = 540, units = &quot;px&quot;, pointsize = 10,bg = &quot;white&quot;)
# Response_Distributions
# dev.off()</code></pre>
</div>
<div id="waterfall-plot" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Waterfall plot</h2>
<p>This waterfall plot displays the individual change score of each
patient. The bars are coloured by the patients’ self-reported
conditions, allowing us to easily see the tools’ ability to detect
change.</p>
<pre class="r"><code>#Clear environment
rm(list=ls())

#Colour scheme
Turquoise100 &lt;- &quot;#00a3e0&quot;
Turquoise75 &lt;- &quot;#40bae8&quot;
Turquoise50 &lt;- &quot;#7fd1ef&quot;
Turquoise25 &lt;- &quot;#bfe8f7&quot;
Blue100 &lt;- &quot;#005587&quot;
Blue50 &lt;- &quot;#7FAAC3&quot;
Green100 &lt;- &quot;#43b02a&quot;
Green50 &lt;- &quot;#a1d794&quot;
Purple100 &lt;-&quot;#830065&quot;
Purple50 &lt;- &quot;#c17fb2&quot;

Names &lt;- c(
  &#39;Dry Cough&#39;,
  &#39;Loss of Smell&#39;,
  &#39;Skin Rash&#39;,
  &#39;Fever&#39;,
  &#39;Headache&#39;,
  &#39;Short of Breath&#39;,
  &#39;Diarrhoea&#39;,
  &#39;Sore Throat&#39;,
  &#39;Fatigue&#39;,
  &#39;Runny Nose&#39;,
  &#39;Ocular Issues&#39;,
  &#39;Loss of Taste&#39;,
  &#39;SDQ TOTAL&#39;,
  &#39;FLU PRO&#39;,
  &#39;Fatigue PRO&#39;)


dat &lt;-read.csv(&quot;./01_Datasets/sdq_raw.csv&quot;)

dat_t4 &lt;- dat %&gt;%
  head(2000) %&gt;%
  select(c(starts_with(&quot;T4&quot;), &quot;PGIC_T4&quot; )) %&gt;%
  mutate(Group = if_else(PGIC_T4&lt;=3, &quot;Improved&quot;,
                         if_else(PGIC_T4 == 4, &quot;No change&quot;, 
                                 if_else(PGIC_T4 == 5, &quot;Worsened a little&quot;, &quot;Worsened a lot&quot;)))) %&gt;%
  arrange(desc(T4_SDQ_PRO_SUM_CHG)) %&gt;%
  mutate(x = seq(1:2000))

dat_t4$Group &lt;- as.factor(dat_t4$Group)
dat_t4$x &lt;- as.factor(dat_t4$x)


Plot &lt;- dat_t4 %&gt;%
  ggplot() + 
  geom_col(aes(x=x, y=T4_SDQ_PRO_SUM_CHG, fill=Group), width = 1,  na.rm = TRUE) +
  ggtitle(&quot;Patients self-reported improvement and worsening \nmatched their SDQ-12 change scores&quot;, subtitle = &quot;Supporting the ability of the SDQ-12 to detect change&quot;) +
  xlab(&quot;Patients, in order of SDQ-12 change score&quot;) + 
  ylab(&quot;SDQ-12 change score&quot;) +
  scale_fill_manual(breaks = c(&quot;Improved&quot;, &quot;No change&quot;, &quot;Worsened a little&quot;, &quot;Worsened a lot&quot;), 
                    values=c(Green50, Turquoise100, Blue100, Purple100), name = &quot;Self-Reported Condition&quot;) +
  scale_y_continuous(limits = c(-35,30), breaks=c(-35, -15, 0, 15)) +
  theme_classic() + #formatting
  theme(panel.background = element_blank(), axis.line = element_blank(),
        axis.text=element_text(size=14),
        axis.title=element_text(size=16),
        legend.text=element_text(size=14),
        legend.title=element_text(size=16),
        plot.title = element_text(size=22, face=&quot;bold&quot;),
        plot.subtitle = element_text(size=14, face=&quot;bold&quot;)) +
  theme(axis.text.x=element_blank(), # remove the participant numbers 
        axis.ticks.x=element_blank())  # remove x-axis ticks 
Plot</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-13-1.png" width="960" /></p>
<pre class="r"><code># png(filename = &quot;Ability_to_detect_change.png&quot;,  width = 920, height = 540, units = &quot;px&quot;, pointsize = 10,bg = &quot;white&quot;)
# Plot
# dev.off()</code></pre>
</div>
<div id="wright-map" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Wright Map</h2>
<p>This final visualization has two features: a histogram displaying the
underlying characteristics of the patient population and a supplementary
graph displaying the expected response thresholds for the different
severity levels in relation to the underlying latent scores.</p>
<p>Again, the plot takes a moment to interpret, but once understood
provides a message that is easy to understand. It may help the viewer
understood more quickly if the vertical gridlines were continued up to
the histogram (or alternatively if the x-axis was positioned between the
two plots) to make clear that the two aspects of the visual are
connected.</p>
<pre class="r"><code>dat &lt;--read.csv(&quot;./01_Datasets/sdq_raw.csv&quot;)

### Make dataset for each timepoint ====
dat_t1 &lt;- dat %&gt;%
  select(c(ends_with(&quot;T1&quot;))) %&gt;%
  select(-c(starts_with(&quot;PGIC&quot;)))

###### 4 - Cat Long Form ####### 
#run the model. remember that for rasch models, these are 1 parameter models and will have the same slope across all items
GRM_model &lt;- mirt(data=dat_t1, model = 1, itemtype = &#39;graded&#39;, SE=TRUE, verbose=FALSE)


#extract the coefficients
GRM_model_coef &lt;- coef(GRM_model, IRTpars=TRUE, simplify=TRUE)

#save them as a dataframe
GRM_model_items &lt;- round(as.data.frame(GRM_model_coef$items), 2)
Items &lt;- rownames(GRM_model_items)

GRM_model_items &lt;- cbind(Items, GRM_model_items)
 
#create rasch based scores if this is necessary - are used in the person item map below. 
Scores &lt;- (fscores(GRM_model, model = &#39;EAP&#39;))



#Take threshold (b) parameters
thresholds &lt;- GRM_model_items[3:5] 

#plot and save
###USING GGPLOT
#Data
thresholds_long &lt;- thresholds %&gt;%
  rownames_to_column() %&gt;%
  rename(Item = rowname) %&gt;%
  arrange(b1) %&gt;%
  mutate(Item = fct_reorder(Item, b1)) %&gt;%
  pivot_longer(cols=-Item, names_to = &quot;threshold&quot;, values_to = &quot;AVAL&quot;)
#Itemside
WrightMap_item &lt;- ggplot(data = thresholds_long, aes(x=factor(Item), y=AVAL)) +
  geom_line(aes(group=factor(Item))) +
  geom_point(aes(colour=threshold), size=5) +
  scale_colour_manual(name=&quot;Response Threshold&quot;, labels = c(&quot;Severe/Moderate&quot;, &quot;Moderate/Mild&quot;, &quot;Mild/None&quot;), values = c(Turquoise100, Blue100, Green100)) +
  labs( x = &quot;Item&quot;, y = &quot;Latent Score&quot;)  +
  theme_bw() + 
  theme(text = element_text(size=16),
        axis.text.x=element_text(colour=&quot;black&quot;),
        axis.text.y=element_text(colour=&quot;black&quot;))+
  theme(axis.text = element_text(size = 10)) + 
  theme(
    legend.title = element_text(size = 12),
    legend.text = element_text(size = 10)
  )+
  scale_y_continuous(breaks = seq(from = -2.5, to = 2.5, by = 1),limits=c(-2.5,2.5)) +
  coord_flip() +
  theme(legend.position=&quot;bottom&quot;) 
WrightMap_item</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-14-1.png" width="960" /></p>
<pre class="r"><code>#PersonSide
Scores &lt;- as.data.frame(Scores)
WrightMap_person &lt;- ggplot(data = Scores) +
  geom_bar(aes(x=F1)) +
  scale_x_binned(breaks = seq(from = -2.5, to = 2.5, by = 0.25),limits=c(-2.5,2.5)) +
  #theme_bw()
  theme_void()
WrightMap_person</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-14-2.png" width="960" /></p>
<pre class="r"><code>WrightMap &lt;- ggarrange(WrightMap_person,WrightMap_item + font(&quot;x.text&quot;, size = 10),
                               ncol = 1, nrow = 2, align = &quot;v&quot;, heights=c(0.75,2.25))

WrightMap</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-14-3.png" width="960" /></p>
<pre class="r"><code># png(filename = &quot;Wrightmap.png&quot;,  width = 920, height = 540, units = &quot;px&quot;, pointsize = 10,bg = &quot;white&quot;)
# WrightMap
# dev.off()</code></pre>
</div>
</div>
<div id="responder-rate" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Responder Rate</h1>
<p>In a Phase III study involving patients suffering from hidradenitis
suppurativa, an active drug was compared to a placebo. Each group
consisted of 200 subjects, and the primary endpoint was the HiSCR, which
is a binary endpoint. This endpoint is based on three continuous
components:</p>
<ol style="list-style-type: decimal">
<li>Number of abscesses</li>
<li>Number of draining fistulae</li>
<li>Number of inflammatory nodules</li>
</ol>
<p>A patient achieves a HiSCR response if all of the following three
conditions are met when comparing baseline data to follow-up data (at
week 16):</p>
<ol style="list-style-type: decimal">
<li>At least a 50% decrease in the AN count; AN count is defined as the
sum of the number of abscesses and the number of inflammatory
nodules.</li>
<li>No increase in the number of abscesses.</li>
<li>No increase in the number of draining fistulae.</li>
</ol>
<p>The aim of the study was to compare the two treatment arms in regard
to the HiSCR response.</p>
<p>The challenge lies in visualizing the impact of changing the
definition of the HiSCR response on the results. For example, altering
the first condition to assume that a decrease of 25% or 75% is needed to
achieve a HiSCR response could be considered. The second and third
conditions could be changed separately, or a mix of changes to two or
all conditions can be applied. How does this impact the results?</p>
<div id="waffle-plot-bar-chart-line-plot" class="section level2"
number="6.1">
<h2><span class="header-section-number">6.1</span> Waffle plot, bar
chart, line plot</h2>
<p>Slide can be found <a
href="https://vis-sig.github.io/blog/posts/2022-06-06-wonderful-wednesdays-may-2022/images/slide_2.pdf">here</a></p>
<p><img src="02_Plots/Visualization/PRO/Responder1a.png" /> <img
src="02_Plots/Visualization/PRO/Responder1b.png" /> <img
src="02_Plots/Visualization/PRO/Responder1c.png" /> <img
src="02_Plots/Visualization/PRO/Responder1d.png" /></p>
</div>
<div id="line-plots-based-on-reduction-in-an-count"
class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Line plots based on
reduction in AN count</h2>
<p>This visualization shows nicely that the difference between the
groups is rather small, if the percentage change to be reached is large
(focusing on the first part of the HiSCR responder definition). This is
done by presenting a line plot for both groups using two different
colors. There are three graphs. Each one of them keeps the second and/or
the third part of the definition of a HiSCR responder fixed. Overall, it
is a very clean visualization which very nicely tackles the challenge of
showing the impact of chaning the definition of HiSCR response.</p>
<pre class="r"><code># library(tidyverse)
# library(ggtext)

df &lt;- read.csv(&quot;./01_Datasets/HiSCR_dat.csv&quot;)

# Create required variables for graph
df_new &lt;- df %&gt;%
          mutate(
            
            # If abscesses increase
            abscesses.incr = if_else(
              condition = abscesses.w16 &gt; abscesses.base,
              true = &quot;Yes&quot;,
              false = &quot;No&quot;,
              missing = NA_character_
            ),
            
            # If draining fistulae increase
            drain.fist.incr = if_else(
              condition = drain.fist.w16 &gt; drain.fist.base,
              true = &quot;Yes&quot;,
              false = &quot;No&quot;,
              missing = NA_character_
            ),
            
            # If abscesses and draining fistulae increase
            drain.fist.abscesses.incr = if_else(
              condition = abscesses.incr == &quot;No&quot; &amp; drain.fist.incr == &quot;No&quot;,
              true = &quot;No&quot;,
              false = &quot;Yes&quot;,
              missing = NA_character_
            ),
            
            an.count.base = abscesses.base + infl.nod.base,
            an.count.w16 = abscesses.w16 + infl.nod.w16,
            
            # Percentage change in AN count
            an.count.change = (an.count.w16 - an.count.base)/an.count.base*100
          ) %&gt;%
  
         select(c(TRT, abscesses.incr, drain.fist.incr,
                  drain.fist.abscesses.incr, an.count.change))

active.df &lt;- filter(df_new, TRT == &quot;ACT&quot;)
placebo.df &lt;- filter(df_new, TRT == &quot;PBO&quot;)

results &lt;- data.frame()

# Find the percentage assigned a positive HiSCR for each value of i
# where i is the minimum required percentage reduction.
for (i in 0:100){
  active.abscesses &lt;- sum(active.df$an.count.change &lt;= -i &amp; active.df$abscesses.incr == &quot;No&quot;)/nrow(active.df)*100
  active.drain.fist &lt;- sum(active.df$an.count.change &lt;= -i &amp; active.df$drain.fist.incr == &quot;No&quot;)/nrow(active.df)*100
  active.both &lt;- sum(active.df$an.count.change &lt;= -i &amp; active.df$drain.fist.abscesses.incr == &quot;No&quot;)/nrow(active.df)*100
  
  placebo.abscesses &lt;- sum(placebo.df$an.count.change &lt;= -i &amp; placebo.df$abscesses.incr == &quot;No&quot;)/nrow(placebo.df)*100
  placebo.drain.fist &lt;- sum(placebo.df$an.count.change &lt;= -i &amp; placebo.df$drain.fist.incr == &quot;No&quot;)/nrow(placebo.df)*100
  placebo.both &lt;- sum(placebo.df$an.count.change &lt;= -i &amp; placebo.df$drain.fist.abscesses.incr == &quot;No&quot;)/nrow(placebo.df)*100
  
  # Store results
  results &lt;- rbind(results,
                   data.frame(percent = i,
                               active.abscesses,
                               active.drain.fist,
                               active.both,
                               placebo.abscesses,
                               placebo.drain.fist,
                               placebo.both))
}

# Create a row for each percentage reduction, treatment arm, and condition
# to get the data into the right form for the graph
graph_df &lt;- results %&gt;%
            pivot_longer(cols = -&quot;percent&quot;) %&gt;%
  
            mutate(
              # Extract treatment arm
              TRT = if_else(
                condition = str_detect(name, pattern = &quot;active&quot;),
                true = &quot;Active&quot;,
                false = &quot;Placebo&quot;,
                missing = NA_character_),
              
              # Extract condition (&lt;br&gt; is used to cause line break in subplot title)
              condition = case_when(
                str_detect(name, pattern = &quot;abscesses&quot;) ~ &quot;No Increase in Abscesses&quot;,
                str_detect(name, pattern = &quot;fist&quot;) ~ &quot;No Increase in Draining Fistulae&quot;,
                TRUE ~ &quot;No Increase in &lt;br&gt;Abscesses &amp; Draining Fistulae&quot;
              )) %&gt;%
  
            select(-name)

# Order conditions for the graph
graph_df$condition &lt;- factor(graph_df$condition,
                             levels = c(&quot;No Increase in Abscesses&quot;,
                                        &quot;No Increase in Draining Fistulae&quot;,
                                        &quot;No Increase in &lt;br&gt;Abscesses &amp; Draining Fistulae&quot;))

# Annotation dataframe for the Placebo and Active labels
arm.ann &lt;- data.frame(x = c(5, 3),
                      y = c(90, 35),
                      TRT = c(&quot;Active&quot;, &quot;Placebo&quot;),
                      condition = rep(&quot;No Increase in Abscesses&quot;, 2))

# Order condition variable to ensure labels appear in correct subplot.
arm.ann$condition &lt;- factor(arm.ann$condition,
                             levels = c(&quot;No Increase in Abscesses&quot;,
                                        &quot;No Increase in Draining Fistulae&quot;,
                                        &quot;No Increase in &lt;br&gt;Abscesses &amp; Draining Fistulae&quot;))

axis.color &lt;- &quot;gray40&quot;

# Create graph
ggplot(data = graph_df,
       aes(x = percent,
           y = value,
           group = TRT)) +

  # Add lines
  geom_line(aes(color = TRT)) +
  
  # Subplot by condition
  facet_wrap(~condition) +
  
  # Restrict plotting area
  coord_cartesian(expand = F) +
  
  # Add % labels to the axes ticks
  scale_x_continuous(labels = scales::percent_format(scale = 1)) +
  
  scale_y_continuous(limits = c(0, 100),
                     labels = scales::percent_format(scale = 1)) +
  
  # Add Active and Placebo labels
  geom_text(data = arm.ann,
            aes(x = x,
                y = y,
                group = condition,
                label = TRT,
                color = TRT),
            hjust = 0,
            size = 2.75) +

  # Define theme
  theme(panel.background    = element_rect(fill = &quot;white&quot;),
        axis.line           = element_line(color = axis.color),
        panel.grid.major    = element_line(color = &quot;gray95&quot;),
        axis.ticks          = element_line(color = axis.color),
        axis.text           = element_text(color = axis.color),
        axis.title          = element_text(color = axis.color,
                                           size = 8),
        axis.title.x        = element_text(hjust = 0,
                                           margin = margin(t = 15)),
        legend.position     = &#39;none&#39;,
        plot.margin         = margin(20, 20, 20, 20),
        strip.text          = element_markdown(size = 8),
        panel.spacing       = unit(0.4, &#39;in&#39;),
        plot.title.position = &#39;plot&#39;,
        plot.subtitle       = element_markdown(color = &quot;gray30&quot;,
                                               size = 9,
                                               margin = margin(b = 10)),
        plot.title          = element_markdown(size = 11),
        plot.caption        = element_markdown(size = 7,
                                               color = axis.color,
                                               margin = margin(t = 15))) +
  
  # Define plot labels
  labs(x = &quot;Minimum Required Percentage Reduction in AN Count*&quot;,
       y = NULL,
       subtitle = &quot; % of Patients assigned a Positive HiSCR Response (N&lt;sub&gt;P&lt;/sub&gt; = N&lt;sub&gt;A&lt;/sub&gt; = 200)&quot;,
       title = &quot;____ &lt;br&gt; &lt;br&gt; How Changing the HiSCR Definition Changes the Results&quot;,
       caption = &quot;*AN Count = Sum of the Number of Abscesses and Inflammatory Nodes &lt;br&gt; Author: Huw Wilson&quot;)</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-15-1.png" width="960" /></p>
</div>
<div id="shiny-apps" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Shiny Apps</h2>
<p>The app can be found <a
href="https://bonorico.shinyapps.io/HiSCR/?_ga=2.91645274.1120831357.1651571388-1024467400.1644592220">here</a>.</p>
<p>This visualization shows on the y-axis the inverse of the risk ratio
and on the x-axis the threshold for the percentage decrease in AN count.
It is actually an animation showing the impact of changing the threshold
for the change of abscesses from baseline. This is a very useful graph
to visualize what happens if you change different aspects of the
definition.</p>
<p><img src="02_Plots/Visualization/PRO/Responder_Shiny_a.PNG" /></p>
<p>This is a very simple app which allows you to change the definition
of the HiSCR definition (on the left-hand side) to see what happens in
the results (on the right-hand side). See
[<em>ShinyVisualizationBar</em>]</p>
<p><img src="02_Plots/Visualization/PRO/Responder_Shiny_b.PNG" /></p>
<p>This is a very advanced app which shows a volcano plot in the main
panel and it shows what happends in the results when you change the
definition on the left-hand side. On the right-hand side, you see a
table with additional results based on different HiSCR definitions. The
panel thinks that it is a not necessarily straightforward to see what is
being shown here. However, it is still a very insightful and useful app
to understand the impact of changing the definition of HiSCR.</p>
<p>The app can be found <a
href="https://vis-sig.github.io/blog/posts/2022-06-06-wonderful-wednesdays-may-2022/images/HiSCR_fig%20-%20Agustin%20Calatroni.html">here</a>.</p>
<p><img src="02_Plots/Visualization/PRO/HiSCR_fig.png" /></p>
</div>
</div>
<div id="variability-plot" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Variability plot</h1>
<p>In this plot, the variability (represented by the standard deviation)
is plotted over time and by treatment group. This is a very good idea to
present the stability of the values.</p>
<p>The title is very nicely done. The first line provides already a very
clear message. The second line uses a smaller font size and provides
additional information. This plot is very clear and easy to read. Only
the coloring could be chosen in a different way as already discussed
above.</p>
<pre class="r"><code>Orange &lt;- &quot;#EF7F04&quot;
Green &lt;- &quot;#68B937&quot;
Blue &lt;- &quot;#00A6CB&quot;
Grey &lt;- &quot;#4E5053&quot;
Darkblue &lt;- &quot;#003569&quot;
Yellow &lt;- &quot;#FFBB2D&quot;

## Read in dataset ----

data &lt;- read_csv(&#39;./01_Datasets/simulated_data.csv&#39;)

data$VISITNUM &lt;- as.character(data$VISITNUM)
data$TREATMENT &lt;- as.factor(data$TREATMENT)

## Set up data frame for changing visitnum to visit name

visits &lt;- data.frame(VISITNUM = c(&#39;3&#39;, &#39;17&#39;, &#39;21&#39;),
                     Visit = c(&#39;Baseline&#39;, &#39;Week 26&#39;, &#39;Week 52&#39;))

## join it on

dataa &lt;- data %&gt;% 
  full_join(visits)

levels(data$TREATMENT)</code></pre>
<pre><code>## [1] &quot;Rx high&quot;   &quot;Rx low&quot;    &quot;Rx medium&quot; &quot;SOC&quot;</code></pre>
<pre class="r"><code>## reorder factor for treatment


dataa$Treatment &lt;- factor(dataa$TREATMENT, levels = c(&quot;Rx high&quot;, &quot;Rx medium&quot;, &quot;Rx low&quot;, &quot;SOC&quot;))

## Add in mean and sd for each patient and visit combination ----

data1 &lt;- dataa %&gt;% 
  group_by(SUBJID, Visit, Treatment) %&gt;% 
  summarise(mean_cgmsim = mean(Simulated_CGMValue), sd_cgmsim = sd(Simulated_CGMValue), 
            mean_cgm = mean(Original_CGMValue), sd_cgm = sd(Simulated_CGMValue),
            med_cgm = median(Original_CGMValue), iqr_cgm = IQR(Original_CGMValue),
            med_cgmsim = median(Simulated_CGMValue), iqr_cgmsim = IQR(Simulated_CGMValue))




# plotdata &lt;- ggplot(data= data1, aes(x=mean_cgmsim, y = sd_cgmsim, colour= TREATMENT, shape= Visit))
# plotdata &lt;- ggplot(data= data1, aes(x=mean_cgm, y = sd_cgm, colour= TREATMENT, shape= VISITNUM))
plotdata &lt;- ggplot(data= data1, aes(x=mean_cgmsim, y = sd_cgmsim, colour= Treatment))
# plotdata &lt;- ggplot(data= data1, aes(x=med_cgmsim, y = iqr_cgmsim, colour= TREATMENT))


plotdata + geom_point() +
  ggtitle(&#39;Medium treatment dose leads to glucose levels within a safe range,&#39;) +
  xlab(&#39;Mean glucose levels per patient (mg/dL)&#39;) +
  ylab(&#39;Variablity of glucose measurements per patient (Standard Deviation)&#39;) +
  scale_colour_manual(values = c(Green, Blue, Darkblue, Orange)) +
  geom_vline(aes(xintercept=140), linetype=2, colour=Grey) +
  facet_wrap(vars(Visit),labeller = labeller(Visit = label_wrap_gen(55))) +
  labs(caption = &quot;Glucose levels between 72 and 140 mg/dL are considered to indicate good glycemic control&quot;,
       subtitle = &quot;and decreased variability compared to SOC and other treatment doses&quot;) +
  theme_bw() +
  theme(panel.background = element_blank(), axis.line = element_blank(),
        axis.text=element_text(size=12),
        axis.title=element_text(size=14),
        # legend.position=&quot;none&quot;,
        legend.title = element_text(size=14),
        legend.text= element_text(size=12),
        plot.title = element_text(size=18, face=&quot;bold&quot;),
        plot.subtitle = element_text(size=14, face=&quot;bold&quot;))</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-16-1.png" width="960" /></p>
</div>
<div id="clinical-improvement" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Clinical
Improvement</h1>
<p>The data reflects a phase III study - active vs placebo and the
endpoint was Ordinal Scale for Improvement (OSCI). All patients started
at OSCI=4 and daily measures over 35 days were performed. The challenge
was to describe the treatment effect specifically taking into account
the number and timing of patients who died, left the hospital or fully
recovered.</p>
<p>The shiny app can be found <a
href="https://bonorico.shinyapps.io/oscicovid">here</a></p>
<pre class="r"><code># packages
pacman::p_load(rio, tidyverse) 
pacman::p_load(RColorBrewer, ggtext)
pacman::p_load(patchwork)

# individual plots
source(&#39;./03_Functions/covid_tile_order.r&#39;)
source(&#39;./03_Functions/covid_histogram.r&#39;)
source(&#39;./03_Functions/covid_mean.r&#39;)
source(&#39;./03_Functions/covid_modal.r&#39;)

# layout
design &lt;- &quot;11114
           11114
           11114
           2222#
           2222#
           3333#&quot;

# combine
(f_t + theme(plot.margin = unit(c(0, 0, 0, 0), &quot;lines&quot;) ) ) +
   
   (f_h + theme(strip.background = element_blank(), 
                strip.text = element_blank(),
                axis.title.x=element_blank(),
                plot.margin = unit(c(0, 0, 0, 0), &quot;lines&quot;) ) ) +
   
   # (f_mo + theme(strip.background = element_blank(), 
   #               strip.text = element_blank(),
   #               plot.margin = unit(c(0, 0, 0, 0), &quot;lines&quot;) ) ) +
   (f_me) +
   
   
   plot_layout(design = design) +
   plot_annotation(
      title    = &#39;COVID-19 study comparing **Active vs Placebo** on Ordinal Scale for Clinical Improvement (OSCI) daily measures (35 days)&#39;,
      subtitle =
      &#39;**A. Full Index Plot** representing all individual OSCI sequences sorted accordingly to the finished order. 
      **B. Frequency Plot** representing OSCI sequences distributions 
      **C. Sequences of modals** summary derived from the OSCI sequences distributions 
      **D. Mean time spent in each OSCI** summary of the mean number of times each OSCI is observed in a sequence. 
      This characterizes the overall OSCI distribution&#39;,
      #caption  = &#39;**Data from Wonderful-Wednesdays** &lt;span style=&quot;font-size:8pt&quot;&gt;github.com/VIS-SIG[2022â03â09]&lt;/span&gt;&#39;,
      theme = theme(plot.title.position = &quot;plot&quot;,
                    plot.title = element_textbox_simple(
                       size = 16,
                       lineheight = 1,
                       r = unit(5, &quot;pt&quot;),
                       padding = margin(10, 10, 7, 10),
                       margin = margin(2, 6, 2, 6),
                       fill = &quot;gray85&quot;
                    ),
                    #plot.subtitle.position = &quot;plot&quot;,
                    plot.subtitle = element_textbox_simple(
                       size = 14,
                       lineheight = 1,
                       r = unit(5, &quot;pt&quot;),
                       padding = margin(5, 5, 5, 5),
                       margin = margin(2, 6, 2, 6),
                       fill = &quot;gray95&quot;
                    ),
                    plot.caption  = element_markdown()) )</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-17-1.png" width="960" /></p>
<pre class="r"><code>#save
# ggsave(&#39;./covid_combined.pdf&#39;, width = 13, height = 10)
# ggsave(&#39;./covid_combined.png&#39;, width = 13, height = 10, dpi = 600)</code></pre>
</div>
<div id="lollipopforest-plot" class="section level1" number="9">
<h1><span class="header-section-number">9</span> Lollipop/forest
plot</h1>
<pre class="r"><code># dat &lt;- read.csv(&quot;./01_Datasets/CGI_S_3_groups_csv.csv&quot;)

# library(RCurl)
# library(dplyr)
# library(tidyr)
# library(ggplot2)
# library(ggrepel)
# library(cowplot)
# library(ggtext)

y &lt;- read.csv(&quot;./01_Datasets/CGI_S_3_groups_csv.csv&quot;) %&gt;%
   rename(Group = CGI)

l &lt;- y %&gt;%
  pivot_longer(cols = X1:X7,
               names_to = &quot;Category&quot;,
               values_to = &quot;n&quot;) %&gt;%
  mutate(Category = as.numeric(gsub(&quot;X&quot;, &quot;&quot;, Category))) %&gt;%
  group_by(Week, Group) %&gt;%
  arrange(Category) %&gt;%
  mutate(
    CumN = cumsum(n),
    Week = paste(&quot;Week&quot;, Week),
    CumFreq = CumN / Total.sample.size,
    Freq = n / Total.sample.size,
    `Cumulative %` = round(CumFreq * 100, 1),
    `%` = round(Freq * 100, 1)
  ) %&gt;%
  ungroup() %&gt;%
  group_by(Week, Category) %&gt;%
  arrange(Group, .by_group = T) %&gt;%
  mutate(
    Odds = CumFreq / (1 - CumFreq),
    OR = ifelse(Group == &quot;Active&quot;, round(Odds / Odds[2], 2), NA),
    selogOR = ifelse(Group == &quot;Active&quot;, sqrt(
      1 / CumN + 1 / (Total.sample.size - CumN) + 1 / CumN[2] + 1 / (Total.sample.size[2] -
                                                                       CumN[2])
    ), NA),
    ORlower95CI = ifelse(Group == &quot;Active&quot;, round(exp(log(OR) - 1.96 * selogOR), 2), NA),
    ORupper95CI = ifelse(Group == &quot;Active&quot;, round(exp(log(OR) + 1.96 * selogOR), 2), NA)
  )
l</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Week"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Group"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Total.sample.size"],"name":[3],"type":["int"],"align":["right"]},{"label":["Category"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["n"],"name":[5],"type":["int"],"align":["right"]},{"label":["CumN"],"name":[6],"type":["int"],"align":["right"]},{"label":["CumFreq"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Freq"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["Cumulative %"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["%"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["Odds"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["OR"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["selogOR"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["ORlower95CI"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["ORupper95CI"],"name":[15],"type":["dbl"],"align":["right"]}],"data":[{"1":"Week 12","2":"Active","3":"108","4":"1","5":"18","6":"18","7":"0.16666667","8":"0.166666667","9":"16.7","10":"16.7","11":"0.20000000","12":"1.98","13":"0.4204375","14":"0.87","15":"4.51"},{"1":"Week 12","2":"Comparator","3":"109","4":"1","5":"10","6":"10","7":"0.09174312","8":"0.091743119","9":"9.2","10":"9.2","11":"0.10101010","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"Week 12","2":"Placebo","3":"108","4":"1","5":"2","6":"2","7":"0.01851852","8":"0.018518519","9":"1.9","10":"1.9","11":"0.01886792","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"Week 12","2":"Active","3":"108","4":"2","5":"32","6":"50","7":"0.46296296","8":"0.296296296","9":"46.3","10":"29.6","11":"0.86206897","12":"1.49","13":"0.2770093","14":"0.87","15":"2.56"},{"1":"Week 12","2":"Comparator","3":"109","4":"2","5":"30","6":"40","7":"0.36697248","8":"0.275229358","9":"36.7","10":"27.5","11":"0.57971014","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"Week 12","2":"Placebo","3":"108","4":"2","5":"5","6":"7","7":"0.06481481","8":"0.046296296","9":"6.5","10":"4.6","11":"0.06930693","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"Week 12","2":"Active","3":"108","4":"3","5":"44","6":"94","7":"0.87037037","8":"0.407407407","9":"87.0","10":"40.7","11":"6.71428571","12":"0.68","13":"0.4383696","14":"0.29","15":"1.61"},{"1":"Week 12","2":"Comparator","3":"109","4":"3","5":"59","6":"99","7":"0.90825688","8":"0.541284404","9":"90.8","10":"54.1","11":"9.90000000","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"Week 12","2":"Placebo","3":"108","4":"3","5":"30","6":"37","7":"0.34259259","8":"0.277777778","9":"34.3","10":"27.8","11":"0.52112676","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"Week 12","2":"Active","3":"108","4":"4","5":"10","6":"104","7":"0.96296296","8":"0.092592593","9":"96.3","10":"9.3","11":"26.00000000","12":"0.49","13":"0.8769043","14":"0.09","15":"2.73"},{"1":"Week 12","2":"Comparator","3":"109","4":"4","5":"8","6":"107","7":"0.98165138","8":"0.073394495","9":"98.2","10":"7.3","11":"53.50000000","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"Week 12","2":"Placebo","3":"108","4":"4","5":"50","6":"87","7":"0.80555556","8":"0.462962963","9":"80.6","10":"46.3","11":"4.14285714","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"Week 12","2":"Active","3":"108","4":"5","5":"3","6":"107","7":"0.99074074","8":"0.027777778","9":"99.1","10":"2.8","11":"107.00000000","12":"0.00","13":"Inf","14":"0.00","15":"NaN"},{"1":"Week 12","2":"Comparator","3":"109","4":"5","5":"2","6":"109","7":"1.00000000","8":"0.018348624","9":"100.0","10":"1.8","11":"Inf","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"Week 12","2":"Placebo","3":"108","4":"5","5":"15","6":"102","7":"0.94444444","8":"0.138888889","9":"94.4","10":"13.9","11":"17.00000000","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"Week 12","2":"Active","3":"108","4":"6","5":"1","6":"108","7":"1.00000000","8":"0.009259259","9":"100.0","10":"0.9","11":"Inf","12":"NaN","13":"Inf","14":"NaN","15":"NaN"},{"1":"Week 12","2":"Comparator","3":"109","4":"6","5":"0","6":"109","7":"1.00000000","8":"0.000000000","9":"100.0","10":"0.0","11":"Inf","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"Week 12","2":"Placebo","3":"108","4":"6","5":"4","6":"106","7":"0.98148148","8":"0.037037037","9":"98.1","10":"3.7","11":"53.00000000","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"Week 12","2":"Active","3":"108","4":"7","5":"0","6":"108","7":"1.00000000","8":"0.000000000","9":"100.0","10":"0.0","11":"Inf","12":"NaN","13":"Inf","14":"NaN","15":"NaN"},{"1":"Week 12","2":"Comparator","3":"109","4":"7","5":"0","6":"109","7":"1.00000000","8":"0.000000000","9":"100.0","10":"0.0","11":"Inf","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"Week 12","2":"Placebo","3":"108","4":"7","5":"2","6":"108","7":"1.00000000","8":"0.018518519","9":"100.0","10":"1.9","11":"Inf","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"Week 52","2":"Active","3":"108","4":"1","5":"35","6":"35","7":"0.32407407","8":"0.324074074","9":"32.4","10":"32.4","11":"0.47945205","12":"3.00","13":"0.3457962","14":"1.52","15":"5.91"},{"1":"Week 52","2":"Comparator","3":"109","4":"1","5":"15","6":"15","7":"0.13761468","8":"0.137614679","9":"13.8","10":"13.8","11":"0.15957447","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"Week 52","2":"Placebo","3":"108","4":"1","5":"5","6":"5","7":"0.04629630","8":"0.046296296","9":"4.6","10":"4.6","11":"0.04854369","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"Week 52","2":"Active","3":"108","4":"2","5":"29","6":"64","7":"0.59259259","8":"0.268518519","9":"59.3","10":"26.9","11":"1.45454545","12":"1.85","13":"0.2749164","14":"1.08","15":"3.17"},{"1":"Week 52","2":"Comparator","3":"109","4":"2","5":"33","6":"48","7":"0.44036697","8":"0.302752294","9":"44.0","10":"30.3","11":"0.78688525","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"Week 52","2":"Placebo","3":"108","4":"2","5":"9","6":"14","7":"0.12962963","8":"0.083333333","9":"13.0","10":"8.3","11":"0.14893617","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"Week 52","2":"Active","3":"108","4":"3","5":"35","6":"99","7":"0.91666667","8":"0.324074074","9":"91.7","10":"32.4","11":"11.00000000","12":"1.23","13":"0.4715138","14":"0.49","15":"3.10"},{"1":"Week 52","2":"Comparator","3":"109","4":"3","5":"50","6":"98","7":"0.89908257","8":"0.458715596","9":"89.9","10":"45.9","11":"8.90909091","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"Week 52","2":"Placebo","3":"108","4":"3","5":"30","6":"44","7":"0.40740741","8":"0.277777778","9":"40.7","10":"27.8","11":"0.68750000","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"Week 52","2":"Active","3":"108","4":"4","5":"5","6":"104","7":"0.96296296","8":"0.046296296","9":"96.3","10":"4.6","11":"26.00000000","12":"0.49","13":"0.8769043","14":"0.09","15":"2.73"},{"1":"Week 52","2":"Comparator","3":"109","4":"4","5":"9","6":"107","7":"0.98165138","8":"0.082568807","9":"98.2","10":"8.3","11":"53.50000000","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"Week 52","2":"Placebo","3":"108","4":"4","5":"45","6":"89","7":"0.82407407","8":"0.416666667","9":"82.4","10":"41.7","11":"4.68421053","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"Week 52","2":"Active","3":"108","4":"5","5":"3","6":"107","7":"0.99074074","8":"0.027777778","9":"99.1","10":"2.8","11":"107.00000000","12":"0.99","13":"1.4207762","14":"0.06","15":"16.03"},{"1":"Week 52","2":"Comparator","3":"109","4":"5","5":"1","6":"108","7":"0.99082569","8":"0.009174312","9":"99.1","10":"0.9","11":"108.00000000","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"Week 52","2":"Placebo","3":"108","4":"5","5":"10","6":"99","7":"0.91666667","8":"0.092592593","9":"91.7","10":"9.3","11":"11.00000000","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"Week 52","2":"Active","3":"108","4":"6","5":"1","6":"108","7":"1.00000000","8":"0.009259259","9":"100.0","10":"0.9","11":"Inf","12":"NaN","13":"Inf","14":"NaN","15":"NaN"},{"1":"Week 52","2":"Comparator","3":"109","4":"6","5":"1","6":"109","7":"1.00000000","8":"0.009174312","9":"100.0","10":"0.9","11":"Inf","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"Week 52","2":"Placebo","3":"108","4":"6","5":"4","6":"103","7":"0.95370370","8":"0.037037037","9":"95.4","10":"3.7","11":"20.60000000","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"Week 52","2":"Active","3":"108","4":"7","5":"0","6":"108","7":"1.00000000","8":"0.000000000","9":"100.0","10":"0.0","11":"Inf","12":"NaN","13":"Inf","14":"NaN","15":"NaN"},{"1":"Week 52","2":"Comparator","3":"109","4":"7","5":"0","6":"109","7":"1.00000000","8":"0.000000000","9":"100.0","10":"0.0","11":"Inf","12":"NA","13":"NA","14":"NA","15":"NA"},{"1":"Week 52","2":"Placebo","3":"108","4":"7","5":"5","6":"108","7":"1.00000000","8":"0.046296296","9":"100.0","10":"4.6","11":"Inf","12":"NA","13":"NA","14":"NA","15":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>k = 3
labs &lt;- c(&quot;Normal, not at all ill -   1&quot;,
          &quot;Normal to borderline ill - &lt;=2&quot;,
          &quot;Normal to mildly ill - &lt;=3&quot;)

p1 &lt;-
  ggplot(data = l[l$Category &lt;= k,], aes(x = `Cumulative %`, y = Category, col =
                                           Group)) +
  geom_point(size = 5) +
  facet_grid(rows = vars(Week)) +
  labs(title = &quot;Cumulative percentage of response&quot;, y = &quot;&quot;, x = &quot;&quot;) +
  scale_y_continuous(breaks = 1:k, labels = labs) +
  scale_x_continuous(limits = c(0, 100)) +
  theme_bw() +
  theme(legend.position = &quot;none&quot;,
        strip.text = element_blank()) +
  geom_text_repel(aes(label = paste(sprintf(
    &quot;%.1f&quot;, `Cumulative %`
  ), &quot;%&quot;)),
  nudge_y = 0.1)
p1</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-18-1.png" width="960" /></p>
<pre class="r"><code>legend_b &lt;- get_legend(p1 +
                         guides(color = guide_legend(nrow = 1)) +
                         theme(legend.position = &quot;bottom&quot;,
                               legend.title = element_blank(),
                               legend.text = element_text(size = 12)))
p2 &lt;-
  ggplot(data = l[l$Category &lt;= k &amp;
                    !is.na(l$OR),], aes(x = OR, y = Category)) +
  geom_point(size = 3, pch = 15) +
  geom_linerange(aes(xmin = ORlower95CI, xmax = ORupper95CI)) +
  geom_vline(xintercept = 1, linetype = 3) +
  facet_grid(rows = vars(Week)) +
  scale_y_continuous(breaks = 1:k, labels = labs) +
  scale_x_continuous(limits = c(0, 6)) +
  theme_bw() +
  theme(legend.position = &quot;none&quot;,
        axis.text.y = element_blank()) +
  labs(x = &quot;&quot;, y=&quot;&quot;, title = &quot;OR (Active vs. Comparator)&quot;) +
  geom_text_repel(aes(label = sprintf(&quot;%.2f&quot;, OR)),
                  nudge_y = 0.1) +
  theme(strip.text = element_text(size=12))
p2</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-18-2.png" width="960" /></p>
<pre class="r"><code>plot_row &lt;- plot_grid(p1, p2, nrow = 1, rel_widths = c(2, 1))

title &lt;- ggdraw() +
  draw_label(
    &quot;Active treatment is more effective than comparator at Week 52&quot;,
    fontface = &#39;bold&#39;,
    x = 0,
    hjust = 0,
    size = 24,
  ) +
  theme(plot.margin = margin(0, 0, 0, 7))

p &lt;- plot_grid(title,
               plot_row,
               legend_b,
               ncol = 1,
               rel_heights = c(0.1, 1, 0.05))
p</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-18-3.png" width="960" /></p>
</div>
<div id="dumbbell-plot" class="section level1" number="10">
<h1><span class="header-section-number">10</span> Dumbbell Plot</h1>
<p><img src="02_Plots/Visualization/PRO/Dumbbell1.png" /></p>
<p><img src="02_Plots/Visualization/PRO/Dumbbell2.png" /></p>
<pre class="r"><code>data &lt;- read.csv(&quot;./01_Datasets/MAI.csv&quot;)</code></pre>
</div>
<div id="scatter-plot" class="section level1" number="11">
<h1><span class="header-section-number">11</span> Scatter Plot</h1>
<p><img src="02_Plots/Visualization/PRO/Scatter.png" /></p>
<pre class="r"><code>data &lt;- read.csv(&quot;./01_Datasets/MAI.csv&quot;)

# Scatter plot with regression lines and confidence intervals
ggplot(data, aes(x = base.mai, y = mai, color = gr)) +
  geom_point(size = 2) +  # Add points
  geom_smooth(method = &quot;lm&quot;, se = TRUE) +  # Add linear regression lines with confidence intervals
  geom_abline(intercept = 0, slope = 1, linetype = &quot;dashed&quot;, color = &quot;black&quot;) +  # Reference line
  labs(title = &quot;Scatter Plot&quot;,
       x = &quot;MAI Score at Baseline&quot;,
       y = &quot;MAI Score After 1 Year&quot;,
       color = &quot;Group&quot;) +
  theme_minimal() +
  theme(legend.position = &quot;top&quot;)</code></pre>
<p><img src="05-Plot-PRO-Data_files/figure-html/unnamed-chunk-20-1.png" width="960" /></p>
</div>
<div id="regression-model-prediction-of-health-status-eq-5d"
class="section level1" number="12">
<h1><span class="header-section-number">12</span> Regression
model-Prediction of health status (EQ-5D)</h1>
<p>The data is based on a study to assess the health status in patients
with coronary heart diseases (see Ose et al., 2012). The research
question was: what factors are associated with health status in usual
primary care?</p>
<p>The original data included 2,656 patients with 14 (patient and
practice) characteristics (with clustered data structure). The outcome
was EQ-5D VAS scale (Health related quality of life; range: [0; 1]). The
data set for this challenge is a sub-sample of patients and variables
and it is simulated data.</p>
<p><img src="02_Plots/Visualization/PRO/Regression1.PNG" /></p>
<p><img src="02_Plots/Visualization/PRO/Regression2.PNG" /></p>
</div>
<div id="reference" class="section level1" number="13">
<h1><span class="header-section-number">13</span> Reference</h1>
<p>SIG (2023, Sept. 13). VIS-SIG Blog: Wonderful Wednesdays September
2023. Retrieved from <a
href="https://graphicsprinciples.github.io/posts/2023-12-17-wonderful-wednesdays-september-2023/"
class="uri">https://graphicsprinciples.github.io/posts/2023-12-17-wonderful-wednesdays-september-2023/</a></p>
<p>SIG (2023, June 11). VIS-SIG Blog: Visualisation SIG Showcase.
Retrieved from <a
href="https://graphicsprinciples.github.io/posts/2023-05-14-visualisation-sig-showcase/"
class="uri">https://graphicsprinciples.github.io/posts/2023-05-14-visualisation-sig-showcase/</a></p>
<p>SIG (2023, May 10). VIS-SIG Blog: Wonderful Wednesdays May 2023.
Retrieved from <a
href="https://graphicsprinciples.github.io/posts/2023-05-29-wonderful-wednesdays-may-2023/"
class="uri">https://graphicsprinciples.github.io/posts/2023-05-29-wonderful-wednesdays-may-2023/</a></p>
<p>SIG (2022, Nov. 9). VIS-SIG Blog: Wonderful Wednesdays November 2022.
Retrieved from <a
href="https://graphicsprinciples.github.io/posts/2023-04-09-wonderful-wednesdays-november-2022/"
class="uri">https://graphicsprinciples.github.io/posts/2023-04-09-wonderful-wednesdays-november-2022/</a></p>
<p>Mallett (2022, Oct. 12). VIS-SIG Blog: Wonderful Wednesdays October
2022. Retrieved from <a
href="https://graphicsprinciples.github.io/posts/2023-04-09-wonderful-wednesdays-october-2022/"
class="uri">https://graphicsprinciples.github.io/posts/2023-04-09-wonderful-wednesdays-october-2022/</a></p>
<p>Uhlmann (2022, May 11). VIS-SIG Blog: Wonderful Wednesdays May 2022.
Retrieved from <a
href="https://graphicsprinciples.github.io/posts/2022-06-06-wonderful-wednesdays-may-2022/"
class="uri">https://graphicsprinciples.github.io/posts/2022-06-06-wonderful-wednesdays-may-2022/</a></p>
<p>SIG (2022, April 13). VIS-SIG Blog: Wonderful Wednesdays April 2022.
Retrieved from <a
href="https://graphicsprinciples.github.io/posts/2022-04-30-wonderful-wednesdays-april-2022/"
class="uri">https://graphicsprinciples.github.io/posts/2022-04-30-wonderful-wednesdays-april-2022/</a></p>
<p>Mallett (2021, Nov. 10). VIS-SIG Blog: Wonderful Wednesdays November
2021. Retrieved from <a
href="https://graphicsprinciples.github.io/posts/2021-12-05-wonderful-wednesdays-november-2021/"
class="uri">https://graphicsprinciples.github.io/posts/2021-12-05-wonderful-wednesdays-november-2021/</a></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
