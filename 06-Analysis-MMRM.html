<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Zehui Bai" />


<title> MMRM</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="site_libs/bsTable-3.3.7/bootstrapTable.js"></script>
<link href="site_libs/font-awesome-6.4.0/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.0/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Zehui Bai</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="02-Clinical_Experience.html">
    <span class="fa fa-user"></span>
     
    Clinical Experience
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-pencil-square-o"></span>
     
    Study Design
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="ZB-Design_Dose-Escalation-and-Stratification-Designs.html">Dose Escalation and Stratification Designs in Early Oncology Development</a>
    </li>
    <li>
      <a href="ZB-Design_Phase-I-Trials---Design-Considerations.html">Phase I Trials - Design Considerations</a>
    </li>
    <li>
      <a href="ZB-Design_Phase-II-Trials---Design-Considerations.html">Phase II Trials - Design Considerations</a>
    </li>
    <li>
      <a href="ZB-Design_Phase-III-Trials---Design-Considerations.html">Phase III Trials - Design Considerations</a>
    </li>
    <li>
      <a href="ZB-Design_Phase-IV-Trials---Design-Considerations.html">Phase IV Trials - Design Considerations for Post Marketing Surveillance</a>
    </li>
    <li>
      <a href="ZB-Design_Design-and-Monitoring-of-Adaptive-Clinical-Trials.html">Design and Monitoring of Adaptive Clinical Trials</a>
    </li>
    <li>
      <a href="ZB-Design_Design-and-Evaluation-of-Complex-Sequential-Trials.html">Design and Evaluation of Complex Sequential Analysis Trials</a>
    </li>
    <li>
      <a href="ZB-Design_Design-and-Evaluation-of-Diagnostic-Study.html">Design and Evaluation of Diagnostic Study</a>
    </li>
    <li>
      <a href="ZB-Design_Externally-Controlled-Trials.html">Considerations for the Design and Conduct of Externally Controlled Trials</a>
    </li>
    <li>
      <a href="ZB-Design_Noninferiority-Trials.html">Noninferiority Trials</a>
    </li>
    <li>
      <a href="ZB-Design_Bioequivalence-and-Biosimilar-Trials.html">Bioequivalence and Biosimilar Trials</a>
    </li>
    <li>
      <a href="ZB-Design_Exploring-Survival-Analysis-Designs-for-Clinical-Trials.html">Exploring Survival Analysis Designs for Clinical Trials</a>
    </li>
    <li>
      <a href="ZB-Design_Projecting-How-Long-Your-Trial-Will-Take.html">Projecting How Long Your Trial Will Take</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-sliders"></span>
     
    Sample Size
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="ZB-SSC_Everything-to-Know-About-Sample-Size-Determination.html">Everything to Know About Sample Size Determination</a>
    </li>
    <li>
      <a href="ZB-SSC_Choosing-the-Effect-Size-for-Sample-Size-Calculations.html">Choosing the Effect Size</a>
    </li>
    <li>
      <a href="ZB-SSC_Sample-Size-and-Power-for-Non-Parametric-Analysis.html">Sample Size and Power for Non-Parametric Analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-line-chart"></span>
     
    Data Visualization
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="05-Plot_Adverse-Event.html">Adverse Event Visualization</a>
    </li>
    <li>
      <a href="05-Plot_Laboratory-Data.html">Laboratory Data Visualization</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-line-chart"></span>
     
    Statistical Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="06-Analysis-Missing-Data.html">Missing Data Analysis</a>
    </li>
    <li>
      <a href="06-Analysis-MI-Implementation.html">Multiple Imputation Analysis</a>
    </li>
    <li>
      <a href="06-Analysis-PK-and-PD.html">PK and PD Analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="07-CV.html">
    <span class="fa fa-file-pdf-o"></span>
     
    CV
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="mailto:zehuibai@outlook.com">
    <span class="fa fa-envelope-o"></span>
     
    Contact me
  </a>
</li>
<li>
  <a href="https://github.com/Zehuibai">
    <span class="fa fa-github"></span>
     
    GitHub
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore"><p><img src="logo.jpg"
style="width:1in" /><br />
MMRM</p></h1>
<h4 class="author">Zehui Bai</h4>
<h4 class="date">2024-09-25 11:28:37</h4>

</div>


<!-- ----------------------------------------- -->
<!-- -----------Mind Map of ToC--------------- -->
<!-- ----------------------------------------- -->
<!-- ----------------------------------------- -->
<!-- --------------CSS Define----------------- -->
<!-- ----------------------------------------- -->
<style>
.bold-list-257f96 + ol {
    font-weight: 900;
    color: #257f96;
}
.bold-list-ff9900 + ol {
    font-weight: 900;
    color: #ff9900;
}
</style>
<!-- ----------------------------------------- -->
<div id="introduction" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<div id="correlated-response-data" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Correlated Response
Data</h2>
<ol style="list-style-type: decimal">
<li><p>Repeated Measurements:</p>
<ul>
<li>Defined as data collected from each experimental unit or subject
under different experimental conditions at multiple occasions.</li>
<li>Requires a flexible correlation structure to reflect the sequential
nature of measurements for each subject, considering possible
correlations related to subject-specific random effects.</li>
<li>Special case: Longitudinal data, which are collected at several time
points and might exhibit sequential correlations.</li>
</ul></li>
<li><p>Clustered Data:</p>
<ul>
<li>Occurs when observations are naturally grouped into clusters,
leading to correlated data within clusters.</li>
<li>Explained typically through random effect models, distinguishing
variability within and between clusters.</li>
<li>In some cases, there might be more than one level of clustering,
leading to a multi-level random effect structure.</li>
<li>Examples include studies on twins (natural clusters) and
ophthalmology studies where each pair of eyes forms a cluster.</li>
</ul></li>
<li><p>Spatially Correlated Data:</p>
<ul>
<li>Occurs when observations include both a response variable and a
location vector associated with it.</li>
<li>The proximity of measured responses determines their
correlation.</li>
<li>Grid data, linked to discrete areas like towns or counties, are also
considered spatially correlated. Examples include census,
socio-economic, and health data.</li>
</ul></li>
</ol>
</div>
<div id="hierarchical-and-marginal-model" class="section level2"
number="1.2">
<h2><span class="header-section-number">1.2</span> Hierarchical and
Marginal model</h2>
<p><strong>Hierarchical Models (Also Known as Multilevel or Mixed-Effect
Models)</strong></p>
<ul>
<li>Hierarchical models explicitly consider the hierarchical structure
of data. For example, students nested within classes, which are nested
within schools.</li>
<li>They include both fixed effects (common to all groups) and random
effects (specific to each group or level).</li>
<li>Random effects allow for individual differences at each level (like
differences among schools or among classes within schools).</li>
<li>Hierarchical models can handle unbalanced data and different numbers
of observations across groups.</li>
<li>They provide insights into <strong>both the individual group level
and the overall population</strong>.</li>
<li>Marginal models need a correct specification of the correlation
structure for consistent estimates, while hierarchical models are more
flexible in this aspect.</li>
</ul>
<p>The general linear mixed model can be written as:</p>
<p><span class="math display">\[
\begin{array}{c}
\mathbf{Y}_{i}=X_{i} \beta+Z_{i} \mathbf{b}_{i}+\epsilon_{i} \\
\mathbf{b}_{i} \sim N(\mathbf{0}, D) \quad \text { und } \quad
\epsilon_{i} \sim N\left(0, \Sigma_{i}\right)
\end{array}
\]</span> und <span class="math inline">\(\mathbf{b}_{1}, \ldots,
\mathbf{b}_{N}, \epsilon_{1}, \ldots, \epsilon_{N}\)</span> are
stochastically independent. This can be rewritten as
<strong>Hierarchical model</strong> <span class="math display">\[
\mathbf{Y}_{i} \mid \mathbf{b}_{i}=N\left(X_{i} \beta+Z_{i}
\mathbf{b}_{i}, \Sigma_{i}\right), \quad \mathbf{b}_{i} \sim
N(\mathbf{0}, D)
\]</span> One often assumes that <span
class="math inline">\(\Sigma_{i}\)</span> only depends on the dimension
of <span class="math inline">\(i\)</span> i.e. that the unknown
parameters in <span class="math inline">\(\Sigma_{i}\)</span> are
independent on <span class="math inline">\(i\)</span> (depends only on
the dimensionality of <span class="math inline">\(i\)</span>, the
unknown parameter <span class="math inline">\(\Sigma_{i}\)</span> is
independent of <span class="math inline">\(i\)</span>)</p>
<p><strong>Marginal Models (Also Known as Population-Averaged
Models)</strong></p>
<ul>
<li>Marginal models focus on the average response of the population,
rather than the individual group levels.</li>
<li>They use generalized estimating equations (GEEs) to estimate the
average response.</li>
<li>These models explicitly model the correlation structure of the data
but do not estimate random effects.</li>
<li>They are suitable when the interest is in the average effect across
all subjects or units, rather than the specific random effects.</li>
<li>Marginal models provide an understanding of the average behavior of
the entire population under study.</li>
<li>They are robust to certain types of misspecifications of the
correlation structure.</li>
</ul>
<p>The following marginal model follows from the hierarchical model:
<span class="math display">\[\mathbf{Y}_{i} \sim N\left(X_{i} \beta,
Z_{i} D Z_{i}^{T}+\Sigma_{i}\right)\]</span> The hierarchical model
implies the marginal model, the reverse is not generally true: <span
class="math inline">\(V_{i}=Z_{i} D Z_{i}^{T}+\Sigma_{i}\)</span></p>
</div>
<div id="maximum-likelihood-ml" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Maximum Likelihood
(ML)</h2>
<p>A linear mixed-effects model is of the form <span
class="math display">\[
y=\underbrace{X \beta}_{\text {fixed }}+\underbrace{Z b}_{\text {random
}}+\underbrace{\varepsilon}_{\text {error }},
\]</span> where - <span class="math inline">\(y\)</span> is the <span
class="math inline">\(n\)</span>-by-1 response vector, and <span
class="math inline">\(n\)</span> is the number of observations. - <span
class="math inline">\(X\)</span> is an <span
class="math inline">\(n\)</span>-by-p fixed-effects design matrix. -
<span class="math inline">\(\beta\)</span> is a <span
class="math inline">\(p\)</span>-by- 1 fixed-effects vector. - <span
class="math inline">\(Z\)</span> is an <span
class="math inline">\(n\)</span>-by- <span
class="math inline">\(q\)</span> random-effects design matrix. - <span
class="math inline">\(b\)</span> is a <span
class="math inline">\(q\)</span>-by-1 random-effects vector. - <span
class="math inline">\(\varepsilon\)</span> is the <span
class="math inline">\(n\)</span>-by-1 observation error vector.</p>
<p>The random-effects vector, <span class="math inline">\(b\)</span>,
and the error vector, <span class="math inline">\(\varepsilon\)</span>,
are assumed to have the following independent prior distributions: <span
class="math display">\[
\begin{aligned}
&amp; b \sim N\left(0, \sigma^2 D(\theta)\right), \\
&amp; \varepsilon \sim N\left(0, \sigma^2 I\right),
\end{aligned}
\]</span></p>
<p>The maximum likelihood estimation includes both regression
coefficients and the variance components, that is, both fixed-effects
and random-effects terms in the likelihood function.</p>
<p>For a linear mixed-effects model defined above, the conditional
response of the response variable <span class="math inline">\(y\)</span>
given <span class="math inline">\(\beta, b, \theta\)</span>, and <span
class="math inline">\(\sigma^2\)</span> is <span class="math display">\[
y \mid b, \beta, \theta, \sigma^2 \sim N\left(X \beta+Z b, \sigma^2
I_n\right) .
\]</span></p>
<p>The likelihood of <span class="math inline">\(y\)</span> given <span
class="math inline">\(\beta, \theta\)</span>, and <span
class="math inline">\(\sigma^2\)</span> is <span class="math display">\[
P\left(y \mid \beta, \theta, \sigma^2\right)=\int P\left(y \mid b,
\beta, \theta, \sigma^2\right) P\left(b \mid \theta, \sigma^2\right) d
b,
\]</span> where <span class="math display">\[
\begin{aligned}
&amp; P\left(b \mid \theta, \sigma^2\right)=\frac{1}{\left(2 \pi
\sigma^2\right)^{q / 2}|D(\theta)|^{1 / 2}} \exp \left\{-\frac{1}{2
\sigma^2} b^T D^{-1} b\right\} \text { and } \\
&amp; P\left(y \mid b, \beta, \theta, \sigma^2\right)=\frac{1}{\left(2
\pi \sigma^2\right)^{n / 2}} \exp \left\{-\frac{1}{2 \sigma^2}(y-X
\beta-Z b)^T(y-X \beta-Z b)\right\} .
\end{aligned}
\]</span></p>
<p>Suppose <span class="math inline">\(\Lambda(\theta)\)</span> is the
lower triangular Cholesky factor of <span
class="math inline">\(D(\theta)\)</span> and <span
class="math inline">\(\Delta(\theta)\)</span> is the inverse of <span
class="math inline">\(\Lambda(\theta)\)</span>. Then, <span
class="math display">\[
D(\theta)^{-1}=\Delta(\theta)^T \Delta(\theta) .
\]</span></p>
<p>Define <span class="math display">\[
r^2(\beta, b, \theta)=b^T \Delta(\theta)^T \Delta(\theta) b+(y-X \beta-Z
b)^T(y-X \beta-Z b),
\]</span> and suppose <span class="math inline">\(b^*\)</span> is the
value of <span class="math inline">\(b\)</span> that satisfies <span
class="math display">\[
\left.\frac{\partial r^2(\beta, b, \theta)}{\partial b}\right|_{b^*}=0
\]</span> for given <span class="math inline">\(\beta\)</span> and <span
class="math inline">\(\theta\)</span>. Then, the likelihood function is
<span class="math display">\[
P\left(y \mid \beta, \theta, \sigma^2\right)=\left(2 \pi
\sigma^2\right)^{-n / 2}|D(\theta)|^{-1 / 2} \exp \left\{-\frac{1}{2
\sigma^2} r^2\left(\beta, b^*(\beta), \theta\right)\right\}
\frac{1}{\left|\Delta^T \Delta+Z^T Z\right|^{1 / 2}} .
\]</span></p>
<p><span class="math inline">\(\mathrm{P}\left(\mathrm{y} \mid \beta,
\theta, \sigma^2\right)\)</span> is first maximized with respect to
<span class="math inline">\(\beta\)</span> and <span
class="math inline">\(\sigma^2\)</span> for a given <span
class="math inline">\(\theta\)</span>. Thus the optimized solutions
<span class="math inline">\(\widehat{\beta}(\theta)\)</span> and <span
class="math inline">\(\widehat{\sigma}^2(\theta)\)</span> are obtained
as functions of <span class="math inline">\(\theta\)</span>.
Substituting these solutions into the likelihood function produces <span
class="math inline">\(P\left(y \mid \widehat{\beta}(\theta), \theta,
\widehat{\sigma}^2(\theta)\right)\)</span>. This expression is called a
profiled likelihood where <span class="math inline">\(\beta\)</span> and
<span class="math inline">\(\sigma^2\)</span> have been profiled out.
<span class="math inline">\(P\left(y \mid \widehat{\beta}(\theta),
\theta, \widehat{\sigma}^2(\theta)\right)\)</span> is a function of
<span class="math inline">\(\theta\)</span>, and the algorithm then
optimizes it with respect to <span
class="math inline">\(\theta\)</span>. Once it finds the optimal
estimate of <span class="math inline">\(\theta\)</span>, the estimates
of <span class="math inline">\(\beta\)</span> and <span
class="math inline">\(\sigma^2\)</span> are given by <span
class="math inline">\(\widehat{\beta}(\theta)\)</span> and <span
class="math inline">\(\widehat{\sigma}^2(\theta)\)</span>.</p>
<p><strong>Summary</strong></p>
<p>The ML method treats <span class="math inline">\(\beta\)</span> as
fixed but unknown quantities when the variance components are estimated,
but does not take into account the degrees of freedom lost by estimating
the fixed effects. This causes ML estimates to be biased with smaller
variances. However, one advantage of ML over REML is that it is possible
to compare two models in terms of their fixed- and random-effects terms.
On the other hand, if you use REML to estimate the parameters, you can
only compare two models, that are nested in their random-effects terms,
with the same fixed-effects design.</p>
<p><strong>Problem of MLE</strong></p>
<p>Maximum likelihood estimation uses an iterative interactive method to
estimate fixed effects and variance when estimating fixed effects and
random effects (variance components) in a mixed effects model. When
estimating variance, you need a reference point, which is the fixed
effect, such as the mean. Therefore, MLE first estimates the fixed
effects and then estimates the variance components. Use EM or IGLS
iteration method to estimate. Fixed effects are estimated first,
assuming missing variance or random effects for any observations. Then
the variance is estimated based on the fixed effects, and iteratively
until the estimated value no longer changes.</p>
<p>Estimating fixed effects, which means treating the fixed effects as
known and fixed when estimating the variance, will cause two
problems.</p>
<ol style="list-style-type: decimal">
<li>Variation in fixed effects is not considered</li>
<li>Degrees of freedom consumed when estimating fixed effects are not
taken into account</li>
</ol>
<p>When the sample is large, these two problems are not a problem. When
the sample is small, these two problems have a relatively large impact
on the estimated variance. When calculating the population variance of
the mean, use “each X value minus the sum of squares of the population
mean” as the numerator, and the denominator uses N; when calculating the
sample variance, use “each 1 (because the mean is estimated, a penalty
is needed at this time); and ML estimation is similar to the estimation
of the population variance, but in practice the sample mean is used, and
<strong>N is used as the numerator instead of N-1</strong>. The
estimated values are almost the same when the sample is large, but they
are very different when the sample is small. This will lead to a smaller
estimated variance and a smaller standard error of the fixed effects,
leading to an inflated type I error.</p>
</div>
<div id="restricted-maximum-likelihood-reml" class="section level2"
number="1.4">
<h2><span class="header-section-number">1.4</span> Restricted Maximum
Likelihood (REML)</h2>
<p>The idea of Restricted Maximum Likelihood (REML) comes from
realization that the variance estimator given by the Maximum Likelihood
(ML) is biased. What is an estimator and in which way it is biased? An
estimator is simply an approximation / estimate of model parameters.
Assuming that statistical observations follow Normal distribution, there
are two parameters: <span class="math inline">\(\mu\)</span> (mean) and
<span class="math inline">\(\sigma^2\)</span> (variance) to estimate if
one wants to summarize the observations. It turns out that the variance
estimator given by Maximum Likelihood (ML) is biased, i.e. the value we
obtain from the ML model over- or under-estimates the true variance, see
the figure below.</p>
<div class="figure" style="text-align: center">
<img src="02_Plots/MMRM/MMRM_Biased_Variance.png" alt="Figure: Illustration of biased vs. unbiased estimators" width="75%" />
<p class="caption">
Figure: Illustration of biased vs. unbiased estimators
</p>
</div>
<p>REML is similar to the “N-1” version of MLE, with the variance
corrected. REML separates the process of estimating fixed effects and
variance, and can estimate variance more accurately when using small
samples, thus obtaining more accurate standard errors of fixed effects,
thereby controlling type one error inflation.</p>
<ol style="list-style-type: decimal">
<li>The first step in REML is to ignore the hierarchical structure and
first obtain the residuals through ordinary least squares (OLS). The OLS
residuals have the same conditional variance (based on the X variable)
as the original results. When using OLS residuals to estimate variance,
the fixed effects are limited to 0, so there is no need to consider
fixed effects when REML estimates variance components.</li>
<li>The second step is to estimate the fixed effects. GLS is used to
estimate fixed effects through matrix multiplication, that is, the
variance components estimated by REML are put into Generalized least
squares (generalized least squares method) to estimate fixed
effects.</li>
</ol>
<p><strong>In SAS</strong>, Both PROC MIXED and PROC GLIMMIX provide
maximum likelihood estimates (abbreviated MLE) of model effects as well
as REML estimates of variance components. REML default variance
estimation method. ML variance estimates can be obtained by using
METHOD=ML in PROC MIXED or METHOD=MSPL in PROC GLIMMIX. The variance
estimate resulting from the ML variance estimate will be smaller than
the corresponding REML estimate, the resulting confidence interval will
be narrower, and the test statistic will be larger. This reflects the
well-known fact that ML estimates of variance components are biased
downward.</p>
<p>For example, in the one-sample case, when <span
class="math inline">\(y_{1}, y_{2}, \ldots, y_{n}\)</span> is a random
sample from <span class="math inline">\(\mathrm{N}\left(\mu,
\sigma^{2}\right)\)</span>, the ML estimate of the variance is as
follows: <span class="math display">\[
\sum_{i}\left(y_{i}-\bar{y}\right)^{2} / n
\]</span></p>
<p>whereas the sample variance - which is the simplest REML variance
estimate-is as follows: <span class="math display">\[
\sum_{i}\left(y_{i}-\bar{y}\right)^{2} /(n-1)
\]</span> The latter is unbiased and is generally considered the
preferred variance estimate. It can be easily seen that using ML
variance estimation results in increased Type 1 error rates (up to 25%
rejection rate for nominal <span class="math inline">\(a=0.05\)</span>)
and insufficient confidence interval coverage.</p>
<pre><code>proc mixed data=bond method=reml;
 class ingot metal;
 model pres=metal;
 random ingot;
run;

proc glimmix data=bond method=rspl;
 class ingot metal;
 model pres=metal;
 random ingot;
run;</code></pre>
<p><strong>Summary</strong></p>
<p>REML accounts for the degrees of freedom lost by estimating the fixed
effects, and makes a less biased estimation of random effects variances.
The estimates of <span class="math inline">\(\theta\)</span> and <span
class="math inline">\(\sigma^2\)</span> are invariant to the value of
<span class="math inline">\(\beta\)</span> and less sensitive to
outliers in the data compared to ML estimates. However, if you use REML
to estimate the parameters, you can only compare two models that have
the identical fixed-effects design matrices and are nested in their
random-effects terms.</p>
</div>
<div id="small-sample-variance-correction" class="section level2"
number="1.5">
<h2><span class="header-section-number">1.5</span> Small Sample Variance
Correction</h2>
<p>In the case of small samples, the variance component of the fixed
effects (which can be understood as the standard error) is not
accurately estimated, whether it is MLE or REML. Furthermore, when
calculating the p-value of fixed effects, the <strong>fisher information
and central limit theorem (asympotics)</strong> that need to be used
will fail in small samples, resulting in an underestimation of the
variance, thus leading to a type of error inflation.</p>
<ul>
<li>Some scholars pointed out that this problem can be solved using the
Bayesian method (the Bayesian method does not rely on asympotics),</li>
<li>But Kackar-Harville and later Kendward-roger solved it within the
frequentist school by correcting square shame.</li>
</ul>
<div id="kackar-harville-correction" class="section level3"
number="1.5.1">
<h3><span class="header-section-number">1.5.1</span> Kackar-Harville
correction</h3>
<p>Kackar-Harville discovered the following formula, the variance of
fixed effects is equal to the REML variance estimate of the fixed
effects sample estimate plus the small sample bias.</p>
<p><span class="math display">\[
\operatorname{Var}(\gamma)=\operatorname{Var}^{R E M
L}(\hat{\gamma})+\text { Small Sample Bias }
\]</span></p>
<p>A series of studies from KH to KR are aimed at how to estimate small
sample bias. KH found that the estimation of Small sample bias (SSB)
requires the use of the population value of the variance component
(rather than the sample estimate); then they used the Taylor series
expansion method to asymptotically estimate SSB using the sample
estimate of the variance and covariance components. ; Later, Prasad-Rao
and Harville-Jeske further expanded and developed this method based on
KH. So this correction is sometimes called
Prasad-Rao-Jeske-kackar-Harville correction.</p>
</div>
<div id="kendward-roger-correction" class="section level3"
number="1.5.2">
<h3><span class="header-section-number">1.5.2</span> Kendward-Roger
correction</h3>
<p>KR further found that “REML variance estimate of fixed effect sample
estimate” also has problems with small samples, that is, when REML
estimates fixed effects, it directly uses the estimated variance into
the GLS estimation equation to estimate fixed effects. At this time,
there is no Consider the variation of the variance component itself, but
directly treat it as known and fixed.</p>
<p>KR further uses Taylor’s formula expansion to estimate “REML variance
estimates of fixed effects sample estimates”, taking into account the
fact that the variance components when estimating fixed effects are
estimates and are not known. In the case of small samples, the t test is
used instead of the Z test (the multivariate case corresponds to the
chi-square test instead of the F test).</p>
<ul>
<li>The first step is equivalent to giving an accurate estimate of the
residuals in “t=fixed effects/residuals”</li>
<li>The second step is to calculate the exact degrees of freedom. In
mixed effects models, the calculation formula for the degrees of freedom
often does not exist, and it is difficult to estimate the accurate
degrees of freedom. KR uses the moment estimation matching procedure
(method of moments matching procedure), and the estimation at this time
is more accurate, sometimes even with fractional degrees of
freedom.</li>
</ul>
</div>
</div>
<div id="test-of-fixed-effects" class="section level2" number="1.6">
<h2><span class="header-section-number">1.6</span> Test of Fixed
Effects</h2>
<p>Tests of fixed effects are typically done with either Wald or
likelihood ratio (LRT) tests. With the <strong>assumptions of asymptotic
distributions and independent predictors</strong>, Wald and LRT tests
are equivalent. How large the data set needs to be for the asymptotic
distribution to be a good approximation depends not only on how many
observations you have, but also on the response variable type and the
size of subgroups of observations formed by the categorical variables in
the model. With a continuous response variable in a linear mixed model,
subgroup sizes as small as five may be enough for the Wald and LRT to be
similar. When the response is an indicator variable and the proportion
of events of interest is small, groups size of one hundred may not be
large enough for the Wald and LRT results to be similar.</p>
<p>When a data set size is not large enough to be a good approximation
of the asymptotic distribution or there is some correlation amongst the
predictors, the Wald and LRT test results can vary considerably.</p>
<ul>
<li>Wald test. Tests of the effect size which is scaled using the
estimated standard error.</li>
<li>LRT (Likelihood Ratio Test.) Tests the difference in two nested
models using the Chi square distribution.</li>
</ul>
<p><strong>Test if coefficients are zero</strong></p>
<ul>
<li><p>Wald test. Tests of the effect size which is scaled using the
estimated standard error.</p></li>
<li><p>LRT (Likelihood Ratio Test.) Tests the difference in two nested
models using the Chi square distribution.</p></li>
<li><p>KRmodComp. For linear mixed models with little correlation among
predictors, a Wald test using the approach of Kenward and Rogers (1997)
will be quite similar to LRT test results. The function is only
available for linear mixed models (does not support glmer() models.) An
F test of nested models with an estimated degrees of freedom. The
KRmodcomp() function estimates which F-test distribution is the best
distribution from the family of F distributions. This function addresses
the degrees of freedom concern.</p></li>
<li><p>Profiled confidence interval. While not a formal test, an
interval which does not contain zero indicates the parameter is
significant. The profiled confidence interval of a parameter is
constructed by holding all other model parameters constant and then
examining the likelihood of the the single parameter individually. If
the parameter being profiled is correlated with other parameters, the
profiled confidence interval assumption of the other parameters being
held constant could affect the estimated interval.</p></li>
<li><p>Parametric bootstrap. Assumes the model which restricts a
parameter to zero (null model) is the true distribution and generates an
empirical distribution of the difference in the two models. The observed
coefficient is tested against the generated empirical
distribution.</p></li>
</ul>
<div id="wald-test" class="section level3" number="1.6.1">
<h3><span class="header-section-number">1.6.1</span> Wald Test</h3>
<p>The Wald test is based only on estimates from the model being
evaluated. This results in an implied assumption that a model which
holds the parameter being tested to zero will be the same with the
exception of the parameter which is being tested. Correlation between
the tested predictor and the other model predictors, can cause the
estimate made from the model including the parameter to be different
from a model which holds the parameter to zero. A Walt test is done by
comparing the coefficient’s estimated value with the estimated standard
error for the coefficient.</p>
<ul>
<li><span class="math inline">\(H_{0}: \beta_{j}=d_{j}\)</span></li>
<li><span class="math inline">\(H_{1}: \beta_{j} \neq
d_{j}\)</span></li>
</ul>
<p>A more general form of linearity assumption</p>
<p><span class="math display">\[
H_{0}: \boldsymbol{C} \boldsymbol{\beta}=\boldsymbol{d} \text { vs }
H_{1}: \boldsymbol{C} \boldsymbol{\beta} \neq \boldsymbol{d}
\]</span> Where <span class="math display">\[W=(\boldsymbol{C}
\hat{\boldsymbol{\beta}}-\boldsymbol{d})^{\prime}\left(\boldsymbol{C}^{\prime}
\boldsymbol{A}_{11} \boldsymbol{C}\right)^{-1}(\boldsymbol{C}
\hat{\boldsymbol{\beta}}-\boldsymbol{d})\]</span> The approximate
covariance matrices are given by <span
class="math display">\[\widehat{\operatorname{Cov}}(\hat{\boldsymbol{\beta}})=\boldsymbol{A}_{11}=\left\{\sum_{i=1}^{m}
\boldsymbol{X}_{i}^{\prime} \hat{\boldsymbol{V}}_{i}^{-1}
\boldsymbol{X}_{i}\right\}^{-1}\]</span></p>
</div>
<div id="likelihood-ratio-test" class="section level3" number="1.6.2">
<h3><span class="header-section-number">1.6.2</span> Likelihood Ratio
Test</h3>
<p>The LRT requires the formal estimation of a model which restricts the
parameter to zero and therefore accounts for correlation in its test.
The Likelihood Ratio Test (LRT) of fixed effects requires the models be
fit with by MLE (use REML=FALSE for linear mixed models.) The LRT of
mixed models is only approximately χ2 distributed.</p>
<p>In SS, the “Null Model Likelihood Ratio Test” is a likelihood ratio
test of whether the model with the specified covariance fits better than
a model with errors- that is, with <span
class="math inline">\(\boldsymbol{\Sigma}=\sigma^2 \mathrm{I}\)</span>.
The <span class="math inline">\(p\)</span>-value <span
class="math inline">\(&lt;.0001\)</span> shows that the iid <span
class="math inline">\(N\left(0, \sigma^2 \mathbf{I}\right)\)</span>
model is clearly inadequate.</p>
</div>
</div>
<div id="test-of-random-parameters" class="section level2" number="1.7">
<h2><span class="header-section-number">1.7</span> Test of Random
Parameters</h2>
<p><strong>Test variance parameter is equal to 0</strong>, The test
which are in common use for the variance parameter are listed from least
efficient to most efficient.</p>
<ul>
<li>LRT (Likelihood Ratio Test): The variance parameter of a generalized
mixed models does not have a known asymptotic distribution. The LRT for
these variance parameters at times can be poor estimates. We recommend
treating these p-values with caution. The LRT test of a variance
parameter equalling zero will be conservative (larger <span
class="math inline">\(p\)</span>-value). This is due to the test being
on a boundary condition <span class="math inline">\(\left(\sigma^2 \geq
0\right)\)</span>. Thus if the <span
class="math inline">\(p\)</span>-value is small enough to be significant
with the LRT test, your finding is likely good. There are some areas
were twice the LRT p-value is used as a formal test. We do not recommend
this for variance of generalized mixed models since the <span
class="math inline">\(p\)</span>-value can be a poor estimate at times.
As example to test random variable g2 in R</li>
</ul>
<pre class="r"><code>gmmG2 &lt;- glmer(bin ~ x1 + x2 + (1|g1) + (1|g2), family=binomial, data=pbDat)
# LRT calculated using the loglik() function
G2 = -2 * logLik(gmm) + 2 * logLik(gmmG2)
pchisq(as.numeric(G2), df=1, lower.tail=F)</code></pre>
<ul>
<li><p>Profiled confidence interval: While not a formal test, an
interval which does not contain zero indicates the parameter is
significant.</p></li>
<li><p>Test based on Crainiceanu, C. and Ruppert, D. ( 2004 ) for linear
mixed models. There is no equivalent for generalized mixed models. The
variance parameters of the model must be uncorrelated. There is no
equivalent function for when the random variables are correlated, such
as with hierarchical models. In R, the exactRLRT() function is an
implementation of Crainiceanu and Ruppert. See <a
href="https://www.ssc.wisc.edu/sscc/pubs/MM/MM_TestEffects.html">Example</a></p></li>
<li><p>Parametric bootstrap. Assumes the model which restricts a
parameter to zero (null model) is the true distribution and generates an
empirical distribution of the difference in the two models. The observed
coefficient is tested against the generated empirical
distribution.</p></li>
</ul>
</div>
<div id="covarianceresidual-structure" class="section level2"
number="1.8">
<h2><span class="header-section-number">1.8</span> Covariance/Residual
Structure</h2>
<p>In the simplest setting of a standard linear regression model, we
have constant variance and no covariance.</p>
<p>However, since mixed models have two sources of variability (within
and between-subjects) different types of residuals may be defined and
the corresponding analysis is more complex.</p>
<p><strong>Homogeneous Variance</strong></p>
<p><span class="math display">\[
\Sigma =
\left[
\begin{array}{ccc}
\sigma^2 &amp; 0   &amp; 0   \\
0   &amp; \sigma^2 &amp; 0   \\
0   &amp; 0   &amp; \sigma^2 \\
\end{array}\right]
\]</span></p>
<div class="figure" style="text-align: center">
<img src="02_Plots/MMRM/MMRM_Residual_Structure.png" alt="Figure: Residual Structure in the mixed model" width="100%" />
<p class="caption">
Figure: Residual Structure in the mixed model
</p>
</div>
<p>Each block represents the covariance matrix associated with
within-individual observations. Within subject, there is variance on the
diagonal and covariance on the off-diagonal. When considering the entire
data, we can see that one subject’s observations have no covariance with
the other (grey). Furthermore, the within-subjectcovariance is a
constant value and the variance is also a constant value.</p>
<p><strong>Heterogeneous Variance</strong></p>
<p>Relax the assumption of equal variances and estimate separately. For
example, in the case of this heterogeneous variance, we might see more
or less variation over time</p>
<p><span class="math display">\[
\Sigma =
\left[
\begin{array}{ccc}
\sigma_1^2 &amp; 0   &amp; 0   \\
0   &amp; \sigma_2^2 &amp; 0   \\
0   &amp; 0   &amp; \sigma_3^2 \\
\end{array}\right]
\]</span> <strong>Covariance Structure of Compound Symmetry
</strong></p>
<p>More generally, referring to the previous estimated variance sign, we
can see that the covariance matrix (for clusters) is as follows.
(covariance structure of compound symmetry)</p>
<p>the model with compound symmetric (or exchangeable)
variance-covariance matrix of the error terms. In this matrix, all
variances are assumed to be equal to <span
class="math inline">\(\sigma^{2}\)</span>, and all correlations are
assumed to be equal to <span class="math inline">\(\rho\)</span>. That
is, the matrix has the form:</p>
<p><span class="math display">\[
\sigma^{2}\left[\begin{array}{ccccc}
1 &amp; \rho &amp; \rho &amp; \ldots &amp; \rho \\
\rho &amp; 1 &amp; \rho &amp; \ldots &amp; \rho \\
\rho &amp; \rho &amp; 1 &amp; \ldots &amp; \rho \\
\ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots \\
\rho &amp; \rho &amp; \rho &amp; \ldots &amp; 1
\end{array}\right]
\]</span></p>
<p>This variance-covariance structure is more suitable for repeated
measures across treatment conditions (rather than longitudinally), since
all observations are assumed to be equally correlated</p>
<p><strong>ARMA (1,1) Structure</strong></p>
<p>Model has the blocks in the variance-covariance matrix that have
constant values on each of the descending diagonals, that is, the matrix
has the form:</p>
<p><span class="math display">\[
\left[\begin{array}{ccccc}
\sigma^{2} &amp; \sigma_{1} &amp; \sigma_{2} &amp; \ldots &amp;
\sigma_{p-1} \\
\sigma_{1} &amp; \sigma^{2} &amp; \sigma_{1} &amp; \ldots &amp;
\sigma_{p-2} \\
\sigma_{2} &amp; \sigma_{1} &amp; \sigma^{2} &amp; \ldots &amp;
\sigma_{p-3} \\
\ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots \\
\sigma_{p-1} &amp; \sigma_{p-2} &amp; \sigma_{p-3} &amp; \ldots &amp;
\sigma^{2}
\end{array}\right]
\]</span></p>
<p>Using this structure implies that observations that are the same
number of time points apart are equally correlated. There are a total of
<span class="math inline">\(p\)</span> unknown parameters <span
class="math inline">\(\sigma^{2}, \sigma_{1}, \ldots, \sigma_{p-1}
.\)</span> This model is said to have the Toeplitz covariance structure,
which is sometimes referred to as an autoregressive-moving average <span
class="math inline">\(\operatorname{ARMA}(1,1)\)</span> structure.</p>
<p>Another model with useful structure of the variance-covariance matrix
relies on the fact that typically as time goes on, observations become
less correlated with the earlier ones. In this model, each block in the
variance-covariance matrix has <span class="math inline">\(\sigma^{2}
\rho^{\left|t_{i}-t_{j}\right|}\)</span> in the <span
class="math inline">\(i j\)</span> -th cell, <span
class="math inline">\(i, j=1, \ldots, p\)</span>, that is, it looks like
this:</p>
<p><span class="math display">\[
\sigma^{2}\left[\begin{array}{ccccc}
1 &amp; \rho^{\left|t_{1}-t_{2}\right|} &amp;
\rho^{\left|t_{1}-t_{3}\right|} &amp; \ldots &amp;
\rho^{\left|t_{1}-t_{p}\right|} \\
\rho^{\left|t_{1}-t_{2}\right|} &amp; 1 &amp;
\rho^{\left|t_{2}-t_{3}\right|} &amp; \ldots &amp;
\rho^{\left|t_{2}-t_{p}\right|} \\
\rho^{\left|t_{1}-t_{3}\right|} &amp; \rho^{\left|t_{2}-t_{3}\right|}
&amp; 1 &amp; \ldots &amp; \rho^{\left|t_{3}-t_{p}\right|} \\
\ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots \\
\rho^{\left|t_{1}-t_{p}\right|} &amp; \rho^{\left|t_{2}-t_{p}\right|}
&amp; \rho^{\left|t_{3}-t_{p}\right|} &amp; \ldots &amp; 1
\end{array}\right]
\]</span></p>
<p>Here <span class="math inline">\(\sigma^{2}\)</span> and <span
class="math inline">\(\rho\)</span> are the unknown constants, <span
class="math inline">\(|\rho|&lt;1\)</span>. Note that in this matrix the
entries decrease as the distance between times <span
class="math inline">\(t_{i}\)</span> and <span
class="math inline">\(t_{j}\)</span> increases.</p>
<p><strong>Autocorrelation Structure</strong></p>
<p>A special case of this model is when the times are equal to <span
class="math inline">\(\$ 1,2,3\)</span>, Vidots, <span
class="math inline">\(\mathrm{p} \$\)</span>. Then the $p <span
class="math inline">\(\mathrm{p}\)</span> $ blocks of the
variance-covariance matrix become:</p>
<p><span class="math display">\[
\sigma^{2}\left[\begin{array}{ccccc}
1 &amp; \rho &amp; \rho^{2} &amp; \ldots &amp; \rho^{p-1} \\
\rho &amp; 1 &amp; \rho &amp; \ldots &amp; \rho^{p-2} \\
\rho^{2} &amp; \rho &amp; 1 &amp; \ldots &amp; \rho^{p-3} \\
\ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots \\
\rho^{p-1} &amp; \rho^{p-2} &amp; \rho^{p-3} &amp; \ldots &amp; 1
\end{array}\right]
\]</span></p>
<p>This model is said to have an autoregressive variance-covariance
structure of the error terms, referring to an AR(1) model, an
autoregressive time series model with lag one that has the same
covariance structure. Note that the autoregressive matrix is a special
case of both Toeplitz and spatial power matrices.</p>
<p><strong>Unstructured Covariance</strong></p>
<p>The most general is an unstructured one with an <span
class="math inline">\(n p \times n p\)</span> block-diagonal matrix with
<span class="math inline">\(n\)</span> identical blocks of size <span
class="math inline">\(p \times p\)</span> of the form:</p>
<p><span class="math display">\[
\left[\begin{array}{ccccc}
\sigma_{1}^{2} &amp; \sigma_{12} &amp; \sigma_{13} &amp; \ldots &amp;
\sigma_{1 p} \\
\sigma_{12} &amp; \sigma_{2}^{2} &amp; \sigma_{23} &amp; \ldots &amp;
\sigma_{2 p} \\
\sigma_{13} &amp; \sigma_{23} &amp; \sigma_{3}^{2} &amp; \ldots &amp;
\sigma_{3 p} \\
\ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots \\
\sigma_{1 p} &amp; \sigma_{2 p} &amp; \sigma_{3 p} &amp; \ldots &amp;
\sigma_{p}^{2}
\end{array}\right]
\]</span></p>
<ul>
<li>If the size of the dataset allows, a model with an
<strong>unstructured variance-covariance</strong> matrix with error
terms should be used. The model makes no assumptions about the structure
and allows the estimation of each parameter to take its own value.</li>
<li>If the size of the dataset is too small to fit in a general
unstructured variance-covariance matrix, there are several
<strong>sparse</strong> but meaningful structures to try.</li>
</ul>
<p><strong>Selecting an Appropriate Covariance Model</strong></p>
<p>It needs an appropriate covariance model in order to draw accurate
conclusions from repeated measures data. If you ignore important
correlation by using a model that is too simple, you risk increasing the
Type I error rate and underestimating standard errors. If the model is
too complex, you sacrifice power and efficiency. Guerin and Stroup
(2000) documented the effects of various covariance modeling decisions
using PROC MIXED for repeated measures data. Their work supports the
idea that repeated measures analysis is robust as long as the covariance
model used is approximately correct. Inference is severely compromised
by a blatantly poor choice of the covariance model.</p>
<p>There are two types of tools to help you select a covariance
model.</p>
<ol style="list-style-type: decimal">
<li>First are <strong>graphical tools</strong> to help visualize
patterns of correlation between observations at different times.</li>
<li>Second are <strong>information criteria</strong> that measure the
relative fit of competing covariance models. As noted at the end of the
last section, these methods work best when you first rule out covariance
structures that are obviously inconsistent with the characteristics of
the data you are analyzing.</li>
</ol>
</div>
<div id="converge-problems" class="section level2" number="1.9">
<h2><span class="header-section-number">1.9</span> Converge
Problems</h2>
<p>The model cannot converge. At this time, the model needs to be
simplified to make it converge: For the problem that the model cannot
converge, first of all, the model we finally select must meet two
standards:</p>
<ol style="list-style-type: decimal">
<li>It can converge;</li>
<li>It cannot be overfitted.</li>
</ol>
<p><strong>Deal with Converge</strong></p>
<ul>
<li>Increase the number of iterations of the model: Regardless of
whether the entire model can converge after increasing the number of
iterations, check its random effects</li>
</ul>
<p><strong>Overfitting</strong></p>
<p>Regardless of whether the entire model can converge after increasing
the number of iterations, check its random effects</p>
<ol style="list-style-type: decimal">
<li>Delete the highest-order interaction first, because as long as there
is the highest-order interaction, deleting other interactions has no
effect on the model (Barr D. J., 2013);</li>
<li>After deleting the interaction, if convergence still cannot be
achieved, please continue deleting. At this time, if the Corr of the two
main effects is greater than 0.9, please delete the one with the larger
Corr first;</li>
<li>If convergence still cannot occur after deleting the larger main
effect, retain the main effect with larger Corr and delete the main
effect with smaller Corr (if the Corr of both main effects is greater
than 0.9, they cannot be deleted directly because the random slopes
interact with each other. If one is deleted, the other Corr will change
accordingly), and so on, until a model that meets the above two criteria
is explored.</li>
</ol>
</div>
<div id="basic-concepts-of-blue-blup" class="section level2"
number="1.10">
<h2><span class="header-section-number">1.10</span> Basic Concepts of
BLUE &amp; BLUP</h2>
<p>The basic form of a linear mixed model is <span
class="math display">\[
Y_j=\sum_i \beta_i X_{j i}+\sum_k u_k Z_{j k}+e_j
\]</span> where * <span class="math inline">\(Y_j\)</span> is the <span
class="math inline">\(j^{\text {th }}\)</span> observation * <span
class="math inline">\(\beta_i\)</span> are fixed effect parameters *
<span class="math inline">\(X_{j i}\)</span> are constants associated
with the fixed effects * <span class="math inline">\(u_k\)</span> are
random effects * <span class="math inline">\(Z_{j k}\)</span> are
constants associated with the random effects * <span
class="math inline">\(e_j\)</span> is the <span
class="math inline">\(j^{\text {th }}\)</span> residual error</p>
<p>Alternatively, can be written as the mixed model in matrix form as
<span class="math inline">\(\mathbf{Y}=\mathbf{X}
\boldsymbol{\beta}+\mathbf{Z u}+\mathbf{e}\)</span>.</p>
<p>The expected value of an observation is <span class="math display">\[
\mathrm{E}[\mathbf{Y}]=\mathrm{E}[\mathbf{X}
\boldsymbol{\beta}+\mathbf{Z u}+\mathbf{e}]=\mathbf{X}
\boldsymbol{\beta}
\]</span> since the expected values of the random effect vector <span
class="math inline">\(\mathbf{u}\)</span> and the error vector <span
class="math inline">\(\mathbf{e}\)</span> are 0 . This is called the
<strong>unconditional expectation</strong>, or the mean of <span
class="math inline">\(\mathbf{Y}\)</span> averaged over all possible
<span class="math inline">\(\mathbf{u}\)</span>. The subtlety of this
quantity is important: in practical terms, the observed levels of the
random effects are a random sample of a larger population. The
unconditional expectation is the mean of <span
class="math inline">\(\mathbf{Y}\)</span> over the entire
population.</p>
<p>The conditional expectation of <span
class="math inline">\(\mathbf{Y}\)</span> given <span
class="math inline">\(\mathbf{u}\)</span>, denoted <span
class="math inline">\(\mathrm{E}[\mathbf{Y} \mid \mathbf{u}]\)</span>,
is <span class="math display">\[
\mathbf{E}[\mathbf{Y} \mid \mathbf{u}]=\mathbf{X}
\boldsymbol{\beta}+\mathbf{Z u}
\]</span></p>
<p>In practical terms, this is the mean of Y for the specific set of
levels of the random effect actually observed.</p>
<p><strong>The unconditional mean is thus a population-wide average,
whereas the conditional mean is an average specific to an observed set
of random effects.</strong> Because the set of observed levels of the
random factors is not an exact duplicate of the entire population, the
conditional and unconditional means are not equal, in general.</p>
<p>Linear combinations of fixed effects, denoted <span
class="math inline">\(\Sigma_i \mathbf{K}_i
\boldsymbol{\beta}_i\)</span>, are called estimable functions if they
can be constructed from a linear combination of unconditional means of
the observations. That is, if <span
class="math inline">\(\mathbf{K}^{\prime}
\boldsymbol{\beta}=\mathbf{T}^{\prime} E[\mathbf{Y}]=\mathbf{T}^{\prime}
\mathbf{X} \boldsymbol{\beta}\)</span> for some <span
class="math inline">\(\mathbf{T}\)</span>, then it is estimable.
Quantities such as regression coefficients, treatment means, treatment
differences, contrasts, and simple effects in factorial experiments are
all common examples of estimable functions.</p>
<p>Estimable functions do not depend on the random effects. A
generalization of the estimable function is required for such cases.
Linear combinations of the fixed and random effects, <span
class="math inline">\(\mathbf{K}^{\prime}
\boldsymbol{\beta}+\mathbf{M}^{\prime} \mathbf{u}\)</span>, can be
formed from linear combinations of the conditional means. Such linear
combinations are called predictable functions. A function <span
class="math inline">\(\mathbf{K}^{\prime}
\boldsymbol{\beta}+\mathbf{M}^{\prime} \mathbf{u}\)</span> is
predictable if its <span class="math inline">\(\mathbf{K}^{\prime}
\boldsymbol{\beta}\)</span> component is estimable.</p>
<p>Using the mixed model equation solution for <span
class="math inline">\(\boldsymbol{\beta}\)</span> in an estimable
function results in the <strong>best linear unbiased estimate
(BLUE)</strong> of <span class="math inline">\(\mathbf{K}^{\prime}
\boldsymbol{\beta}\)</span>. For predictable functions, the solutions
for <span class="math inline">\(\boldsymbol{\beta}\)</span> and <span
class="math inline">\(\mathbf{u}\)</span> provide the <strong>best
linear unbiased predictor (BLUP)</strong> of <span
class="math inline">\(\mathbf{K}^{\prime}
\boldsymbol{\beta}+\mathbf{M}^{\prime} \mathbf{u}\)</span>.</p>
<p>To summarize, linear combinations of fixed effects only are called
estimable functions. The solution of the mixed model equations results
in estimates, or BLUEs, of <span
class="math inline">\(\mathbf{K}^{\prime} \boldsymbol{\beta}\)</span>.
Linear combinations of fixed and random effects are called predictable
functions. Solving the mixed model equations yields predictors, or
BLUPs, of <span class="math inline">\(\mathbf{K}^{\prime}
\boldsymbol{\beta}+\mathbf{M}^{\prime} \mathbf{u}\)</span>.</p>
</div>
</div>
<div id="missing-data-in-mmrm" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Missing Data in
MMRM</h1>
<p>MMRM is an advanced extension of the analysis of covariance (ANCOVA)
tailored for repeated assessments in clinical trials. It specifically
addresses the scenario where data may be missing from subjects who drop
out before the study concludes.</p>
<ul>
<li><strong>Treatment Group Differences:</strong> MMRM estimates
differences between treatment groups at the primary endpoint, typically
the final visit of the treatment phase, while utilizing all available
data, including that from subjects who dropped out early.</li>
<li><strong>Assumption of Data:</strong> The model operates under the
assumption that data is missing at random (MAR), which simplifies the
handling of incomplete data sets.</li>
<li><strong>Model Configuration:</strong> MMRM is a specific form of the
mixed linear model, often implemented without random effects. It treats
the timing of post-baseline visits as categorical variables and imposes
a structure on the variance-covariance pattern across these visits.</li>
<li><strong>Variance-Covariance Structure:</strong> An unstructured
variance-covariance pattern is preferred due to its minimal assumptions,
enhancing the model’s flexibility in estimating outcomes at each visit.
However, this choice may sometimes lead to issues with model
convergence.</li>
<li><strong>Planning and Backup:</strong> The variance-covariance
pattern must be specified in the analysis plan, with an alternative
pattern pre-specified in case the primary model fails to converge.</li>
<li><strong>Preliminary Data Analysis:</strong> Before starting the
analysis, it’s crucial to assess the amount and pattern of missing data
through appropriate descriptive displays.</li>
<li><strong>Extension to Binary Data:</strong> For repeated binary
outcomes, an extension of MMRM can be implemented using a Generalized
Linear Mixed Model (GLMM), which typically assumes that data are missing
completely at random (MCAR). Despite this assumption, the estimates from
GLMM can remain robust even with mild deviations from MCAR.</li>
<li><strong>Sensitivity Analysis:</strong> Sensitivity analysis should
be pre-planned to test the robustness of the study findings against the
assumptions of MAR</li>
</ul>
<div id="introduction-1" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Introduction</h2>
<p>Mixed linear models represent a comprehensive family of
likelihood-based models that estimate linear functions of correlated
data. These models uniquely blend fixed and random effects to evaluate
repeated measurements, making them particularly useful in contexts where
the data points are interrelated within subjects over time. Such models
are invaluable in handling incomplete data sets, common in scenarios
where patients might discontinue a study. The concept of “mixed model
for repeated measures” (MMRM), as introduced by Mallinckrodt et al., is
a specialized adaptation within this family designed to compare
treatment groups at the final time point of a clinical trial with
minimal assumptions about the trends in the outcome measure
(Mallinckrodt et al., 2003; 2008).</p>
<p>Traditional approaches to modeling repeated measurements often
involve fitting linear or quadratic regression slopes to time-series
data. This method, however, presupposes the accuracy of the modeled
slope as the true trajectory of symptom progression, a significant
assumption that can be problematic in clinical trials seeking regulatory
approval. Unlike these approaches, MMRM categorizes time as a
classification variable, avoiding assumptions about the progression
pattern over time. The model leverages the intrinsic mixed model
functionality to account for correlations between repeated visits, using
these estimated correlations to infer outcomes at the primary endpoint,
even in the presence of missing data from patient dropouts.</p>
<p>Historically, the analysis of covariance with last observation
carried forward (LOCF) imputation was the standard for analyzing primary
continuous outcomes in FDA new drug applications. However, the LOCF
method often assumes no subsequent change post-discontinuation, which
can inadvertently bias results in favor of the experimental arm. MMRM,
by assuming that missing data are missing at random (MAR), generally
provides less biased estimates at crucial endpoints compared to LOCF
(Mallinckrodt et al., 2001a; 2001b; 2004; Siddiqui et al., 2009).</p>
<p>MMRM shares structural similarities with ANCOVA, making it
straightforward to describe, present, and interpret results. This
similarity has been emphasized in the FDA-endorsed National Research
Council report on the prevention and treatment of missing data, which
highlights the importance of choosing interpretable methods for handling
missing data (National Research Council, 2010).</p>
<p>In addition to handling continuous outcomes, MMRM can be adapted for
binary data, such as responder or relapse status, by employing a
generalized linear mixed model (GLMM) approach. This adaptation allows
for the computation of odds ratios (ORs) comparing treatment effects at
the final study visit.</p>
</div>
<div id="mixed-model-and-mmrm" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Mixed Model and
MMRM</h2>
<p>Consider a clinical trial dataset where each participant <span
class="math inline">\(i\)</span> is subject to multiple post-baseline
assessments. While all participants follow a standardized visit
schedule, instances of missing measurements arise due to “skipped”
visits or premature trial discontinuation.</p>
<p>For a continuous outcome variable <span
class="math inline">\(y\)</span> for subject <span
class="math inline">\(i\)</span> at visit <span
class="math inline">\(j\)</span> under treatment <span
class="math inline">\(t\)</span>, the model is formulated as: <span
class="math display">\[ y_{ij} = \beta_{0jt} + \sum_{s} x_{ijs} \beta_s
+ e_{ij} \]</span> where: - <span
class="math inline">\(\beta_{0jt}\)</span> represents the interaction
term between visit and treatment, - <span
class="math inline">\(\beta_1\)</span> to <span
class="math inline">\(\beta_s\)</span> are coefficients for explanatory
variables <span class="math inline">\(x_1\)</span> to <span
class="math inline">\(x_s\)</span>, - <span
class="math inline">\(e_{ij}\)</span> denotes the residuals.</p>
<p>Explanatory variables can either be consistent across all visits for
a subject or vary between visits. Using matrix notation for clarity, the
model for all observations across subjects is expressed as: <span
class="math display">\[ Y = X\beta + e \]</span> where: - <span
class="math inline">\(Y\)</span> is the vector of outcomes for each
visit, - <span class="math inline">\(X\)</span> is the matrix of
explanatory variables (including visit, treatment, and interactions), -
<span class="math inline">\(\beta\)</span> represents fixed regression
coefficients, - <span class="math inline">\(e\)</span> is the vector of
residuals.</p>
<p>In a standard linear model, observations are considered independent,
leading to a simplified variance-covariance matrix: <span
class="math display">\[ V = \sigma^2 I_{NJ} \]</span> However, because
repeated measures within a subject are correlated, a mixed effects model
is more appropriate: <span class="math display">\[ Y = X\beta + Z\gamma
+ e \]</span> Here: - <span class="math inline">\(\gamma\)</span> is a
vector of random parameters, - <span class="math inline">\(Z\)</span> is
the design matrix for random effects, - <span
class="math inline">\(G\)</span> and <span
class="math inline">\(R\)</span> are the variance-covariance matrices
for <span class="math inline">\(\gamma\)</span> and <span
class="math inline">\(e\)</span>, respectively.</p>
<p>The overall variance-covariance matrix of outcomes <span
class="math inline">\(Y\)</span> is: <span class="math display">\[ V =
ZGZ^T + R \]</span></p>
<p>MMRM focuses on the correlation of errors within a subject without
incorporating random effects, making it distinct within mixed models:
<span class="math display">\[ \Omega_i = R_i \ \text{(for all i)}
\]</span> where <span class="math inline">\(R_i\)</span> defines the
covariance structure of residuals for subject <span
class="math inline">\(i\)</span>.</p>
<p>Each <span class="math inline">\(R_i\)</span> forms a block in the
overall diagonal matrix <span class="math inline">\(R\)</span>, aligning
with the data’s structure per subject. The matrix <span
class="math inline">\(R\)</span> is customized per the data’s needs
(discussed in Section 5.2.2), and parameters are estimated using
Restricted Maximum Likelihood (REML).</p>
</div>
<div id="covariance-structures" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Covariance
Structures</h2>
<p>Covariance Structures When choosing a covariance matrix R, there are
several options available. It might seem tempting to delay selecting a
covariance structure until the end of a study to find the best fit for
the data. However, this approach might be considered data dredging, as
it seeks to favorably adjust the results for the test treatment. To
avoid this bias, it is crucial to specify the covariance structure
beforehand in the study’s protocol or analysis plan. In regulatory
contexts, pre-defining the covariance structure is mandatory.</p>
<p>Key Considerations for Covariance Structures Two main considerations
are crucial when selecting a covariance structure: 1. The ability to
accurately represent correlations between measurements while minimizing
assumptions. 2. Ensuring that the chosen covariance structure allows for
convergence in the MMRM (Mixed Models for Repeated Measures) model.</p>
<p>Common Covariance Structures Several covariance structures are
commonly used:</p>
<ul>
<li><strong>Unstructured</strong>: This structure assumes each visit has
a unique variance, and each pair of visits has a distinct correlation,
making it a highly flexible option that is preferred if convergence is
not an issue. However, it involves estimating a large number of
parameters, which can be problematic with small sample sizes or many
visits.
<ul>
<li>This is the most flexible covariance structure where each pair of
visits can have a unique covariance, and each visit can have a unique
variance. The matrix for this pattern, when there are four visits, might
look like this: <span class="math display">\[
\begin{pmatrix}
\sigma^2_1 &amp; \sigma_{12} &amp; \sigma_{13} &amp; \sigma_{14} \\
\sigma_{12} &amp; \sigma^2_2 &amp; \sigma_{23} &amp; \sigma_{24} \\
\sigma_{13} &amp; \sigma_{23} &amp; \sigma^2_3 &amp; \sigma_{34} \\
\sigma_{14} &amp; \sigma_{24} &amp; \sigma_{34} &amp; \sigma^2_4
\end{pmatrix}
\]</span></li>
<li>Each off-diagonal element <span
class="math inline">\(\sigma_{ij}\)</span> represents the covariance
between the <span class="math inline">\(i\)</span>th and <span
class="math inline">\(j\)</span>th visits, and each diagonal element
<span class="math inline">\(\sigma^2_i\)</span> is the variance at the
<span class="math inline">\(i\)</span>th visit.</li>
</ul></li>
<li><strong>Toeplitz and Heterogeneous Toeplitz</strong>: These
structures are useful as backup options if the unstructured pattern
fails to converge. The Toeplitz pattern assumes equal variance across
visits and consistent correlations for visits equally spaced apart,
which can help in convergence due to fewer parameters required. The
heterogeneous Toeplitz variant allows for different variances across
visits, adding flexibility.
<ul>
<li><strong>Toeplitz (TOEP)</strong>:
<ul>
<li>Assumes a constant variance across all visits and a constant
covariance for visits equally spaced apart. A Toeplitz matrix for four
visits might look like this: <span class="math display">\[
\begin{pmatrix}
\sigma^2 &amp; \rho_1 &amp; \rho_2 &amp; \rho_3 \\
\rho_1 &amp; \sigma^2 &amp; \rho_1 &amp; \rho_2 \\
\rho_2 &amp; \rho_1 &amp; \sigma^2 &amp; \rho_1 \\
\rho_3 &amp; \rho_2 &amp; \rho_1 &amp; \sigma^2
\end{pmatrix}
\]</span></li>
<li>Here, <span class="math inline">\(\sigma^2\)</span> is the common
variance, and <span class="math inline">\(\rho_k\)</span> is the
covariance between visits <span class="math inline">\(k\)</span> steps
apart.</li>
</ul></li>
<li><strong>Heterogeneous Toeplitz (TOEPH)</strong>:
<ul>
<li>Allows for different variances at each visit while maintaining the
Toeplitz structure for covariances: <span class="math display">\[
\begin{pmatrix}
\sigma^2_1 &amp; \rho_1 &amp; \rho_2 &amp; \rho_3 \\
\rho_1 &amp; \sigma^2_2 &amp; \rho_1 &amp; \rho_2 \\
\rho_2 &amp; \rho_1 &amp; \sigma^2_3 &amp; \rho_1 \\
\rho_3 &amp; \rho_2 &amp; \rho_1 &amp; \sigma^2_4
\end{pmatrix}
\]</span></li>
</ul></li>
</ul></li>
<li><strong>Spatial Power and AR(1)</strong>: These patterns are
suitable when visits are not equally spaced, as they consider the time
intervals between visits to model correlations. They generally require
fewer parameters than the unstructured pattern, making them potentially
more robust in studies with many visits.
<ul>
<li><strong>Spatial Power</strong>:
<ul>
<li>The covariances decrease with the increase in time between visits.
For four visits, if <span class="math inline">\(\rho(d_{ij})\)</span>
denotes the correlation based on the distance <span
class="math inline">\(d_{ij}\)</span> between visits <span
class="math inline">\(i\)</span> and <span
class="math inline">\(j\)</span>, the matrix might look like: <span
class="math display">\[
\begin{pmatrix}
\sigma^2 &amp; \rho(d_{12}) &amp; \rho(d_{13}) &amp; \rho(d_{14}) \\
\rho(d_{12}) &amp; \sigma^2 &amp; \rho(d_{23}) &amp; \rho(d_{24}) \\
\rho(d_{13}) &amp; \rho(d_{23}) &amp; \sigma^2 &amp; \rho(d_{34}) \\
\rho(d_{14}) &amp; \rho(d_{24}) &amp; \rho(d_{34}) &amp; \sigma^2
\end{pmatrix}
\]</span></li>
</ul></li>
<li><strong>AR(1)</strong>:
<ul>
<li>Assumes that correlations between visits decrease exponentially with
the number of visits separating them. For four visits, the matrix could
look like: <span class="math display">\[
\begin{pmatrix}
\sigma^2 &amp; \rho &amp; \rho^2 &amp; \rho^3 \\
\rho &amp; \sigma^2 &amp; \rho &amp; \rho^2 \\
\rho^2 &amp; \rho &amp; \sigma^2 &amp; \rho \\
\rho^3 &amp; \rho^2 &amp; \rho &amp; \sigma^2
\end{pmatrix}
\]</span></li>
<li>Here, <span class="math inline">\(\rho\)</span> is the correlation
between consecutive visits, and <span
class="math inline">\(\rho^k\)</span> is the correlation between visits
<span class="math inline">\(k\)</span> intervals apart.</li>
</ul></li>
</ul></li>
</ul>
<p>Specifics of Some Covariance Patterns - <strong>Unstructured
Pattern</strong>: Best for scenarios with no convergence concerns;
allows data-driven estimates with minimal assumptions. Suitable for
clinical trials with fixed visit schedules. - <strong>Toeplitz and
Heterogeneous Toeplitz Patterns</strong>: Good secondary choices if the
unstructured pattern does not converge, with Toeplitz being simpler but
less flexible compared to the heterogeneous variant. - <strong>Spatial
Patterns</strong>: Ideal for trials with uneven visit intervals,
focusing on the time between visits to determine correlations,
potentially offering a more realistic representation of the data.</p>
<p><strong>Note</strong>:</p>
<p>The Toeplitz and Heterogeneous Toeplitz covariance structures are
indeed sensitive to the ordering of data, particularly the sequence in
which visits or measurements occur. This sensitivity arises from the
core assumptions these patterns make about the data:</p>
<ol style="list-style-type: decimal">
<li><strong>Toeplitz Covariance Structure:</strong>
<ul>
<li><strong>Assumption of Stationarity</strong>: The Toeplitz structure
assumes that the covariance between any two measurements depends only on
the time interval or lag between them, not on the specific time points
at which the measurements are taken. This implies that the data must be
ordered in such a way that this assumption holds true across all
intervals. For instance, the correlation between the first and third
time points is assumed to be the same as the correlation between the
second and fourth time points, as long as the interval between these
points is the same.</li>
<li><strong>Sensitivity to Ordering</strong>: If the data are not
ordered chronologically or if the intervals between successive
measurements vary in a way that does not align with the assumptions of
the Toeplitz structure, the resulting covariance estimates may not
accurately reflect the underlying patterns of correlation in the
data.</li>
</ul></li>
<li><strong>Heterogeneous Toeplitz Covariance Structure:</strong>
<ul>
<li><strong>Extension of Toeplitz Assumptions</strong>: While the
Heterogeneous Toeplitz structure allows for different variances at each
time point, it still assumes that the covariance between measurements is
based solely on their intervals. Thus, like the standard Toeplitz
structure, it assumes that all pairs of measurements separated by the
same number of time intervals have the same covariance, regardless of
their absolute positioning in the timeline.</li>
<li><strong>Sensitivity to Ordering and Variance
Considerations</strong>: This structure’s allowance for heterogeneous
variances adds flexibility but does not alleviate the requirement that
data must be properly ordered according to the intervals between
measurements. Misordering can lead to incorrect estimates not only of
the covariances but also of the variances at each time point, given that
each variance parameter is tied to a specific position in the
sequence.</li>
</ul></li>
</ol>
<p><strong>Implications for Data Analysis:</strong></p>
<ul>
<li><strong>Careful Data Preparation</strong>: When using either
Toeplitz or Heterogeneous Toeplitz structures, it is crucial to ensure
that data are ordered correctly and consistently, particularly in
studies where measurements are taken at irregular intervals or where
missing data may disrupt the sequence of intervals.</li>
<li><strong>Model Suitability Evaluation</strong>: Before applying these
structures, researchers should evaluate whether the assumption of
equidistant (or at least pattern-consistent) intervals holds for their
data. If measurements are not equidistant but are assumed to be in the
analysis, the covariance structure may misrepresent the actual
correlations.</li>
</ul>
</div>
<div id="mmrm-versus-gee" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> MMRM versus GEE</h2>
<p>For achieving accurate estimates in Mixed Models for Repeated
Measures (MMRM), selecting the appropriate variance-covariance matrix is
critical. An unstructured pattern, while imposing minimal assumptions
about the correlation structure, may not always be feasible due to its
requirement for large parameter estimates, especially in studies with
numerous time points or small sample sizes. In such cases, choosing a
less flexible covariance structure could lead to bias if it doesn’t
properly represent the underlying correlations among the repeated
measures.</p>
<p><strong>Empirical Sandwich Estimator:</strong> To mitigate the risk
of bias from misspecified covariance structures, regulatory bodies like
the FDA sometimes recommend supplementing primary MMRM analyses with an
empirical sandwich estimator. This estimator provides asymptotically
consistent estimates of the variance-covariance matrix for the fixed
effects, making the fixed effect estimates asymptotically unbiased and
robust against correlation pattern misspecification. However, the
sandwich estimator comes with its own requirements and limitations: -
<strong>Assumption of Missing Completely at Random (MCAR)</strong>: The
data must be MCAR, which is a stronger condition than Missing at Random
(MAR), typically required for model-based estimators. When data are MAR
but not MCAR, using the sandwich estimator can result in biased
analyses. - <strong>Use in Sensitivity Analysis</strong>: Given its
reliance on the MCAR assumption, it’s prudent to use the sandwich
estimator as a secondary analysis in MMRM studies to assess the
robustness of the results obtained from the primary analysis that uses a
structured correlation pattern.</p>
<p><strong>Generalized Estimating Equations (GEE):</strong> -
<strong>Comparison to MMRM</strong>: GEE is another method used for
dealing with repeated measures, particularly with binary outcomes but
also applicable to normally distributed data. Like MMRM utilizing a
sandwich estimator, GEE provides asymptotically unbiased estimates of
the fixed effects under the condition of MCAR. - <strong>Working
Correlation Matrix</strong>: In GEE, the correlation among repeated
measures is captured by a “working” correlation matrix, estimated using
the method of moments. This is analogous to specifying a covariance
structure in MMRM but is termed as a working matrix because it does not
necessarily need to correctly specify the true correlations to achieve
consistency. - <strong>Efficiency and Sample Size</strong>: GEE
typically requires a larger sample size to satisfy its asymptotic
properties compared to MMRM under MAR. If the working correlation matrix
is misspecified, GEE can lose efficiency, leading to wider confidence
intervals and less precise estimates.</p>
<p><strong>Sensitivity Analyses</strong>: - Given the complexities and
assumptions involved with both the sandwich estimator and GEE,
additional sensitivity analyses are often discussed in clinical trial
reports to ensure the robustness and validity of the findings. These
analyses help identify the impact of different assumptions on the
study’s conclusions.</p>
</div>
<div id="mmrm-vs-locf" class="section level2" number="2.5">
<h2><span class="header-section-number">2.5</span> MMRM vs LOCF</h2>
<p>When considering the analysis of longitudinal data in clinical
trials, Mixed Models for Repeated Measures (MMRM) and Last Observation
Carried Forward (LOCF) represent two common approaches. Each has its own
assumptions, strengths, and weaknesses.</p>
<ul>
<li><strong>MMRM</strong> is generally preferred for its flexibility and
ability to handle more complex data structures and missing data
patterns. It is better suited for more rigorous scientific inquiries
where assumptions about data continuity post-dropout are less
realistic.</li>
<li><strong>LOCF</strong> might still be used for its simplicity and
historical precedence in certain regulatory contexts, but it is
typically considered less robust and less reliable for drawing
conclusions about treatment effects, especially in conditions that
evolve over time.</li>
<li>Despite its limitations, <strong>LOCF</strong> has been historically
significant and is still requested by regulatory authorities like the
FDA in some situations. Therefore, including LOCF analyses as a
supplementary descriptive analysis might still be relevant, especially
for conditions that are stable over time.</li>
</ul>
<p><strong>Assumptions and Biases</strong></p>
<ol style="list-style-type: decimal">
<li><strong>Residual Error Normality</strong>:
<ul>
<li>Both MMRM and ANCOVA of LOCF data assume that the residual errors
are normally distributed. This is a common assumption in many
statistical tests to ensure the validity of inference.</li>
</ul></li>
<li><strong>Handling of Missing Data</strong>:
<ul>
<li><strong>MMRM</strong>: Assumes that the missing data are Missing at
Random (MAR). This means that the likelihood of missing data depends on
the observed data but not on the unobserved data.</li>
<li><strong>LOCF</strong>: Assumes that the data after a subject drops
out remain constant over time. This is a strong and often unrealistic
assumption, especially in studies where the condition of subjects is
expected to change over time.</li>
</ul></li>
<li><strong>Bias with MNAR Data</strong>:
<ul>
<li>Both methods are biased if the data are Missing Not at Random
(MNAR); however, simulations suggest that MMRM tends to be less biased
compared to LOCF. This is primarily because MMRM leverages more of the
available data and patterns within it, whereas LOCF ignores any changes
after the point of dropout.</li>
</ul></li>
</ol>
<p><strong>Variance and Error Estimates</strong></p>
<ul>
<li><strong>MMRM</strong> generally produces larger variance estimates
than LOCF. This is because LOCF tends to underestimate standard errors
due to its simplistic assumption about data post-dropout, potentially
leading to misleading confidence intervals and p-values.</li>
<li>In some cases, however, LOCF might show a higher variance than MMRM,
particularly when the last observed values are significantly different
from subsequent values (which are ignored in LOCF but modeled in
MMRM).</li>
</ul>
<p><strong>Treatment Effect Estimates</strong></p>
<ul>
<li><strong>LOCF</strong> can lead to treatment effect estimates that
deviate significantly from those derived under MAR or MCAR assumptions.
The direction of this deviation (whether conservative or
anti-conservative) depends on the nature of the data and the progression
of the condition being studied.</li>
<li><strong>MMRM</strong>, while also requiring correct specification of
the covariance structure for unbiased estimates, tends to maintain a
better control over Type I error rates compared to LOCF, even if the
covariance pattern is misspecified.</li>
</ul>
</div>
<div id="applying-mmrm" class="section level2" number="2.6">
<h2><span class="header-section-number">2.6</span> Applying MMRM</h2>
<p>For an effective analysis, it’s crucial to articulate a clear and
complete description in the statistical analysis plan (SAP) prior to
unblinding the trial. Here’s how MMRM can be framed for a Parkinson’s
disease trial, focusing on changes from baseline in the Unified
Parkinson’s Disease Rating Scale (UPDRS) Total Score at Week 28:</p>
<ul>
<li>Model Description: Utilize a mixed effects ANCOVA model for repeated
measures. The dependent variable is the observed change from baseline
score at each scheduled post-baseline visit (Visits 1 to 8).</li>
<li>Fixed Effects: Include the baseline UPDRS total score as a
covariate, along with categorical factors for geographic region,
treatment group, and visit, plus interactions between baseline × visit
and treatment × visit.</li>
<li>Covariance Structure: Use an unstructured covariance pattern to
estimate the variance–covariance of the within-subject repeated
measures. If this fails to converge, switch to a heterogeneous Toeplitz
covariance pattern.</li>
<li>Parameter Estimation: Employ REML with the Newton–Raphson algorithm,
and use the Kenward–Roger method for calculating denominator degrees of
freedom.</li>
<li>The primary objective is to assess treatment differences at Week 28
using least squares (LS) means derived from the model, testing the
hypothesis that response profiles over time are parallel across
treatment groups.</li>
</ul>
<pre><code>Treatment groups will be compared for the change from baseline in the Unified
Parkinson’s Disease Rating Scale (UPDRS) Total Score at Week 28 using a mixed
effects ANCOVA model for repeated measures (MMRM). The observed change
from baseline score at each scheduled post-baseline visit (Visits 1 to 8) is the
dependent variable. The model will include the baseline UPDRS total score as a
fixed effect covariate, with fixed effect categorical factors for geographic region
(North America, South America, Western Europe, Eastern Europe and Asia),
treatment group (Active and Placebo), visit and baseline × visit and treatment ×
visit interactions. The interactions will remain in the model regardless of significance. Treatment group comparisons at each visit will be estimated by differences
between least squares (LS) means from the treatment × visit interaction, with
accompanying p-values and 95% CIs. An unstructured covariance pattern will be
used to estimate the variance–covariance of the within-subject repeated measures.
Parameters will be estimated using REML with the Newton–Raphson algorithm
and using the Kenward–Roger method for calculating the denominator degrees of freedom.
In case this model does not converge, a heterogeneous Toeplitz covariance
pattern will be used in place of unstructured. In this case, to assess the robustness
of the results, a supportive model using a sandwich estimator for the standard
error of the fixed effects parameters will also be produced.</code></pre>
<pre><code>PROC MIXED DATA=updrs_v;
  CLASS subjid region trt visit ;
  MODEL change = base_upd region trt visit trt*visit
  base_upd*visit / DDFM=KR ;
  REPEATED visit / TYPE=UN SUBJECT=subjid R RCORR;
  LSMEANS trt*visit / PDIFF CL;
  ESTIMATE “TRT 1 vs 2 at visit 8” TRT 1 -1
  TRT*VISIT 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 -1 /CL ;
RUN;</code></pre>
<div id="strategies-to-improve-convergence"
class="section level3 unnumbered">
<h3 class="unnumbered">Strategies to Improve Convergence</h3>
<ol style="list-style-type: decimal">
<li><p><strong>Site Pooling</strong>: In clinical trials, especially
multinational Phase III trials, adjusting for investigator sites is
beneficial but challenging due to potentially small sample sizes per
site. Pre-planned pooling of small sites can aid model convergence.
Sites might be grouped by geographic location, type, or subject numbers.
The pooling strategy should aim to balance the size of pooled sites to
prevent any single site from dominating the analysis.</p></li>
<li><p><strong>Baseline × Visit Interaction</strong>: Including this
interaction helps account for potential differences in how baseline
conditions influence changes over time. However, if the trial has many
visits and a small sample size, it might be necessary to simplify the
model by excluding this term, although it’s generally advisable to
retain it when feasible.</p></li>
</ol>
<p><strong>Generalized Estimating Equations (GEE) Compariso</strong></p>
<p>Though less commonly used for normally distributed outcomes, GEE
provides a robust alternative that is less sensitive to the covariance
structure:</p>
<pre><code>proc genmod data=updrs_v;
   class subjid region trt visit;
   model change = baseline region trt visit trt*visit baseline*visit / dist=normal link=identity;
   repeated subject=subjid / type=cs corrw;
   lsmeans trt*visit / pdiff cl;
   estimate &#39;TRT 1 vs 2 at visit 8&#39; trt 1 -1 trt*visit 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 -1;
run;</code></pre>
<p>In SAS, GENMOD has fewer options for fitting the working correlation
structure than MIXED, as less emphasis is placed on fitting the
structure in GEE since GEE estimates are asymptotically unbiased
regardless of the covariance matrix selected, under the MCAR assumption.
Due to the relatively large sample size required for GEE estimation, and
the small number of subjects in our example, the GEE algorithm would not
converge with an unstructured pattern. Compound symmetry, also called
exchangeable, was selected instead. The compound symmetry structure
estimates one covariance term, and assumes homogeneous variances and
covariances across all visits. Results are similar to the MMRM using the
spatial power with random subject effect and sandwich estimator</p>
</div>
<div id="treatment-by-subgroup-and-site-interactions"
class="section level3 unnumbered">
<h3 class="unnumbered">Treatment by Subgroup and Site Interactions</h3>
<ol style="list-style-type: decimal">
<li><strong>Treatment by Subgroup and Site Interactions</strong>:
<ul>
<li><strong>Importance</strong>: It’s essential for phase III clinical
trials to evaluate interactions between treatment and trial site as
specified in the analysis plan. Similarly, treatment by subgroup
interactions must be assessed before submitting a new drug
application.</li>
<li><strong>Specific Example</strong>: For a Parkinson’s disease study,
the interaction between treatment and gender is analyzed, particularly
focusing on Week 28 (Visit 8). Although a one-degree freedom interaction
(treatment × gender) across all visits is considered, the primary focus
is on Visit 8. To do this, a more complex three-way interaction
(treatment × gender × visit) involving seven degrees of freedom is
assessed specifically at Visit 8 using contrast statements in SAS.</li>
<li><strong>SAS Implementation</strong>: The SAS code provided
illustrates how to test these interactions at Visit 8. It includes
sorting the data and ensuring consistency in the order of items in the
class, model, and contrast statements.</li>
</ul></li>
<li><strong>Testing Interaction with Regions</strong>:
<ul>
<li><strong>Complexity in Regions</strong>: Testing the interaction
between treatment and region at Visit 8 involves a four degrees of
freedom test due to the presence of five regions, which is handled
through a complex contrast statement. The approach involves comparing
differences between regions and adjusting the coefficients
accordingly.</li>
</ul></li>
<li><strong>Effect Size Calculation</strong>:
<ul>
<li><strong>Utility</strong>: Calculating the effect size is crucial for
quantifying the treatment difference in standardized terms, which helps
in assessing the treatment’s effectiveness and planning sample sizes for
future trials.
<ul>
<li>The effect size, often referred to as Cohen’s d, is calculated using
the formula: <span class="math display">\[ \text{Effect size
(Cohen&#39;s d)} = \frac{\text{LSMean
difference}}{\sqrt{\text{Variance}}} \]</span> Where:</li>
<li><strong>LSMean difference</strong> is the least squares mean
difference between treatment groups.</li>
<li><strong>Variance</strong> is the estimated variance of the change
from baseline at a specific visit.</li>
</ul>
<ol style="list-style-type: decimal">
<li><strong>Estimate the LSMean Difference</strong>: involves
calculating the difference in the least squares means between two
treatment groups at a specific time point or visit. In clinical trials,
this typically represents the difference in the primary outcome between
groups (e.g., the difference in symptom severity between a treatment
group and a placebo group).</li>
<li><strong>Determine the Variance</strong>: The variance used in the
denominator is the variance of the change from baseline for a specific
visit. This variance can be estimated from a mixed model, such as the
mixed models for repeated measures (MMRM). In SAS, this would typically
be extracted from the variance-covariance matrix (R matrix) that is
outputted by the PROC MIXED procedure. The specific variance estimate
would be from the diagonal cells of the R matrix associated with the
visit of interest.</li>
<li><strong>Compute Cohen’s d</strong>: Divide the LSMean difference by
the square root of the variance estimate to get Cohen’s d. This provides
a standardized measure of effect size, facilitating comparisons across
studies or different measurement scales.</li>
<li><strong>Interpreting Cohen’s d</strong>: <strong>Values of Cohen’s
d</strong>: Typically, a Cohen’s d value of 0.2 is considered a small
effect, 0.5 a medium effect, and 0.8 or higher a large effect. These
thresholds help determine the clinical significance of the treatment
effect. Even a small effect size (like 0.2) might be considered
significant in clinical terms, depending on the context and the
condition being treated.</li>
</ol></li>
</ul></li>
</ol>
</div>
<div id="constrained-longitudinal-data-analysis-clda"
class="section level3 unnumbered">
<h3 class="unnumbered">Constrained Longitudinal Data Analysis
(cLDA)</h3>
<p><strong>Alternative Modeling Strategy - cLDA</strong>: - <strong>cLDA
vs. MMRM</strong>: The constrained longitudinal data analysis (cLDA)
method treats the baseline score as another repeated measurement,
differing from the more traditional ANCOVA method used in MMRM. This
approach might provide benefits, especially in estimating the treatment
group differences in the presence of missing data. -
<strong>Implementation and Comparison</strong>: The cLDA model tends to
estimate fewer covariance parameters and is presented as potentially
more challenging to program and interpret.</p>
<pre><code>PROC MIXED DATA=updrs_v;
  CLASS subjid region trt visit ;
  MODEL updrs = region vis1 vis2 vis3 vis4 vis5 vis6 vis7 vis8
  trt*vis1 trt*vis2 trt*vis3 trt*vis4 trt*vis5
  trt*vis6 trt*vis7 trt*vis8 / DDFM=KR ;
  REPEATED visit / TYPE=UN SUBJECT=subjid R RCORR;
  ESTIMATE ’BL lsmean’ INTERCEPT 1 region 0.2 0.2 0.2 0.2 0.2 ;
  ESTIMATE ’vis 8 chg from BL trt 1’ vis8 1 trt*vis8 1 0 / cl;
  ESTIMATE ’vis 8 chg from BL trt 2’ vis8 1 trt*vis8 0 1 / cl;
  ESTIMATE ’active - placebo at v8’ trt*vis8 -1 1 / cl ;
RUN;</code></pre>
<p>The cLDA model is designed to analyze data where repeated
measurements are taken over time on the same subjects, which is typical
in clinical trials. Unlike traditional models that treat baseline values
as a covariate, the cLDA incorporates the baseline as another repeated
measurement within the model. This approach can be beneficial,
especially when considering the full trajectory of response over time
and handling missing data effectively.</p>
<p><strong>Key Features of cLDA</strong></p>
<ol style="list-style-type: decimal">
<li><strong>Treatment of Baseline Measurements</strong>:
<ul>
<li>In cLDA, the baseline score is included as a repeated measure rather
than being used as a covariate. This means that the baseline becomes
part of the sequence of observations that are modeled together.</li>
<li>By treating baseline as a repeated measure, cLDA can directly
incorporate the baseline variability into the model’s estimation
process, potentially leading to a more accurate understanding of how
subjects’ responses change over time relative to their starting
points.</li>
</ul></li>
<li><strong>Modeling Structure</strong>:
<ul>
<li>The cLDA model constrains the mean of the baseline scores to be the
same across different treatment groups. This assumption is reasonable
under randomization in clinical trials, where baseline characteristics
should be balanced across groups.</li>
<li>The model also allows for the estimation of the overall treatment
effect by comparing the trajectories of response over time between
different treatment groups.</li>
</ul></li>
<li><strong>Handling of Covariance</strong>:
<ul>
<li>With cLDA, there is an opportunity to model the covariance structure
more comprehensively by using all available repeated measurements,
including baseline. This can provide a richer estimation of the
correlation structure across time points.</li>
<li>More covariance parameters may be estimated compared to traditional
methods, which can lead to more robust handling of missing data. This is
because the correlation structure helps inform the imputation of missing
observations based on observed data patterns.</li>
</ul></li>
</ol>
<p><strong>Advantages of cLDA</strong></p>
<ul>
<li><strong>Enhanced Handling of Missing Data</strong>: By using all
repeated measures, cLDA can utilize the inherent correlations in the
data to better predict missing values, which is particularly useful in
longitudinal studies where dropout rates can be significant.</li>
<li><strong>Improved Estimation of Treatment Effects</strong>: The
inclusion of baseline as a repeated measure allows the model to account
for individual variations at the start of the study, potentially leading
to more precise estimates of treatment effects.</li>
</ul>
<p><strong>Disadvantages of cLDA</strong></p>
<ul>
<li><strong>Complexity in Estimation</strong>: The inclusion of more
covariance parameters to estimate can increase the complexity of the
model, potentially leading to issues with convergence in the fitting
process.</li>
<li><strong>Statistical Power</strong>: The increased number of
parameters might also impact the statistical power of the test for
treatment group differences, particularly in studies with smaller sample
sizes.</li>
</ul>
</div>
</div>
<div id="generalized-linear-mixed-model-glmm" class="section level2"
number="2.7">
<h2><span class="header-section-number">2.7</span> Generalized Linear
Mixed Model (GLMM)</h2>
<ul>
<li><strong>Basic Concept</strong>: GLMM extends the linear mixed model
(which assumes a normally distributed outcome) to accommodate various
distributions of the response variable. This is crucial when the
response variable does not follow a normal distribution, such as binary
outcomes in logistic regression.</li>
<li><strong>Components of GLMM</strong>:
<ul>
<li><strong>Linear Predictors (Xβ)</strong>: This component models the
fixed effects, similar to traditional regression models but suited for
mixed effects with repeated measures.</li>
<li><strong>Link Function</strong>: This is a monotonic mapping function
that relates the mean of the dependent variable to the linear
predictors. In the context of binary data and logistic regression, the
logit (log-odds) function is used.</li>
<li><strong>Error Distribution</strong>: The model error follows a
distribution within the exponential family. For binary outcomes, this is
typically the binomial distribution.</li>
</ul></li>
</ul>
<div id="logistic-regression-as-a-glmm"
class="section level3 unnumbered">
<h3 class="unnumbered">Logistic Regression as a GLMM</h3>
<ul>
<li><strong>Application in Repeated Measures</strong>: When modeling
binary repeated measures data, the logistic regression model can be
adapted into a GLMM framework. This approach allows for the modeling of
correlations among repeated measurements on the same subject, which is
essential for data integrity and accuracy in estimates.</li>
<li><strong>Logit Transformation</strong>: The logit, defined as <span
class="math inline">\(\log\left(\frac{p}{1-p}\right)\)</span>, where
<span class="math inline">\(p\)</span> is the probability of an event,
is used as the link function.</li>
<li><strong>Model Estimation</strong>:
<ul>
<li>The response probability for a subject visit <span
class="math inline">\(y_{ij}\)</span> is transformed using the logit
function and modeled as a linear combination of predictors: <span
class="math inline">\(\logit(\mathbb{E}[y_{ij}]) =
x_{ij}\beta\)</span>.</li>
<li>This model estimates the odds ratio as <span
class="math inline">\(e^{x_{ij}\beta}\)</span>, and the predicted
probability is <span class="math inline">\(\frac{e^{x_{ij}\beta}}{1 +
e^{x_{ij}\beta}}\)</span>.</li>
</ul></li>
</ul>
<p><strong>Estimation Techniques</strong></p>
<ul>
<li><strong>Restricted Pseudolikelihood</strong>: Unlike linear mixed
models, GLMMs are typically estimated using iterative methods like
restricted pseudolikelihood due to the complexity of the error structure
and the link function.</li>
<li><strong>Handling of Variance-Covariance</strong>: The
variance-covariance matrix, crucial for understanding relationships
among repeated measures, is modeled using a specified structure. The
matrix <span class="math inline">\(A\)</span> contains variances that
depend on the model’s error distribution, particularly for binomial
outcomes in logistic regression.</li>
</ul>
<p><strong>Considerations</strong></p>
<ul>
<li><strong>Random Effects</strong>: In the logistic regression version
of MMRM, random effects are limited to those arising from correlations
among repeated measurements. This simplifies the model to <span
class="math inline">\(P = X\beta + e\)</span>, excluding random slopes
or other complex random structures.</li>
<li><strong>Optimization and Convergence</strong>: Various optimization
techniques, like Newton–Raphson with ridging, may be employed. These
methods address the challenges in convergence due to the complexity of
the model’s structure.</li>
<li><strong>Data Assumptions</strong>: The logistic regression GLMM
assumes that data are missing completely at random (MCAR). If data is
missing at random (MAR) but the correlation structure is correctly
specified, GLMM tends to provide more reliable estimates compared to
other methods like Generalized Estimating Equations (GEE), which also
assume MCAR.</li>
</ul>
</div>
<div id="applying-mmrm-1" class="section level3" number="2.7.1">
<h3><span class="header-section-number">2.7.1</span> Applying MMRM</h3>
<pre><code>Treatment groups will be compared for odds of response at Day 28 using a logistic
GLMM for repeated measures. Response or non-response at each scheduled postbaseline visit (Visits 1 to 5) is the dependent variable. Subjects who discontinued
very early without providing a post-baseline YMRS score will be considered
non-responders at Visit 1 (Day 4). The logistic GLMM is fit using the logit link
and the binomial distribution. The model will include the baseline YMRS total
score as a fixed effect covariate, with fixed effect categorical factors for pooled
investigator site (defined elsewhere in the SAP), treatment group (Experimental
and Control), visit and baseline × visit and treatment × visit interactions. The
interactions will remain in the model regardless of significance. Treatment group
comparisons at each visit will be estimated by differences between LS means
from the treatment × visit interaction, and will be presented as odds ratios with
accompanying p-values and 95% CIs. The predicted probability of response at
each visit will also be presented. An unstructured covariance pattern will be used
to estimate the variance–covariance of the within-subject repeated measures i.e.,
as R-side random effects. Parameters will be estimated using restricted pseudolikelihood with Newton–Raphson ridging optimization and the Kenward–Roger
method for calculating the denominator degrees of freedom.
In case this model does not converge, a heterogeneous Toeplitz covariance
pattern will be used in place of unstructured. In this case, to assess the robustness
of the results, a supportive model will also be produced using the bias-corrected
sandwich estimator HC3 (MacKinnon and White, 1985) for the standard error of
the fixed effects parameters.</code></pre>
<p>Pooling investigator sites in logistic regression models for clinical
trials with binary responses is a strategy designed to improve model
convergence and enhance statistical power. This approach is particularly
relevant when dealing with low event rates at individual sites, which
can hamper the ability of logistic models to converge successfully.
Here’s a detailed breakdown of the site pooling strategy for logistic
regression, its rationale, and its implementation in SAS:</p>
<p><strong>Rationale for Site Pooling in Logistic
Regression</strong></p>
<ol style="list-style-type: decimal">
<li><p><strong>Convergence Issues</strong>: Logistic regression models
can struggle to converge when individual sites have low event rates.
This is because the model relies on sufficient variation and number of
events (outcomes) to estimate the parameters accurately.</p></li>
<li><p><strong>Variance Reduction</strong>: Adjusting for site
differences can significantly reduce variance in the model estimates,
leading to more reliable results and increased power to detect true
effects.</p></li>
<li><p><strong>Event Rates</strong>: For logistic regression, the number
of subjects with events (rather than the total number of subjects) at
each site is crucial. Low event rates can lead to instability in model
estimates.</p></li>
</ol>
<p><strong>Guidelines for Site Pooling</strong></p>
<ol style="list-style-type: decimal">
<li><p><strong>Conservative Pooling</strong>: Given the dependency on
event rates, site pooling for logistic regression often needs to be more
conservative compared to pooling for linear models. This means pooling
more sites together to ensure adequate events per site.</p></li>
<li><p><strong>Event Thresholds</strong>: A common guideline suggests
having at least 5-10 events per category of a categorical predictor to
maintain adequate model stability and convergence. Below 5 events per
category can significantly jeopardize model convergence.</p></li>
<li><p><strong>Analysis Plan</strong>: The method and specifics of site
pooling should be predetermined and documented in the analysis plan
before unblinding the study. This is crucial for maintaining the
integrity of the analysis and avoiding bias.</p></li>
</ol>
<p>The SAS code provided uses PROC GLIMMIX, which is suited for
generalized linear mixed models, including logistic regression with
random effects:</p>
<pre class="sas"><code>PROC GLIMMIX DATA=mania_v;
NLOPTIONS TECHNIQUE=NRRIDG;
CLASS subjid poolinv trt visit;
MODEL RESPONSE = base_ymrs poolinv trt visit trt*visit base_ymrs*visit /
                DIST=BIN LINK=LOGIT DDFM=KR;
RANDOM visit / TYPE=UN SUBJECT=subjid RSIDE;
LSMEANS trt*visit / ILINK CL; /* Estimates event rates */
LSMEANS trt*visit / ODDSRATIO DIFF CL; /* Estimates Odds Ratios */
ESTIMATE &quot;Experimental vs Control at visit 5&quot;
         TRT -1 1 TRT*VISIT 0 0 0 0 -1 0 0 0 0 1 / EXP CL;
RUN;</code></pre>
<ul>
<li><strong>Optimization Technique</strong>: <code>NRRIDG</code>
(Newton-Raphson with ridging) is specified to aid in convergence,
particularly useful in complex models or when dealing with boundary
issues that logistic regression might face.</li>
<li><strong>Model Specifications</strong>: The model adjusts for pooled
investigator sites (<code>poolinv</code>), treatment groups
(<code>trt</code>), visits (<code>visit</code>), and their interactions.
It uses the logit link function appropriate for binary outcomes.</li>
<li><strong>Random Effects</strong>: The <code>RANDOM</code> statement
specifies that the visit effects are random, accommodating intra-subject
correlation over time.</li>
<li><strong>Estimation and Comparison</strong>: LSMEANS are used to
estimate event rates and odds ratios, essential for interpreting
treatment effects over time.</li>
</ul>
</div>
<div id="alternate-models" class="section level3 unnumbered">
<h3 class="unnumbered">Alternate Models</h3>
<p>In the context of clinical trials analyzing binary outcomes, the
planned analysis may often be followed by several alternate models to
provide a deeper, more robust evaluation of the data. This approach
helps in understanding the influence of various modeling strategies and
adjustments on the outcomes, especially in complex settings like
logistic regression where model convergence can be challenging.</p>
<ol style="list-style-type: decimal">
<li><strong>Excluding Baseline × Visit Interaction</strong>:
<ul>
<li>Removing this interaction did not significantly change the results,
suggesting that this interaction may not be critical for the model in
this specific study context.</li>
</ul></li>
<li><strong>Heterogeneous Toeplitz Covariance Structure</strong>:
<ul>
<li>This structure, which estimated fewer covariance parameters (9
instead of 15), yielded results that were similar to the more complex
model but with a slightly lower odds ratio (OR) of 1.49. This suggests a
potential reduction in model complexity without substantial loss of
information.</li>
</ul></li>
<li><strong>Generalized Estimating Equations (GEE)</strong>:
<ul>
<li>A GEE model with an unstructured working covariance matrix produced
an OR of 1.54, indicating similar findings to the GLMM model. This
highlights that both GEE and GLMM can be suitable for handling binary
repeated measures data with large sample sizes.</li>
</ul></li>
</ol>
<p>The SAS code provided for the GEE model is as follows:</p>
<pre class="sas"><code>PROC GENMOD DATA=mania_v DESCENDING;
CLASS subjid poolinv trt visit;
MODEL RESPONSE = base_ymrs poolinv trt visit trt*visit base_ymrs*visit /
DIST=BIN LINK=LOGIT TYPE3;
REPEATED SUBJECT=subjid / TYPE=UN CORRW;
LSMEANS trt*visit / DIFF CL;
ESTIMATE “Experimental vs Control at visit 5”
TRT -1 1 TRT*VISIT 0 0 0 0 -1 0 0 0 0 1 /EXP;
RUN;</code></pre>
<p><strong>Methodological Considerations</strong></p>
<ul>
<li><strong>Model Convergence Issues</strong>: Logistic regression
models adjusted for pooled sites encountered issues at some sites with
quasi-complete separation, where some sites had zero non-responders.
This can lead to estimation problems and should be carefully managed,
possibly by modifying pooling strategies or analytic approaches.</li>
<li><strong>Interpretation and Sensitivity Analyses</strong>: Results
should be interpreted with caution, especially when quasi-complete
separation affects the logistic regression estimates. Sensitivity
analyses, like defining all dropouts as non-responders, help assess the
robustness of the findings.</li>
</ul>
</div>
</div>
</div>
<div id="implementation-lme4-in-r" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Implementation lme4 in
R</h1>
<p>The lme4 package (Bates, Maechler, Bolker, and Walker 2014a) for R (R
Core Team 2015) provides functions to fit and analyze linear mixed
models, generalized linear mixed models and nonlinear mixed models.</p>
<p>At present, the main alternative to lme4 for mixed modeling in R is
the nlme package (Pinheiro, Bates, DebRoy, Sarkar, and R Core Team
2014). The main features distinguishing lme4 from nlme are</p>
<pre><code>    (1) more efficient linear algebra tools, giving improved performance on large problems; 
    (2) simpler syntax and more efficient implementation for fitting models with crossed random effects; 
    (3) the implementation of profile likelihood confidence intervals on random-effects parameters; and 
    (4) the ability to fit generalized linear mixed models (although in this paper we restrict ourselves to linear mixed models). </code></pre>
<p>The main advantage of nlme relative to lme4 is a user interface for
fitting models with structure in the residuals (various forms of
heteroscedasticity and autocorrelation) and in the random-effects
covariance matrices (e.g., compound symmetric models).</p>
<div id="preface-vs-linear-model" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Preface vs Linear
Model</h2>
<pre class="r"><code>shrimp &lt;- read.csv(&quot;./01_Datasets/shrimp.csv&quot;,sep=&quot;,&quot;, header=TRUE)   
# AnimalID-individual number
# SireID-sire number
# DamID-parent number
# FamilyID-family number
# SexID - sex
# TankID-test pool number
# M1BW-weight before entering the pool
# M2BW - Harvest Weight and M2Age
# The age at harvest is a numeric variable
 
ggplot(data=shrimp,aes(x=SexID,y=M2BW,color=SexID))+
  geom_boxplot()+
  geom_dotplot(binaxis = &quot;y&quot;,
               stackdir = &quot;center&quot;,
               position = &quot;dodge&quot;,
               binwidth = 0.25)</code></pre>
<p><img src="06-Analysis-MMRM_files/figure-html/shrimp-1.png" width="672" /></p>
<pre class="r"><code># Choose the model 模型中一个效应到底是作为固定效应，还是随机效应
# &quot;SAS for Mixed models (Second edition)&quot;: An effect is called fixed if the levels in the study represent all possible levels of the factor, or at least all levels about which inference is to be made
# Factor effects are random if they are used in the study to represent only a sample (ideally, a random sample) of a larger set of potential levels”
# 固定效应，该效应的所有水平在实验群体中都已经出现
# 随机效应, 试验群体出现的该效应的水平只是一个很大水平数中的随机抽样
# 如果我们分析一个效应的目的是为了研究它所在的一个具有概率分布的大群体的情况，那么这个效应应该作为随机效应。随机效应有两个特点，a) 它是大群体中的一个样本，b) 它具有概率分布。

shrimp.lm &lt;- lm(M2BW~SexID,shrimp)
summary(shrimp.lm) </code></pre>
<pre><code>## 
## Call:
## lm(formula = M2BW ~ SexID, data = shrimp)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -22.9765  -3.1765  -0.0765   3.0235  18.9235 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  34.3765     0.1082  317.65   &lt;2e-16 ***
## SexIDMale    -6.2137     0.1560  -39.82   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.101 on 4280 degrees of freedom
## Multiple R-squared:  0.2704, Adjusted R-squared:  0.2702 
## F-statistic:  1586 on 1 and 4280 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>shrimp %&gt;% 
  group_by(SexID) %&gt;% 
  transmute(sex.mean=mean(M2BW)) %&gt;% unique()</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["SexID"],"name":[1],"type":["chr"],"align":["left"]},{"label":["sex.mean"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"Male","2":"28.16273"},{"1":"Female","2":"34.37646"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>ggplot(data=shrimp,aes(x=SexID,y=M2BW,color=SexID))+
  geom_dotplot(binaxis = &quot;y&quot;,stackdir = &quot;center&quot;,position = &quot;dodge&quot;,binwidth = 0.25)+
  geom_vline(xintercept = 1)+
  geom_vline(xintercept = 2)+
  geom_hline(yintercept = 34.37646)+
  geom_hline(yintercept = 28.16273)+
  geom_abline(intercept = 34.3765+6.2137, slope=-6.2137)+
  geom_text(x=2.4,y=31.5,label=&quot;-6.6155&quot;)+
  annotate(&quot;segment&quot;,x=2.5,xend=2.5,y=28.16273,yend = 34.37646)</code></pre>
<p><img src="06-Analysis-MMRM_files/figure-html/shrimp-2.png" width="672" /></p>
<pre class="r"><code># 考虑家系结构，Pop:Family为随机效应，Pop、Sex和Tank为固定效应，Sex:M1BW为协变量
shrimp.lm.9 &lt;- lmer(M2BW ~ 1 + PopID + SexID + TankID + SexID:M1BW 
                    + (1|PopID:FamilyID),shrimp)
summary(shrimp.lm.9)</code></pre>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: M2BW ~ 1 + PopID + SexID + TankID + SexID:M1BW + (1 | PopID:FamilyID)
##    Data: shrimp
## 
## REML criterion at convergence: 23070.4
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -5.5304 -0.5854  0.0240  0.6388  3.8977 
## 
## Random effects:
##  Groups         Name        Variance Std.Dev.
##  PopID:FamilyID (Intercept)  5.933   2.436   
##  Residual                   12.527   3.539   
## Number of obs: 4241, groups:  PopID:FamilyID, 105
## 
## Fixed effects:
##                   Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept)        35.7188     1.0605  487.3240  33.683  &lt; 2e-16 ***
## PopIDPop2          -1.6596     0.6884  100.5550  -2.411  0.01774 *  
## PopIDPop3          -3.7742     0.6733  101.7519  -5.606 1.78e-07 ***
## PopIDPop4          -5.8638     0.7359  110.5088  -7.968 1.58e-12 ***
## SexIDMale          -5.6599     0.5901 4148.3019  -9.591  &lt; 2e-16 ***
## TankIDT2           -2.9491     0.1097 4140.0606 -26.884  &lt; 2e-16 ***
## SexIDFemale:M1BW    0.3757     0.1204  992.9529   3.122  0.00185 ** 
## SexIDMale:M1BW      0.2904     0.1231 1068.2960   2.360  0.01847 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) PpIDP2 PpIDP3 PpIDP4 SxIDMl TnIDT2 SIDF:M
## PopIDPop2   -0.384                                          
## PopIDPop3   -0.419  0.506                                   
## PopIDPop4   -0.519  0.476  0.494                            
## SexIDMale   -0.248  0.002  0.007 -0.004                     
## TankIDT2    -0.042 -0.006 -0.004 -0.001 -0.030              
## SxIDFm:M1BW -0.889  0.077  0.108  0.250  0.291 -0.010       
## SxIDMl:M1BW -0.711  0.074  0.100  0.246 -0.352  0.010  0.786</code></pre>
<pre class="r"><code>anova(shrimp.lm.9)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Sum Sq"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Mean Sq"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["NumDF"],"name":[3],"type":["int"],"align":["right"]},{"label":["DenDF"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["F value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"914.1576","2":"304.71920","3":"3","4":"103.8097","5":"24.325494","6":"5.319016e-12","_rn_":"PopID"},{"1":"1152.3988","2":"1152.39879","3":"1","4":"4148.3019","5":"91.995086","6":"1.452119e-21","_rn_":"SexID"},{"1":"9053.6582","2":"9053.65817","3":"1","4":"4140.0606","5":"722.746388","6":"7.117930e-147","_rn_":"TankID"},{"1":"122.3593","2":"61.17964","3":"2","4":"1414.1757","5":"4.883923","6":"7.695395e-03","_rn_":"SexID:M1BW"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code># Compare with linear model
shrimp.lm.8 &lt;- lm(M2BW ~ 1 + PopID + SexID + TankID + SexID:M1BW,shrimp)
# Mixed model Residual  Variance 12.527     
# 考虑家系结构后，残差方差明显变小，从残差中分离出了大部分的家系方差。
# 如果不考虑家系结构，残差方差明显被高估,估计值
mean(resid(shrimp.lm.8)^2) </code></pre>
<pre><code>## [1] 18.42117</code></pre>
</div>
<div id="random-slope-and-intercept-model" class="section level2"
number="3.2">
<h2><span class="header-section-number">3.2</span> Random Slope and
Intercept Model</h2>
<p><strong>This structure assumes that the errors are independent, and
thus is termed an independent structure.</strong></p>
<p><span class="math display">\[
\Sigma =
\left[
\begin{array}{ccc}
\sigma_1^2 &amp; 0   &amp; 0   \\
0   &amp; \sigma_2^2 &amp; 0   \\
0   &amp; 0   &amp; \sigma_3^2 \\
\end{array}\right]
\]</span></p>
<div id="model-with-one-random-intercept-effekct" class="section level3"
number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Model with One
Random Intercept Effekct</h3>
<pre class="r"><code>## library(&quot;lmerTest&quot;) 
load(&quot;./01_Datasets/gpa.RData&quot;)

# Standard regression
gpa_lm = lm(gpa ~ occasion, data = gpa)  
summary(gpa_lm)</code></pre>
<pre><code>## 
## Call:
## lm(formula = gpa ~ occasion, data = gpa)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.90553 -0.22447 -0.01184  0.26921  1.19447 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 2.599214   0.017846  145.65   &lt;2e-16 ***
## occasion    0.106314   0.005894   18.04   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3487 on 1198 degrees of freedom
## Multiple R-squared:  0.2136, Adjusted R-squared:  0.2129 
## F-statistic: 325.3 on 1 and 1198 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code># Run a mixed model, taking into account the specific effects of the students
# (1 | student) means that the intercept allowed to be expressed by 1 varies from student to student
gpa_mixed = lmer(gpa ~ occasion + (1 | student), data = gpa)
summary(gpa_mixed)</code></pre>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: gpa ~ occasion + (1 | student)
##    Data: gpa
## 
## REML criterion at convergence: 408.9
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.6169 -0.6373 -0.0004  0.6361  2.8310 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  student  (Intercept) 0.06372  0.2524  
##  Residual             0.05809  0.2410  
## Number of obs: 1200, groups:  student, 200
## 
## Fixed effects:
##              Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept) 2.599e+00  2.170e-02 3.223e+02   119.8   &lt;2e-16 ***
## occasion    1.063e-01  4.074e-03 9.990e+02    26.1   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##          (Intr)
## occasion -0.469</code></pre>
<pre class="r"><code># Another way to interpret the variance output is to record the student variance as a percentage of the total variance, which is 0.064 / 0.122 = 52%.
# This is also called intra-class correlation because it is also an estimate of intra-cluster correlation

# Profile confidence intervals      
confint(gpa_mixed)</code></pre>
<pre><code>##                  2.5 %    97.5 %
## .sig01      0.22517423 0.2824604
## .sigma      0.23071113 0.2518510
## (Intercept) 2.55665145 2.6417771
## occasion    0.09832589 0.1143027</code></pre>
<pre class="r"><code># Random effect and random interception (i.e. intercept + random effect)
ranef(gpa_mixed)$student %&gt;% head(5)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["(Intercept)"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"-0.07089492","_rn_":"1"},{"1":"-0.21557844","_rn_":"2"},{"1":"0.08825694","_rn_":"3"},{"1":"-0.18664174","_rn_":"4"},{"1":"0.03038354","_rn_":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code># Occasion changes are not allowed, it is a fixed effect for all students
coef(gpa_mixed)$student %&gt;% head(5)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["(Intercept)"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["occasion"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"2.528319","2":"0.1063143","_rn_":"1"},{"1":"2.383636","2":"0.1063143","_rn_":"2"},{"1":"2.687471","2":"0.1063143","_rn_":"3"},{"1":"2.412573","2":"0.1063143","_rn_":"4"},{"1":"2.629598","2":"0.1063143","_rn_":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code># check the influence (uncertainty)
library(merTools)
predictInterval(gpa_mixed)   # For various model predictions, possibly with new data</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["fit"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["upr"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["lwr"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"2.528445","2":"2.884564","3":"2.203923"},{"1":"2.646149","2":"2.993896","3":"2.274397"},{"1":"2.748767","2":"3.091476","3":"2.412216"},{"1":"2.851982","2":"3.174105","3":"2.515336"},{"1":"2.958891","2":"3.282237","3":"2.642091"},{"1":"3.065202","2":"3.383587","3":"2.697028"},{"1":"2.393842","2":"2.738143","3":"2.043021"},{"1":"2.484133","2":"2.818216","3":"2.160561"},{"1":"2.598344","2":"2.918913","3":"2.277874"},{"1":"2.698381","2":"3.029979","3":"2.374484"},{"1":"2.806214","2":"3.140430","3":"2.475820"},{"1":"2.910283","2":"3.252936","3":"2.564557"},{"1":"2.684198","2":"3.014164","3":"2.348025"},{"1":"2.790802","2":"3.123025","3":"2.449355"},{"1":"2.899673","2":"3.234696","3":"2.562693"},{"1":"3.006143","2":"3.321029","3":"2.689505"},{"1":"3.111153","2":"3.443625","3":"2.766468"},{"1":"3.207224","2":"3.526519","3":"2.854618"},{"1":"2.402007","2":"2.718466","3":"2.080813"},{"1":"2.512917","2":"2.854827","3":"2.193312"},{"1":"2.600669","2":"2.967762","3":"2.267083"},{"1":"2.726017","2":"3.058198","3":"2.394963"},{"1":"2.837396","2":"3.147947","3":"2.489828"},{"1":"2.923664","2":"3.286523","3":"2.579939"},{"1":"2.650670","2":"2.975008","3":"2.303153"},{"1":"2.729136","2":"3.084652","3":"2.413293"},{"1":"2.827974","2":"3.158085","3":"2.521535"},{"1":"2.947730","2":"3.278483","3":"2.580506"},{"1":"3.061107","2":"3.408265","3":"2.749451"},{"1":"3.167399","2":"3.474726","3":"2.827466"},{"1":"2.291498","2":"2.646929","3":"1.966614"},{"1":"2.392853","2":"2.711659","3":"2.032128"},{"1":"2.541553","2":"2.856745","3":"2.188817"},{"1":"2.615387","2":"2.955953","3":"2.291975"},{"1":"2.730231","2":"3.037487","3":"2.398810"},{"1":"2.803943","2":"3.151477","3":"2.524695"},{"1":"2.452087","2":"2.777369","3":"2.139878"},{"1":"2.560914","2":"2.899618","3":"2.227067"},{"1":"2.653126","2":"2.996563","3":"2.349829"},{"1":"2.767712","2":"3.112790","3":"2.456548"},{"1":"2.876429","2":"3.212992","3":"2.555576"},{"1":"2.976520","2":"3.306195","3":"2.628108"},{"1":"2.817637","2":"3.119816","3":"2.465089"},{"1":"2.940522","2":"3.276755","3":"2.582469"},{"1":"3.037817","2":"3.346762","3":"2.685002"},{"1":"3.127634","2":"3.470630","3":"2.811552"},{"1":"3.244797","2":"3.578646","3":"2.881293"},{"1":"3.346666","2":"3.677483","3":"3.021580"},{"1":"2.704519","2":"3.037778","3":"2.376621"},{"1":"2.809762","2":"3.138974","3":"2.492984"},{"1":"2.933201","2":"3.244083","3":"2.590504"},{"1":"3.011416","2":"3.320483","3":"2.680570"},{"1":"3.126492","2":"3.457280","3":"2.799335"},{"1":"3.226522","2":"3.552883","3":"2.893390"},{"1":"2.603659","2":"2.943317","3":"2.261829"},{"1":"2.726128","2":"3.062000","3":"2.392256"},{"1":"2.822998","2":"3.145905","3":"2.503349"},{"1":"2.936422","2":"3.272855","3":"2.604899"},{"1":"3.045048","2":"3.374068","3":"2.701165"},{"1":"3.140972","2":"3.456146","3":"2.811634"},{"1":"2.959512","2":"3.292539","3":"2.606325"},{"1":"3.068247","2":"3.395293","3":"2.760010"},{"1":"3.186655","2":"3.501286","3":"2.846750"},{"1":"3.286614","2":"3.617818","3":"2.958527"},{"1":"3.374924","2":"3.684296","3":"3.029569"},{"1":"3.482165","2":"3.836816","3":"3.149361"},{"1":"2.602117","2":"2.947221","3":"2.285368"},{"1":"2.707784","2":"3.048006","3":"2.377576"},{"1":"2.806361","2":"3.163767","3":"2.480519"},{"1":"2.929072","2":"3.250928","3":"2.582727"},{"1":"3.030988","2":"3.384093","3":"2.691911"},{"1":"3.141302","2":"3.466954","3":"2.808145"},{"1":"3.129948","2":"3.451857","3":"2.803739"},{"1":"3.219943","2":"3.564157","3":"2.891523"},{"1":"3.336896","2":"3.657159","3":"3.011071"},{"1":"3.459190","2":"3.781608","3":"3.114980"},{"1":"3.537336","2":"3.860154","3":"3.195714"},{"1":"3.641477","2":"4.006781","3":"3.316614"},{"1":"2.704704","2":"3.046021","3":"2.376710"},{"1":"2.815695","2":"3.136016","3":"2.462771"},{"1":"2.935945","2":"3.294573","3":"2.591899"},{"1":"3.038913","2":"3.357056","3":"2.734938"},{"1":"3.139420","2":"3.488680","3":"2.830653"},{"1":"3.253219","2":"3.580093","3":"2.924413"},{"1":"2.385684","2":"2.720401","3":"2.041743"},{"1":"2.466470","2":"2.779496","3":"2.154370"},{"1":"2.592896","2":"2.900967","3":"2.258464"},{"1":"2.693685","2":"3.038320","3":"2.374307"},{"1":"2.799943","2":"3.153196","3":"2.487284"},{"1":"2.914452","2":"3.235816","3":"2.581958"},{"1":"2.462865","2":"2.787766","3":"2.136927"},{"1":"2.578368","2":"2.917787","3":"2.248075"},{"1":"2.673285","2":"3.006813","3":"2.360309"},{"1":"2.782707","2":"3.125459","3":"2.460919"},{"1":"2.888010","2":"3.195497","3":"2.549419"},{"1":"2.994422","2":"3.330333","3":"2.667106"},{"1":"2.316487","2":"2.654208","3":"1.996511"},{"1":"2.426758","2":"2.777158","3":"2.088578"},{"1":"2.527662","2":"2.852602","3":"2.192849"},{"1":"2.634996","2":"2.977306","3":"2.303043"},{"1":"2.758363","2":"3.100023","3":"2.426896"},{"1":"2.841717","2":"3.159592","3":"2.513600"},{"1":"2.316700","2":"2.617553","3":"1.981047"},{"1":"2.405166","2":"2.740611","3":"2.051137"},{"1":"2.493332","2":"2.865777","3":"2.189444"},{"1":"2.612113","2":"2.951994","3":"2.281188"},{"1":"2.724513","2":"3.030003","3":"2.398803"},{"1":"2.827583","2":"3.165121","3":"2.505788"},{"1":"2.508562","2":"2.827866","3":"2.174293"},{"1":"2.589429","2":"2.939684","3":"2.271930"},{"1":"2.710576","2":"3.021922","3":"2.357389"},{"1":"2.813016","2":"3.140495","3":"2.495464"},{"1":"2.952817","2":"3.272912","3":"2.624809"},{"1":"3.011880","2":"3.343815","3":"2.693243"},{"1":"2.840580","2":"3.180556","3":"2.502595"},{"1":"2.938188","2":"3.266430","3":"2.617494"},{"1":"3.044538","2":"3.374392","3":"2.723572"},{"1":"3.153014","2":"3.468057","3":"2.828081"},{"1":"3.258664","2":"3.575127","3":"2.904265"},{"1":"3.373993","2":"3.709986","3":"3.028413"},{"1":"2.278881","2":"2.616071","3":"1.970326"},{"1":"2.399083","2":"2.730183","3":"2.068044"},{"1":"2.509523","2":"2.836209","3":"2.167602"},{"1":"2.628068","2":"2.968474","3":"2.294141"},{"1":"2.714552","2":"3.052736","3":"2.400150"},{"1":"2.812304","2":"3.176478","3":"2.500605"},{"1":"2.722358","2":"3.043330","3":"2.392950"},{"1":"2.828006","2":"3.150135","3":"2.505552"},{"1":"2.915829","2":"3.247399","3":"2.598546"},{"1":"3.038520","2":"3.365290","3":"2.685450"},{"1":"3.149120","2":"3.473715","3":"2.811852"},{"1":"3.247967","2":"3.592319","3":"2.918423"},{"1":"2.661001","2":"2.992906","3":"2.315164"},{"1":"2.779432","2":"3.122171","3":"2.458325"},{"1":"2.880780","2":"3.226004","3":"2.542058"},{"1":"2.992282","2":"3.335813","3":"2.681837"},{"1":"3.111989","2":"3.409298","3":"2.783940"},{"1":"3.203355","2":"3.536766","3":"2.866543"},{"1":"2.596561","2":"2.918707","3":"2.262521"},{"1":"2.689539","2":"3.035551","3":"2.346290"},{"1":"2.816261","2":"3.141106","3":"2.492092"},{"1":"2.912065","2":"3.269239","3":"2.564813"},{"1":"3.023298","2":"3.388119","3":"2.683170"},{"1":"3.112322","2":"3.451124","3":"2.795373"},{"1":"2.991910","2":"3.289506","3":"2.666611"},{"1":"3.087495","2":"3.415749","3":"2.790192"},{"1":"3.193476","2":"3.511862","3":"2.850218"},{"1":"3.321738","2":"3.661796","3":"2.989164"},{"1":"3.410536","2":"3.747668","3":"3.095524"},{"1":"3.524132","2":"3.875742","3":"3.188456"},{"1":"2.336987","2":"2.671154","3":"1.982530"},{"1":"2.442161","2":"2.784213","3":"2.099728"},{"1":"2.544782","2":"2.881994","3":"2.216715"},{"1":"2.653227","2":"2.967490","3":"2.309799"},{"1":"2.751741","2":"3.100000","3":"2.407806"},{"1":"2.858300","2":"3.204669","3":"2.516213"},{"1":"2.216112","2":"2.571786","3":"1.886826"},{"1":"2.326558","2":"2.638016","3":"1.992360"},{"1":"2.442538","2":"2.765492","3":"2.110480"},{"1":"2.554025","2":"2.891643","3":"2.220832"},{"1":"2.637863","2":"2.976598","3":"2.300667"},{"1":"2.757479","2":"3.096590","3":"2.421172"},{"1":"2.699486","2":"3.032439","3":"2.379722"},{"1":"2.807319","2":"3.119735","3":"2.483161"},{"1":"2.925389","2":"3.276663","3":"2.613288"},{"1":"3.050615","2":"3.386665","3":"2.698808"},{"1":"3.148902","2":"3.472156","3":"2.815518"},{"1":"3.242920","2":"3.556368","3":"2.911147"},{"1":"2.705636","2":"3.047186","3":"2.332918"},{"1":"2.806584","2":"3.140377","3":"2.481413"},{"1":"2.916453","2":"3.245134","3":"2.578560"},{"1":"3.029523","2":"3.338713","3":"2.680001"},{"1":"3.135532","2":"3.475499","3":"2.805063"},{"1":"3.244644","2":"3.579605","3":"2.927948"},{"1":"2.803286","2":"3.157956","3":"2.481420"},{"1":"2.925078","2":"3.252113","3":"2.585244"},{"1":"3.046199","2":"3.381491","3":"2.722560"},{"1":"3.126013","2":"3.476861","3":"2.797940"},{"1":"3.239118","2":"3.570902","3":"2.875146"},{"1":"3.353241","2":"3.697958","3":"3.043178"},{"1":"2.251338","2":"2.593723","3":"1.928081"},{"1":"2.346424","2":"2.673603","3":"2.017424"},{"1":"2.478858","2":"2.799249","3":"2.132661"},{"1":"2.562290","2":"2.899084","3":"2.240033"},{"1":"2.668291","2":"2.991904","3":"2.316741"},{"1":"2.785758","2":"3.102186","3":"2.454764"},{"1":"2.850657","2":"3.191433","3":"2.500840"},{"1":"2.957322","2":"3.314470","3":"2.651319"},{"1":"3.079791","2":"3.413356","3":"2.728263"},{"1":"3.174750","2":"3.492603","3":"2.851571"},{"1":"3.279217","2":"3.620739","3":"2.952462"},{"1":"3.382265","2":"3.713186","3":"3.057441"},{"1":"2.449427","2":"2.781805","3":"2.122845"},{"1":"2.582744","2":"2.927841","3":"2.247857"},{"1":"2.672626","2":"3.007200","3":"2.357414"},{"1":"2.788976","2":"3.128026","3":"2.460934"},{"1":"2.887943","2":"3.208560","3":"2.553250"},{"1":"3.001810","2":"3.337553","3":"2.656248"},{"1":"2.377991","2":"2.699488","3":"2.040793"},{"1":"2.498561","2":"2.827624","3":"2.127910"},{"1":"2.605958","2":"2.939348","3":"2.283164"},{"1":"2.713991","2":"3.004956","3":"2.382468"},{"1":"2.810617","2":"3.150827","3":"2.470780"},{"1":"2.934483","2":"3.242852","3":"2.599678"},{"1":"2.677781","2":"2.995246","3":"2.375034"},{"1":"2.796875","2":"3.132673","3":"2.465005"},{"1":"2.909638","2":"3.241024","3":"2.584059"},{"1":"3.037491","2":"3.354920","3":"2.702105"},{"1":"3.103366","2":"3.432666","3":"2.768834"},{"1":"3.209068","2":"3.543764","3":"2.883932"},{"1":"2.747670","2":"3.061087","3":"2.400791"},{"1":"2.833087","2":"3.180105","3":"2.498838"},{"1":"2.948799","2":"3.279413","3":"2.594964"},{"1":"3.062061","2":"3.416212","3":"2.724632"},{"1":"3.144139","2":"3.486280","3":"2.827436"},{"1":"3.271734","2":"3.620127","3":"2.931190"},{"1":"2.674395","2":"3.026080","3":"2.357931"},{"1":"2.780920","2":"3.134965","3":"2.483456"},{"1":"2.887692","2":"3.260061","3":"2.561274"},{"1":"3.008922","2":"3.351727","3":"2.677435"},{"1":"3.130141","2":"3.448252","3":"2.796238"},{"1":"3.197034","2":"3.543210","3":"2.912977"},{"1":"3.034142","2":"3.372905","3":"2.714167"},{"1":"3.131270","2":"3.458544","3":"2.790810"},{"1":"3.220164","2":"3.569383","3":"2.890081"},{"1":"3.337177","2":"3.679783","3":"3.002252"},{"1":"3.462213","2":"3.763383","3":"3.117982"},{"1":"3.530817","2":"3.853778","3":"3.208480"},{"1":"2.531419","2":"2.862881","3":"2.192864"},{"1":"2.657379","2":"2.973476","3":"2.296627"},{"1":"2.757877","2":"3.077551","3":"2.431234"},{"1":"2.872619","2":"3.221508","3":"2.553085"},{"1":"2.965436","2":"3.279282","3":"2.651194"},{"1":"3.069763","2":"3.414047","3":"2.733200"},{"1":"2.882425","2":"3.223120","3":"2.514179"},{"1":"2.975347","2":"3.300859","3":"2.654059"},{"1":"3.083704","2":"3.425360","3":"2.751825"},{"1":"3.198505","2":"3.524172","3":"2.855757"},{"1":"3.298282","2":"3.639065","3":"2.958179"},{"1":"3.409355","2":"3.744659","3":"3.089378"},{"1":"3.131018","2":"3.466295","3":"2.787976"},{"1":"3.235235","2":"3.578875","3":"2.907426"},{"1":"3.341280","2":"3.684459","3":"3.019233"},{"1":"3.422850","2":"3.754058","3":"3.113341"},{"1":"3.563239","2":"3.842546","3":"3.210493"},{"1":"3.650033","2":"3.993291","3":"3.297396"},{"1":"2.543420","2":"2.851516","3":"2.189740"},{"1":"2.662627","2":"2.986321","3":"2.329391"},{"1":"2.754008","2":"3.072621","3":"2.406906"},{"1":"2.868881","2":"3.212314","3":"2.533631"},{"1":"2.980442","2":"3.306656","3":"2.662155"},{"1":"3.084954","2":"3.410875","3":"2.737193"},{"1":"2.660202","2":"2.970966","3":"2.340962"},{"1":"2.775790","2":"3.112984","3":"2.440884"},{"1":"2.903701","2":"3.233694","3":"2.568535"},{"1":"2.999964","2":"3.328194","3":"2.683769"},{"1":"3.098269","2":"3.422160","3":"2.768589"},{"1":"3.222064","2":"3.563257","3":"2.872634"},{"1":"2.771611","2":"3.102679","3":"2.406828"},{"1":"2.876326","2":"3.216644","3":"2.555367"},{"1":"2.986387","2":"3.320823","3":"2.649450"},{"1":"3.084659","2":"3.412289","3":"2.775858"},{"1":"3.217384","2":"3.510106","3":"2.875538"},{"1":"3.309057","2":"3.614984","3":"2.964178"},{"1":"2.792619","2":"3.108005","3":"2.458587"},{"1":"2.889777","2":"3.195811","3":"2.563833"},{"1":"2.996992","2":"3.336438","3":"2.685152"},{"1":"3.086395","2":"3.444225","3":"2.790206"},{"1":"3.212231","2":"3.539865","3":"2.872697"},{"1":"3.320736","2":"3.629896","3":"2.987683"},{"1":"2.305032","2":"2.630362","3":"1.982606"},{"1":"2.424268","2":"2.739320","3":"2.083841"},{"1":"2.502876","2":"2.851794","3":"2.184444"},{"1":"2.632598","2":"2.963233","3":"2.319712"},{"1":"2.742141","2":"3.049980","3":"2.411600"},{"1":"2.852908","2":"3.182148","3":"2.516943"},{"1":"2.373197","2":"2.704091","3":"2.027214"},{"1":"2.482746","2":"2.815604","3":"2.166137"},{"1":"2.580293","2":"2.906537","3":"2.265591"},{"1":"2.678352","2":"3.026384","3":"2.357671"},{"1":"2.782951","2":"3.129340","3":"2.459754"},{"1":"2.919469","2":"3.269650","3":"2.579806"},{"1":"2.603788","2":"2.923084","3":"2.272334"},{"1":"2.712842","2":"3.044584","3":"2.393921"},{"1":"2.814706","2":"3.170828","3":"2.479342"},{"1":"2.918262","2":"3.256771","3":"2.591641"},{"1":"3.029589","2":"3.344228","3":"2.687259"},{"1":"3.147044","2":"3.461497","3":"2.816399"},{"1":"2.710318","2":"3.054304","3":"2.384948"},{"1":"2.837772","2":"3.167837","3":"2.496053"},{"1":"2.928233","2":"3.247085","3":"2.608935"},{"1":"3.020160","2":"3.366978","3":"2.660865"},{"1":"3.119648","2":"3.467052","3":"2.791363"},{"1":"3.233239","2":"3.559158","3":"2.907738"},{"1":"2.533723","2":"2.870552","3":"2.219984"},{"1":"2.620712","2":"2.944631","3":"2.288567"},{"1":"2.750658","2":"3.080138","3":"2.394729"},{"1":"2.845249","2":"3.172875","3":"2.512521"},{"1":"2.950121","2":"3.283470","3":"2.626295"},{"1":"3.063833","2":"3.408399","3":"2.711065"},{"1":"2.582345","2":"2.918256","3":"2.226051"},{"1":"2.683603","2":"3.026781","3":"2.359477"},{"1":"2.770006","2":"3.108869","3":"2.444321"},{"1":"2.902819","2":"3.230334","3":"2.567894"},{"1":"2.987373","2":"3.331353","3":"2.641435"},{"1":"3.096942","2":"3.429560","3":"2.774890"},{"1":"2.753444","2":"3.098542","3":"2.448379"},{"1":"2.874123","2":"3.202745","3":"2.553069"},{"1":"2.981465","2":"3.327665","3":"2.620828"},{"1":"3.078505","2":"3.379253","3":"2.755834"},{"1":"3.190152","2":"3.515634","3":"2.850098"},{"1":"3.291665","2":"3.616720","3":"2.973805"},{"1":"2.682937","2":"3.001043","3":"2.330674"},{"1":"2.782702","2":"3.095423","3":"2.434673"},{"1":"2.858640","2":"3.193578","3":"2.554333"},{"1":"2.979763","2":"3.296202","3":"2.670640"},{"1":"3.096873","2":"3.428441","3":"2.768019"},{"1":"3.190880","2":"3.519051","3":"2.865169"},{"1":"2.811941","2":"3.135604","3":"2.437914"},{"1":"2.903391","2":"3.232187","3":"2.552803"},{"1":"3.000937","2":"3.309075","3":"2.700591"},{"1":"3.114683","2":"3.468909","3":"2.790823"},{"1":"3.222089","2":"3.545023","3":"2.878622"},{"1":"3.333681","2":"3.663618","3":"2.984241"},{"1":"2.734197","2":"3.090795","3":"2.405592"},{"1":"2.855519","2":"3.191478","3":"2.520833"},{"1":"2.946928","2":"3.298724","3":"2.611481"},{"1":"3.057336","2":"3.374768","3":"2.712677"},{"1":"3.171030","2":"3.492144","3":"2.822303"},{"1":"3.281955","2":"3.615784","3":"2.945445"},{"1":"2.326571","2":"2.688771","3":"2.011479"},{"1":"2.438387","2":"2.755291","3":"2.124783"},{"1":"2.557292","2":"2.892899","3":"2.225318"},{"1":"2.656568","2":"3.034255","3":"2.301310"},{"1":"2.767393","2":"3.114823","3":"2.440492"},{"1":"2.888067","2":"3.204763","3":"2.550506"},{"1":"2.688054","2":"3.007618","3":"2.364802"},{"1":"2.777730","2":"3.103975","3":"2.438768"},{"1":"2.888667","2":"3.233010","3":"2.552162"},{"1":"2.993172","2":"3.321733","3":"2.662376"},{"1":"3.097698","2":"3.440171","3":"2.769826"},{"1":"3.198290","2":"3.532637","3":"2.850961"},{"1":"2.417789","2":"2.733009","3":"2.069736"},{"1":"2.521644","2":"2.828609","3":"2.172067"},{"1":"2.594972","2":"2.960510","3":"2.281700"},{"1":"2.720083","2":"3.048601","3":"2.400529"},{"1":"2.846293","2":"3.179387","3":"2.522675"},{"1":"2.948098","2":"3.275409","3":"2.637755"},{"1":"2.660267","2":"3.021636","3":"2.340934"},{"1":"2.755224","2":"3.091469","3":"2.440907"},{"1":"2.866885","2":"3.190053","3":"2.548546"},{"1":"2.997653","2":"3.333971","3":"2.664156"},{"1":"3.092747","2":"3.431110","3":"2.754717"},{"1":"3.205225","2":"3.529622","3":"2.879693"},{"1":"2.436398","2":"2.752845","3":"2.113061"},{"1":"2.525737","2":"2.848403","3":"2.201898"},{"1":"2.663355","2":"2.971165","3":"2.334750"},{"1":"2.759231","2":"3.093402","3":"2.447985"},{"1":"2.868205","2":"3.191879","3":"2.526063"},{"1":"2.957802","2":"3.303917","3":"2.614117"},{"1":"2.877811","2":"3.197874","3":"2.546590"},{"1":"2.973274","2":"3.299385","3":"2.649633"},{"1":"3.070857","2":"3.419950","3":"2.723743"},{"1":"3.169186","2":"3.510905","3":"2.856389"},{"1":"3.282126","2":"3.632435","3":"2.955515"},{"1":"3.384226","2":"3.708218","3":"3.053409"},{"1":"2.497061","2":"2.838082","3":"2.144207"},{"1":"2.591452","2":"2.901759","3":"2.267905"},{"1":"2.709251","2":"3.018278","3":"2.363785"},{"1":"2.815724","2":"3.140892","3":"2.475542"},{"1":"2.927069","2":"3.263818","3":"2.567890"},{"1":"3.015896","2":"3.350791","3":"2.686653"},{"1":"2.859100","2":"3.203424","3":"2.524497"},{"1":"2.983879","2":"3.325938","3":"2.649150"},{"1":"3.103458","2":"3.417410","3":"2.728468"},{"1":"3.192288","2":"3.537826","3":"2.854352"},{"1":"3.306376","2":"3.639073","3":"2.961218"},{"1":"3.414775","2":"3.758352","3":"3.065581"},{"1":"2.702694","2":"3.054676","3":"2.369664"},{"1":"2.811175","2":"3.155528","3":"2.470778"},{"1":"2.910961","2":"3.203262","3":"2.557830"},{"1":"3.024807","2":"3.358161","3":"2.698488"},{"1":"3.139579","2":"3.474791","3":"2.785320"},{"1":"3.235689","2":"3.559785","3":"2.912969"},{"1":"2.333414","2":"2.709883","3":"2.021206"},{"1":"2.469408","2":"2.799944","3":"2.107936"},{"1":"2.575766","2":"2.921531","3":"2.232340"},{"1":"2.660337","2":"2.980796","3":"2.329131"},{"1":"2.778917","2":"3.099259","3":"2.432955"},{"1":"2.887304","2":"3.225693","3":"2.574763"},{"1":"2.791023","2":"3.118373","3":"2.465546"},{"1":"2.912234","2":"3.251322","3":"2.594320"},{"1":"2.995408","2":"3.322433","3":"2.661563"},{"1":"3.132285","2":"3.464547","3":"2.799107"},{"1":"3.216522","2":"3.554267","3":"2.893403"},{"1":"3.334902","2":"3.669825","3":"2.989956"},{"1":"2.387181","2":"2.710784","3":"2.071777"},{"1":"2.490646","2":"2.843027","3":"2.156838"},{"1":"2.602843","2":"2.935153","3":"2.252279"},{"1":"2.695408","2":"3.025882","3":"2.355668"},{"1":"2.798694","2":"3.119466","3":"2.481925"},{"1":"2.930752","2":"3.248530","3":"2.588486"},{"1":"2.319479","2":"2.636723","3":"1.980636"},{"1":"2.429133","2":"2.742730","3":"2.104530"},{"1":"2.549782","2":"2.849368","3":"2.220225"},{"1":"2.663539","2":"2.979287","3":"2.310000"},{"1":"2.749970","2":"3.081905","3":"2.424505"},{"1":"2.856660","2":"3.176085","3":"2.527311"},{"1":"2.319706","2":"2.641440","3":"1.995827"},{"1":"2.435301","2":"2.759645","3":"2.111877"},{"1":"2.542289","2":"2.875494","3":"2.194994"},{"1":"2.640177","2":"2.987673","3":"2.302144"},{"1":"2.741023","2":"3.083082","3":"2.412140"},{"1":"2.860012","2":"3.197196","3":"2.523409"},{"1":"2.617027","2":"2.957163","3":"2.294178"},{"1":"2.723648","2":"3.056479","3":"2.402518"},{"1":"2.834013","2":"3.174163","3":"2.504597"},{"1":"2.943457","2":"3.271038","3":"2.618884"},{"1":"3.052023","2":"3.382865","3":"2.707117"},{"1":"3.139689","2":"3.469981","3":"2.831793"},{"1":"2.601771","2":"2.944604","3":"2.272870"},{"1":"2.690327","2":"3.021733","3":"2.371924"},{"1":"2.827149","2":"3.148192","3":"2.489744"},{"1":"2.915369","2":"3.235594","3":"2.566594"},{"1":"3.035386","2":"3.368469","3":"2.683639"},{"1":"3.125120","2":"3.484526","3":"2.768074"},{"1":"3.020841","2":"3.362719","3":"2.709278"},{"1":"3.141310","2":"3.478984","3":"2.829144"},{"1":"3.252481","2":"3.590937","3":"2.929395"},{"1":"3.341868","2":"3.718706","3":"3.022014"},{"1":"3.464534","2":"3.775973","3":"3.157878"},{"1":"3.581561","2":"3.908738","3":"3.252518"},{"1":"2.398721","2":"2.729101","3":"2.051680"},{"1":"2.488554","2":"2.831704","3":"2.175791"},{"1":"2.605051","2":"2.923123","3":"2.264144"},{"1":"2.717372","2":"3.018378","3":"2.394199"},{"1":"2.807704","2":"3.163025","3":"2.479610"},{"1":"2.915983","2":"3.249298","3":"2.584431"},{"1":"2.814426","2":"3.168962","3":"2.467155"},{"1":"2.937838","2":"3.265254","3":"2.592760"},{"1":"3.028009","2":"3.352489","3":"2.703407"},{"1":"3.149222","2":"3.486523","3":"2.813923"},{"1":"3.259705","2":"3.601462","3":"2.891408"},{"1":"3.351835","2":"3.688413","3":"3.012745"},{"1":"2.620939","2":"2.948575","3":"2.294582"},{"1":"2.735084","2":"3.087014","3":"2.385026"},{"1":"2.851295","2":"3.180479","3":"2.531762"},{"1":"2.957512","2":"3.277667","3":"2.629738"},{"1":"3.062148","2":"3.392353","3":"2.729397"},{"1":"3.146205","2":"3.471381","3":"2.796343"},{"1":"2.753584","2":"3.117783","3":"2.441323"},{"1":"2.873591","2":"3.190907","3":"2.535314"},{"1":"2.976872","2":"3.316566","3":"2.645909"},{"1":"3.080382","2":"3.399106","3":"2.745666"},{"1":"3.196996","2":"3.534961","3":"2.875390"},{"1":"3.281907","2":"3.631912","3":"2.958259"},{"1":"3.073703","2":"3.403877","3":"2.759864"},{"1":"3.183630","2":"3.506428","3":"2.835192"},{"1":"3.300658","2":"3.602861","3":"2.978669"},{"1":"3.403710","2":"3.718660","3":"3.068269"},{"1":"3.510938","2":"3.851432","3":"3.170115"},{"1":"3.609536","2":"3.942174","3":"3.277917"},{"1":"2.215937","2":"2.575114","3":"1.883342"},{"1":"2.337067","2":"2.665010","3":"2.012005"},{"1":"2.442720","2":"2.764925","3":"2.130284"},{"1":"2.555892","2":"2.880212","3":"2.234942"},{"1":"2.649332","2":"2.979761","3":"2.332478"},{"1":"2.743757","2":"3.101259","3":"2.425360"},{"1":"2.131575","2":"2.472172","3":"1.795211"},{"1":"2.232609","2":"2.556180","3":"1.914667"},{"1":"2.314247","2":"2.663504","3":"2.007377"},{"1":"2.445338","2":"2.776099","3":"2.117019"},{"1":"2.558537","2":"2.865448","3":"2.223217"},{"1":"2.642542","2":"2.975643","3":"2.327542"},{"1":"2.789201","2":"3.148076","3":"2.454329"},{"1":"2.905596","2":"3.226670","3":"2.580938"},{"1":"3.012520","2":"3.363897","3":"2.663171"},{"1":"3.109707","2":"3.428881","3":"2.778896"},{"1":"3.215518","2":"3.564671","3":"2.893978"},{"1":"3.329676","2":"3.638616","3":"2.989200"},{"1":"2.640344","2":"2.955802","3":"2.302692"},{"1":"2.749863","2":"3.091775","3":"2.420307"},{"1":"2.844067","2":"3.183204","3":"2.536536"},{"1":"2.966596","2":"3.282219","3":"2.629144"},{"1":"3.069861","2":"3.404443","3":"2.750758"},{"1":"3.178942","2":"3.530290","3":"2.828030"},{"1":"2.905508","2":"3.208540","3":"2.576078"},{"1":"3.011391","2":"3.356688","3":"2.675277"},{"1":"3.129446","2":"3.485797","3":"2.771920"},{"1":"3.225699","2":"3.571165","3":"2.880627"},{"1":"3.321520","2":"3.661612","3":"2.980667"},{"1":"3.442134","2":"3.775624","3":"3.121422"},{"1":"2.870368","2":"3.207104","3":"2.551561"},{"1":"2.956570","2":"3.288191","3":"2.630105"},{"1":"3.053159","2":"3.404088","3":"2.705503"},{"1":"3.167852","2":"3.482032","3":"2.844729"},{"1":"3.268326","2":"3.600041","3":"2.942373"},{"1":"3.400352","2":"3.716142","3":"3.071492"},{"1":"2.066589","2":"2.391399","3":"1.726070"},{"1":"2.162444","2":"2.504687","3":"1.841986"},{"1":"2.299795","2":"2.608151","3":"1.956963"},{"1":"2.375648","2":"2.742216","3":"2.050181"},{"1":"2.486892","2":"2.831700","3":"2.162909"},{"1":"2.602853","2":"2.911880","3":"2.266434"},{"1":"2.723212","2":"3.061362","3":"2.384772"},{"1":"2.818923","2":"3.147047","3":"2.506235"},{"1":"2.935212","2":"3.237662","3":"2.594040"},{"1":"3.042027","2":"3.369075","3":"2.694131"},{"1":"3.133160","2":"3.465262","3":"2.799444"},{"1":"3.254505","2":"3.580466","3":"2.916821"},{"1":"2.398935","2":"2.735011","3":"2.056418"},{"1":"2.530481","2":"2.843569","3":"2.197709"},{"1":"2.650251","2":"2.986862","3":"2.313603"},{"1":"2.728163","2":"3.057947","3":"2.398277"},{"1":"2.845215","2":"3.173481","3":"2.537754"},{"1":"2.942779","2":"3.307888","3":"2.616323"},{"1":"2.596347","2":"2.932603","3":"2.280336"},{"1":"2.709013","2":"3.040587","3":"2.371597"},{"1":"2.804946","2":"3.144787","3":"2.478654"},{"1":"2.903021","2":"3.236722","3":"2.593004"},{"1":"3.021421","2":"3.326402","3":"2.659348"},{"1":"3.127809","2":"3.471458","3":"2.797700"},{"1":"2.543930","2":"2.857445","3":"2.213649"},{"1":"2.666173","2":"2.977890","3":"2.338389"},{"1":"2.749891","2":"3.083194","3":"2.417794"},{"1":"2.866673","2":"3.180661","3":"2.520823"},{"1":"2.994616","2":"3.309883","3":"2.639549"},{"1":"3.072664","2":"3.398402","3":"2.747820"},{"1":"2.745865","2":"3.051529","3":"2.419583"},{"1":"2.862539","2":"3.183379","3":"2.526104"},{"1":"2.949327","2":"3.302881","3":"2.610725"},{"1":"3.072555","2":"3.396691","3":"2.731840"},{"1":"3.173775","2":"3.495376","3":"2.830702"},{"1":"3.293491","2":"3.614574","3":"2.927861"},{"1":"2.547669","2":"2.872554","3":"2.215142"},{"1":"2.652355","2":"2.978945","3":"2.320141"},{"1":"2.755708","2":"3.085782","3":"2.415612"},{"1":"2.851853","2":"3.178022","3":"2.553897"},{"1":"2.963699","2":"3.282415","3":"2.632361"},{"1":"3.070413","2":"3.411542","3":"2.731934"},{"1":"2.287254","2":"2.611435","3":"1.981795"},{"1":"2.410018","2":"2.721396","3":"2.042752"},{"1":"2.500676","2":"2.834490","3":"2.164027"},{"1":"2.605546","2":"2.938648","3":"2.281857"},{"1":"2.690552","2":"3.024476","3":"2.385850"},{"1":"2.831291","2":"3.166866","3":"2.508274"},{"1":"3.250965","2":"3.562400","3":"2.953324"},{"1":"3.373689","2":"3.711139","3":"3.043385"},{"1":"3.483795","2":"3.815466","3":"3.140726"},{"1":"3.566341","2":"3.894958","3":"3.266590"},{"1":"3.698610","2":"3.998845","3":"3.372545"},{"1":"3.778549","2":"4.103438","3":"3.438391"},{"1":"2.966686","2":"3.285438","3":"2.651948"},{"1":"3.066284","2":"3.412057","3":"2.723752"},{"1":"3.181317","2":"3.500008","3":"2.833257"},{"1":"3.280879","2":"3.618399","3":"2.961748"},{"1":"3.378544","2":"3.701944","3":"3.054373"},{"1":"3.497013","2":"3.831652","3":"3.165387"},{"1":"2.569108","2":"2.907564","3":"2.210871"},{"1":"2.658153","2":"3.003997","3":"2.311102"},{"1":"2.764243","2":"3.081112","3":"2.433255"},{"1":"2.861427","2":"3.187396","3":"2.521621"},{"1":"2.959118","2":"3.281190","3":"2.635082"},{"1":"3.056804","2":"3.396350","3":"2.735543"},{"1":"2.472593","2":"2.816459","3":"2.143586"},{"1":"2.566231","2":"2.897500","3":"2.222460"},{"1":"2.689598","2":"3.006887","3":"2.334996"},{"1":"2.793161","2":"3.116266","3":"2.465171"},{"1":"2.916917","2":"3.223638","3":"2.568197"},{"1":"3.007876","2":"3.352682","3":"2.660946"},{"1":"2.749469","2":"3.079405","3":"2.436752"},{"1":"2.854367","2":"3.185742","3":"2.519854"},{"1":"2.937131","2":"3.282665","3":"2.617996"},{"1":"3.081969","2":"3.370570","3":"2.736146"},{"1":"3.169922","2":"3.512637","3":"2.843563"},{"1":"3.282279","2":"3.616842","3":"2.958989"},{"1":"2.548070","2":"2.917401","3":"2.204113"},{"1":"2.655899","2":"2.987075","3":"2.327379"},{"1":"2.753473","2":"3.108792","3":"2.439387"},{"1":"2.869150","2":"3.200754","3":"2.531695"},{"1":"2.965343","2":"3.315663","3":"2.634331"},{"1":"3.071624","2":"3.405523","3":"2.745805"},{"1":"2.784187","2":"3.112139","3":"2.459085"},{"1":"2.900800","2":"3.235884","3":"2.577320"},{"1":"2.986429","2":"3.298707","3":"2.652346"},{"1":"3.099237","2":"3.441693","3":"2.765282"},{"1":"3.199237","2":"3.556019","3":"2.880277"},{"1":"3.322603","2":"3.656276","3":"2.981842"},{"1":"2.424928","2":"2.766429","3":"2.090102"},{"1":"2.531777","2":"2.881095","3":"2.206757"},{"1":"2.636642","2":"2.958757","3":"2.297204"},{"1":"2.733331","2":"3.075118","3":"2.440813"},{"1":"2.847934","2":"3.187219","3":"2.531971"},{"1":"2.959172","2":"3.293234","3":"2.616120"},{"1":"2.152252","2":"2.503208","3":"1.837436"},{"1":"2.258562","2":"2.602593","3":"1.920610"},{"1":"2.367004","2":"2.695705","3":"2.020304"},{"1":"2.482083","2":"2.793814","3":"2.139637"},{"1":"2.588217","2":"2.930576","3":"2.251365"},{"1":"2.671753","2":"3.016797","3":"2.375693"},{"1":"2.928270","2":"3.259524","3":"2.598305"},{"1":"3.022468","2":"3.356745","3":"2.706023"},{"1":"3.151473","2":"3.478012","3":"2.831526"},{"1":"3.251586","2":"3.589613","3":"2.927343"},{"1":"3.368931","2":"3.705137","3":"3.042856"},{"1":"3.493527","2":"3.801449","3":"3.180149"},{"1":"2.567312","2":"2.858274","3":"2.222963"},{"1":"2.673323","2":"2.972669","3":"2.341972"},{"1":"2.767529","2":"3.093639","3":"2.448900"},{"1":"2.877645","2":"3.195671","3":"2.561220"},{"1":"2.986622","2":"3.320665","3":"2.676578"},{"1":"3.077899","2":"3.426501","3":"2.763914"},{"1":"2.446476","2":"2.785881","3":"2.104006"},{"1":"2.575033","2":"2.885132","3":"2.253003"},{"1":"2.641820","2":"3.000545","3":"2.307666"},{"1":"2.788746","2":"3.110872","3":"2.467904"},{"1":"2.888640","2":"3.218680","3":"2.551030"},{"1":"3.004288","2":"3.316863","3":"2.656073"},{"1":"2.699444","2":"3.032114","3":"2.360050"},{"1":"2.802550","2":"3.137838","3":"2.484866"},{"1":"2.902301","2":"3.242124","3":"2.562309"},{"1":"3.000405","2":"3.315535","3":"2.651960"},{"1":"3.107646","2":"3.459159","3":"2.797608"},{"1":"3.236183","2":"3.553750","3":"2.930412"},{"1":"3.366956","2":"3.721155","3":"3.032869"},{"1":"3.482341","2":"3.811621","3":"3.160010"},{"1":"3.579434","2":"3.923438","3":"3.242424"},{"1":"3.670868","2":"4.025274","3":"3.360754"},{"1":"3.769173","2":"4.121349","3":"3.460114"},{"1":"3.890896","2":"4.238077","3":"3.558876"},{"1":"2.234963","2":"2.570782","3":"1.878407"},{"1":"2.341704","2":"2.682193","3":"2.018818"},{"1":"2.475229","2":"2.791551","3":"2.103989"},{"1":"2.561255","2":"2.905605","3":"2.225922"},{"1":"2.658693","2":"3.003102","3":"2.333642"},{"1":"2.783694","2":"3.105916","3":"2.461384"},{"1":"2.271467","2":"2.585867","3":"1.953267"},{"1":"2.368923","2":"2.696774","3":"2.014690"},{"1":"2.457555","2":"2.788100","3":"2.132595"},{"1":"2.568445","2":"2.918385","3":"2.240198"},{"1":"2.680263","2":"3.015209","3":"2.318573"},{"1":"2.795190","2":"3.132119","3":"2.476011"},{"1":"2.209428","2":"2.544096","3":"1.853709"},{"1":"2.299379","2":"2.654861","3":"1.956025"},{"1":"2.417164","2":"2.753533","3":"2.115965"},{"1":"2.525991","2":"2.868995","3":"2.194188"},{"1":"2.633321","2":"2.969615","3":"2.282046"},{"1":"2.746796","2":"3.077147","3":"2.377671"},{"1":"2.519692","2":"2.848624","3":"2.215233"},{"1":"2.629432","2":"2.956081","3":"2.314696"},{"1":"2.724215","2":"3.069529","3":"2.396831"},{"1":"2.853345","2":"3.159979","3":"2.531117"},{"1":"2.953733","2":"3.280086","3":"2.619863"},{"1":"3.056138","2":"3.393053","3":"2.745763"},{"1":"2.096555","2":"2.434395","3":"1.735939"},{"1":"2.202672","2":"2.537001","3":"1.875546"},{"1":"2.306275","2":"2.645891","3":"1.983400"},{"1":"2.409669","2":"2.719453","3":"2.094506"},{"1":"2.521897","2":"2.847913","3":"2.185796"},{"1":"2.633104","2":"2.986715","3":"2.318173"},{"1":"2.176656","2":"2.474347","3":"1.833239"},{"1":"2.271496","2":"2.586010","3":"1.955375"},{"1":"2.379554","2":"2.703211","3":"2.058082"},{"1":"2.470343","2":"2.808174","3":"2.155099"},{"1":"2.585121","2":"2.916908","3":"2.259683"},{"1":"2.697489","2":"3.052443","3":"2.368499"},{"1":"2.815202","2":"3.140023","3":"2.491141"},{"1":"2.936106","2":"3.259163","3":"2.618330"},{"1":"3.033347","2":"3.343480","3":"2.695548"},{"1":"3.114004","2":"3.478347","3":"2.798024"},{"1":"3.229473","2":"3.564831","3":"2.920378"},{"1":"3.350927","2":"3.681400","3":"3.025947"},{"1":"2.453928","2":"2.754354","3":"2.111464"},{"1":"2.534376","2":"2.854408","3":"2.181016"},{"1":"2.638582","2":"2.966972","3":"2.306793"},{"1":"2.746957","2":"3.073764","3":"2.430319"},{"1":"2.876561","2":"3.200849","3":"2.552694"},{"1":"2.957322","2":"3.288578","3":"2.615354"},{"1":"2.568158","2":"2.882914","3":"2.216833"},{"1":"2.661916","2":"3.004693","3":"2.323804"},{"1":"2.778186","2":"3.109889","3":"2.444966"},{"1":"2.890130","2":"3.220128","3":"2.526949"},{"1":"2.970683","2":"3.312718","3":"2.653411"},{"1":"3.097228","2":"3.425004","3":"2.755045"},{"1":"2.508366","2":"2.828572","3":"2.183909"},{"1":"2.632718","2":"2.958460","3":"2.314562"},{"1":"2.728614","2":"3.055950","3":"2.403563"},{"1":"2.817911","2":"3.164764","3":"2.496177"},{"1":"2.932782","2":"3.272992","3":"2.613068"},{"1":"3.045476","2":"3.388065","3":"2.719435"},{"1":"2.473175","2":"2.798893","3":"2.141272"},{"1":"2.586137","2":"2.922282","3":"2.248086"},{"1":"2.695094","2":"3.010238","3":"2.342623"},{"1":"2.780707","2":"3.105527","3":"2.443186"},{"1":"2.887808","2":"3.243567","3":"2.582839"},{"1":"3.004780","2":"3.315576","3":"2.684629"},{"1":"2.572086","2":"2.931496","3":"2.248016"},{"1":"2.701192","2":"3.004575","3":"2.360296"},{"1":"2.794124","2":"3.127463","3":"2.466612"},{"1":"2.915409","2":"3.271272","3":"2.580882"},{"1":"2.999566","2":"3.338967","3":"2.665640"},{"1":"3.105276","2":"3.452458","3":"2.776586"},{"1":"2.724263","2":"3.065971","3":"2.415904"},{"1":"2.835537","2":"3.158616","3":"2.525818"},{"1":"2.965079","2":"3.281677","3":"2.637067"},{"1":"3.047019","2":"3.377645","3":"2.677028"},{"1":"3.167872","2":"3.492490","3":"2.843182"},{"1":"3.269596","2":"3.613707","3":"2.921514"},{"1":"2.379447","2":"2.714256","3":"2.058156"},{"1":"2.512302","2":"2.846019","3":"2.182166"},{"1":"2.610390","2":"2.950893","3":"2.253500"},{"1":"2.705002","2":"3.047649","3":"2.376674"},{"1":"2.803849","2":"3.154483","3":"2.465151"},{"1":"2.936627","2":"3.261804","3":"2.599432"},{"1":"2.714970","2":"3.072461","3":"2.358820"},{"1":"2.830356","2":"3.163655","3":"2.495327"},{"1":"2.933186","2":"3.263370","3":"2.599822"},{"1":"3.029070","2":"3.365000","3":"2.700218"},{"1":"3.136841","2":"3.449173","3":"2.796713"},{"1":"3.256264","2":"3.576230","3":"2.903772"},{"1":"2.658166","2":"2.994081","3":"2.330088"},{"1":"2.790532","2":"3.092881","3":"2.461653"},{"1":"2.897920","2":"3.246470","3":"2.591661"},{"1":"3.004460","2":"3.333004","3":"2.692151"},{"1":"3.108689","2":"3.438319","3":"2.760180"},{"1":"3.219083","2":"3.547687","3":"2.884702"},{"1":"2.839529","2":"3.181646","3":"2.517344"},{"1":"2.948544","2":"3.269866","3":"2.613838"},{"1":"3.061977","2":"3.389374","3":"2.735158"},{"1":"3.181182","2":"3.503117","3":"2.812276"},{"1":"3.281732","2":"3.627375","3":"2.943482"},{"1":"3.382423","2":"3.720040","3":"3.037792"},{"1":"2.213088","2":"2.552596","3":"1.912393"},{"1":"2.323100","2":"2.663347","3":"1.985023"},{"1":"2.449819","2":"2.768077","3":"2.104900"},{"1":"2.539072","2":"2.883962","3":"2.208609"},{"1":"2.636699","2":"2.957346","3":"2.294925"},{"1":"2.752193","2":"3.089194","3":"2.429131"},{"1":"2.710617","2":"3.029532","3":"2.356188"},{"1":"2.796180","2":"3.150834","3":"2.474916"},{"1":"2.903851","2":"3.235710","3":"2.557103"},{"1":"2.996507","2":"3.336731","3":"2.685040"},{"1":"3.110820","2":"3.431214","3":"2.777549"},{"1":"3.236198","2":"3.571756","3":"2.885343"},{"1":"2.387864","2":"2.718001","3":"2.053821"},{"1":"2.500680","2":"2.835922","3":"2.149144"},{"1":"2.618400","2":"2.933702","3":"2.265863"},{"1":"2.706762","2":"3.036973","3":"2.393872"},{"1":"2.795718","2":"3.151562","3":"2.473783"},{"1":"2.940548","2":"3.271398","3":"2.613412"},{"1":"2.483229","2":"2.830700","3":"2.151091"},{"1":"2.586920","2":"2.911221","3":"2.245197"},{"1":"2.704279","2":"3.015937","3":"2.367560"},{"1":"2.797876","2":"3.114296","3":"2.479707"},{"1":"2.892589","2":"3.224084","3":"2.572858"},{"1":"3.013327","2":"3.337453","3":"2.705761"},{"1":"2.247778","2":"2.583415","3":"1.921357"},{"1":"2.355904","2":"2.697911","3":"2.031758"},{"1":"2.473905","2":"2.804675","3":"2.142385"},{"1":"2.564194","2":"2.895305","3":"2.239207"},{"1":"2.678377","2":"3.002246","3":"2.365244"},{"1":"2.794657","2":"3.098116","3":"2.463124"},{"1":"2.529835","2":"2.852151","3":"2.198139"},{"1":"2.642152","2":"2.973985","3":"2.292016"},{"1":"2.731977","2":"3.068826","3":"2.407918"},{"1":"2.836583","2":"3.170684","3":"2.518125"},{"1":"2.935743","2":"3.301063","3":"2.608406"},{"1":"3.061416","2":"3.397388","3":"2.725562"},{"1":"2.553508","2":"2.879118","3":"2.224115"},{"1":"2.632929","2":"2.944635","3":"2.334531"},{"1":"2.738190","2":"3.093804","3":"2.412377"},{"1":"2.859530","2":"3.193697","3":"2.528986"},{"1":"2.980147","2":"3.294169","3":"2.651090"},{"1":"3.077374","2":"3.380732","3":"2.721558"},{"1":"2.731255","2":"3.059262","3":"2.413742"},{"1":"2.846570","2":"3.141579","3":"2.510304"},{"1":"2.932387","2":"3.258324","3":"2.613844"},{"1":"3.059599","2":"3.384343","3":"2.699631"},{"1":"3.142599","2":"3.477494","3":"2.821515"},{"1":"3.247585","2":"3.598137","3":"2.920259"},{"1":"2.904093","2":"3.254495","3":"2.576423"},{"1":"2.995333","2":"3.335081","3":"2.662718"},{"1":"3.109833","2":"3.452228","3":"2.790613"},{"1":"3.221483","2":"3.548963","3":"2.895763"},{"1":"3.335369","2":"3.673599","3":"3.006841"},{"1":"3.429674","2":"3.771540","3":"3.123970"},{"1":"2.768429","2":"3.107661","3":"2.430119"},{"1":"2.863386","2":"3.210025","3":"2.543938"},{"1":"2.975979","2":"3.304290","3":"2.635601"},{"1":"3.080428","2":"3.397937","3":"2.743135"},{"1":"3.207813","2":"3.518644","3":"2.847330"},{"1":"3.283381","2":"3.639544","3":"2.975307"},{"1":"2.206816","2":"2.509578","3":"1.850377"},{"1":"2.318016","2":"2.637146","3":"2.002782"},{"1":"2.417839","2":"2.740055","3":"2.077234"},{"1":"2.512302","2":"2.858840","3":"2.194023"},{"1":"2.639435","2":"2.965221","3":"2.305386"},{"1":"2.740657","2":"3.069361","3":"2.381753"},{"1":"2.606395","2":"2.962579","3":"2.282115"},{"1":"2.721442","2":"3.041749","3":"2.383240"},{"1":"2.837801","2":"3.163547","3":"2.493735"},{"1":"2.941570","2":"3.277523","3":"2.598231"},{"1":"3.057050","2":"3.387020","3":"2.710339"},{"1":"3.143362","2":"3.467193","3":"2.798447"},{"1":"2.681603","2":"3.026729","3":"2.373773"},{"1":"2.776895","2":"3.104046","3":"2.443690"},{"1":"2.899833","2":"3.237497","3":"2.557264"},{"1":"3.009109","2":"3.325866","3":"2.646238"},{"1":"3.115762","2":"3.428716","3":"2.777670"},{"1":"3.234906","2":"3.556196","3":"2.888021"},{"1":"2.425179","2":"2.765459","3":"2.112571"},{"1":"2.535337","2":"2.864915","3":"2.191020"},{"1":"2.647728","2":"2.989492","3":"2.311174"},{"1":"2.759718","2":"3.080641","3":"2.402831"},{"1":"2.860068","2":"3.188027","3":"2.531782"},{"1":"2.957221","2":"3.294901","3":"2.628796"},{"1":"2.517335","2":"2.847876","3":"2.189533"},{"1":"2.621934","2":"2.936482","3":"2.287835"},{"1":"2.723787","2":"3.043928","3":"2.381144"},{"1":"2.837438","2":"3.171793","3":"2.488672"},{"1":"2.927027","2":"3.274648","3":"2.624047"},{"1":"3.026111","2":"3.372101","3":"2.689887"},{"1":"2.549527","2":"2.853450","3":"2.207007"},{"1":"2.634683","2":"2.964877","3":"2.343041"},{"1":"2.743727","2":"3.075997","3":"2.410898"},{"1":"2.844095","2":"3.161177","3":"2.529174"},{"1":"2.941377","2":"3.259755","3":"2.618637"},{"1":"3.070162","2":"3.379900","3":"2.758953"},{"1":"2.788581","2":"3.124678","3":"2.463276"},{"1":"2.925973","2":"3.252304","3":"2.582189"},{"1":"3.007523","2":"3.337640","3":"2.703094"},{"1":"3.114948","2":"3.448585","3":"2.774476"},{"1":"3.225570","2":"3.541670","3":"2.906678"},{"1":"3.335464","2":"3.680339","3":"3.007175"},{"1":"2.463717","2":"2.783908","3":"2.150877"},{"1":"2.573284","2":"2.921253","3":"2.256667"},{"1":"2.708608","2":"3.005811","3":"2.369647"},{"1":"2.788729","2":"3.112461","3":"2.467735"},{"1":"2.888614","2":"3.246519","3":"2.569253"},{"1":"3.003672","2":"3.354634","3":"2.680510"},{"1":"2.807368","2":"3.151144","3":"2.489525"},{"1":"2.911224","2":"3.236230","3":"2.563918"},{"1":"3.005735","2":"3.325084","3":"2.690709"},{"1":"3.105729","2":"3.450973","3":"2.775053"},{"1":"3.241438","2":"3.549955","3":"2.910390"},{"1":"3.327761","2":"3.647990","3":"2.984839"},{"1":"2.683367","2":"3.004815","3":"2.338479"},{"1":"2.807980","2":"3.166944","3":"2.466206"},{"1":"2.887868","2":"3.212215","3":"2.571936"},{"1":"2.992982","2":"3.324197","3":"2.642813"},{"1":"3.094188","2":"3.420244","3":"2.769476"},{"1":"3.240739","2":"3.565071","3":"2.891258"},{"1":"2.554162","2":"2.893438","3":"2.215041"},{"1":"2.662774","2":"3.006708","3":"2.335852"},{"1":"2.775468","2":"3.092372","3":"2.458732"},{"1":"2.886997","2":"3.187137","3":"2.531886"},{"1":"2.990855","2":"3.288503","3":"2.675027"},{"1":"3.082837","2":"3.435419","3":"2.762708"},{"1":"2.695984","2":"3.024253","3":"2.359668"},{"1":"2.788656","2":"3.134676","3":"2.446925"},{"1":"2.894204","2":"3.252131","3":"2.546088"},{"1":"3.001149","2":"3.339761","3":"2.678935"},{"1":"3.115111","2":"3.450294","3":"2.788801"},{"1":"3.231363","2":"3.558683","3":"2.877516"},{"1":"2.526530","2":"2.875951","3":"2.179081"},{"1":"2.624948","2":"2.960142","3":"2.282281"},{"1":"2.734678","2":"3.073717","3":"2.401627"},{"1":"2.839370","2":"3.194045","3":"2.524004"},{"1":"2.945568","2":"3.310946","3":"2.606438"},{"1":"3.038611","2":"3.398658","3":"2.699975"},{"1":"2.301532","2":"2.642986","3":"1.942224"},{"1":"2.404479","2":"2.733235","3":"2.081583"},{"1":"2.534167","2":"2.861888","3":"2.196493"},{"1":"2.612223","2":"2.962335","3":"2.279623"},{"1":"2.738397","2":"3.065611","3":"2.376754"},{"1":"2.855229","2":"3.151283","3":"2.514541"},{"1":"2.989258","2":"3.322318","3":"2.644923"},{"1":"3.102015","2":"3.452950","3":"2.787825"},{"1":"3.180993","2":"3.550487","3":"2.866666"},{"1":"3.313244","2":"3.625891","3":"2.972301"},{"1":"3.405595","2":"3.762898","3":"3.051137"},{"1":"3.529927","2":"3.878367","3":"3.178410"},{"1":"2.457764","2":"2.788017","3":"2.126934"},{"1":"2.551774","2":"2.903743","3":"2.228434"},{"1":"2.653669","2":"2.979746","3":"2.342003"},{"1":"2.786848","2":"3.121469","3":"2.430325"},{"1":"2.884940","2":"3.216876","3":"2.548217"},{"1":"2.993900","2":"3.330121","3":"2.675900"},{"1":"2.543281","2":"2.858181","3":"2.208688"},{"1":"2.670332","2":"2.971326","3":"2.335166"},{"1":"2.771306","2":"3.099087","3":"2.447939"},{"1":"2.856609","2":"3.220095","3":"2.530211"},{"1":"2.967685","2":"3.284578","3":"2.639913"},{"1":"3.079954","2":"3.438224","3":"2.743005"},{"1":"2.356254","2":"2.703326","3":"2.036191"},{"1":"2.482243","2":"2.810419","3":"2.149968"},{"1":"2.569265","2":"2.906120","3":"2.271153"},{"1":"2.692580","2":"3.008429","3":"2.346888"},{"1":"2.791549","2":"3.121226","3":"2.449577"},{"1":"2.910239","2":"3.243069","3":"2.577210"},{"1":"2.417057","2":"2.746340","3":"2.081453"},{"1":"2.539276","2":"2.851852","3":"2.199986"},{"1":"2.639621","2":"2.946715","3":"2.293295"},{"1":"2.722557","2":"3.065946","3":"2.385724"},{"1":"2.843011","2":"3.174394","3":"2.520604"},{"1":"2.946182","2":"3.300732","3":"2.619278"},{"1":"2.503430","2":"2.852456","3":"2.147656"},{"1":"2.603845","2":"2.919417","3":"2.245705"},{"1":"2.689505","2":"3.024983","3":"2.369819"},{"1":"2.800022","2":"3.162403","3":"2.463231"},{"1":"2.900639","2":"3.250114","3":"2.577899"},{"1":"3.019804","2":"3.368890","3":"2.694198"},{"1":"2.563542","2":"2.894174","3":"2.237981"},{"1":"2.659446","2":"2.990196","3":"2.349382"},{"1":"2.785418","2":"3.118735","3":"2.428612"},{"1":"2.882396","2":"3.216451","3":"2.551026"},{"1":"2.991077","2":"3.327502","3":"2.650502"},{"1":"3.117617","2":"3.426032","3":"2.777700"},{"1":"2.816188","2":"3.143546","3":"2.491349"},{"1":"2.921159","2":"3.238966","3":"2.590741"},{"1":"3.028858","2":"3.358028","3":"2.685572"},{"1":"3.133753","2":"3.473352","3":"2.774942"},{"1":"3.241475","2":"3.586112","3":"2.921337"},{"1":"3.352002","2":"3.691082","3":"3.020825"},{"1":"2.510867","2":"2.818384","3":"2.182671"},{"1":"2.627611","2":"2.951209","3":"2.306914"},{"1":"2.735169","2":"3.048989","3":"2.406121"},{"1":"2.838879","2":"3.180809","3":"2.499348"},{"1":"2.932222","2":"3.239184","3":"2.610709"},{"1":"3.058153","2":"3.391016","3":"2.712511"},{"1":"2.511401","2":"2.875807","3":"2.195425"},{"1":"2.610123","2":"2.951736","3":"2.298827"},{"1":"2.739384","2":"3.084180","3":"2.403190"},{"1":"2.842418","2":"3.161268","3":"2.497010"},{"1":"2.947601","2":"3.261568","3":"2.634957"},{"1":"3.039468","2":"3.386674","3":"2.703876"},{"1":"2.932316","2":"3.274600","3":"2.617236"},{"1":"3.059312","2":"3.379534","3":"2.706700"},{"1":"3.134424","2":"3.458698","3":"2.833975"},{"1":"3.258639","2":"3.581186","3":"2.930249"},{"1":"3.353246","2":"3.678935","3":"3.022428"},{"1":"3.470329","2":"3.797619","3":"3.144215"},{"1":"2.563367","2":"2.900996","3":"2.250289"},{"1":"2.662977","2":"3.008776","3":"2.354493"},{"1":"2.788704","2":"3.120265","3":"2.465764"},{"1":"2.883460","2":"3.224257","3":"2.566681"},{"1":"3.013237","2":"3.330297","3":"2.693849"},{"1":"3.112523","2":"3.452567","3":"2.773657"},{"1":"3.066155","2":"3.404211","3":"2.722874"},{"1":"3.151002","2":"3.484662","3":"2.812793"},{"1":"3.272036","2":"3.599309","3":"2.941299"},{"1":"3.364709","2":"3.702558","3":"3.050874"},{"1":"3.478129","2":"3.789883","3":"3.150946"},{"1":"3.581743","2":"3.929605","3":"3.264727"},{"1":"2.963954","2":"3.315133","3":"2.640006"},{"1":"3.070831","2":"3.414581","3":"2.722845"},{"1":"3.180641","2":"3.506974","3":"2.852774"},{"1":"3.291332","2":"3.613937","3":"2.936880"},{"1":"3.389363","2":"3.720692","3":"3.067069"},{"1":"3.505369","2":"3.828700","3":"3.159983"},{"1":"2.525631","2":"2.839454","3":"2.169517"},{"1":"2.595950","2":"2.939770","3":"2.293020"},{"1":"2.712152","2":"3.053329","3":"2.384844"},{"1":"2.820785","2":"3.166136","3":"2.508999"},{"1":"2.934204","2":"3.245388","3":"2.604546"},{"1":"3.036365","2":"3.373639","3":"2.710352"},{"1":"2.179362","2":"2.517445","3":"1.836237"},{"1":"2.286470","2":"2.600823","3":"1.927862"},{"1":"2.394559","2":"2.723112","3":"2.062531"},{"1":"2.488879","2":"2.811696","3":"2.163119"},{"1":"2.600663","2":"2.959492","3":"2.259216"},{"1":"2.701059","2":"3.029377","3":"2.340736"},{"1":"2.562119","2":"2.899129","3":"2.234316"},{"1":"2.653719","2":"3.000202","3":"2.349159"},{"1":"2.785320","2":"3.103960","3":"2.467425"},{"1":"2.879951","2":"3.193686","3":"2.542013"},{"1":"2.982366","2":"3.307355","3":"2.657956"},{"1":"3.081935","2":"3.420660","3":"2.756699"},{"1":"2.479261","2":"2.808807","3":"2.140721"},{"1":"2.586023","2":"2.918637","3":"2.231648"},{"1":"2.709370","2":"3.013403","3":"2.380490"},{"1":"2.794882","2":"3.117433","3":"2.470997"},{"1":"2.916034","2":"3.235695","3":"2.574728"},{"1":"3.004930","2":"3.348121","3":"2.690546"},{"1":"2.597770","2":"2.927147","3":"2.277790"},{"1":"2.696623","2":"3.063228","3":"2.365331"},{"1":"2.793424","2":"3.130709","3":"2.482030"},{"1":"2.917220","2":"3.252018","3":"2.575672"},{"1":"3.016754","2":"3.364710","3":"2.672096"},{"1":"3.141560","2":"3.469188","3":"2.825397"},{"1":"2.799181","2":"3.130215","3":"2.471713"},{"1":"2.903470","2":"3.213063","3":"2.563460"},{"1":"3.003399","2":"3.349620","3":"2.659885"},{"1":"3.115884","2":"3.453326","3":"2.785788"},{"1":"3.202443","2":"3.526557","3":"2.891803"},{"1":"3.339260","2":"3.667347","3":"3.003286"},{"1":"2.794079","2":"3.133971","3":"2.472192"},{"1":"2.908479","2":"3.236413","3":"2.582688"},{"1":"3.024708","2":"3.345424","3":"2.701721"},{"1":"3.105210","2":"3.451338","3":"2.811981"},{"1":"3.238855","2":"3.593490","3":"2.899760"},{"1":"3.345606","2":"3.679040","3":"3.003223"},{"1":"2.871618","2":"3.199220","3":"2.535464"},{"1":"2.976857","2":"3.332111","3":"2.635977"},{"1":"3.079147","2":"3.408642","3":"2.752976"},{"1":"3.160354","2":"3.504533","3":"2.840592"},{"1":"3.309656","2":"3.642131","3":"2.965402"},{"1":"3.402929","2":"3.746097","3":"3.076420"},{"1":"2.864983","2":"3.187806","3":"2.548877"},{"1":"2.961957","2":"3.283143","3":"2.620566"},{"1":"3.073614","2":"3.388014","3":"2.744331"},{"1":"3.196373","2":"3.516645","3":"2.847509"},{"1":"3.289894","2":"3.625773","3":"2.946927"},{"1":"3.394757","2":"3.701776","3":"3.041899"},{"1":"3.013861","2":"3.313391","3":"2.667608"},{"1":"3.090664","2":"3.399119","3":"2.760234"},{"1":"3.218569","2":"3.544434","3":"2.866114"},{"1":"3.320058","2":"3.644862","3":"2.984600"},{"1":"3.428060","2":"3.739673","3":"3.080546"},{"1":"3.511294","2":"3.821642","3":"3.190479"},{"1":"2.313987","2":"2.632074","3":"1.976095"},{"1":"2.415120","2":"2.770687","3":"2.075119"},{"1":"2.523028","2":"2.878813","3":"2.177823"},{"1":"2.612787","2":"2.953393","3":"2.291691"},{"1":"2.731793","2":"3.062922","3":"2.424564"},{"1":"2.842593","2":"3.199373","3":"2.505540"},{"1":"2.566702","2":"2.898257","3":"2.203182"},{"1":"2.655544","2":"2.998350","3":"2.327971"},{"1":"2.768555","2":"3.104247","3":"2.426237"},{"1":"2.893796","2":"3.211011","3":"2.535868"},{"1":"2.978169","2":"3.308657","3":"2.634001"},{"1":"3.097108","2":"3.439435","3":"2.745368"},{"1":"2.863895","2":"3.183564","3":"2.522416"},{"1":"2.967374","2":"3.318343","3":"2.639395"},{"1":"3.075798","2":"3.407394","3":"2.748528"},{"1":"3.177536","2":"3.495285","3":"2.841637"},{"1":"3.291335","2":"3.636566","3":"2.963804"},{"1":"3.397160","2":"3.730240","3":"3.093720"},{"1":"2.725255","2":"3.040633","3":"2.373493"},{"1":"2.827959","2":"3.167946","3":"2.489359"},{"1":"2.927906","2":"3.250863","3":"2.581287"},{"1":"3.032937","2":"3.369923","3":"2.668135"},{"1":"3.137555","2":"3.459526","3":"2.814287"},{"1":"3.234097","2":"3.579341","3":"2.902397"},{"1":"2.673517","2":"3.015507","3":"2.353578"},{"1":"2.801770","2":"3.151339","3":"2.467260"},{"1":"2.901822","2":"3.251540","3":"2.589691"},{"1":"3.011586","2":"3.331374","3":"2.692980"},{"1":"3.133797","2":"3.468379","3":"2.809647"},{"1":"3.227001","2":"3.553761","3":"2.910140"},{"1":"2.502169","2":"2.852797","3":"2.148773"},{"1":"2.633663","2":"2.974734","3":"2.290073"},{"1":"2.721884","2":"3.068802","3":"2.392619"},{"1":"2.845647","2":"3.186226","3":"2.521882"},{"1":"2.947585","2":"3.297380","3":"2.593618"},{"1":"3.062012","2":"3.406356","3":"2.723128"},{"1":"2.805355","2":"3.145651","3":"2.460131"},{"1":"2.898064","2":"3.210563","3":"2.551114"},{"1":"2.998515","2":"3.336462","3":"2.675409"},{"1":"3.091059","2":"3.440601","3":"2.769223"},{"1":"3.194783","2":"3.543762","3":"2.866643"},{"1":"3.326883","2":"3.636227","3":"3.001194"},{"1":"2.627303","2":"2.952916","3":"2.281934"},{"1":"2.719579","2":"3.076693","3":"2.369108"},{"1":"2.829119","2":"3.146544","3":"2.497504"},{"1":"2.954065","2":"3.264970","3":"2.604427"},{"1":"3.051700","2":"3.381636","3":"2.721232"},{"1":"3.159113","2":"3.477884","3":"2.818935"},{"1":"2.633021","2":"2.971834","3":"2.315115"},{"1":"2.749353","2":"3.086233","3":"2.429026"},{"1":"2.863341","2":"3.184722","3":"2.541320"},{"1":"2.966236","2":"3.301170","3":"2.611286"},{"1":"3.082686","2":"3.406506","3":"2.745019"},{"1":"3.180437","2":"3.517494","3":"2.861494"},{"1":"2.363669","2":"2.724127","3":"2.048969"},{"1":"2.473144","2":"2.800217","3":"2.118232"},{"1":"2.593416","2":"2.909734","3":"2.271889"},{"1":"2.692690","2":"3.030700","3":"2.371300"},{"1":"2.783861","2":"3.141784","3":"2.475698"},{"1":"2.903510","2":"3.236032","3":"2.587577"},{"1":"2.264536","2":"2.571721","3":"1.920149"},{"1":"2.347743","2":"2.658408","3":"2.014409"},{"1":"2.483459","2":"2.806379","3":"2.114764"},{"1":"2.573877","2":"2.923329","3":"2.264008"},{"1":"2.681310","2":"3.023369","3":"2.338150"},{"1":"2.776367","2":"3.095226","3":"2.443032"},{"1":"2.805061","2":"3.130130","3":"2.479032"},{"1":"2.926934","2":"3.256705","3":"2.583403"},{"1":"3.022566","2":"3.369357","3":"2.686982"},{"1":"3.136698","2":"3.459324","3":"2.795524"},{"1":"3.233186","2":"3.526753","3":"2.922881"},{"1":"3.353803","2":"3.675014","3":"3.012031"},{"1":"2.350200","2":"2.670732","3":"2.021348"},{"1":"2.456581","2":"2.816801","3":"2.106369"},{"1":"2.552489","2":"2.879113","3":"2.222037"},{"1":"2.665412","2":"2.994861","3":"2.349669"},{"1":"2.780560","2":"3.101256","3":"2.439462"},{"1":"2.872395","2":"3.208113","3":"2.547552"},{"1":"2.595927","2":"2.936158","3":"2.268649"},{"1":"2.714186","2":"3.034190","3":"2.403316"},{"1":"2.820862","2":"3.145452","3":"2.475888"},{"1":"2.935005","2":"3.249256","3":"2.580041"},{"1":"3.044422","2":"3.376822","3":"2.694337"},{"1":"3.137324","2":"3.488461","3":"2.804035"},{"1":"2.708904","2":"3.030701","3":"2.369669"},{"1":"2.799796","2":"3.106952","3":"2.459898"},{"1":"2.909427","2":"3.242864","3":"2.573067"},{"1":"3.004490","2":"3.349210","3":"2.685277"},{"1":"3.092558","2":"3.408272","3":"2.785736"},{"1":"3.219159","2":"3.526274","3":"2.890055"},{"1":"2.534505","2":"2.862225","3":"2.200352"},{"1":"2.657147","2":"2.984892","3":"2.314498"},{"1":"2.769941","2":"3.116714","3":"2.418869"},{"1":"2.855104","2":"3.203761","3":"2.533307"},{"1":"2.979583","2":"3.278981","3":"2.651733"},{"1":"3.070071","2":"3.412615","3":"2.733831"},{"1":"2.247876","2":"2.540951","3":"1.916684"},{"1":"2.352614","2":"2.657108","3":"2.008206"},{"1":"2.458077","2":"2.776672","3":"2.118628"},{"1":"2.574511","2":"2.904592","3":"2.228292"},{"1":"2.659489","2":"3.005984","3":"2.337941"},{"1":"2.776872","2":"3.127885","3":"2.440148"},{"1":"2.749289","2":"3.092273","3":"2.439124"},{"1":"2.849713","2":"3.184500","3":"2.528097"},{"1":"2.956876","2":"3.265081","3":"2.629684"},{"1":"3.059264","2":"3.388392","3":"2.726975"},{"1":"3.170728","2":"3.484841","3":"2.847671"},{"1":"3.288890","2":"3.636297","3":"2.935525"},{"1":"2.803561","2":"3.109251","3":"2.467022"},{"1":"2.911247","2":"3.242934","3":"2.583296"},{"1":"3.017941","2":"3.340144","3":"2.664378"},{"1":"3.134172","2":"3.457252","3":"2.807405"},{"1":"3.231178","2":"3.575106","3":"2.899799"},{"1":"3.354178","2":"3.677102","3":"3.014147"},{"1":"2.233705","2":"2.558229","3":"1.860208"},{"1":"2.321350","2":"2.654391","3":"2.001002"},{"1":"2.446516","2":"2.778553","3":"2.113771"},{"1":"2.545759","2":"2.880146","3":"2.196487"},{"1":"2.641539","2":"2.977984","3":"2.304463"},{"1":"2.759000","2":"3.097089","3":"2.423590"},{"1":"2.560693","2":"2.903859","3":"2.244585"},{"1":"2.675320","2":"2.997359","3":"2.339569"},{"1":"2.779461","2":"3.136958","3":"2.439537"},{"1":"2.908528","2":"3.224581","3":"2.583469"},{"1":"2.982533","2":"3.323498","3":"2.661270"},{"1":"3.100323","2":"3.462303","3":"2.749686"},{"1":"2.564352","2":"2.903629","3":"2.236957"},{"1":"2.658674","2":"3.013765","3":"2.319358"},{"1":"2.783006","2":"3.103397","3":"2.457739"},{"1":"2.882360","2":"3.217911","3":"2.543661"},{"1":"2.984152","2":"3.318220","3":"2.667171"},{"1":"3.092459","2":"3.436316","3":"2.769747"},{"1":"2.651653","2":"2.966548","3":"2.327411"},{"1":"2.749117","2":"3.094057","3":"2.430656"},{"1":"2.863957","2":"3.176342","3":"2.520690"},{"1":"2.942632","2":"3.264665","3":"2.631304"},{"1":"3.068949","2":"3.394136","3":"2.725839"},{"1":"3.181278","2":"3.519965","3":"2.831846"},{"1":"2.584717","2":"2.918822","3":"2.282121"},{"1":"2.691591","2":"3.032473","3":"2.343224"},{"1":"2.813029","2":"3.169627","3":"2.472695"},{"1":"2.909931","2":"3.222156","3":"2.582851"},{"1":"3.024325","2":"3.370544","3":"2.697873"},{"1":"3.136285","2":"3.454005","3":"2.797024"},{"1":"2.206556","2":"2.534297","3":"1.895288"},{"1":"2.293876","2":"2.619843","3":"1.958850"},{"1":"2.430989","2":"2.749593","3":"2.066420"},{"1":"2.503341","2":"2.859230","3":"2.180585"},{"1":"2.614433","2":"2.937613","3":"2.302181"},{"1":"2.713050","2":"3.059144","3":"2.392328"},{"1":"2.570895","2":"2.890477","3":"2.239048"},{"1":"2.677303","2":"3.020929","3":"2.357046"},{"1":"2.771394","2":"3.095828","3":"2.467200"},{"1":"2.894211","2":"3.223010","3":"2.569664"},{"1":"2.999044","2":"3.340195","3":"2.659990"},{"1":"3.094060","2":"3.427929","3":"2.762050"},{"1":"2.786532","2":"3.122743","3":"2.443790"},{"1":"2.895771","2":"3.226974","3":"2.561645"},{"1":"3.007902","2":"3.345373","3":"2.696268"},{"1":"3.107289","2":"3.426834","3":"2.777939"},{"1":"3.220699","2":"3.546414","3":"2.891041"},{"1":"3.310106","2":"3.648064","3":"2.999422"},{"1":"2.770686","2":"3.096580","3":"2.470612"},{"1":"2.886645","2":"3.205679","3":"2.556387"},{"1":"2.975343","2":"3.305186","3":"2.621282"},{"1":"3.065390","2":"3.422571","3":"2.750441"},{"1":"3.188849","2":"3.527982","3":"2.858780"},{"1":"3.306263","2":"3.629314","3":"2.963892"},{"1":"2.405242","2":"2.737134","3":"2.091611"},{"1":"2.516621","2":"2.855356","3":"2.187229"},{"1":"2.630959","2":"2.967475","3":"2.297546"},{"1":"2.753637","2":"3.084173","3":"2.433812"},{"1":"2.847225","2":"3.178683","3":"2.520292"},{"1":"2.948806","2":"3.250692","3":"2.633157"},{"1":"2.958563","2":"3.277499","3":"2.653809"},{"1":"3.052443","2":"3.403289","3":"2.708867"},{"1":"3.164169","2":"3.483073","3":"2.811706"},{"1":"3.268626","2":"3.604716","3":"2.929854"},{"1":"3.372453","2":"3.702365","3":"3.042197"},{"1":"3.492063","2":"3.808855","3":"3.140265"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>REsim(gpa_mixed)             # 随机效应估计的均值，中位数和标准差</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["groupFctr"],"name":[1],"type":["chr"],"align":["left"]},{"label":["groupID"],"name":[2],"type":["chr"],"align":["left"]},{"label":["term"],"name":[3],"type":["chr"],"align":["left"]},{"label":["mean"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["median"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"student","2":"1","3":"(Intercept)","4":"-0.0795994170","5":"-0.0910388972","6":"0.09150004"},{"1":"student","2":"2","3":"(Intercept)","4":"-0.2143007606","5":"-0.2056001655","6":"0.08805204"},{"1":"student","2":"3","3":"(Intercept)","4":"0.0942418212","5":"0.0944145168","6":"0.09310659"},{"1":"student","2":"4","3":"(Intercept)","4":"-0.1883217012","5":"-0.1915065028","6":"0.08557043"},{"1":"student","2":"5","3":"(Intercept)","4":"0.0276885387","5":"0.0282722219","6":"0.09430585"},{"1":"student","2":"6","3":"(Intercept)","4":"-0.3084356812","5":"-0.3085241903","6":"0.09658078"},{"1":"student","2":"7","3":"(Intercept)","4":"-0.1487782011","5":"-0.1515795572","6":"0.09686068"},{"1":"student","2":"8","3":"(Intercept)","4":"0.2234774416","5":"0.2235608653","6":"0.09036534"},{"1":"student","2":"9","3":"(Intercept)","4":"0.1067266889","5":"0.1046574788","6":"0.10149354"},{"1":"student","2":"10","3":"(Intercept)","4":"0.0131652964","5":"0.0129023589","6":"0.09741427"},{"1":"student","2":"11","3":"(Intercept)","4":"0.3623544366","5":"0.3665725346","6":"0.08705630"},{"1":"student","2":"12","3":"(Intercept)","4":"-0.0019058536","5":"0.0042893476","6":"0.09682794"},{"1":"student","2":"13","3":"(Intercept)","4":"0.5100462099","5":"0.5155906563","6":"0.09720957"},{"1":"student","2":"14","3":"(Intercept)","4":"0.1214083983","5":"0.1105852964","6":"0.09241020"},{"1":"student","2":"15","3":"(Intercept)","4":"-0.2243280071","5":"-0.2233772506","6":"0.09166599"},{"1":"student","2":"16","3":"(Intercept)","4":"-0.1220896845","5":"-0.1250237760","6":"0.09532679"},{"1":"student","2":"17","3":"(Intercept)","4":"-0.2689125172","5":"-0.2630067645","6":"0.09547066"},{"1":"student","2":"18","3":"(Intercept)","4":"-0.3094526207","5":"-0.3187898433","6":"0.09799107"},{"1":"student","2":"19","3":"(Intercept)","4":"-0.0953225315","5":"-0.0971623234","6":"0.09169126"},{"1":"student","2":"20","3":"(Intercept)","4":"0.2308002216","5":"0.2295352955","6":"0.08515156"},{"1":"student","2":"21","3":"(Intercept)","4":"-0.2922182695","5":"-0.3012743648","6":"0.09422172"},{"1":"student","2":"22","3":"(Intercept)","4":"0.1187910258","5":"0.1228492998","6":"0.09449380"},{"1":"student","2":"23","3":"(Intercept)","4":"0.0803310074","5":"0.0769592244","6":"0.09760976"},{"1":"student","2":"24","3":"(Intercept)","4":"0.0143485321","5":"0.0147370420","6":"0.09566686"},{"1":"student","2":"25","3":"(Intercept)","4":"0.3881697855","5":"0.3854441388","6":"0.09309264"},{"1":"student","2":"26","3":"(Intercept)","4":"-0.2792530962","5":"-0.2815751943","6":"0.09602967"},{"1":"student","2":"27","3":"(Intercept)","4":"-0.3755178599","5":"-0.3757512911","6":"0.09219753"},{"1":"student","2":"28","3":"(Intercept)","4":"0.1106435297","5":"0.1042848797","6":"0.09465540"},{"1":"student","2":"29","3":"(Intercept)","4":"0.1096434055","5":"0.1056777932","6":"0.09153997"},{"1":"student","2":"30","3":"(Intercept)","4":"0.2133828194","5":"0.2179926271","6":"0.09137725"},{"1":"student","2":"31","3":"(Intercept)","4":"-0.3495385549","5":"-0.3462589487","6":"0.10078442"},{"1":"student","2":"32","3":"(Intercept)","4":"0.2671559331","5":"0.2705508844","6":"0.08298522"},{"1":"student","2":"33","3":"(Intercept)","4":"-0.1255520449","5":"-0.1303668068","6":"0.09484192"},{"1":"student","2":"34","3":"(Intercept)","4":"-0.2221422057","5":"-0.2191863295","6":"0.08725081"},{"1":"student","2":"35","3":"(Intercept)","4":"0.1004742867","5":"0.1017735564","6":"0.09039567"},{"1":"student","2":"36","3":"(Intercept)","4":"0.1302117565","5":"0.1381335302","6":"0.10020959"},{"1":"student","2":"37","3":"(Intercept)","4":"0.0934489112","5":"0.0967089635","6":"0.08523759"},{"1":"student","2":"38","3":"(Intercept)","4":"0.4180855872","5":"0.4249469941","6":"0.09442210"},{"1":"student","2":"39","3":"(Intercept)","4":"-0.0581405629","5":"-0.0696367498","6":"0.10541597"},{"1":"student","2":"40","3":"(Intercept)","4":"0.2798177297","5":"0.2709046981","6":"0.10039434"},{"1":"student","2":"41","3":"(Intercept)","4":"0.5222612441","5":"0.5162912719","6":"0.08842467"},{"1":"student","2":"42","3":"(Intercept)","4":"-0.0545208503","5":"-0.0527670388","6":"0.08973087"},{"1":"student","2":"43","3":"(Intercept)","4":"0.0729905645","5":"0.0720232673","6":"0.09696482"},{"1":"student","2":"44","3":"(Intercept)","4":"0.1570140547","5":"0.1513973828","6":"0.09933593"},{"1":"student","2":"45","3":"(Intercept)","4":"0.1764947927","5":"0.1721567759","6":"0.08723339"},{"1":"student","2":"46","3":"(Intercept)","4":"-0.2873387962","5":"-0.2856123942","6":"0.09577917"},{"1":"student","2":"47","3":"(Intercept)","4":"-0.2352000125","5":"-0.2231630179","6":"0.09000033"},{"1":"student","2":"48","3":"(Intercept)","4":"-0.0026822523","5":"0.0008284659","6":"0.08827909"},{"1":"student","2":"49","3":"(Intercept)","4":"0.1036726891","5":"0.1058665844","6":"0.09338900"},{"1":"student","2":"50","3":"(Intercept)","4":"-0.0525824491","5":"-0.0487982926","6":"0.09440919"},{"1":"student","2":"51","3":"(Intercept)","4":"-0.0164300853","5":"-0.0108392586","6":"0.08152889"},{"1":"student","2":"52","3":"(Intercept)","4":"0.1650531770","5":"0.1557324184","6":"0.08908711"},{"1":"student","2":"53","3":"(Intercept)","4":"0.0858257807","5":"0.0906480030","6":"0.08412431"},{"1":"student","2":"54","3":"(Intercept)","4":"0.1933473117","5":"0.1831378643","6":"0.08849213"},{"1":"student","2":"55","3":"(Intercept)","4":"0.1453787583","5":"0.1452127943","6":"0.09524044"},{"1":"student","2":"56","3":"(Intercept)","4":"-0.2634494396","5":"-0.2536421353","6":"0.09812797"},{"1":"student","2":"57","3":"(Intercept)","4":"0.0747042409","5":"0.0689024512","6":"0.09096056"},{"1":"student","2":"58","3":"(Intercept)","4":"-0.1854465102","5":"-0.1871820132","6":"0.08925423"},{"1":"student","2":"59","3":"(Intercept)","4":"0.0636894715","5":"0.0787147585","6":"0.09725778"},{"1":"student","2":"60","3":"(Intercept)","4":"-0.1576678527","5":"-0.1475419084","6":"0.08852979"},{"1":"student","2":"61","3":"(Intercept)","4":"0.2576148542","5":"0.2579903099","6":"0.09141243"},{"1":"student","2":"62","3":"(Intercept)","4":"-0.1070649735","5":"-0.1048017047","6":"0.08386414"},{"1":"student","2":"63","3":"(Intercept)","4":"0.2872406575","5":"0.2829207230","6":"0.08733116"},{"1":"student","2":"64","3":"(Intercept)","4":"0.1080828880","5":"0.1042438829","6":"0.09579144"},{"1":"student","2":"65","3":"(Intercept)","4":"-0.2510950345","5":"-0.2475627695","6":"0.09543127"},{"1":"student","2":"66","3":"(Intercept)","4":"0.2064812702","5":"0.2118886451","6":"0.08830621"},{"1":"student","2":"67","3":"(Intercept)","4":"-0.2204219644","5":"-0.2199628717","6":"0.10070715"},{"1":"student","2":"68","3":"(Intercept)","4":"-0.2844455505","5":"-0.2817608004","6":"0.10012515"},{"1":"student","2":"69","3":"(Intercept)","4":"-0.2743807973","5":"-0.2773633861","6":"0.08767248"},{"1":"student","2":"70","3":"(Intercept)","4":"0.0083425839","5":"0.0047748377","6":"0.09166288"},{"1":"student","2":"71","3":"(Intercept)","4":"-0.0059182573","5":"0.0018404459","6":"0.09560180"},{"1":"student","2":"72","3":"(Intercept)","4":"0.4377229920","5":"0.4379819811","6":"0.10329602"},{"1":"student","2":"73","3":"(Intercept)","4":"-0.1981352706","5":"-0.2017979176","6":"0.08927851"},{"1":"student","2":"74","3":"(Intercept)","4":"0.2211194031","5":"0.2184744796","6":"0.09309974"},{"1":"student","2":"75","3":"(Intercept)","4":"0.0382890017","5":"0.0418134550","6":"0.09854468"},{"1":"student","2":"76","3":"(Intercept)","4":"0.1583024369","5":"0.1516434476","6":"0.08855930"},{"1":"student","2":"77","3":"(Intercept)","4":"0.4774612659","5":"0.4799960104","6":"0.09446762"},{"1":"student","2":"78","3":"(Intercept)","4":"-0.3677790499","5":"-0.3765170938","6":"0.09787835"},{"1":"student","2":"79","3":"(Intercept)","4":"-0.4768217680","5":"-0.4745948241","6":"0.08446039"},{"1":"student","2":"80","3":"(Intercept)","4":"0.1999593118","5":"0.1879753511","6":"0.09505906"},{"1":"student","2":"81","3":"(Intercept)","4":"0.0399899840","5":"0.0315104638","6":"0.08220693"},{"1":"student","2":"82","3":"(Intercept)","4":"0.3136105195","5":"0.3165176001","6":"0.09414345"},{"1":"student","2":"83","3":"(Intercept)","4":"0.2487872596","5":"0.2488192647","6":"0.09402699"},{"1":"student","2":"84","3":"(Intercept)","4":"-0.5275015317","5":"-0.5307224337","6":"0.09656151"},{"1":"student","2":"85","3":"(Intercept)","4":"0.1194904719","5":"0.1231570616","6":"0.09618623"},{"1":"student","2":"86","3":"(Intercept)","4":"-0.1872149823","5":"-0.1927750765","6":"0.08654442"},{"1":"student","2":"87","3":"(Intercept)","4":"-0.0007199955","5":"-0.0054699169","6":"0.09898787"},{"1":"student","2":"88","3":"(Intercept)","4":"-0.0519990916","5":"-0.0454109013","6":"0.09615890"},{"1":"student","2":"89","3":"(Intercept)","4":"0.1584413966","5":"0.1658082517","6":"0.09467151"},{"1":"student","2":"90","3":"(Intercept)","4":"-0.0581508326","5":"-0.0597709006","6":"0.09338265"},{"1":"student","2":"91","3":"(Intercept)","4":"-0.3216646171","5":"-0.3207493916","6":"0.09479031"},{"1":"student","2":"92","3":"(Intercept)","4":"0.6616354700","5":"0.6618202272","6":"0.08849353"},{"1":"student","2":"93","3":"(Intercept)","4":"0.3717064438","5":"0.3611946320","6":"0.10045426"},{"1":"student","2":"94","3":"(Intercept)","4":"-0.0651702610","5":"-0.0677056893","6":"0.09516809"},{"1":"student","2":"95","3":"(Intercept)","4":"-0.1222539646","5":"-0.1322696325","6":"0.09674999"},{"1":"student","2":"96","3":"(Intercept)","4":"0.1557425231","5":"0.1574277566","6":"0.09182077"},{"1":"student","2":"97","3":"(Intercept)","4":"-0.0506265805","5":"-0.0505044246","6":"0.09075190"},{"1":"student","2":"98","3":"(Intercept)","4":"0.1913227183","5":"0.1963156868","6":"0.08905573"},{"1":"student","2":"99","3":"(Intercept)","4":"-0.1634532391","5":"-0.1627219198","6":"0.09644746"},{"1":"student","2":"100","3":"(Intercept)","4":"-0.4539820986","5":"-0.4586272160","6":"0.09539356"},{"1":"student","2":"101","3":"(Intercept)","4":"0.3363118097","5":"0.3284639526","6":"0.09611536"},{"1":"student","2":"102","3":"(Intercept)","4":"-0.0364340437","5":"-0.0333838339","6":"0.08618161"},{"1":"student","2":"103","3":"(Intercept)","4":"-0.1481071689","5":"-0.1493078533","6":"0.09631667"},{"1":"student","2":"104","3":"(Intercept)","4":"0.0940773712","5":"0.0878680634","6":"0.09982427"},{"1":"student","2":"105","3":"(Intercept)","4":"0.7623459427","5":"0.7656723973","6":"0.09156838"},{"1":"student","2":"106","3":"(Intercept)","4":"-0.3511219957","5":"-0.3556773361","6":"0.09332480"},{"1":"student","2":"107","3":"(Intercept)","4":"-0.3474406354","5":"-0.3411565699","6":"0.09840896"},{"1":"student","2":"108","3":"(Intercept)","4":"-0.3936638019","5":"-0.3957854196","6":"0.09576862"},{"1":"student","2":"109","3":"(Intercept)","4":"-0.0642032503","5":"-0.0682872102","6":"0.09934058"},{"1":"student","2":"110","3":"(Intercept)","4":"-0.5069535966","5":"-0.5037716587","6":"0.09424172"},{"1":"student","2":"111","3":"(Intercept)","4":"-0.4402129624","5":"-0.4380694639","6":"0.09034859"},{"1":"student","2":"112","3":"(Intercept)","4":"0.2040967276","5":"0.2097678373","6":"0.09604064"},{"1":"student","2":"113","3":"(Intercept)","4":"-0.1664149706","5":"-0.1718900894","6":"0.09358652"},{"1":"student","2":"114","3":"(Intercept)","4":"-0.0446040954","5":"-0.0372533710","6":"0.09664063"},{"1":"student","2":"115","3":"(Intercept)","4":"-0.0889846127","5":"-0.0875154397","6":"0.09097234"},{"1":"student","2":"116","3":"(Intercept)","4":"-0.1320105983","5":"-0.1365138991","6":"0.09402253"},{"1":"student","2":"117","3":"(Intercept)","4":"-0.0165135205","5":"-0.0172803737","6":"0.08861253"},{"1":"student","2":"118","3":"(Intercept)","4":"0.1447893381","5":"0.1386081775","6":"0.08711552"},{"1":"student","2":"119","3":"(Intercept)","4":"-0.2134657418","5":"-0.2197407836","6":"0.09449890"},{"1":"student","2":"120","3":"(Intercept)","4":"0.1186413974","5":"0.1255085832","6":"0.09513260"},{"1":"student","2":"121","3":"(Intercept)","4":"0.0955104583","5":"0.0953176328","6":"0.09493020"},{"1":"student","2":"122","3":"(Intercept)","4":"0.2455407741","5":"0.2483680577","6":"0.08958900"},{"1":"student","2":"123","3":"(Intercept)","4":"-0.3723272878","5":"-0.3660128830","6":"0.09714323"},{"1":"student","2":"124","3":"(Intercept)","4":"0.1032308718","5":"0.1042820204","6":"0.10302949"},{"1":"student","2":"125","3":"(Intercept)","4":"-0.1960393875","5":"-0.2023245342","6":"0.08843405"},{"1":"student","2":"126","3":"(Intercept)","4":"-0.1173771225","5":"-0.1114537810","6":"0.09003737"},{"1":"student","2":"127","3":"(Intercept)","4":"-0.3475792747","5":"-0.3515015358","6":"0.09478037"},{"1":"student","2":"128","3":"(Intercept)","4":"-0.0772486867","5":"-0.0813680325","6":"0.09073452"},{"1":"student","2":"129","3":"(Intercept)","4":"-0.0694166220","5":"-0.0731631007","6":"0.09753270"},{"1":"student","2":"130","3":"(Intercept)","4":"0.1190465978","5":"0.1235195161","6":"0.09626685"},{"1":"student","2":"131","3":"(Intercept)","4":"0.2991811886","5":"0.2997198178","6":"0.09594383"},{"1":"student","2":"132","3":"(Intercept)","4":"0.1613817155","5":"0.1579475705","6":"0.09050671"},{"1":"student","2":"133","3":"(Intercept)","4":"-0.3924293343","5":"-0.3942153192","6":"0.08922128"},{"1":"student","2":"134","3":"(Intercept)","4":"0.0127770551","5":"0.0086271151","6":"0.09268585"},{"1":"student","2":"135","3":"(Intercept)","4":"0.0791552757","5":"0.0746079138","6":"0.08678392"},{"1":"student","2":"136","3":"(Intercept)","4":"-0.1654355243","5":"-0.1671036476","6":"0.09057502"},{"1":"student","2":"137","3":"(Intercept)","4":"-0.0987782453","5":"-0.0953739229","6":"0.09224058"},{"1":"student","2":"138","3":"(Intercept)","4":"-0.0764671962","5":"-0.0853456739","6":"0.08924838"},{"1":"student","2":"139","3":"(Intercept)","4":"0.2017174856","5":"0.1995538247","6":"0.09115029"},{"1":"student","2":"140","3":"(Intercept)","4":"-0.1305016404","5":"-0.1381553844","6":"0.08938878"},{"1":"student","2":"141","3":"(Intercept)","4":"0.1874230915","5":"0.1826587438","6":"0.10433561"},{"1":"student","2":"142","3":"(Intercept)","4":"0.0932389929","5":"0.0953701805","6":"0.09501037"},{"1":"student","2":"143","3":"(Intercept)","4":"-0.0315828421","5":"-0.0260719859","6":"0.09857839"},{"1":"student","2":"144","3":"(Intercept)","4":"0.0976809816","5":"0.0950753708","6":"0.09657533"},{"1":"student","2":"145","3":"(Intercept)","4":"-0.0717543617","5":"-0.0703625542","6":"0.09212219"},{"1":"student","2":"146","3":"(Intercept)","4":"-0.2826340007","5":"-0.2848398301","6":"0.09176598"},{"1":"student","2":"147","3":"(Intercept)","4":"0.3966456401","5":"0.3963548104","6":"0.09234634"},{"1":"student","2":"148","3":"(Intercept)","4":"-0.1487392967","5":"-0.1518627111","6":"0.08677954"},{"1":"student","2":"149","3":"(Intercept)","4":"-0.0648770301","5":"-0.0667275120","6":"0.09108687"},{"1":"student","2":"150","3":"(Intercept)","4":"-0.2216759367","5":"-0.2165838166","6":"0.10078231"},{"1":"student","2":"151","3":"(Intercept)","4":"-0.1952520567","5":"-0.2039386315","6":"0.09655619"},{"1":"student","2":"152","3":"(Intercept)","4":"-0.1197015383","5":"-0.1241927705","6":"0.08275772"},{"1":"student","2":"153","3":"(Intercept)","4":"-0.0309924443","5":"-0.0298694282","6":"0.09350570"},{"1":"student","2":"154","3":"(Intercept)","4":"0.2230740328","5":"0.2196874704","6":"0.08836622"},{"1":"student","2":"155","3":"(Intercept)","4":"-0.0710378789","5":"-0.0641487779","6":"0.09345180"},{"1":"student","2":"156","3":"(Intercept)","4":"-0.0907979326","5":"-0.0897452413","6":"0.10000629"},{"1":"student","2":"157","3":"(Intercept)","4":"0.3261642092","5":"0.3274517984","6":"0.09209811"},{"1":"student","2":"158","3":"(Intercept)","4":"-0.0261132864","5":"-0.0259876355","6":"0.09418049"},{"1":"student","2":"159","3":"(Intercept)","4":"0.4475717318","5":"0.4485971097","6":"0.09539303"},{"1":"student","2":"160","3":"(Intercept)","4":"0.3530601087","5":"0.3512052136","6":"0.09776440"},{"1":"student","2":"161","3":"(Intercept)","4":"-0.1002709383","5":"-0.1077871559","6":"0.09701509"},{"1":"student","2":"162","3":"(Intercept)","4":"-0.4430836128","5":"-0.4468815282","6":"0.09566335"},{"1":"student","2":"163","3":"(Intercept)","4":"-0.0375170192","5":"-0.0340400795","6":"0.10436046"},{"1":"student","2":"164","3":"(Intercept)","4":"-0.1191484965","5":"-0.1126143412","6":"0.10198591"},{"1":"student","2":"165","3":"(Intercept)","4":"-0.0142377610","5":"-0.0106305190","6":"0.09388520"},{"1":"student","2":"166","3":"(Intercept)","4":"0.1914996716","5":"0.1830557778","6":"0.10121550"},{"1":"student","2":"167","3":"(Intercept)","4":"0.2039396655","5":"0.2015139837","6":"0.09750619"},{"1":"student","2":"168","3":"(Intercept)","4":"0.2723929499","5":"0.2783412635","6":"0.09610137"},{"1":"student","2":"169","3":"(Intercept)","4":"0.2674284391","5":"0.2734574620","6":"0.09566847"},{"1":"student","2":"170","3":"(Intercept)","4":"0.3671341891","5":"0.3645446929","6":"0.09584731"},{"1":"student","2":"171","3":"(Intercept)","4":"-0.2822854062","5":"-0.2794502476","6":"0.08803975"},{"1":"student","2":"172","3":"(Intercept)","4":"-0.0451495658","5":"-0.0419163550","6":"0.08718766"},{"1":"student","2":"173","3":"(Intercept)","4":"0.2658604697","5":"0.2668935973","6":"0.09379953"},{"1":"student","2":"174","3":"(Intercept)","4":"0.1080500447","5":"0.1061717540","6":"0.08853321"},{"1":"student","2":"175","3":"(Intercept)","4":"0.0970587384","5":"0.0976116172","6":"0.08908458"},{"1":"student","2":"176","3":"(Intercept)","4":"-0.0716065028","5":"-0.0671896962","6":"0.09062454"},{"1":"student","2":"177","3":"(Intercept)","4":"0.1789905746","5":"0.1861588271","6":"0.09113669"},{"1":"student","2":"178","3":"(Intercept)","4":"0.0340007657","5":"0.0353497048","6":"0.09541293"},{"1":"student","2":"179","3":"(Intercept)","4":"0.0420862590","5":"0.0338832284","6":"0.09207309"},{"1":"student","2":"180","3":"(Intercept)","4":"-0.2305936161","5":"-0.2259144472","6":"0.09160821"},{"1":"student","2":"181","3":"(Intercept)","4":"-0.3510010011","5":"-0.3509788340","6":"0.09018124"},{"1":"student","2":"182","3":"(Intercept)","4":"0.2191760026","5":"0.2234312212","6":"0.08928287"},{"1":"student","2":"183","3":"(Intercept)","4":"-0.2669922346","5":"-0.2716642104","6":"0.09089924"},{"1":"student","2":"184","3":"(Intercept)","4":"0.0190034279","5":"0.0183959344","6":"0.09479336"},{"1":"student","2":"185","3":"(Intercept)","4":"0.0927242267","5":"0.0963396590","6":"0.10123089"},{"1":"student","2":"186","3":"(Intercept)","4":"-0.0535793707","5":"-0.0493597735","6":"0.09856574"},{"1":"student","2":"187","3":"(Intercept)","4":"-0.3636146873","5":"-0.3623965583","6":"0.09750732"},{"1":"student","2":"188","3":"(Intercept)","4":"0.1373361689","5":"0.1351404889","6":"0.08620518"},{"1":"student","2":"189","3":"(Intercept)","4":"0.1937343257","5":"0.1882563979","6":"0.09258387"},{"1":"student","2":"190","3":"(Intercept)","4":"-0.3745111341","5":"-0.3809708736","6":"0.09116804"},{"1":"student","2":"191","3":"(Intercept)","4":"-0.0317718493","5":"-0.0358499991","6":"0.09253687"},{"1":"student","2":"192","3":"(Intercept)","4":"-0.0364765775","5":"-0.0300670136","6":"0.08933170"},{"1":"student","2":"193","3":"(Intercept)","4":"0.0460686865","5":"0.0448971293","6":"0.09068231"},{"1":"student","2":"194","3":"(Intercept)","4":"0.0019758621","5":"0.0069487602","6":"0.09755285"},{"1":"student","2":"195","3":"(Intercept)","4":"-0.4109474412","5":"-0.4174098257","6":"0.08999183"},{"1":"student","2":"196","3":"(Intercept)","4":"-0.0304990947","5":"-0.0244873148","6":"0.09410612"},{"1":"student","2":"197","3":"(Intercept)","4":"0.1971770011","5":"0.2040402610","6":"0.10087906"},{"1":"student","2":"198","3":"(Intercept)","4":"0.1626680607","5":"0.1607332319","6":"0.09732064"},{"1":"student","2":"199","3":"(Intercept)","4":"-0.1897273168","5":"-0.1940816903","6":"0.08512854"},{"1":"student","2":"200","3":"(Intercept)","4":"0.3623666112","5":"0.3652595409","6":"0.09785346"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>plotREsim(REsim(gpa_mixed))  # Plotting interval estimates</code></pre>
<p><img src="06-Analysis-MMRM_files/figure-html/one-random-intercept-1.png" width="672" /></p>
<pre class="r"><code># predict don&#39;t use random effects re.form = NA
predict(gpa_mixed, re.form=NA) %&gt;% head()</code></pre>
<pre><code>##        1        2        3        4        5        6 
## 2.599214 2.705529 2.811843 2.918157 3.024471 3.130786</code></pre>
<pre class="r"><code># R outputs AIC and BIC values automatically. The AICC value has to be computed as
# AICC &lt;- -2*logLik(gpa_mixed)+2*p*n/(n-p-1)</code></pre>
</div>
<div id="model-with-random-intercept-and-slpoe-effects"
class="section level3" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Model with random
intercept and slpoe effects</h3>
<pre class="r"><code>gpa_mixed =  lmer(gpa ~ occasion + (1 + occasion | student), data = gpa)
summary(gpa_mixed)</code></pre>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: gpa ~ occasion + (1 + occasion | student)
##    Data: gpa
## 
## REML criterion at convergence: 261
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.2695 -0.5377 -0.0128  0.5326  3.1939 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev. Corr 
##  student  (Intercept) 0.045193 0.21259       
##           occasion    0.004504 0.06711  -0.10
##  Residual             0.042388 0.20588       
## Number of obs: 1200, groups:  student, 200
## 
## Fixed effects:
##              Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept) 2.599e+00  1.836e-02 1.990e+02  141.59   &lt;2e-16 ***
## occasion    1.063e-01  5.885e-03 1.990e+02   18.07   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##          (Intr)
## occasion -0.345</code></pre>
</div>
</div>
<div id="covariance-structure-using-nlme" class="section level2"
number="3.3">
<h2><span class="header-section-number">3.3</span> Covariance Structure
using nlme</h2>
<p>A structure can be specified by adding <code>correlation=</code> to
the syntax within thelme()function. The choices are:</p>
<pre><code>corSymm() (unstructured),
corARMA(form=∼ 1|id.name, p=1, q=1) (Toeplitz),
corCAR1(form=∼1|id.name) (spatial power),
corAR1(form=∼1|id.name) (autoregressive),
corCompSymm(form=∼1|id.name) (compound symmetric).</code></pre>
<p>lme4 fails to model the residual covariance structure in a simple
way. To estimate heterogeneous variance, It is needed to use additional
weight parameters. The following will give each occasion point a unique
estimate.</p>
<pre class="r"><code>load(&quot;./01_Datasets/gpa.RData&quot;)
## Heterogeneous variance 
heterovar_res = lme(
  gpa ~ occasion,
  data = gpa,
  random = ~ 1 | student,
  weights = varIdent(form = ~ 1 | occasion)
)
summary(heterovar_res)</code></pre>
<pre><code>## Linear mixed-effects model fit by REML
##   Data: gpa 
##        AIC      BIC    logLik
##   274.0536 319.8492 -128.0268
## 
## Random effects:
##  Formula: ~1 | student
##         (Intercept)  Residual
## StdDev:    0.305992 0.3716858
## 
## Variance function:
##  Structure: Different standard deviations per stratum
##  Formula: ~1 | occasion 
##  Parameter estimates:
##         0         1         2         3         4         5 
## 1.0000000 0.8261186 0.6272415 0.4311126 0.3484014 0.4324629 
## Fixed effects:  gpa ~ occasion 
##                 Value   Std.Error  DF  t-value p-value
## (Intercept) 2.5987900 0.026249747 999 99.00248       0
## occasion    0.1061401 0.004033168 999 26.31680       0
##  Correlation: 
##          (Intr)
## occasion -0.528
## 
## Standardized Within-Group Residuals:
##         Min          Q1         Med          Q3         Max 
## -2.74415662 -0.64519739  0.02266271  0.62705161  3.05558490 
## 
## Number of Observations: 1200
## Number of Groups: 200</code></pre>
<pre class="r"><code>## Autocorrelation
corr_res = lme(
  gpa ~ occasion,
  data = gpa,
  random = ~ 1 | student,
  correlation = corAR1(form = ~ occasion)
)

##  new parameter in the nlme output called Phi which represents autocorrelation Phi
summary(corr_res)</code></pre>
<pre><code>## Linear mixed-effects model fit by REML
##   Data: gpa 
##        AIC      BIC    logLik
##   334.1208 359.5629 -162.0604
## 
## Random effects:
##  Formula: ~1 | student
##         (Intercept)  Residual
## StdDev:   0.2145887 0.2732718
## 
## Correlation Structure: AR(1)
##  Formula: ~occasion | student 
##  Parameter estimate(s):
##       Phi 
## 0.4182174 
## Fixed effects:  gpa ~ occasion 
##                 Value   Std.Error  DF   t-value p-value
## (Intercept) 2.5969002 0.022951743 999 113.14610       0
## occasion    0.1071433 0.005278835 999  20.29677       0
##  Correlation: 
##          (Intr)
## occasion -0.575
## 
## Standardized Within-Group Residuals:
##          Min           Q1          Med           Q3          Max 
## -3.053039560 -0.612466765  0.009312407  0.607759461  2.646750929 
## 
## Number of Observations: 1200
## Number of Groups: 200</code></pre>
</div>
<div id="advance-of-lme4" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Advance of lme4</h2>
<div id="output-module" class="section level3" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Output module</h3>
<p><span class="math display">\[
\begin{array}{ll}
\hline \text { Generic } &amp; \text { Brief description of return value
} \\
\hline \text { anova } &amp; \text { Decomposition of fixed-effects
contributions } \\
\text { as.function } &amp; \text { Function returning profiled deviance
or REML criterion. } \\
\text { coef } &amp; \text { Sum of the random and fixed effects for
each level. } \\
\text { confint } &amp; \text { Confidence intervals on linear
mixed-model parameters. } \\
\text { deviance} &amp; \text { Minus twice maximum log-likelihood. } \\
&amp; \text { (Use REMLcrit for the REML criterion.) } \\
\text { df.residual } &amp; \text { Residual degrees of freedom. } \\
\text { drop1 } &amp; \text { Drop allowable single terms from the
model. } \\
\text { extractAIC } &amp; \text { Generalized Akaike information
criterion } \\
\text { fitted } &amp; \text { Fitted values given conditional modes
(Equation 13). } \\
\text { fixef} &amp; \text { Estimates of the fixed-effects
coefficients, } \widehat{\boldsymbol{\beta}} \\
\text { formula } &amp; \text { Mixed-model formula of fitted model. }
\\
\text { logLik } &amp; \text { Maximum log-likelihood. } \\
\text { model.frame } &amp; \text { Data required to fit the model. } \\
\text { model.matrix } &amp; \text { Fixed-effects model matrix, }
\boldsymbol{X} . \\
\text { ngrps } &amp; \text { Number of levels in each grouping factor.
} \\
\text { nobs } &amp; \text { Number of observations. } \\
\text { plot } &amp; \text { Diagnostic plots for mixed-model fits. } \\
\text { predict} &amp; \text { Various types of predicted values. } \\
\text { print } &amp; \text { Basic printout of mixed-model objects. }
\\
\text { profile} &amp; \text { Profiled likelihood over various model
parameters. } \\
\text { ranef} &amp; \text { Conditional modes of the random effects. }
\\
\text { refit} &amp; \text { A model (re)fitted to a new set of
observations of the response variable. } \\
\text { refitML } &amp; \text { A model (re)fitted by maximum
likelihood. } \\
\text { residuals} &amp; \text { Various types of residual values. } \\
\text { sigma } &amp; \text { Residual standard deviation. } \\
\text { simulate  } &amp; \text { Simulated data from a fitted mixed
model. } \\
\text { termary  } &amp; \text { Summary of a mixed model. } \\
\text { update } &amp; \text { Terms representation of a mixed model. }
\\
\text { VarCorr  } &amp; \text { Estimated random-effects variances,
standard deviations, and correlations. } \\
\text { vcov } &amp; \text { Covariance matrix of the fixed-effect
estimates. } \\
\text { weights } &amp; \text { Prior weights used in model fitting. }
\\
\hline
\end{array}
\]</span></p>
</div>
<div id="fit-model-using-high-level-modular-structure"
class="section level3" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Fit model using
High level modular structure</h3>
<pre class="r"><code>str(sleepstudy)</code></pre>
<pre><code>## &#39;data.frame&#39;:    180 obs. of  3 variables:
##  $ Reaction: num  250 259 251 321 357 ...
##  $ Days    : num  0 1 2 3 4 5 6 7 8 9 ...
##  $ Subject : Factor w/ 18 levels &quot;308&quot;,&quot;309&quot;,&quot;310&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<pre class="r"><code>xyplot(Reaction ~ Days | Subject, sleepstudy, aspect = &quot;xy&quot;,
       layout = c(9, 2), type = c(&quot;g&quot;, &quot;p&quot;, &quot;r&quot;),
       index.cond = function(x, y) coef(lm(y ~ x))[2],
       xlab = &quot;Days of sleep deprivation&quot;,
       ylab = &quot;Average reaction time (ms)&quot;,
       as.table = TRUE)</code></pre>
<p><img src="06-Analysis-MMRM_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code>fm1 &lt;- lmer(Reaction ~ Days + (Days | Subject), sleepstudy)
fm2 &lt;- lmer(Reaction ~ Days + (Days || Subject), sleepstudy)


## Uisng High level modular structure
parsedFormula &lt;- lFormula(formula = Reaction ~ Days + (Days | Subject),
                          data = sleepstudy)
devianceFunction &lt;- do.call(mkLmerDevfun, parsedFormula)
optimizerOutput &lt;- optimizeLmer(devianceFunction)
mkMerMod(rho = environment(devianceFunction),
         opt = optimizerOutput,
         reTrms = parsedFormula$reTrms,
         fr = parsedFormula$fr)</code></pre>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## REML criterion at convergence: 1743.628
## Random effects:
##  Groups   Name        Std.Dev. Corr
##  Subject  (Intercept) 24.741       
##           Days         5.922   0.07
##  Residual             25.592       
## Number of obs: 180, groups:  Subject, 18
## Fixed Effects:
## (Intercept)         Days  
##      251.41        10.47</code></pre>
</div>
<div id="updating-fitted-mixed-models" class="section level3"
number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> Updating fitted
mixed models</h3>
<pre class="r"><code>fm3 &lt;- update(fm1, . ~ . - (Days | Subject) + (1 | Subject))
formula(fm1)</code></pre>
<pre><code>## Reaction ~ Days + (Days | Subject)</code></pre>
<pre class="r"><code>formula(fm3)</code></pre>
<pre><code>## Reaction ~ Days + (1 | Subject)</code></pre>
</div>
<div id="model-summary-and-associated-accessors" class="section level3"
number="3.4.4">
<h3><span class="header-section-number">3.4.4</span> Model Summary and
Associated Accessors</h3>
<div id="reproduces-the-model-formula-and-the-scaled-pearson-residuals"
class="section level4" number="3.4.4.1">
<h4><span class="header-section-number">3.4.4.1</span> Reproduces the
Model Formula and the Scaled Pearson Residuals</h4>
<pre class="r"><code>ss &lt;- summary(fm1)
cc &lt;- capture.output(print(ss))
reRow &lt;- grep(&quot;^Random effects&quot;, cc)
cat(cc[1:(reRow - 2)], sep = &quot;\n&quot;)</code></pre>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: Reaction ~ Days + (Days | Subject)
##    Data: sleepstudy
## 
## REML criterion at convergence: 1743.6
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.9536 -0.4634  0.0231  0.4634  5.1793</code></pre>
<pre class="r"><code>## ----summary-reproduced-------------------------------------
formula(fm1)</code></pre>
<pre><code>## Reaction ~ Days + (Days | Subject)</code></pre>
<pre class="r"><code>REMLcrit(fm1)</code></pre>
<pre><code>## [1] 1743.628</code></pre>
<pre class="r"><code>quantile(residuals(fm1, &quot;pearson&quot;, scaled = TRUE))</code></pre>
<pre><code>##          0%         25%         50%         75%        100% 
## -3.95356735 -0.46339768  0.02311766  0.46340208  5.17926037</code></pre>
</div>
<div id="information-regarding-the-random-effects-residual-variation"
class="section level4" number="3.4.4.2">
<h4><span class="header-section-number">3.4.4.2</span> Information
Regarding the Random-Effects &amp; Residual Variation</h4>
<pre class="r"><code>feRow &lt;- grep(&quot;^Fixed effects&quot;, cc)
cat(cc[reRow:(feRow - 2)], sep = &quot;\n&quot;)</code></pre>
<pre><code>## Random effects:
##  Groups   Name        Variance Std.Dev. Corr
##  Subject  (Intercept) 612.10   24.741       
##           Days         35.07    5.922   0.07
##  Residual             654.94   25.592       
## Number of obs: 180, groups:  Subject, 18</code></pre>
<pre class="r"><code>## ----summary-reproduced------------------
print(vc &lt;- VarCorr(fm1), comp = c(&quot;Variance&quot;, &quot;Std.Dev.&quot;))</code></pre>
<pre><code>##  Groups   Name        Variance Std.Dev. Corr 
##  Subject  (Intercept) 612.100  24.7407       
##           Days         35.072   5.9221  0.066
##  Residual             654.940  25.5918</code></pre>
<pre class="r"><code>c(nobs(fm1), ngrps(fm1), sigma(fm1))</code></pre>
<pre><code>##           Subject          
## 180.0000  18.0000  25.5918</code></pre>
</div>
<div id="fixed-effect-estimates" class="section level4"
number="3.4.4.3">
<h4><span class="header-section-number">3.4.4.3</span> Fixed-Effect
Estimates</h4>
<pre class="r"><code>corRow &lt;- grep(&quot;^Correlation&quot;, cc)
cat(cc[feRow:(corRow - 2)], sep = &quot;\n&quot;)</code></pre>
<pre><code>## Fixed effects:
##             Estimate Std. Error      df t value Pr(&gt;|t|)    
## (Intercept)  251.405      6.825  17.000  36.838  &lt; 2e-16 ***
## Days          10.467      1.546  17.000   6.771 3.26e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="correlations-between-the-fixed-effect-estimates"
class="section level4" number="3.4.4.4">
<h4><span class="header-section-number">3.4.4.4</span> Correlations
Between the Fixed-Effect Estimates</h4>
<pre class="r"><code>cat(cc[corRow:length(cc)], sep = &quot;\n&quot;)</code></pre>
<pre><code>## Correlation of Fixed Effects:
##      (Intr)
## Days -0.138</code></pre>
</div>
</div>
<div id="diagnostic-plots" class="section level3" number="3.4.5">
<h3><span class="header-section-number">3.4.5</span> Diagnostic
Plots</h3>
<p>lme4 provides tools for generating most of the standard graphical
diagnostic plots (with the exception of those incorporating influence
measures, e.g., Cook’s distance and leverage plots), in a way modeled on
the diagnostic graphics of nlme (Pinheiro and Bates 2000). In
particular, the familiar plot method in base R for linear models
(objects of class ‘lm’) can be used to create the standard fitted
vs. residual plots,</p>
<p><strong>Standard fitted vs. residual plots</strong></p>
<pre class="r"><code>plot(fm1, type = c(&quot;p&quot;, &quot;smooth&quot;))</code></pre>
<p><img src="06-Analysis-MMRM_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p><strong>Scale-location plots</strong></p>
<pre class="r"><code>plot(fm1, sqrt(abs(resid(.))) ~ fitted(.),
type = c(&quot;p&quot;, &quot;smooth&quot;))</code></pre>
<p><img src="06-Analysis-MMRM_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p><strong>Quantile-quantile plots (from lattice)</strong></p>
<pre class="r"><code> qqmath(fm1, id = 0.05)</code></pre>
<p><img src="06-Analysis-MMRM_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p><strong>Sequential decomposition and model comparison</strong></p>
<p>Objects of class ‘merMod’ have an anova method which returns F
statistics corresponding to the sequential decomposition of the
contributions of fixed-effects terms.</p>
<pre class="r"><code>##  fit a model with orthogonal linear and quadratic Days terms
fm4 &lt;- lmer(Reaction ~ polyDays[ , 1] + polyDays[ , 2] +
              (polyDays[ , 1] + polyDays[ , 2] | Subject),
            within(sleepstudy, polyDays &lt;- poly(Days, 2)))
anova(fm4)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Sum Sq"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Mean Sq"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["NumDF"],"name":[3],"type":["int"],"align":["right"]},{"label":["DenDF"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["F value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"23761.1505","2":"23761.1505","3":"1","4":"17.00259","5":"45.85721","6":"3.259288e-06","_rn_":"polyDays[, 1]"},{"1":"340.2518","2":"340.2518","3":"1","4":"16.99831","5":"0.65666","6":"4.289413e-01","_rn_":"polyDays[, 2]"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>## For multiple arguments, the anova method returns model comparison statistics.
anova(fm1, fm2, fm3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["npar"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["logLik"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["deviance"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"4","2":"1802.079","3":"1814.850","4":"-897.0393","5":"1794.079","6":"NA","7":"NA","8":"NA","_rn_":"fm3"},{"1":"5","2":"1762.003","3":"1777.968","4":"-876.0016","5":"1752.003","6":"42.07538787","7":"1","8":"8.782158e-11","_rn_":"fm2"},{"1":"6","2":"1763.939","3":"1783.097","4":"-875.9697","5":"1751.939","6":"0.06391068","7":"1","8":"8.004184e-01","_rn_":"fm1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="reference" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Reference</h2>
<ul>
<li><code>citation("lme4")</code></li>
</ul>
</div>
</div>
<div id="implementation-mmrm-in-r" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Implementation mmrm in
R</h1>
<div id="package-introduction" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Package
introduction</h2>
<ul>
<li>fit a mmrm model with us (unstructured) covariance structure
specified, as well as the defaults of reml = TRUE and control =
mmrm_control().</li>
<li>The method and vcov arguments specify the degrees of freedom and
coefficients covariance matrix adjustment methods, respectively.
mmrm_control: method = c(“Satterthwaite”, “Kenward-Roger”, “Residual”,
“Between-Within”),</li>
<li>The summary() method then provides the coefficients table with
Satterthwaite degrees of freedom as well as the covariance matrix
estimate</li>
<li>Residuals
<ul>
<li><code>residuals(fit, type = "response")</code>, Response or raw
residuals - the difference between the observed and fitted or predicted
value.</li>
<li><code>residuals(fit, type = "pearson")</code>, Pearson residuals -
the raw residuals scaled by the estimated standard deviation of the
response.</li>
<li><code>residuals(fit, type = "normalized")</code>, Normalized or
scaled residuals - the raw residuals are ‘de-correlated’ based on the
Cholesky decomposition of the variance-covariance matrix.</li>
</ul></li>
</ul>
<div id="fit-models" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Fit Models</h3>
<pre class="r"><code>## Release and development
# install.packages(
#   &quot;mmrm&quot;,
#   repos = c(&quot;https://openpharma.r-universe.dev&quot;, &quot;https://cloud.r-project.org&quot;)
# )
library(mmrm)
## https://cran.r-project.org/web/packages/mmrm/index.html
## citation(&quot;mmrm&quot;)

head(fev_data) %&gt;%
  kable(caption = &quot;Check the head of fev_data&quot;, format = &quot;html&quot;) %&gt;% 
  kable_styling(bootstrap_options = &quot;striped&quot;, 
                full_width = F, 
                position = &quot;center&quot;,
                fixed_thead = T) </code></pre>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Check the head of fev_data
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
USUBJID
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
AVISIT
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
ARMCD
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
RACE
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
SEX
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
FEV1_BL
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
FEV1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
WEIGHT
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
VISITN
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
VISITN2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
PT1
</td>
<td style="text-align:left;">
VIS1
</td>
<td style="text-align:left;">
TRT
</td>
<td style="text-align:left;">
Black or African American
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:right;">
25.27144
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.6767231
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.6264538
</td>
</tr>
<tr>
<td style="text-align:left;">
PT1
</td>
<td style="text-align:left;">
VIS2
</td>
<td style="text-align:left;">
TRT
</td>
<td style="text-align:left;">
Black or African American
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:right;">
25.27144
</td>
<td style="text-align:right;">
39.97105
</td>
<td style="text-align:right;">
0.8006186
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.1836433
</td>
</tr>
<tr>
<td style="text-align:left;">
PT1
</td>
<td style="text-align:left;">
VIS3
</td>
<td style="text-align:left;">
TRT
</td>
<td style="text-align:left;">
Black or African American
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:right;">
25.27144
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.7087859
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
-0.8356286
</td>
</tr>
<tr>
<td style="text-align:left;">
PT1
</td>
<td style="text-align:left;">
VIS4
</td>
<td style="text-align:left;">
TRT
</td>
<td style="text-align:left;">
Black or African American
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:right;">
25.27144
</td>
<td style="text-align:right;">
20.48379
</td>
<td style="text-align:right;">
0.8088997
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1.5952808
</td>
</tr>
<tr>
<td style="text-align:left;">
PT2
</td>
<td style="text-align:left;">
VIS1
</td>
<td style="text-align:left;">
PBO
</td>
<td style="text-align:left;">
Asian
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
45.02477
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.4651848
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.3295078
</td>
</tr>
<tr>
<td style="text-align:left;">
PT2
</td>
<td style="text-align:left;">
VIS2
</td>
<td style="text-align:left;">
PBO
</td>
<td style="text-align:left;">
Asian
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
45.02477
</td>
<td style="text-align:right;">
31.45522
</td>
<td style="text-align:right;">
0.2330974
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-0.8204684
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>## by default this uses restricted maximum likelihood (REML)
fit &lt;- mmrm(
  formula = FEV1 ~ SEX + ARMCD * AVISIT + us(AVISIT | USUBJID),
  data = fev_data,
  control = mmrm_control(method = &quot;Between-Within&quot;)
)
summary(fit)</code></pre>
<pre><code>## mmrm fit
## 
## Formula:     FEV1 ~ SEX + ARMCD * AVISIT + us(AVISIT | USUBJID)
## Data:        fev_data (used 537 observations from 197 subjects with maximum 4 
## timepoints)
## Covariance:  unstructured (10 variance parameters)
## Method:      Between-Within
## Vcov Method: Asymptotic
## Inference:   REML
## 
## Model selection criteria:
##      AIC      BIC   logLik deviance 
##   3469.5   3502.3  -1724.7   3449.5 
## 
## Coefficients: 
##                      Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept)          32.72334    0.84850 334.00000  38.566  &lt; 2e-16 ***
## SEXFemale            -0.03415    0.62860 194.00000  -0.054    0.957    
## ARMCDTRT              4.46564    1.11580 194.00000   4.002 8.93e-05 ***
## AVISITVIS2            4.89577    0.80286 334.00000   6.098 2.97e-09 ***
## AVISITVIS3           10.30577    0.84028 334.00000  12.265  &lt; 2e-16 ***
## AVISITVIS4           15.26776    1.31888 334.00000  11.576  &lt; 2e-16 ***
## ARMCDTRT:AVISITVIS2  -0.26457    1.13004 334.00000  -0.234    0.815    
## ARMCDTRT:AVISITVIS3  -0.82235    1.21559 334.00000  -0.677    0.499    
## ARMCDTRT:AVISITVIS4   0.50353    1.85777 334.00000   0.271    0.787    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Covariance estimate:
##         VIS1    VIS2    VIS3     VIS4
## VIS1 45.2601 18.7444  9.7947  19.4867
## VIS2 18.7444 30.1211  7.1097  12.7024
## VIS3  9.7947  7.1097 20.5504   8.7375
## VIS4 19.4867 12.7024  8.7375 102.7578</code></pre>
<pre class="r"><code>## Other components
component(fit, name = c(&quot;convergence&quot;, &quot;evaluations&quot;, &quot;conv_message&quot;))</code></pre>
<pre><code>## $convergence
## [1] 0
## 
## $evaluations
## function gradient 
##      127       22 
## 
## $conv_message
## NULL</code></pre>
<pre class="r"><code>component(fit, name = &quot;call&quot;)</code></pre>
<pre><code>## mmrm(formula = FEV1 ~ SEX + ARMCD * AVISIT + us(AVISIT | USUBJID), 
##     data = fev_data, control = mmrm_control(method = &quot;Between-Within&quot;))</code></pre>
<pre class="r"><code>## look at the design matrix
## head(model.matrix(fit), 1)</code></pre>
</div>
<div id="neat-output" class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Neat Output</h3>
<ol style="list-style-type: decimal">
<li>tab_model for HTML output</li>
<li>tidy method to return a summary table of coefficient estimates</li>
<li>glance method to return a summary table of goodness of fit
statistics</li>
<li>augment method to return a merged tibble of the data, fitted values
and residuals</li>
</ol>
<pre class="r"><code>## tab_model for HTML output
tab_model(fit)</code></pre>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
FEV1
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Estimates
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
CI
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
(Intercept)
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
32.72
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
31.05 – 34.39
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
SEX [Female]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.03
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-1.27 – 1.21
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.957
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
ARMCD [TRT]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
4.47
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
2.26 – 6.67
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
AVISIT [VIS2]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
4.90
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
3.32 – 6.48
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
AVISIT [VIS3]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
10.31
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
8.65 – 11.96
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
AVISIT [VIS4]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
15.27
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
12.67 – 17.86
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
ARMCD [TRT] * AVISIT<br>[VIS2]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.26
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-2.49 – 1.96
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.815
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
ARMCD [TRT] * AVISIT<br>[VIS3]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.82
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-3.21 – 1.57
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.499
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
ARMCD [TRT] * AVISIT<br>[VIS4]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.50
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-3.15 – 4.16
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.787
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N <sub>USUBJID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
197
</td>
</table>
<pre class="r"><code>## tidy method to return a summary table of coefficient estimates
fit %&gt;%
  tidy(conf.int = TRUE, conf.level = 0.9)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["conf.low"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["conf.high"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"32.72333694","3":"0.8484961","4":"334","5":"38.56627790","6":"4.603542e-125","7":"31.327685","8":"34.1189889"},{"1":"ARMCDTRT","2":"4.46564345","3":"1.1157973","4":"194","5":"4.00219967","6":"8.926018e-05","7":"2.630320","8":"6.3009666"},{"1":"ARMCDTRT:AVISITVIS2","2":"-0.26457438","3":"1.1300442","4":"334","5":"-0.23412746","6":"8.150295e-01","7":"-2.123332","8":"1.5941830"},{"1":"ARMCDTRT:AVISITVIS3","2":"-0.82235026","3":"1.2155863","4":"334","5":"-0.67650504","6":"4.991883e-01","7":"-2.821812","8":"1.1771113"},{"1":"ARMCDTRT:AVISITVIS4","2":"0.50352583","3":"1.8577683","4":"334","5":"0.27103802","6":"7.865292e-01","7":"-2.552231","8":"3.5592827"},{"1":"AVISITVIS2","2":"4.89577201","3":"0.8028581","4":"334","5":"6.09792946","6":"2.968522e-09","7":"3.575188","8":"6.2163561"},{"1":"AVISITVIS3","2":"10.30577448","3":"0.8402820","4":"334","5":"12.26466176","6":"8.397695e-29","7":"8.923634","8":"11.6879154"},{"1":"AVISITVIS4","2":"15.26775520","3":"1.3188800","4":"334","5":"11.57630345","6":"2.760986e-26","7":"13.098391","8":"17.4371198"},{"1":"SEXFemale","2":"-0.03414531","3":"0.6285969","4":"194","5":"-0.05431989","6":"9.567362e-01","7":"-1.068095","8":"0.9998045"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>## glance method to return a summary table of goodness of fit statistics
fit %&gt;%
  glance()</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["AIC"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["logLik"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["deviance"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"3469.499","2":"3502.331","3":"-1724.749","4":"3449.499"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>## augment method to return a merged tibble of the data, fitted values and residuals
fit %&gt;%
  augment(interval = &quot;confidence&quot;, type.residuals = &quot;normalized&quot;) %&gt;%
  head()</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[".rownames"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["FEV1"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["SEX"],"name":[3],"type":["fct"],"align":["left"]},{"label":["ARMCD"],"name":[4],"type":["fct"],"align":["left"]},{"label":["AVISIT"],"name":[5],"type":["fct"],"align":["left"]},{"label":["USUBJID"],"name":[6],"type":["fct"],"align":["left"]},{"label":[".fitted"],"name":[7],"type":["dbl"],"align":["right"]},{"label":[".lower"],"name":[8],"type":["dbl"],"align":["right"]},{"label":[".upper"],"name":[9],"type":["dbl"],"align":["right"]},{"label":[".se.fit"],"name":[10],"type":["dbl"],"align":["right"]},{"label":[".resid"],"name":[11],"type":["dbl"],"align":["right"]}],"data":[{"1":"2","2":"39.97105","3":"Female","4":"TRT","5":"VIS2","6":"PT1","7":"39.97105","8":"39.97105","9":"39.97105","10":"0","11":"-0.3307023"},{"1":"4","2":"20.48379","3":"Female","4":"TRT","5":"VIS4","6":"PT1","7":"20.48379","8":"20.48379","9":"20.48379","10":"0","11":"-3.2096766"},{"1":"6","2":"31.45522","3":"Male","4":"PBO","5":"VIS2","6":"PT2","7":"31.45522","8":"31.45522","9":"31.45522","10":"0","11":"-1.1231030"},{"1":"7","2":"36.87889","3":"Male","4":"PBO","5":"VIS3","6":"PT2","7":"36.87889","8":"36.87889","9":"36.87889","10":"0","11":"-1.0808150"},{"1":"8","2":"48.80809","3":"Male","4":"PBO","5":"VIS4","6":"PT2","7":"48.80809","8":"48.80809","9":"48.80809","10":"0","11":"0.4953054"},{"1":"10","2":"35.98699","3":"Female","4":"PBO","5":"VIS2","6":"PT3","7":"35.98699","8":"35.98699","9":"35.98699","10":"0","11":"-0.2911615"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="residuals" class="section level3" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Residuals</h3>
<ol style="list-style-type: decimal">
<li>Response or raw residuals - the difference between the observed and
fitted or predicted value. MMRMs can allow for heteroscedasticity, so
these residuals should be interpreted with caution.</li>
<li>Pearson residuals - the raw residuals scaled by the estimated
standard deviation of the response. This residual type is better suited
to identifying outlying observations and the appropriateness of the
covariance structure, compared to the raw residuals.</li>
<li>Normalized or scaled residuals - the raw residuals are
‘de-correlated’ based on the Cholesky decomposition of the
variance-covariance matrix. These residuals should approximately follow
the standard normal distribution, and therefore can be used to check for
normality (<span class="citation">@galecki2013linear</span>).</li>
</ol>
<pre class="r"><code>residuals_resp &lt;- residuals(fit, type = &quot;response&quot;)
residuals_pearson &lt;- residuals(fit, type = &quot;pearson&quot;)
residuals_norm &lt;- residuals(fit, type = &quot;normalized&quot;)</code></pre>
</div>
<div id="predictions" class="section level3" number="4.1.4">
<h3><span class="header-section-number">4.1.4</span> Predictions</h3>
<pre class="r"><code>predict(fit, new_data = fev_data) </code></pre>
<pre><code>##        1        2        3        4        5        6        7        8 
## 32.25866 39.97105 44.34333 20.48379 28.05528 31.45522 36.87889 48.80809 
##        9       10       11       12       13       14       15       16 
## 30.49156 35.98699 42.02155 37.16444 33.89229 33.74637 45.19841 54.45055 
##       17       18       19       20       21       22       23       24 
## 32.31386 37.79436 46.79361 41.71154 30.81454 36.23356 39.02423 46.28832 
##       25       26       27       28       29       30       31       32 
## 31.93050 32.90947 42.29985 48.28031 32.23021 35.91080 45.54898 53.02877 
##       33       34       35       36       37       38       39       40 
## 47.16898 46.64287 48.95534 58.09713 33.63345 38.27038 44.97613 48.79929 
##       41       42       43       44       45       46       47       48 
## 44.32755 38.97813 43.72862 46.43393 40.34576 42.76568 40.11155 50.64079 
##       49       50       51       52       53       54       55       56 
## 40.40130 44.14770 53.31791 56.07641 32.18917 37.23137 41.90837 47.51458 
##       57       58       59       60       61       62       63       64 
## 27.90468 34.19932 34.65663 39.07791 31.68910 35.89612 42.62155 47.67264 
##       65       66       67       68       69       70       71       72 
## 22.65440 33.29247 40.69005 40.85376 32.60048 33.64329 44.45759 40.92278 
##       73       74       75       76       77       78       79       80 
## 32.14831 46.43604 41.34973 66.30382 42.66600 47.95358 53.97364 57.31509 
##       81       82       83       84       85       86       87       88 
## 46.42171 56.64544 49.70872 60.40497 45.98525 51.90911 41.50787 53.42727 
##       89       90       91       92       93       94       95       96 
## 23.86859 35.98563 43.60626 45.06810 29.59773 35.50688 55.42944 52.10530 
##       97       98       99      100      101      102      103      104 
## 31.69644 32.16159 51.04735 55.85987 49.11706 49.25544 51.72211 69.99128 
##      105      106      107      108      109      110      111      112 
## 22.07169 36.21004 46.08393 52.42288 37.69466 44.59400 52.08897 58.22961 
##      113      114      115      116      117      118      119      120 
## 37.22824 34.39863 45.03684 36.34012 45.44182 41.54847 43.92172 61.83243 
##      121      122      123      124      125      126      127      128 
## 27.25656 35.96987 45.65133 46.55779 33.19334 39.69556 45.34921 41.66826 
##      129      130      131      132      133      134      135      136 
## 27.12753 31.74858 43.44704 41.60000 39.45250 32.61823 34.62445 45.90515 
##      137      138      139      140      141      142      143      144 
## 36.17780 39.79796 46.12340 50.08272 37.22104 44.64316 46.46440 39.73529 
##      145      146      147      148      149      150      151      152 
## 34.06164 40.18592 41.17584 57.76669 38.18460 40.36031 47.19893 51.06239 
##      153      154      155      156      157      158      159      160 
## 37.32785 39.01971 43.16048 41.40349 30.15733 35.84353 40.95250 46.43128 
##      161      162      163      164      165      166      167      168 
## 36.20637 41.37928 50.17316 45.35226 39.06491 39.82325 43.98944 42.11960 
##      169      170      171      172      173      174      175      176 
## 29.81042 42.57055 47.81652 68.06024 35.62071 41.17068 46.33302 52.28504 
##      177      178      179      180      181      182      183      184 
## 33.89134 36.42808 37.57519 58.46873 19.54516 31.13541 40.89955 42.29082 
##      185      186      187      188      189      190      191      192 
## 22.18809 41.05857 37.32452 46.15340 35.48478 43.12432 41.99349 49.60258 
##      193      194      195      196      197      198      199      200 
## 44.03080 38.66417 53.45993 53.92606 29.81948 30.43859 40.18095 47.24024 
##      201      202      203      204      205      206      207      208 
## 26.78578 34.55115 43.66857 40.06421 37.04540 43.09329 46.48947 45.71567 
##      209      210      211      212      213      214      215      216 
## 40.74992 44.74635 45.28549 52.23482 37.15484 41.78603 46.63826 52.92612 
##      217      218      219      220      221      222      223      224 
## 40.14674 48.75859 46.43462 55.05953 29.33990 36.28645 42.36384 47.93165 
##      225      226      227      228      229      230      231      232 
## 36.84732 41.11632 47.05889 52.24599 45.09785 54.14236 50.44618 58.40798 
##      233      234      235      236      237      238      239      240 
## 37.53657 42.62110 49.45840 59.12866 40.31268 39.66049 50.89726 56.13116 
##      241      242      243      244      245      246      247      248 
## 32.82981 46.53837 46.59402 51.81265 27.91889 29.91939 41.18559 44.72429 
##      249      250      251      252      253      254      255      256 
## 43.25627 51.05656 50.50059 64.11388 32.21843 29.64732 41.79198 45.09919 
##      257      258      259      260      261      262      263      264 
## 39.75659 37.28894 44.80145 65.95920 33.43439 33.57042 39.91543 49.57098 
##      265      266      267      268      269      270      271      272 
## 38.91634 36.69011 45.66665 52.07431 42.21411 45.02901 47.88986 55.34215 
##      273      274      275      276      277      278      279      280 
## 30.98338 44.72932 40.68711 34.71530 27.30752 37.31585 42.07073 44.83000 
##      281      282      283      284      285      286      287      288 
## 32.93042 44.91911 45.68636 65.98800 46.60130 40.89786 46.66708 55.70526 
##      289      290      291      292      293      294      295      296 
## 32.45400 37.48502 43.83270 44.11604 38.29612 41.26590 51.38570 56.20979 
##      297      298      299      300      301      302      303      304 
## 35.45580 43.45819 38.38741 56.42818 39.05050 42.60733 47.09107 54.09200 
##      305      306      307      308      309      310      311      312 
## 31.40521 46.13330 45.29845 28.06936 38.73300 42.50283 46.45368 64.97366 
##      313      314      315      316      317      318      319      320 
## 31.93472 37.09316 42.65668 43.97847 35.33466 39.34378 41.27633 50.78029 
##      321      322      323      324      325      326      327      328 
## 33.58005 39.83058 43.49673 44.06114 41.43742 41.51202 46.16954 54.24024 
##      329      330      331      332      333      334      335      336 
## 36.61831 42.09272 50.69556 51.72563 33.81612 38.31955 43.50026 53.89947 
##      337      338      339      340      341      342      343      344 
## 32.74582 37.48384 39.94420 56.42482 41.86385 34.56420 38.68927 62.88743 
##      345      346      347      348      349      350      351      352 
## 28.85343 37.19314 49.29495 48.06710 28.74029 36.63983 43.59994 57.38616 
##      353      354      355      356      357      358      359      360 
## 35.36824 43.06110 31.27551 54.13245 25.97050 34.82243 41.56774 45.08366 
##      361      362      363      364      365      366      367      368 
## 38.32473 42.72867 51.17493 48.44043 43.33128 45.52184 55.93546 54.15312 
##      369      370      371      372      373      374      375      376 
## 33.85482 40.60252 44.44715 40.54161 33.95563 37.93395 43.67802 42.76023 
##      377      378      379      380      381      382      383      384 
## 34.63082 42.82678 39.59218 48.75639 33.49216 35.39266 42.59847 42.36266 
##      385      386      387      388      389      390      391      392 
## 48.54368 43.94366 48.38610 47.91204 20.72928 28.00599 40.19255 37.79360 
##      393      394      395      396      397      398      399      400 
## 32.18359 36.75177 42.82439 47.62533 34.59822 39.32034 40.65702 48.35301 
##      401      402      403      404      405      406      407      408 
## 40.13414 43.03255 54.65715 55.81275 35.55742 43.70215 42.52157 54.89337 
##      409      410      411      412      413      414      415      416 
## 32.03460 29.45107 45.35138 46.81705 38.73784 39.50734 41.42283 47.32385 
##      417      418      419      420      421      422      423      424 
## 41.04691 47.55310 49.06509 55.68220 29.22591 40.08175 45.68142 41.47403 
##      425      426      427      428      429      430      431      432 
## 35.80521 39.53212 42.51970 69.36099 42.39760 43.72376 49.47601 51.94188 
##      433      434      435      436      437      438      439      440 
## 31.79374 40.59100 39.97833 31.69049 34.51747 37.20517 46.28740 51.22825 
##      441      442      443      444      445      446      447      448 
## 31.48125 36.79757 42.45335 41.58720 32.17365 37.00871 40.69375 47.19794 
##      449      450      451      452      453      454      455      456 
## 32.28771 41.76205 40.06768 47.95298 29.14213 39.50989 43.32349 47.16756 
##      457      458      459      460      461      462      463      464 
## 40.93020 42.19406 41.21057 50.94762 38.54330 41.46189 43.96324 42.67652 
##      465      466      467      468      469      470      471      472 
## 22.79584 33.50764 40.88071 43.71681 31.43559 38.85064 48.24288 48.92557 
##      473      474      475      476      477      478      479      480 
## 44.71302 51.85370 49.24534 57.63284 30.56757 36.70630 42.53583 47.04348 
##      481      482      483      484      485      486      487      488 
## 38.50591 42.67862 47.26289 59.90473 35.91423 39.92595 49.76150 50.83390 
##      489      490      491      492      493      494      495      496 
## 47.21985 40.34525 48.29793 54.10008 36.68616 44.39634 41.71421 47.37535 
##      497      498      499      500      501      502      503      504 
## 42.03797 37.56100 45.11793 51.32144 34.62530 45.28206 47.18422 63.57761 
##      505      506      507      508      509      510      511      512 
## 35.80878 41.24459 46.36260 52.67314 35.88734 38.73222 46.70361 53.65398 
##      513      514      515      516      517      518      519      520 
## 36.71543 41.62406 46.56993 52.75638 37.36315 41.54317 51.67909 51.99478 
##      521      522      523      524      525      526      527      528 
## 27.40130 30.33517 37.73092 29.11668 30.12357 32.08830 41.66067 53.90815 
##      529      530      531      532      533      534      535      536 
## 33.33389 35.06937 47.17615 56.49347 34.05531 38.88006 47.54070 43.53705 
##      537      538      539      540      541      542      543      544 
## 31.82054 39.62816 44.95543 21.11543 34.74671 41.02447 46.34720 56.69249 
##      545      546      547      548      549      550      551      552 
## 22.73126 32.50075 42.37206 42.89847 55.62582 45.38998 52.66743 60.60850 
##      553      554      555      556      557      558      559      560 
## 30.90653 37.28017 34.18931 45.59740 28.89198 38.46147 42.63563 49.90357 
##      561      562      563      564      565      566      567      568 
## 38.78865 44.14167 47.29718 55.24278 37.18898 41.82018 46.67240 52.96026 
##      569      570      571      572      573      574      575      576 
## 27.38001 33.63251 43.60753 39.34410 26.98575 24.04175 42.16648 44.75380 
##      577      578      579      580      581      582      583      584 
## 31.55469 44.42696 44.10343 49.07014 35.26871 37.87445 48.31828 50.21520 
##      585      586      587      588      589      590      591      592 
## 41.94615 39.62690 46.69763 51.99089 38.46554 43.75255 47.38873 53.85430 
##      593      594      595      596      597      598      599      600 
## 32.43412 43.07163 42.99551 53.82759 38.24357 41.44829 50.64802 63.44051 
##      601      602      603      604      605      606      607      608 
## 34.48949 40.08056 43.55575 47.46553 32.50058 37.11697 44.66965 36.25120 
##      609      610      611      612      613      614      615      616 
## 29.20171 31.53773 42.35683 64.78352 32.72757 37.50022 43.36771 57.03861 
##      617      618      619      620      621      622      623      624 
## 36.32475 40.94975 41.46725 59.01411 30.14970 34.91740 52.13900 58.73839 
##      625      626      627      628      629      630      631      632 
## 35.83185 41.45633 46.57214 56.41409 38.13481 43.55593 44.26320 59.25579 
##      633      634      635      636      637      638      639      640 
## 28.47314 47.47581 46.02749 51.11188 40.01364 46.47483 51.22677 45.82777 
##      641      642      643      644      645      646      647      648 
## 33.61198 39.06783 43.34498 48.58229 29.99542 36.85067 42.79139 54.17796 
##      649      650      651      652      653      654      655      656 
## 38.42979 44.55743 45.35498 62.59579 31.72978 35.48396 44.07768 46.57837 
##      657      658      659      660      661      662      663      664 
## 47.67979 46.14494 48.91595 57.45763 22.15439 35.59361 43.41879 46.48713 
##      665      666      667      668      669      670      671      672 
## 34.27765 36.90059 42.85333 40.54285 29.09494 37.21768 43.08491 46.79598 
##      673      674      675      676      677      678      679      680 
## 27.12174 34.11916 41.63170 45.31955 35.49550 40.80230 45.89269 43.69153 
##      681      682      683      684      685      686      687      688 
## 28.82687 29.22869 41.68549 55.68362 31.90698 37.31061 40.75546 49.23304 
##      689      690      691      692      693      694      695      696 
## 42.19474 44.87228 47.55198 55.23537 50.62894 45.47551 48.62168 58.19013 
##      697      698      699      700      701      702      703      704 
## 29.66493 34.57406 41.76014 38.11676 33.77204 34.26148 45.45167 58.81037 
##      705      706      707      708      709      710      711      712 
## 31.22299 36.53004 39.88119 46.65268 31.62708 37.19952 42.82547 48.22049 
##      713      714      715      716      717      718      719      720 
## 42.58829 44.22400 49.33262 53.74331 29.71857 30.45651 38.29800 44.76498 
##      721      722      723      724      725      726      727      728 
## 36.81040 38.62269 42.35045 39.39860 36.67247 41.62033 49.73629 41.58082 
##      729      730      731      732      733      734      735      736 
## 43.58901 40.16762 47.44575 54.80900 38.70788 41.08206 47.45876 69.37409 
##      737      738      739      740      741      742      743      744 
## 34.19182 41.27625 44.76138 39.69815 38.44296 48.20586 44.69620 35.50735 
##      745      746      747      748      749      750      751      752 
## 32.08153 37.33330 42.86346 47.69532 44.69256 41.99195 42.18689 52.28969 
##      753      754      755      756      757      758      759      760 
## 37.01741 38.26920 49.28806 52.83044 40.45953 45.10337 45.58250 62.96989 
##      761      762      763      764      765      766      767      768 
## 30.78252 38.89672 45.02228 44.69667 32.72491 45.78702 48.74886 84.08449 
##      769      770      771      772      773      774      775      776 
## 28.64973 30.19495 36.78573 61.03588 20.36749 35.22480 37.42847 30.20501 
##      777      778      779      780      781      782      783      784 
## 41.42278 49.12862 47.31234 55.70050 19.28388 30.00682 40.15078 49.21768 
##      785      786      787      788      789      790      791      792 
## 31.23325 36.64780 42.36098 40.13353 42.34534 52.32575 49.44529 69.26254 
##      793      794      795      796      797      798      799      800 
## 37.18898 41.82018 46.67240 52.96026 35.70341 41.64454 44.23828 54.25081</code></pre>
<pre class="r"><code># predict(
#   fit,
#   new_data = fev_data,
#   type = &quot;raw&quot;,
#   opts = list(se.fit = TRUE, interval = &quot;prediction&quot;, nsim = 10L)
# ) 

# augment(fit, new_data = fev_data) %&gt;%
#   select(USUBJID, AVISIT, .resid, .fitted)</code></pre>
</div>
</div>
<div id="common-customizations" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Common
Customizations</h2>
<ul>
<li>mmrm_control() is provided. This function allows the user to choose
the adjustment method for the degrees of freedom and the coefficients
covariance matrix, specify optimization routines, number of cores to be
used on Unix systems for trying several optimizers in parallel, provide
a vector of starting parameter values, decide the action to be taken
when the defined design matrix is singular, not drop unobserved visit
levels.</li>
</ul>
<pre><code>mmrm_control(
  method = &quot;Kenward-Roger&quot;,
  optimizer = c(&quot;L-BFGS-B&quot;, &quot;BFGS&quot;),
  n_cores = 2,
  start = c(0, 1, 1, 0, 1, 0),
  accept_singular = FALSE,
  drop_visit_levels = FALSE
)</code></pre>
<ul>
<li>REML or ML</li>
</ul>
<pre><code>fit_ml &lt;- mmrm(
  formula = FEV1 ~ RACE + ARMCD * AVISIT + us(AVISIT | USUBJID),
  data = fev_data,
  reml = FALSE
)</code></pre>
<ul>
<li>Adjustment Method
<ul>
<li>In additional to the residual and Between-Within degrees of freedom,
both Satterthwaite and Kenward-Roger adjustment methods are available.
<code>method = "Kenward-Roger"</code></li>
<li>“Kenward-Roger”</li>
<li>“Satterthwaite”</li>
<li>“Residual”</li>
<li>“Between-Within”</li>
</ul></li>
<li>Variance-covariance for Coefficients
<ul>
<li><a
href="https://cran.r-project.org/web/packages/mmrm/vignettes/coef_vcov.html">Coefficients
Covariance Matrix Adjustment</a></li>
<li>There are multiple variance-covariance estimator available for the
coefficients, including:</li>
<li>“Asymptotic”</li>
<li>“Empirical” (Cluster Robust Sandwich)</li>
<li>“Empirical-Jackknife”</li>
<li>“Empirical-Bias-Reduced”</li>
<li>“Kenward-Roger”</li>
<li>“Kenward-Roger-Linear”</li>
</ul></li>
<li>Optimizer to converge
<ul>
<li>General-purpose optimization based on Nelder–Mead, quasi-Newton and
conjugate-gradient algorithms. It includes an option for box-constrained
optimization and simulated annealing.</li>
<li>The default method is an implementation of that of Nelder and Mead
(1965), that uses only function values and is robust but relatively
slow. It will work reasonably well for non-differentiable
functions.</li>
<li>Method “BFGS” is a quasi-Newton method (also known as a variable
metric algorithm), specifically that published simultaneously in 1970 by
Broyden, Fletcher, Goldfarb and Shanno. This uses function values and
gradients to build up a picture of the surface to be optimized.</li>
<li>Method “CG” is a conjugate gradients method based on that by
Fletcher and Reeves (1964) (but with the option of Polak–Ribiere or
Beale–Sorenson updates). Conjugate gradient methods will generally be
more fragile than the BFGS method, but as they do not store a matrix
they may be successful in much larger optimization problems.</li>
<li>Method “L-BFGS-B” is that of Byrd et. al. (1995) which allows box
constraints, that is each variable can be given a lower and/or upper
bound. The initial value must satisfy the constraints. This uses a
limited-memory modification of the BFGS quasi-Newton method. If
non-trivial bounds are supplied, this method will be selected, with a
warning.</li>
</ul></li>
</ul>
<pre><code>?stats::optim()
fit_opt &lt;- mmrm(
  formula = FEV1 ~ RACE + ARMCD * AVISIT + us(AVISIT | USUBJID),
  data = fev_data,
  optimizer = &quot;BFGS&quot;
)</code></pre>
<ul>
<li>Covariance Structure
<ul>
<li><a
href="https://cran.r-project.org/web/packages/mmrm/vignettes/covariance.html">covariance
vignette</a></li>
<li>Grouped Covariance Structure: the estimates are allowed to vary
across groups
<code>formula = FEV1 ~ RACE + ARMCD * AVISIT + cs(AVISIT | ARMCD / USUBJID)</code></li>
</ul></li>
</ul>
<div class="figure" style="text-align: center">
<img src="02_Plots/MMRM/MMRM_var.png" alt="Figure: Common Covariance Structures" width="75%" />
<p class="caption">
Figure: Common Covariance Structures
</p>
</div>
<ul>
<li>Weighting: perform weighted MMRM by specifying a numeric vector
weights with positive values.</li>
</ul>
<pre><code>fit_wt &lt;- mmrm(
  formula = FEV1 ~ RACE + ARMCD * AVISIT + us(AVISIT | USUBJID),
  data = fev_data,
  weights = fev_data$WEIGHT
)</code></pre>
</div>
<div id="keeping-unobserved-visits" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Keeping Unobserved
Visits</h2>
<p>Sometimes not all possible time points are observed in a given data
set. When using a structured covariance matrix, e.g. with
auto-regressive structure, then it can be relevant to keep the correct
distance between the observed time points.</p>
<p>Consider the following example where we have deliberately removed the
VIS3 observations from our initial example data set fev_data to obtain
sparse_data. We first fit the model where we do not drop the visit level
explicitly, using the drop_visit_levels = FALSE choice. Second we fit
the model by default without this option.</p>
<pre class="r"><code>sparse_data &lt;- fev_data[fev_data$AVISIT != &quot;VIS3&quot;, ]
sparse_result &lt;- mmrm(
  FEV1 ~ RACE + ar1(AVISIT | USUBJID),
  data = sparse_data,
  drop_visit_levels = FALSE
)

dropped_result &lt;- mmrm(
  FEV1 ~ RACE + ar1(AVISIT | USUBJID),
  data = sparse_data
)

tab_model(sparse_result,dropped_result)</code></pre>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
FEV1
</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
FEV1
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Estimates
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
CI
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Estimates
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
CI
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
(Intercept)
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
40.08
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
38.27 – 41.90
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
39.69
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
37.98 – 41.40
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
RACE [Black or African<br>American]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.41
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-2.12 – 2.94
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.747
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.45
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-1.94 – 2.85
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.708
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
RACE [White]
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
6.58
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
3.80 – 9.36
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001</strong>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
6.57
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
3.94 – 9.21
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
<strong>&lt;0.001</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
192 <sub>USUBJID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">
192 <sub>USUBJID</sub>
</td>
</table>
<pre class="r"><code>## Keep VIS3 in covariance matrix
cov2cor(VarCorr(sparse_result))</code></pre>
<pre><code>##            VIS1      VIS2      VIS3       VIS4
## VIS1 1.00000000 0.4051834 0.1641736 0.06652042
## VIS2 0.40518341 1.0000000 0.4051834 0.16417360
## VIS3 0.16417360 0.4051834 1.0000000 0.40518341
## VIS4 0.06652042 0.1641736 0.4051834 1.00000000</code></pre>
<pre class="r"><code>## By default, drop the VIS3 from the covariance matrix. As a consequence, we model the correlation between VIS2 and VIS4 the same as the correlation between VIS1 and VIS2. Hence we get a smaller correlation estimate here compared to the first result, which includes VIS3 explicitly.
cov2cor(VarCorr(dropped_result))</code></pre>
<pre><code>##            VIS1      VIS2       VIS4
## VIS1 1.00000000 0.1468464 0.02156386
## VIS2 0.14684640 1.0000000 0.14684640
## VIS4 0.02156386 0.1468464 1.00000000</code></pre>
</div>
<div id="hypothesis-testing" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Hypothesis
Testing</h2>
<p>This package supports estimation of one- and multi-dimensional
contrasts (t-test and F-test calculation) with the df_1d() and df_md()
functions.</p>
<div id="one-dimensional-contrasts" class="section level3"
number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> One-Dimensional
Contrasts</h3>
<pre class="r"><code>fit &lt;- mmrm(
  formula = FEV1 ~ RACE + SEX + ARMCD * AVISIT + us(AVISIT | USUBJID),
  data = fev_data
)

contrast &lt;- numeric(length(component(fit, &quot;beta_est&quot;)))
contrast[3] &lt;- 1
contrast</code></pre>
<pre><code>##  [1] 0 0 1 0 0 0 0 0 0 0 0</code></pre>
<pre class="r"><code>df_1d(fit, contrast)</code></pre>
<pre><code>## $est
## [1] 5.643565
## 
## $se
## [1] 0.6656093
## 
## $df
## [1] 157.1382
## 
## $t_stat
## [1] 8.478795
## 
## $p_val
## [1] 1.564869e-14</code></pre>
</div>
<div id="multi-dimensional-contrasts" class="section level3"
number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Multi-Dimensional
Contrasts</h3>
<pre class="r"><code>contrast &lt;- matrix(data = 0, nrow = 2, ncol = length(component(fit, &quot;beta_est&quot;)))
contrast[1, 2] &lt;- contrast[2, 3] &lt;- 1
contrast</code></pre>
<pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11]
## [1,]    0    1    0    0    0    0    0    0    0     0     0
## [2,]    0    0    1    0    0    0    0    0    0     0     0</code></pre>
<pre class="r"><code>df_md(fit, contrast)</code></pre>
<pre><code>## $num_df
## [1] 2
## 
## $denom_df
## [1] 165.5553
## 
## $f_stat
## [1] 36.91143
## 
## $p_val
## [1] 5.544575e-14</code></pre>
</div>
</div>
<div id="least-square-means" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Least-Square
Means</h2>
<p>This package includes methods that allow mmrm objects to be used with
the emmeans package. emmeans computes estimated marginal means (also
called least-square means) for the coefficients of the MMRM. For
example, in order to see the least-square means by visit and by
treatment arm:</p>
<pre class="r"><code>library(emmeans)
#&gt; mmrm() registered as emmeans extension
lsmeans_by_visit &lt;- emmeans(fit, ~ ARMCD | AVISIT)
lsmeans_by_visit</code></pre>
<pre><code>## AVISIT = VIS1:
##  ARMCD emmean    SE  df lower.CL upper.CL
##  PBO     33.3 0.755 148     31.8     34.8
##  TRT     37.1 0.763 143     35.6     38.6
## 
## AVISIT = VIS2:
##  ARMCD emmean    SE  df lower.CL upper.CL
##  PBO     38.2 0.612 147     37.0     39.4
##  TRT     41.9 0.602 143     40.7     43.1
## 
## AVISIT = VIS3:
##  ARMCD emmean    SE  df lower.CL upper.CL
##  PBO     43.7 0.462 130     42.8     44.6
##  TRT     46.8 0.509 130     45.7     47.8
## 
## AVISIT = VIS4:
##  ARMCD emmean    SE  df lower.CL upper.CL
##  PBO     48.4 1.189 134     46.0     50.7
##  TRT     52.8 1.188 133     50.4     55.1
## 
## Results are averaged over the levels of: RACE, SEX 
## Confidence level used: 0.95</code></pre>
<p>Furthermore, we can also obtain the differences between the treatment
arms for each visit by applying pairs() on the object returned by
emmeans() earlier:</p>
<pre class="r"><code>pairs(lsmeans_by_visit, reverse = TRUE)</code></pre>
<pre><code>## AVISIT = VIS1:
##  contrast  estimate    SE  df t.ratio p.value
##  TRT - PBO     3.77 1.074 146   3.514  0.0006
## 
## AVISIT = VIS2:
##  contrast  estimate    SE  df t.ratio p.value
##  TRT - PBO     3.73 0.859 145   4.346  &lt;.0001
## 
## AVISIT = VIS3:
##  contrast  estimate    SE  df t.ratio p.value
##  TRT - PBO     3.08 0.690 131   4.467  &lt;.0001
## 
## AVISIT = VIS4:
##  contrast  estimate    SE  df t.ratio p.value
##  TRT - PBO     4.40 1.681 133   2.617  0.0099
## 
## Results are averaged over the levels of: RACE, SEX</code></pre>
</div>
<div id="reference-1" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> Reference</h2>
<ul>
<li><code>citation("mmrm")</code></li>
<li><a
href="https://cran.r-project.org/web/packages/mmrm/vignettes/algorithm.html">mmrm:
Model Fitting Algorithm</a></li>
<li><a
href="https://cran.r-project.org/web/packages/mmrm/vignettes/between_within.html">mmrm:
Between-Within</a></li>
<li><a
href="https://cran.r-project.org/web/packages/mmrm/vignettes/coef_vcov.html">mmrm:
Coefficients Covariance Matrix Adjustment</a></li>
<li><a
href="https://cran.r-project.org/web/packages/mmrm/vignettes/covariance.html">mmrm:
Covariance Structures</a></li>
<li><a
href="https://cran.r-project.org/web/packages/mmrm/vignettes/empirical_wls.html">mmrm:
Weighted Least Square Empirical Covariance</a></li>
<li><a
href="https://cran.r-project.org/web/packages/mmrm/vignettes/kenward.html">mmrm:
Kenward-Roger</a></li>
<li><a
href="https://cran.r-project.org/web/packages/mmrm/vignettes/methodological_introduction.html">mmrm:
Mixed Models for Repeated Measures</a></li>
<li><a
href="https://cran.r-project.org/web/packages/mmrm/vignettes/mmrm_review_methods.html">mmrm:
Comparison with SAS</a></li>
<li><a
href="https://cran.r-project.org/web/packages/mmrm/vignettes/introduction.html">mmrm:
Package Introduction</a></li>
</ul>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
