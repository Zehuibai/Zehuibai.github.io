<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title> Scatter Plot</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Zehui Bai</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="02-Clinical_Experience.html">
    <span class="fa fa-user"></span>
     
    Clinical Experience
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-sliders"></span>
     
    Sample Size
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="03-SSC-Everything-to-Know-About-Sample-Size-Determination.html">Everything to Know About Sample Size Determination</a>
    </li>
    <li>
      <a href="03-SSC-Choosing-the-Effect-Size-for-Sample-Size-Calculations.html">Choosing the Effect Size</a>
    </li>
    <li>
      <a href="03-SSC-Biosimilar-Trials.html">Statistical Considerations for the Design and Analysis of Biosimilar Trials</a>
    </li>
    <li>
      <a href="03-SSC-Sample-Size-and-Power-for-Non-Parametric-Analysis.html">Sample Size and Power for Non-Parametric Analysis</a>
    </li>
    <li>
      <a href="03-SSC-Power-for-Complex-Hypotheses.html">Power for Complex Hypotheses</a>
    </li>
    <li>
      <a href="03-SSC-Alternatives-to-Power.html">Bayesian methods - Alternatives to Power</a>
    </li>
    <li>
      <a href="03-SSC-Sample-Size-for-Pilot-Studies.html">Sample Size for Pilot Studies</a>
    </li>
    <li>
      <a href="03-SSC-Case-Continuous-Endpoint.html">Sample Size Determination for Continuous Endpoint</a>
    </li>
    <li>
      <a href="03-SSC-Case-Categorical-Endpoint.html">Sample Size Determination for Categorical Endpoint</a>
    </li>
    <li>
      <a href="03-SSC-Sample-Size-Determination-for-Counts-and-Rates.html">Sample Size Determination for Counts and Rates</a>
    </li>
    <li>
      <a href="03-SSC-Case-Survival-Endpoint.html">Sample Size Determination for Survival Endpoint</a>
    </li>
    <li>
      <a href="03-SSC-Case-Repeated-Measures.html">Sample Size Determination for Repeated Measures</a>
    </li>
    <li>
      <a href="03-SSC-IA-Sequential-Design.html">Statistical Considerations for Group Sequential Design</a>
    </li>
    <li>
      <a href="03-SSC-IA-Adaptive-Design.html">Statistical Considerations for Adaptive Design</a>
    </li>
    <li>
      <a href="03-SSC-Multiple-Test.html">Sample Size for Multiple Test</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-pencil-square-o"></span>
     
    Study Design
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="04-Design-General-Consideration.html">General Consideration</a>
    </li>
    <li>
      <a href="04-Design-Estimands-Framework.html">Estimands Framework</a>
    </li>
    <li>
      <a href="04-Design-Estimands-Practice.html">Estimands and Sensitivity Analyses</a>
    </li>
    <li>
      <a href="04-Design-Phase-I-Trials---Design-Considerations.html">Phase I Trials - Design Considerations</a>
    </li>
    <li>
      <a href="04-Design-Phase-II-Trials---Design-Considerations.html">Phase II Trials - Design Considerations</a>
    </li>
    <li>
      <a href="04-Design-Phase-III-Trials---Design-Considerations.html">Phase III Trials - Design Considerations</a>
    </li>
    <li>
      <a href="04-Design-Phase-IV-Trials---Design-Considerations.html">Phase IV Trials - Design Considerations for Post Marketing Surveillance</a>
    </li>
    <li>
      <a href="04-Design-Complex-Sequential-Trials.html">Complex Sequential Analysis Trials</a>
    </li>
    <li>
      <a href="04-Design-Adaptive-Clinical-Trials.html">Adaptive Clinical Trials</a>
    </li>
    <li>
      <a href="04-Design-Bayesian-Clinical-Trials.html">Bayesian Clinical Trials</a>
    </li>
    <li>
      <a href="04-Design-Dose-Escalation-and-Stratification-Designs.html">Dose Escalation and Stratification Designs in Early Oncology Development</a>
    </li>
    <li>
      <a href="04-Design-Single-Arm-Clinical-Trials.html">Single Arm Clinical Trials</a>
    </li>
    <li>
      <a href="04-Design-Diagnostic-Study-Design-and-Evaluation.html">Diagnostic Study-Design and Evaluation</a>
    </li>
    <li>
      <a href="04-Design-Diagnostic-Study-MRMC.html">Diagnostic Study-Multireader Multicase (MRMC)</a>
    </li>
    <li>
      <a href="04-Design-Vaccine-Design.html">Vaccine Trials</a>
    </li>
    <li>
      <a href="04-Design-Externally-Controlled-Trials.html">Externally Controlled Trials</a>
    </li>
    <li>
      <a href="04-Design-Noninferiority-Trials.html">Noninferiority Trials</a>
    </li>
    <li>
      <a href="04-Design-Bioequivalence-and-Biosimilar-Trials.html">Bioequivalence and Biosimilar Trials</a>
    </li>
    <li>
      <a href="04-Design-Exploring-Survival-Analysis-Designs-for-Clinical-Trials.html">Exploring Survival Analysis Designs for Clinical Trials</a>
    </li>
    <li>
      <a href="04-Design-Hierarchical-composite-endpoints.html">Hierarchical Composite Endpoints</a>
    </li>
    <li>
      <a href="04-Design-Regulatory-Submission.html">Regulatory Submission from Stats Perspective</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-line-chart"></span>
     
    Data Visualization
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="05-Plot-Time-To-Event.html">Time to Event Data Visualization</a>
    </li>
    <li>
      <a href="05-Plot-PRO-Data.html">Patient Reported Outcome Data Visualization</a>
    </li>
    <li>
      <a href="05-Plot-SSC-and-Power-Calculation.html">Sample Size and Power Calculations Visualization</a>
    </li>
    <li>
      <a href="05-Plot-Correlation.html">Correlation Visualization</a>
    </li>
    <li>
      <a href="05-Plot-Model-Table.html">Clinical Data and Model visualization</a>
    </li>
    <li>
      <a href="05-Plot-ScatterPlot.html">Scatter and Line Plot</a>
    </li>
    <li>
      <a href="05-Plot-BarPlot.html">Bar Chart</a>
    </li>
    <li>
      <a href="05-Plot-PieChart.html">Pie Chart</a>
    </li>
    <li>
      <a href="05-Plot-BoxPlot.html">Box Plot</a>
    </li>
    <li>
      <a href="05-Plot-Histogram.html">Histogram</a>
    </li>
    <li>
      <a href="05-Plot-Forest-Plot.html">Forest Plot</a>
    </li>
    <li>
      <a href="05-Plot-Flow-Chart.html">Flow Chart</a>
    </li>
    <li>
      <a href="05-Plot-Some-Interesting.html">Some Interesting Plots</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-calculator"></span>
     
    Statistical Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="06-Analysis-Linear-Regression.html">Linear Regression</a>
    </li>
    <li>
      <a href="06-Analysis-Logistic-Regression.html">Logistic Regression</a>
    </li>
    <li>
      <a href="06-Analysis-Mixed-Model.html">Mixed Model</a>
    </li>
    <li>
      <a href="06-Analysis-MMRM.html">Mixed Model Repeated Measures</a>
    </li>
    <li>
      <a href="06-Analysis-GEE.html">Generalized Estimating Equation</a>
    </li>
    <li>
      <a href="06-Analysis-ANOVA.html">Analysis of Variance</a>
    </li>
    <li>
      <a href="06-Analysis-Survival-Analysis.html">Survival Analysis</a>
    </li>
    <li>
      <a href="06-Analysis-Survival-Competing-Risk.html">Survival Analysis - Competing Risk</a>
    </li>
    <li>
      <a href="06-Analysis-Missing-Data.html">Missing Data Analysis</a>
    </li>
    <li>
      <a href="06-Analysis-MI-Implementation.html">Multiple Imputation Analysis</a>
    </li>
    <li>
      <a href="06-Analysis-SSD.html">Safety Signal Detection and Evaluation</a>
    </li>
    <li>
      <a href="06-Analysis-Meta-Analysis.html">Meta Analysis</a>
    </li>
    <li>
      <a href="06-Analysis-PK-and-PD.html">PK and PD Analysis</a>
    </li>
    <li>
      <a href="06-Analysis-Time-Series-Analysis.html">Time Series Analysis</a>
    </li>
    <li>
      <a href="06-Analysis-SEM.html">Structural Equation Modeling</a>
    </li>
    <li>
      <a href="06-Analysis-Factor-Analysis.html">Factor Analysis</a>
    </li>
    <li>
      <a href="06-Analysis-Propensity-Score.html">Propensity Score Analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-bar-chart"></span>
     
    Machine Learning
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="07-ML-Bayesian-Theory.html">Bayesian Theory</a>
    </li>
    <li>
      <a href="07-ML-Bayesian-Analysis.html">Bayesian Analysis</a>
    </li>
    <li>
      <a href="07-ML-Regularization-Penalized-Regression.html">Regularization Penalized Regression</a>
    </li>
    <li>
      <a href="07-ML-Loss-Regression.html">Loss Functions in Machine Learning</a>
    </li>
    <li>
      <a href="07-ML-PCA.html">Principal Component Analysis</a>
    </li>
    <li>
      <a href="07-ML-KNN.html">K-Nearest Neighbors</a>
    </li>
    <li>
      <a href="07-ML-SVM.html">Support Vector Machine</a>
    </li>
    <li>
      <a href="07-ML-Tree-Models.html">Tree Models</a>
    </li>
    <li>
      <a href="07-ML-LDA.html">Linear Discriminant Analysis</a>
    </li>
    <li>
      <a href="07-ML-Cluster-Analysis.html">Cluster Analysis</a>
    </li>
    <li>
      <a href="07-ML-Neural-Networks.html">Neural Network</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-stethoscope"></span>
     
    Clinical Analysis (ADaM)
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="08-Clinical-Disposition-Baseline.html">Disposition and Baseline</a>
    </li>
    <li>
      <a href="08-Clinical-Efficacy.html">Efficacy Analysis</a>
    </li>
    <li>
      <a href="08-Clinical-Pharmacokinetics-Analysis.html">Pharmacokinetics Analysis</a>
    </li>
    <li>
      <a href="08-Clinical-Adverse-Event.html">Adverse Event Visualization</a>
    </li>
    <li>
      <a href="08-Clinical-Laboratory-Data.html">Laboratory Data Visualization</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="08-CV.html">
    <span class="fa fa-file-pdf-o"></span>
     
    CV
  </a>
</li>
<li>
  <a href="mailto:zehuibai@outlook.com">
    <span class="fa fa-envelope-o"></span>
     
    Contact me
  </a>
</li>
<li>
  <a href="https://github.com/Zehuibai">
    <span class="fa fa-github"></span>
     
    GitHub
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore"><p><img src="logo.png"
style="width:3in" /><br />
Scatter Plot</p></h1>

</div>


<div id="grouping-aesthetic" class="section level1">
<h1>Grouping Aesthetic</h1>
<ul>
<li>Color Aesthetic</li>
<li>Size Aesthetic</li>
<li>Alpha Aesthetic</li>
<li>Shape Aesthetic</li>
</ul>
<pre class="r"><code># Color Aesthetic
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, color = class))</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/the%20aesthetic-1.png" width="672" /></p>
<pre class="r"><code># Set the aesthetic properties of your geom manually
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy), color = &quot;blue&quot;)</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/the%20aesthetic-2.png" width="672" /></p>
<pre class="r"><code># Size Aesthetic
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, size = class))</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/the%20aesthetic-3.png" width="672" /></p>
<pre class="r"><code># Alpha aesthetic, which controls the transparency of the points
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, alpha = class))</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/the%20aesthetic-4.png" width="672" /></p>
<pre class="r"><code># shape aesthetic
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, shape = class))</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/the%20aesthetic-5.png" width="672" /></p>
<pre class="r"><code>data(iris)
theme_set(theme_bw())
ggplot(data = iris, mapping = aes(x = Petal.Length, y = Petal.Width, shape = Species)) +
  geom_point(aes(color = Species), size = 3) +
  scale_colour_manual(values=c(&quot;#3399CC&quot;,&quot;#33FF33&quot;,&quot;#FFCC33&quot;))+
  scale_shape_manual(values = c(1,2,3)) +
  xlab(&quot;Petal Length&quot;) +  ylab(&quot;Petal Width&quot;) +
  ylim(0, 3)+
  ggtitle(&quot;Petal Width and Length&quot;) +
  theme(plot.title = element_text(hjust = 0.5,face = &quot;bold&quot;),
        legend.title = element_blank(),
        legend.position = c(0.1, 0.85))</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/the%20aesthetic-6.png" width="672" /></p>
</div>
<div id="smooth-line" class="section level1">
<h1>Smooth Line</h1>
<div id="geom_smooth" class="section level2">
<h2>geom_smooth</h2>
<pre class="r"><code># display different aesthetics in different layers
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point(mapping = aes(color = class)) + 
  geom_smooth()</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre class="r"><code># no aesthetic just grouping
ggplot(data = mpg) +
  geom_smooth(mapping = aes(x = displ, y = hwy, group = drv)) +
  geom_point(mapping = aes(x = displ, y = hwy, color = class))</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-2-2.png" width="672" /></p>
<pre class="r"><code># linetype aesthetic set the shape of a point
ggplot(data = mpg) + 
  geom_smooth(mapping = aes(x = displ, y = hwy, linetype = drv))</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-2-3.png" width="672" /></p>
<pre class="r"><code># color aesthetic
ggplot(data = mpg) +
  geom_smooth(
    mapping = aes(x = displ, y = hwy, color = drv),
    show.legend = FALSE
  )</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-2-4.png" width="672" /></p>
<pre class="r"><code># Linear line
ggplot(mpg, aes(cty, hwy))+
  geom_point() + 
  geom_smooth(method=&quot;lm&quot;, se=F) +
  theme_bw()+
  labs(subtitle=&quot;mpg: city vs highway mileage&quot;, 
       y=&quot;hwy&quot;, 
       x=&quot;cty&quot;, 
       title=&quot;Scatterplot with overlapping points&quot;, 
       caption=&quot;Source: midwest&quot;)</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-2-5.png" width="672" /></p>
<pre class="r"><code># The raw dataset has 234 observations, but shown in figure fewer, because some points lay together, the jitter plot could be used in this case by applying jitter_geom
ggplot(mpg, aes(cty, hwy))+
  geom_point() + 
  theme_bw()+
  geom_jitter(width = .5, size=1) +
  labs(subtitle=&quot;mpg: city vs highway mileage&quot;, 
       y=&quot;hwy&quot;, 
       x=&quot;cty&quot;, 
       title=&quot;Jittered Points&quot;)</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-2-6.png" width="672" /></p>
</div>
<div id="exploratory-exposure-response-analysis" class="section level2">
<h2>Exploratory exposure-response analysis</h2>
<pre class="r"><code># Read in data
my_data &lt;- 
  read_csv(&quot;./01_Datasets/401_case1_PKPDdataset_ard.csv&quot;) %&gt;%
  filter(CYCLE == 1)

# Plot response vs exposure
my_data %&gt;%
  ggplot(aes(x = AUC, y = sCHG)) + 
  geom_point() + 
  scale_y_continuous(breaks = seq(-800, 800, 200)) +  
  theme_gray(base_size = 10) +
  labs(x = &quot;RESN&quot;, y = &quot;LIDV&quot;, title = &quot;&quot;)</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre class="r"><code># Define custom breaks and labels
lbr &lt;- scales::trans_breaks(&quot;log10&quot;, function(x) 10^x)
llb &lt;- scales::trans_format(&quot;log10&quot;, scales::math_format(10^.x))
source(&#39;./03_Functions/paper_theme.R&#39;)

my_data %&gt;%
  ggplot(aes(x = AUC, y = sCHG)) + 
  geom_point(alpha = 0.7) + 
  geom_smooth(method = &quot;loess&quot;, colour = &quot;red&quot;) + 
  scale_x_log10(
    breaks = lbr,  # Set custom breaks
    labels = llb  # Set custom labels
  ) +
  scale_y_continuous(breaks = seq(-800, 800, 200)) +
  annotation_logticks(sides = &quot;b&quot;) +
  labs(
    x = expression(paste(&quot;AUC0-24h (h*&quot;,mu,&quot;g/mL)&quot;, sep = &quot;&quot;)),
    y = &quot;FEV1 change from baseline (mL)&quot;, 
    title = &quot;Exposure is positively associated with response&quot;,
    subtitle = &quot;Loess smoother (95% CI)&quot;
    ) +
  paper_theme() </code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code># Cleveland, William S. 1979. “Robust Locally Weighted Regression and Smoothing Scatterplots.” Journal of the American Statistical Association 74 (368): 829–36. https://doi.org/10.1080/01621459.1979.10481038
# https://graphicsprinciples.github.io/tutorial-case-studies/posts/401-case1-eda/401-case1-eda.html
my_data %&gt;%
  ggplot(aes(x = AUC, y = sCHG, colour = factor(DOSE))) + 
  geom_point(alpha = 0.5) + 
  geom_smooth(method = &quot;lm&quot;, se = FALSE) + 
  scale_colour_brewer(palette = &quot;Set2&quot; , name = &quot;Dose (mg)&quot;) + 
  scale_x_log10(breaks = lbr, labels = llb) + 
  scale_y_continuous(breaks = seq(-800, 800, 200)) + 
  annotation_logticks(sides = &quot;b&quot;) +
  labs(
    x = expression(paste(&quot;AUC0-24h (h*&quot;, mu, &quot;g/mL)&quot;, sep = &quot;&quot;)), 
    y = &quot;FEV1 change from baseline (mL)&quot;, 
    title = &quot;Exposure is not a better predictor of response than dose&quot;) + 
  paper_theme() + 
  theme(
    legend.position = c(&quot;right&quot;),
    legend.title = element_text(size = 10)
    )</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p><strong>Change the Title rendering using
ggtext::element_textbox()</strong></p>
<pre class="r"><code># library(&quot;ggtext&quot;)
ggplot(mtcars, aes(disp, mpg)) + 
  geom_point() +
  labs(
    title = &quot;&lt;b&gt;Fuel economy vs. engine displacement&lt;/b&gt;&lt;br&gt;
    &lt;span style = &#39;font-size:10pt&#39;&gt;Lorem ipsum *dolor sit amet,*
    consectetur adipiscing elit, **sed do eiusmod tempor incididunt** ut
    labore et dolore magna aliqua. &lt;span style = &#39;color:red;&#39;&gt;Ut enim
    ad minim veniam,&lt;/span&gt; quis nostrud exercitation ullamco laboris nisi
    ut aliquip ex ea commodo consequat.&lt;/span&gt;&quot;,
    x = &quot;displacement (in&lt;sup&gt;3&lt;/sup&gt;)&quot;,
    y = &quot;Miles per gallon (mpg)&lt;br&gt;&lt;span style = &#39;font-size:8pt&#39;&gt;A measure of
    the car&#39;s fuel efficiency.&lt;/span&gt;&quot;
  ) +
  theme(
    plot.title.position = &quot;plot&quot;,
    plot.title = element_textbox_simple(
      size = 13,
      lineheight = 1,
      padding = margin(5.5, 5.5, 5.5, 5.5),
      margin = margin(0, 0, 5.5, 0),
      fill = &quot;cornsilk&quot;
    ),
    axis.title.x = element_textbox_simple(
      width = NULL,
      padding = margin(4, 4, 4, 4),
      margin = margin(4, 0, 0, 0),
      linetype = 1,
      r = grid::unit(8, &quot;pt&quot;),
      fill = &quot;azure1&quot;
    ),
    axis.title.y = element_textbox_simple(
      hjust = 0,
      orientation = &quot;left-rotated&quot;,
      minwidth = unit(1, &quot;in&quot;),
      maxwidth = unit(2, &quot;in&quot;),
      padding = margin(4, 4, 2, 4),
      margin = margin(0, 0, 2, 0),
      fill = &quot;lightsteelblue1&quot;
    )
  )</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/element_textbox-1.png" width="672" /></p>
</div>
</div>
<div id="quadrant-counts" class="section level1">
<h1>Quadrant Counts</h1>
<pre class="r"><code># library(ggpp)

set.seed(4321)
x &lt;- -50:50
y &lt;- rnorm(length(x), mean = 0)
my.data &lt;- data.frame(x, y)

# whole panel
ggplot(my.data, aes(x, y)) +
  geom_point() +
  stat_quadrant_counts(quadrants = 0, label.x = &quot;left&quot;, label.y = &quot;bottom&quot;) +
  scale_y_continuous(expand = expansion(mult = c(0.15, 0.05)))</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre class="r"><code>ggplot(my.data, aes(x, y)) +
  geom_point() +
  geom_quadrant_lines(xintercept = 0, yintercept = 0) +
  stat_quadrant_counts(aes(label = after_stat(pc.label)))</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-6-2.png" width="672" /></p>
<pre class="r"><code>ggplot(my.data, aes(x, y)) +
  geom_point() +
  geom_quadrant_lines() +
  stat_quadrant_counts(aes(label = after_stat(fr.label)))</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-6-3.png" width="672" /></p>
<pre class="r"><code>ggplot(my.data, aes(x, y)) +
  geom_point() +
  geom_quadrant_lines() +
  stat_quadrant_counts(aes(label = after_stat(dec.label)))</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-6-4.png" width="672" /></p>
<pre class="r"><code>ggplot(my.data, aes(x, y)) +
 geom_point() +
  geom_quadrant_lines() +
  stat_quadrant_counts(aes(label = sprintf(&quot;%i observations&quot;, after_stat(count)))) +
  scale_y_continuous(expand = expansion(c(0.05, 0.15))) # reserve space</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-6-5.png" width="672" /></p>
<pre class="r"><code>ggplot(my.data, aes(x, y)) +
  geom_quadrant_lines(colour = &quot;blue&quot;, xintercept = 10, yintercept = -1) +
  stat_quadrant_counts(colour = &quot;blue&quot;, xintercept = 10, yintercept = -1) +
  geom_point() +
  scale_y_continuous(expand = expansion(mult = 0.15))</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-6-6.png" width="672" /></p>
<pre class="r"><code>## grouped quadrants
ggplot(my.data, aes(x, y)) +
  geom_quadrant_lines(colour = &quot;blue&quot;,
                      pool.along = &quot;x&quot;) +
  stat_quadrant_counts(colour = &quot;blue&quot;, label.x = &quot;right&quot;,
                       pool.along = &quot;x&quot;) +
  geom_point() +
  scale_y_continuous(expand = expansion(mult = 0.15))</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-6-7.png" width="672" /></p>
</div>
<div id="grouping" class="section level1">
<h1>Grouping</h1>
<div id="facet" class="section level2">
<h2>Facet</h2>
<p>facet_wrap(), “winding facet”, only one standard can be applied to
data classification, and the small shapes obtained from different sets
of data are arranged in the order of “winding” from left to right and
from top to bottom</p>
<p>facet_grid(), facet the drawing of the combination of two
variables</p>
<pre class="r"><code>ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) + 
  facet_wrap(.~ class, nrow = 2)</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/facet_wrap%20and%20facet_grid-1.png" width="672" /></p>
<pre class="r"><code>ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) + 
  facet_grid(.~ class)</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/facet_wrap%20and%20facet_grid-2.png" width="672" /></p>
<pre class="r"><code>ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) +
  facet_grid(drv ~ .)</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/facet_wrap%20and%20facet_grid-3.png" width="672" /></p>
<pre class="r"><code>ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) + 
  facet_grid(drv ~ cyl)</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/facet_wrap%20and%20facet_grid-4.png" width="672" /></p>
<p><strong>Replacing facet strips with text boxes using
ggtext::</strong></p>
<pre class="r"><code># library(&quot;cowplot&quot;)

ggplot(mpg, aes(cty, hwy)) + 
  geom_point() +
  facet_wrap(~class) +
  theme_half_open(12) +
  background_grid() </code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/Replacing%20facet%20strips-1.png" width="672" /></p>
<pre class="r"><code># library(&quot;ggtext&quot;)
ggplot(mpg, aes(cty, hwy)) + 
  geom_point() +
  facet_wrap(~class) +
  theme_half_open(12) +
  background_grid() +
  theme(
    strip.background = element_blank(),
    strip.text = element_textbox(
      size = 12,
      color = &quot;white&quot;, fill = &quot;#5D729D&quot;, box.color = &quot;#4A618C&quot;,
      halign = 0.5, linetype = 1, r = unit(5, &quot;pt&quot;), width = unit(1, &quot;npc&quot;),
      padding = margin(2, 0, 1, 0), margin = margin(3, 3, 3, 3)
    )
  )</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/Replacing%20facet%20strips-2.png" width="672" /></p>
</div>
<div id="xy-plots" class="section level2">
<h2>XY plots</h2>
<pre class="r"><code># library(&quot;lme4&quot;) # data sleepstudy
# library(&quot;lattice&quot;)

##------------------------------------------------------------------------
# str(sleepstudy)

xyplot(Reaction ~ Days | Subject, sleepstudy, aspect = &quot;xy&quot;,
       layout = c(9, 2), type = c(&quot;g&quot;, &quot;p&quot;, &quot;r&quot;),
       index.cond = function(x, y) coef(lm(y ~ x))[2],
       xlab = &quot;Days of sleep deprivation&quot;,
       ylab = &quot;Average reaction time (ms)&quot;,
       as.table = TRUE)</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
</div>
<div id="text-ggrepel" class="section level1">
<h1>Text: ggrepel</h1>
<p>There are two important functions in ggrepel R packages:</p>
<ul>
<li>geom_label_repel()</li>
<li>geom_text_repel()</li>
</ul>
<pre class="r"><code># library(&quot;ggrepel&quot;)
# Take a subset of 15 random points
set.seed(1234)
ss &lt;- sample(1:32, 15)
df &lt;- mtcars[ss, ]

# Create a scatter plot:
p &lt;- ggplot(df, aes(wt, mpg)) +
  geom_point(color = &#39;red&#39;) +
  theme_classic(base_size = 10)

# Add text labels:
# Add text annotations using ggplot2::geom_text
p + geom_text(aes(label = rownames(df)),
              size = 3.5)</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/ggrepel-1.png" width="672" /></p>
<pre class="r"><code># Use ggrepel::geom_text_repel
require(&quot;ggrepel&quot;)
set.seed(42)
p + geom_text_repel(aes(label = rownames(df)),
                    size = 3.5) </code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/ggrepel-2.png" width="672" /></p>
<pre class="r"><code># Change color by groups
p + geom_label_repel(aes(label = rownames(df),
                    fill = factor(cyl)), color = &#39;white&#39;,
                    size = 3.5) +
   theme(legend.position = &quot;bottom&quot;)</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/ggrepel-3.png" width="672" /></p>
<pre class="r"><code># With selection
# Data are available in the gapminder package
# library(&quot;gapminder&quot;)
data &lt;- gapminder %&gt;% filter(year==&quot;2007&quot;) %&gt;% select(-year)
# prepare data
tmp &lt;- data %&gt;%
  mutate( annotation = ifelse(gdpPercap &gt; 5000 &amp; lifeExp &lt; 60, &quot;yes&quot;, &quot;no&quot;))
# plot
tmp %&gt;%
  ggplot( aes(x=gdpPercap, y=lifeExp, size = pop, color = continent)) +
    geom_point(alpha=0.7) +
    theme(legend.position=&quot;none&quot;) +
    geom_text_repel(data=tmp %&gt;% filter(annotation==&quot;yes&quot;), aes(label=country), size=4 )</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/ggrepel-4.png" width="672" /></p>
</div>
<div id="dot-plot" class="section level1">
<h1>Dot Plot</h1>
<p>Order <code>fct_reorder</code>: Modifying factor order</p>
<pre class="r"><code># library(&quot;forcats&quot;) 
relig_summary &lt;- gss_cat %&gt;%
  group_by(relig) %&gt;%
  summarise(
    age = mean(age, na.rm = TRUE),
    tvhours = mean(tvhours, na.rm = TRUE),
    n = n()
  )

ggplot(relig_summary, aes(tvhours, relig)) + geom_point()</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/fct_reorder-1.png" width="672" /></p>
<pre class="r"><code>ggplot(relig_summary, aes(tvhours, fct_reorder(relig, tvhours))) +
  geom_point()</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/fct_reorder-2.png" width="672" /></p>
<div id="diverging-dot-plot" class="section level2">
<h2>Diverging Dot Plot</h2>
<pre class="r"><code># Data Prep
data(&quot;mtcars&quot;)  # load data
mtcars$`car name` &lt;- rownames(mtcars)  # create new column for car names
mtcars$mpg_z &lt;- round((mtcars$mpg - mean(mtcars$mpg))/sd(mtcars$mpg), 2)  # compute normalized mpg
mtcars$mpg_type &lt;- ifelse(mtcars$mpg_z &lt; 0, &quot;below&quot;, &quot;above&quot;)  # above / below avg flag
mtcars &lt;- mtcars[order(mtcars$mpg_z), ]  # sort
mtcars$`car name` &lt;- factor(mtcars$`car name`, levels = mtcars$`car name`)  # convert to factor to retain sorted order in plot.


ggplot(mtcars, aes(x=`car name`, y=mpg_z, label=mpg_z)) + 
  geom_point(stat=&#39;identity&#39;, aes(col=mpg_type), size=6)  +
  scale_color_manual(name=&quot;Mileage&quot;, 
                     labels = c(&quot;Above Average&quot;, &quot;Below Average&quot;), 
                     values = c(&quot;above&quot;=&quot;#00ba38&quot;, &quot;below&quot;=&quot;#f8766d&quot;)) + 
  geom_text(color=&quot;white&quot;, size=2) +
  labs(title=&quot;Diverging Dot Plot&quot;, 
       subtitle=&quot;Normalized mileage from &#39;mtcars&#39;: Dotplot&quot;) + 
  ylim(-2.5, 2.5) +
  coord_flip()</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre class="r"><code># Diverging Lollipop Chart
ggplot(mtcars, aes(x=`car name`, y=mpg_z, label=mpg_z)) + 
  geom_point(stat=&#39;identity&#39;, fill=&quot;black&quot;, size=6)  +
  geom_segment(aes(y = 0, 
                   x = `car name`, 
                   yend = mpg_z, 
                   xend = `car name`), 
               color = &quot;black&quot;) +
  geom_text(color=&quot;white&quot;, size=2) +
  labs(title=&quot;Diverging Lollipop Chart&quot;, 
       subtitle=&quot;Normalized mileage from &#39;mtcars&#39;: Lollipop&quot;) + 
  ylim(-2.5, 2.5) +
  coord_flip()</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-8-2.png" width="672" /></p>
<pre class="r"><code># Diverging Barcharts
ggplot(mtcars, aes(x=`car name`, y=mpg_z, label=mpg_z)) + 
  geom_bar(stat=&#39;identity&#39;, aes(fill=mpg_type), width=.5)  +
  scale_fill_manual(name=&quot;Mileage&quot;, 
                    labels = c(&quot;Above Average&quot;, &quot;Below Average&quot;), 
                    values = c(&quot;above&quot;=&quot;#00ba38&quot;, &quot;below&quot;=&quot;#f8766d&quot;)) + 
  labs(subtitle=&quot;Normalised mileage from &#39;mtcars&#39;&quot;, 
       title= &quot;Diverging Bars&quot;) + 
  coord_flip() +
  theme_bw()</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-8-3.png" width="672" /></p>
</div>
<div id="alternative-using-ggbur" class="section level2">
<h2>Alternative using ggbur</h2>
<pre class="r"><code># library(ggpubr)
# https://rpkgs.datanovia.com/ggpubr/
data(&quot;mtcars&quot;)
dfm &lt;- mtcars
# Convert the cyl variable to a factor
dfm$cyl &lt;- as.factor(dfm$cyl)
# Add the name colums
dfm$name &lt;- rownames(dfm)
dfm$mpg_z &lt;- (dfm$mpg -mean(dfm$mpg))/sd(dfm$mpg)
dfm$mpg_grp &lt;- factor(ifelse(dfm$mpg_z &lt; 0, &quot;low&quot;, &quot;high&quot;), 
                     levels = c(&quot;low&quot;, &quot;high&quot;))

ggdotchart(dfm, x = &quot;name&quot;, y = &quot;mpg&quot;,
           color = &quot;cyl&quot;,                                # Color by groups
           palette = c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;, &quot;#FC4E07&quot;), # Custom color palette
           sorting = &quot;ascending&quot;,                        # Sort value in descending order
           add = &quot;segments&quot;,                             # Add segments from y = 0 to dots
           ggtheme = theme_pubr()                        # ggplot2 theme
           )</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code>ggdotchart(dfm, x = &quot;name&quot;, y = &quot;mpg&quot;,
           color = &quot;cyl&quot;,                                # Color by groups
           palette = c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;, &quot;#FC4E07&quot;), # Custom color palette
           sorting = &quot;descending&quot;,                       # Sort value in descending order
           add = &quot;segments&quot;,                             # Add segments from y = 0 to dots
           rotate = TRUE,                                # Rotate vertically
           group = &quot;cyl&quot;,                                # Order by groups
           dot.size = 6,                                 # Large dot size
           label = round(dfm$mpg),                        # Add mpg values as dot labels
           font.label = list(color = &quot;white&quot;, size = 9, 
                             vjust = 0.5),               # Adjust label parameters
           ggtheme = theme_pubr()                        # ggplot2 theme
           )</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
<pre class="r"><code>ggdotchart(dfm, x = &quot;name&quot;, y = &quot;mpg_z&quot;,
           color = &quot;cyl&quot;,                                # Color by groups
           palette = c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;, &quot;#FC4E07&quot;), # Custom color palette
           sorting = &quot;descending&quot;,                       # Sort value in descending order
           add = &quot;segments&quot;,                             # Add segments from y = 0 to dots
           add.params = list(color = &quot;lightgray&quot;, size = 2), # Change segment color and size
           group = &quot;cyl&quot;,                                # Order by groups
           dot.size = 6,                                 # Large dot size
           label = round(dfm$mpg_z,1),                        # Add mpg values as dot labels
           font.label = list(color = &quot;white&quot;, size = 9, 
                             vjust = 0.5),               # Adjust label parameters
           ggtheme = theme_pubr()                        # ggplot2 theme
           )+
  geom_hline(yintercept = 0, linetype = 2, color = &quot;lightgray&quot;)</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-9-3.png" width="672" /></p>
<pre class="r"><code>ggdotchart(dfm, x = &quot;name&quot;, y = &quot;mpg&quot;,
           color = &quot;cyl&quot;,                                # Color by groups
           palette = c(&quot;#00AFBB&quot;, &quot;#E7B800&quot;, &quot;#FC4E07&quot;), # Custom color palette
           sorting = &quot;descending&quot;,                       # Sort value in descending order
           rotate = TRUE,                                # Rotate vertically
           dot.size = 2,                                 # Large dot size
           y.text.col = TRUE,                            # Color y text by groups
           ggtheme = theme_pubr()                        # ggplot2 theme
           )+
  theme_cleveland()         </code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-9-4.png" width="672" /></p>
</div>
</div>
<div id="residuals-plot" class="section level1">
<h1>Residuals Plot</h1>
<div id="residuals-vs.-fitted-plot" class="section level2">
<h2>Residuals vs. Fitted Plot</h2>
<pre class="r"><code>#fit regression model
fit &lt;- lm(mpg ~ qsec, data=mtcars) 


par(mfrow = c(2, 2))
plot(fit)</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<pre class="r"><code>par(mfrow = c(1, 1))  # Return plotting panel to 1 section


# Create residuals vs fitted plot
p.fvr &lt;- ggplot(fit, aes(x = .fitted, y = .resid)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = 2) +
  xlab(&quot;Fitted Values&quot;) +
  ylab(&quot;Residuals&quot;) +
  ggtitle(&quot;Residuals vs. Fitted Plot Created using ggplot2&quot;) +
  theme_bw()
p.fvr</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-10-2.png" width="672" /></p>
<pre class="r"><code># Add a smoothed curve to the ggplot object:
p.fvr + geom_smooth(se = FALSE)</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-10-3.png" width="672" /></p>
<pre class="r"><code># Create standardised residuals vs fitted plot 
ggplot(fit, aes(x = .fitted, y = .stdresid)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = 2) +
  xlab(&quot;Fitted Values&quot;) +
  ylab(&quot;Residuals&quot;) +
  ggtitle(&quot;Standardised residuals vs. Fitted Plot Created using ggplot2&quot;) +
  theme_bw()</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-10-4.png" width="672" /></p>
</div>
<div id="plot-actual-and-predicted-values" class="section level2">
<h2>Plot actual and predicted values</h2>
<pre class="r"><code>#fit regression model
d &lt;- mtcars
fit &lt;- lm(mpg ~ hp, data = d) 
d$predicted &lt;- predict(fit)   # Save the predicted values
d$residuals &lt;- residuals(fit) # Save the residual values

# d %&gt;% select(mpg, predicted, residuals) %&gt;% head()
ggplot(d, aes(x = hp, y = mpg)) +
  geom_smooth(method = &quot;lm&quot;, se = FALSE,formula = y ~ x, color = &quot;lightgrey&quot;) +  # Plot regression slope
  geom_segment(aes(xend = hp, yend = predicted), alpha = .2) +  # alpha to fade lines, connect the actual data points 
  geom_point(aes(alpha = abs(residuals))) +  # Alpha mapped to abs(residuals)
  guides(alpha = &quot;none&quot;) +  # Alpha legend removed
  geom_point(aes(y = predicted), shape = 1) +
  theme_bw()  </code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Color mapped to residual with sign taken into account. i.e., whether
actual value is greater or less than predicted</p>
<pre class="r"><code>ggplot(d, aes(x = hp, y = mpg)) +
  geom_smooth(method = &quot;lm&quot;, se = FALSE, formula = y ~ x,color = &quot;lightgrey&quot;) +
  geom_segment(aes(xend = hp, yend = predicted), alpha = .2) +
  # &gt; Color adjustments made here...
  geom_point(aes(color = residuals)) +  # Color mapped here
  scale_color_gradient2(low = &quot;blue&quot;, mid = &quot;white&quot;, high = &quot;red&quot;) +  # Colors to use here
  guides(color = FALSE) +
  # &lt;
  geom_point(aes(y = predicted), shape = 1) +
  theme_bw()</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>For more details see (here)[<a
href="https://drsimonj.svbtle.com/visualising-residuals"
class="uri">https://drsimonj.svbtle.com/visualising-residuals</a>]</p>
</div>
<div id="normal-probability-plot" class="section level2">
<h2>Normal Probability Plot</h2>
<pre class="r"><code>#fit regression model
fit &lt;- lm(mpg ~ qsec, data=mtcars) 

# Create Q-Q plot from residuals
qq_plot &lt;- ggplot(fit, aes(sample = .resid)) +
  geom_qq() +
  geom_abline(slope = 1, intercept = 0, color =
                &quot;red&quot;, linetype = &quot;dashed&quot;) +
  xlab(&quot;Theoretical Quantiles&quot;) +
  ylab(&quot;Sample Quantiles&quot;) +
  ggtitle(&quot;Normal Q-Q Plot of Residuals&quot;) +
  theme_bw()

# Display plot
qq_plot</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="histogram-of-residuals" class="section level2">
<h2>Histogram of Residuals</h2>
<pre class="r"><code>#fit regression model
fit &lt;- lm(mpg ~ qsec, data=mtcars) 

# Create a histogram of residuals using ggplot2
p.hist &lt;- ggplot(fit, aes(x = .resid)) +
  geom_histogram(binwidth = 0.5, fill = &quot;skyblue&quot;, color = &quot;black&quot;) +
  xlab(&quot;Residuals&quot;) +
  ylab(&quot;Frequency&quot;) +
  ggtitle(&quot;Histogram of Residuals Created using ggplot2&quot;) +
  theme_bw()
p.hist</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="bubble-plot" class="section level1">
<h1>Bubble Plot</h1>
<div id="basic" class="section level2">
<h2>Basic</h2>
<pre class="r"><code># The dataset is provided in the gapminder library
# library(&quot;gapminder&quot;)
data &lt;- gapminder %&gt;% filter(year==&quot;2007&quot;) %&gt;% dplyr::select(-year)

# Control circle size with scale_size()
# Set the size of the smallest and the biggest circles using the range argument.
# circles often overlap. To avoid having big circles on top of the chart you have to reorder your dataset first, as in the code below.
data %&gt;%
  arrange(desc(pop)) %&gt;%
  mutate(country = factor(country, country)) %&gt;%
  ggplot(aes(x=gdpPercap, y=lifeExp, size=pop, color=continent)) +
    geom_point(alpha=0.5) +
    scale_size(range = c(.1, 18), name=&quot;Population (M)&quot;)</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r"><code># use of the viridis package for nice color palette
# use of theme_ipsum() of the hrbrthemes package
# add stroke to circle: change shape to 21 and specify color (stroke) and fill

# library(hrbrthemes)
# library(viridis)

data %&gt;%
  arrange(desc(pop)) %&gt;%
  mutate(country = factor(country, country)) %&gt;%
  ggplot(aes(x=gdpPercap, y=lifeExp, size=pop, fill=continent)) +
    geom_point(alpha=0.5, shape=21, color=&quot;black&quot;) +
    scale_size(range = c(.1, 18), name=&quot;Population (M)&quot;) +
    scale_fill_viridis(discrete=TRUE, guide=FALSE, option=&quot;A&quot;) +
    theme_ipsum() +
    theme(legend.position=&quot;none&quot;) +
    ylab(&quot;Life Expectancy&quot;) +
    xlab(&quot;Gdp per Capita&quot;) </code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
</div>
<div id="interactive-version" class="section level2">
<h2>Interactive Version</h2>
<pre class="r"><code># Libraries
# library(ggplot2)
# library(dplyr)
# library(plotly)
# library(viridis)
# library(hrbrthemes)
# library(gapminder)
# data &lt;- gapminder %&gt;% filter(year==&quot;2007&quot;) %&gt;% dplyr::select(-year)

p &lt;- data %&gt;%
  mutate(gdpPercap=round(gdpPercap,0)) %&gt;%
  mutate(pop=round(pop/1000000,2)) %&gt;%
  mutate(lifeExp=round(lifeExp,1)) %&gt;%
  
  # Reorder countries to having big bubbles on top
  arrange(desc(pop)) %&gt;%
  mutate(country = factor(country, country)) %&gt;%
  
  # prepare text for tooltip
  mutate(text = paste(&quot;Country: &quot;, country, &quot;\nPopulation (M): &quot;, pop, &quot;\nLife Expectancy: &quot;, lifeExp, &quot;\nGdp per capita: &quot;, gdpPercap, sep=&quot;&quot;)) %&gt;%
  
  # Classic ggplot
  ggplot( aes(x=gdpPercap, y=lifeExp, size = pop, color = continent, text=text)) +
    geom_point(alpha=0.7) +
    scale_size(range = c(1.4, 19), name=&quot;Population (M)&quot;) +
    scale_color_viridis(discrete=TRUE, guide=FALSE) +
    theme_ipsum() +
    theme(legend.position=&quot;none&quot;)

# turn ggplot interactive with plotly
pp &lt;- ggplotly(p, tooltip=&quot;text&quot;)
pp</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-466358a46d1399716e82" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-466358a46d1399716e82">{"x":{"data":[{"x":[2014,5581,691,278,9270,2602,1107,1463,3820,6223,1056,1328,824,1045,1545,2042,1217,759,620,4797,470,1712,1043,1271,7093,1704,943,926,863,430,1441,863,12057,883,641,706,3633,1803,415,4811,1569,753,12570,579,13206,10957,4513,7670,986,12154,2082,1598],"y":[46.899999999999999,71.299999999999997,52.899999999999999,46.5,49.299999999999997,58.600000000000001,52.5,54.100000000000001,71.200000000000003,72.299999999999997,51.5,60,42.100000000000001,59.399999999999999,48.299999999999997,50.399999999999999,52.299999999999997,48.299999999999997,56.899999999999999,42.700000000000003,43.5,63.100000000000001,54.5,42.399999999999999,73.900000000000006,50.700000000000003,56,48.200000000000003,46.200000000000003,49.600000000000001,56.700000000000003,42.600000000000001,74,58.399999999999999,58,44.700000000000003,55.299999999999997,64.200000000000003,45.700000000000003,52.899999999999999,42.600000000000001,59.399999999999999,50.700000000000003,46.399999999999999,56.700000000000003,72.799999999999997,39.600000000000001,76.400000000000006,65.200000000000003,51.600000000000001,54.799999999999997,65.5],"text":["Country: Nigeria<br />Population (M): 135.03<br />Life Expectancy: 46.9<br />Gdp per capita: 2014","Country: Egypt<br />Population (M): 80.26<br />Life Expectancy: 71.3<br />Gdp per capita: 5581","Country: Ethiopia<br />Population (M): 76.51<br />Life Expectancy: 52.9<br />Gdp per capita: 691","Country: Congo, Dem. Rep.<br />Population (M): 64.61<br />Life Expectancy: 46.5<br />Gdp per capita: 278","Country: South Africa<br />Population (M): 44<br />Life Expectancy: 49.3<br />Gdp per capita: 9270","Country: Sudan<br />Population (M): 42.29<br />Life Expectancy: 58.6<br />Gdp per capita: 2602","Country: Tanzania<br />Population (M): 38.14<br />Life Expectancy: 52.5<br />Gdp per capita: 1107","Country: Kenya<br />Population (M): 35.61<br />Life Expectancy: 54.1<br />Gdp per capita: 1463","Country: Morocco<br />Population (M): 33.76<br />Life Expectancy: 71.2<br />Gdp per capita: 3820","Country: Algeria<br />Population (M): 33.33<br />Life Expectancy: 72.3<br />Gdp per capita: 6223","Country: Uganda<br />Population (M): 29.17<br />Life Expectancy: 51.5<br />Gdp per capita: 1056","Country: Ghana<br />Population (M): 22.87<br />Life Expectancy: 60<br />Gdp per capita: 1328","Country: Mozambique<br />Population (M): 19.95<br />Life Expectancy: 42.1<br />Gdp per capita: 824","Country: Madagascar<br />Population (M): 19.17<br />Life Expectancy: 59.4<br />Gdp per capita: 1045","Country: Cote d'Ivoire<br />Population (M): 18.01<br />Life Expectancy: 48.3<br />Gdp per capita: 1545","Country: Cameroon<br />Population (M): 17.7<br />Life Expectancy: 50.4<br />Gdp per capita: 2042","Country: Burkina Faso<br />Population (M): 14.33<br />Life Expectancy: 52.3<br />Gdp per capita: 1217","Country: Malawi<br />Population (M): 13.33<br />Life Expectancy: 48.3<br />Gdp per capita: 759","Country: Niger<br />Population (M): 12.89<br />Life Expectancy: 56.9<br />Gdp per capita: 620","Country: Angola<br />Population (M): 12.42<br />Life Expectancy: 42.7<br />Gdp per capita: 4797","Country: Zimbabwe<br />Population (M): 12.31<br />Life Expectancy: 43.5<br />Gdp per capita: 470","Country: Senegal<br />Population (M): 12.27<br />Life Expectancy: 63.1<br />Gdp per capita: 1712","Country: Mali<br />Population (M): 12.03<br />Life Expectancy: 54.5<br />Gdp per capita: 1043","Country: Zambia<br />Population (M): 11.75<br />Life Expectancy: 42.4<br />Gdp per capita: 1271","Country: Tunisia<br />Population (M): 10.28<br />Life Expectancy: 73.9<br />Gdp per capita: 7093","Country: Chad<br />Population (M): 10.24<br />Life Expectancy: 50.7<br />Gdp per capita: 1704","Country: Guinea<br />Population (M): 9.95<br />Life Expectancy: 56<br />Gdp per capita: 943","Country: Somalia<br />Population (M): 9.12<br />Life Expectancy: 48.2<br />Gdp per capita: 926","Country: Rwanda<br />Population (M): 8.86<br />Life Expectancy: 46.2<br />Gdp per capita: 863","Country: Burundi<br />Population (M): 8.39<br />Life Expectancy: 49.6<br />Gdp per capita: 430","Country: Benin<br />Population (M): 8.08<br />Life Expectancy: 56.7<br />Gdp per capita: 1441","Country: Sierra Leone<br />Population (M): 6.14<br />Life Expectancy: 42.6<br />Gdp per capita: 863","Country: Libya<br />Population (M): 6.04<br />Life Expectancy: 74<br />Gdp per capita: 12057","Country: Togo<br />Population (M): 5.7<br />Life Expectancy: 58.4<br />Gdp per capita: 883","Country: Eritrea<br />Population (M): 4.91<br />Life Expectancy: 58<br />Gdp per capita: 641","Country: Central African Republic<br />Population (M): 4.37<br />Life Expectancy: 44.7<br />Gdp per capita: 706","Country: Congo, Rep.<br />Population (M): 3.8<br />Life Expectancy: 55.3<br />Gdp per capita: 3633","Country: Mauritania<br />Population (M): 3.27<br />Life Expectancy: 64.2<br />Gdp per capita: 1803","Country: Liberia<br />Population (M): 3.19<br />Life Expectancy: 45.7<br />Gdp per capita: 415","Country: Namibia<br />Population (M): 2.06<br />Life Expectancy: 52.9<br />Gdp per capita: 4811","Country: Lesotho<br />Population (M): 2.01<br />Life Expectancy: 42.6<br />Gdp per capita: 1569","Country: Gambia<br />Population (M): 1.69<br />Life Expectancy: 59.4<br />Gdp per capita: 753","Country: Botswana<br />Population (M): 1.64<br />Life Expectancy: 50.7<br />Gdp per capita: 12570","Country: Guinea-Bissau<br />Population (M): 1.47<br />Life Expectancy: 46.4<br />Gdp per capita: 579","Country: Gabon<br />Population (M): 1.45<br />Life Expectancy: 56.7<br />Gdp per capita: 13206","Country: Mauritius<br />Population (M): 1.25<br />Life Expectancy: 72.8<br />Gdp per capita: 10957","Country: Swaziland<br />Population (M): 1.13<br />Life Expectancy: 39.6<br />Gdp per capita: 4513","Country: Reunion<br />Population (M): 0.8<br />Life Expectancy: 76.4<br />Gdp per capita: 7670","Country: Comoros<br />Population (M): 0.71<br />Life Expectancy: 65.2<br />Gdp per capita: 986","Country: Equatorial Guinea<br />Population (M): 0.55<br />Life Expectancy: 51.6<br />Gdp per capita: 12154","Country: Djibouti<br />Population (M): 0.5<br />Life Expectancy: 54.8<br />Gdp per capita: 2082","Country: Sao Tome and Principe<br />Population (M): 0.2<br />Life Expectancy: 65.5<br />Gdp per capita: 1598"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(68,1,84,1)","opacity":0.69999999999999996,"size":[26.563257959966595,21.682933162225595,21.294439274052486,19.993800414329737,17.415465285445308,17.176439505814113,16.575312518226415,16.192590463440961,15.904001912288507,15.835793370179923,15.151582505337938,14.013802290221911,13.43269861908694,13.270313071236298,13.022511212708375,12.954931641370955,12.177615642717408,11.929468900402734,11.81729579651136,11.695304531173916,11.666416286511661,11.655878960789829,11.592284955470662,11.517271015310156,11.107596772948085,11.096045106748161,11.011597922703537,10.762705476074075,10.68237613566288,10.534042866766962,10.43386486305041,9.7561861206366629,9.7184437061150621,9.5876401292297544,9.2671324970057452,9.032284576359304,8.7672176768208097,8.5011727733892641,8.4590747650733693,7.7897840986939073,7.7559740759860061,7.527517482601854,7.4896775444485151,7.3558404095865013,7.3395199810551031,7.1685278416906453,7.0580063494777265,6.7103602807203897,6.5996119457744395,6.375134306688472,6.2947384480143782,5.2913385826771648],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(68,1,84,1)"}},"hoveron":"points","name":"Africa","legendgroup":"Africa","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[42952,9066,11978,7007,12779,36319,7409,11416,13172,6873,5186,8948,6025,3822,1202,3548,5728,4173,2749,9645,19329,10611,9809,7321,18009],"y":[78.200000000000003,72.400000000000006,76.200000000000003,72.900000000000006,75.299999999999997,80.700000000000003,71.400000000000006,73.700000000000003,78.599999999999994,75,70.299999999999997,78.299999999999997,72.200000000000003,65.599999999999994,60.899999999999999,70.200000000000003,71.900000000000006,71.799999999999997,72.900000000000006,78.799999999999997,78.700000000000003,76.400000000000006,75.5,72.599999999999994,69.799999999999997],"text":["Country: United States<br />Population (M): 301.14<br />Life Expectancy: 78.2<br />Gdp per capita: 42952","Country: Brazil<br />Population (M): 190.01<br />Life Expectancy: 72.4<br />Gdp per capita: 9066","Country: Mexico<br />Population (M): 108.7<br />Life Expectancy: 76.2<br />Gdp per capita: 11978","Country: Colombia<br />Population (M): 44.23<br />Life Expectancy: 72.9<br />Gdp per capita: 7007","Country: Argentina<br />Population (M): 40.3<br />Life Expectancy: 75.3<br />Gdp per capita: 12779","Country: Canada<br />Population (M): 33.39<br />Life Expectancy: 80.7<br />Gdp per capita: 36319","Country: Peru<br />Population (M): 28.67<br />Life Expectancy: 71.4<br />Gdp per capita: 7409","Country: Venezuela<br />Population (M): 26.08<br />Life Expectancy: 73.7<br />Gdp per capita: 11416","Country: Chile<br />Population (M): 16.28<br />Life Expectancy: 78.6<br />Gdp per capita: 13172","Country: Ecuador<br />Population (M): 13.76<br />Life Expectancy: 75<br />Gdp per capita: 6873","Country: Guatemala<br />Population (M): 12.57<br />Life Expectancy: 70.3<br />Gdp per capita: 5186","Country: Cuba<br />Population (M): 11.42<br />Life Expectancy: 78.3<br />Gdp per capita: 8948","Country: Dominican Republic<br />Population (M): 9.32<br />Life Expectancy: 72.2<br />Gdp per capita: 6025","Country: Bolivia<br />Population (M): 9.12<br />Life Expectancy: 65.6<br />Gdp per capita: 3822","Country: Haiti<br />Population (M): 8.5<br />Life Expectancy: 60.9<br />Gdp per capita: 1202","Country: Honduras<br />Population (M): 7.48<br />Life Expectancy: 70.2<br />Gdp per capita: 3548","Country: El Salvador<br />Population (M): 6.94<br />Life Expectancy: 71.9<br />Gdp per capita: 5728","Country: Paraguay<br />Population (M): 6.67<br />Life Expectancy: 71.8<br />Gdp per capita: 4173","Country: Nicaragua<br />Population (M): 5.68<br />Life Expectancy: 72.9<br />Gdp per capita: 2749","Country: Costa Rica<br />Population (M): 4.13<br />Life Expectancy: 78.8<br />Gdp per capita: 9645","Country: Puerto Rico<br />Population (M): 3.94<br />Life Expectancy: 78.7<br />Gdp per capita: 19329","Country: Uruguay<br />Population (M): 3.45<br />Life Expectancy: 76.4<br />Gdp per capita: 10611","Country: Panama<br />Population (M): 3.24<br />Life Expectancy: 75.5<br />Gdp per capita: 9809","Country: Jamaica<br />Population (M): 2.78<br />Life Expectancy: 72.6<br />Gdp per capita: 7321","Country: Trinidad and Tobago<br />Population (M): 1.06<br />Life Expectancy: 69.8<br />Gdp per capita: 18009"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(59,82,139,1)","opacity":0.69999999999999996,"size":[37.071300274493503,30.530385772108716,24.373531410793372,17.44725635799373,16.89207601891016,15.845337304661243,15.066122027751748,14.610901551499989,12.637431770969043,12.037290724302162,11.734488861413897,11.427684583105821,10.823703647336728,10.762705476074075,10.56913285206582,10.234207584058042,10.047355155739783,9.951120067088576,9.5798215576065981,8.9230362429786734,8.834159597865332,8.5939318524758619,8.4854510420136435,8.2338846047344489,6.9902183206147992],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(59,82,139,1)"}},"hoveron":"points","name":"Americas","legendgroup":"Americas","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[4959,2452,3541,2606,1391,31656,3190,2442,11606,7458,23348,944,975,1091,21655,4471,12452,1593,28718,2281,3970,4185,1714,39725,25523,4519,47143,3025,10461,22316,3096,47307,29796],"y":[73,64.700000000000003,70.700000000000003,65.5,64.099999999999994,82.599999999999994,71.700000000000003,74.200000000000003,71,70.599999999999994,78.599999999999994,62.100000000000001,43.799999999999997,63.799999999999997,72.799999999999997,59.5,74.200000000000003,67.299999999999997,78.400000000000006,62.700000000000003,72.400000000000006,74.099999999999994,59.700000000000003,82.200000000000003,80.700000000000003,72.5,80,73.400000000000006,72,75.599999999999994,66.799999999999997,77.599999999999994,75.599999999999994],"text":["Country: China<br />Population (M): 1318.68<br />Life Expectancy: 73<br />Gdp per capita: 4959","Country: India<br />Population (M): 1110.4<br />Life Expectancy: 64.7<br />Gdp per capita: 2452","Country: Indonesia<br />Population (M): 223.55<br />Life Expectancy: 70.7<br />Gdp per capita: 3541","Country: Pakistan<br />Population (M): 169.27<br />Life Expectancy: 65.5<br />Gdp per capita: 2606","Country: Bangladesh<br />Population (M): 150.45<br />Life Expectancy: 64.1<br />Gdp per capita: 1391","Country: Japan<br />Population (M): 127.47<br />Life Expectancy: 82.6<br />Gdp per capita: 31656","Country: Philippines<br />Population (M): 91.08<br />Life Expectancy: 71.7<br />Gdp per capita: 3190","Country: Vietnam<br />Population (M): 85.26<br />Life Expectancy: 74.2<br />Gdp per capita: 2442","Country: Iran<br />Population (M): 69.45<br />Life Expectancy: 71<br />Gdp per capita: 11606","Country: Thailand<br />Population (M): 65.07<br />Life Expectancy: 70.6<br />Gdp per capita: 7458","Country: Korea, Rep.<br />Population (M): 49.04<br />Life Expectancy: 78.6<br />Gdp per capita: 23348","Country: Myanmar<br />Population (M): 47.76<br />Life Expectancy: 62.1<br />Gdp per capita: 944","Country: Afghanistan<br />Population (M): 31.89<br />Life Expectancy: 43.8<br />Gdp per capita: 975","Country: Nepal<br />Population (M): 28.9<br />Life Expectancy: 63.8<br />Gdp per capita: 1091","Country: Saudi Arabia<br />Population (M): 27.6<br />Life Expectancy: 72.8<br />Gdp per capita: 21655","Country: Iraq<br />Population (M): 27.5<br />Life Expectancy: 59.5<br />Gdp per capita: 4471","Country: Malaysia<br />Population (M): 24.82<br />Life Expectancy: 74.2<br />Gdp per capita: 12452","Country: Korea, Dem. Rep.<br />Population (M): 23.3<br />Life Expectancy: 67.3<br />Gdp per capita: 1593","Country: Taiwan<br />Population (M): 23.17<br />Life Expectancy: 78.4<br />Gdp per capita: 28718","Country: Yemen, Rep.<br />Population (M): 22.21<br />Life Expectancy: 62.7<br />Gdp per capita: 2281","Country: Sri Lanka<br />Population (M): 20.38<br />Life Expectancy: 72.4<br />Gdp per capita: 3970","Country: Syria<br />Population (M): 19.31<br />Life Expectancy: 74.1<br />Gdp per capita: 4185","Country: Cambodia<br />Population (M): 14.13<br />Life Expectancy: 59.7<br />Gdp per capita: 1714","Country: Hong Kong, China<br />Population (M): 6.98<br />Life Expectancy: 82.2<br />Gdp per capita: 39725","Country: Israel<br />Population (M): 6.43<br />Life Expectancy: 80.7<br />Gdp per capita: 25523","Country: Jordan<br />Population (M): 6.05<br />Life Expectancy: 72.5<br />Gdp per capita: 4519","Country: Singapore<br />Population (M): 4.55<br />Life Expectancy: 80<br />Gdp per capita: 47143","Country: West Bank and Gaza<br />Population (M): 4.02<br />Life Expectancy: 73.4<br />Gdp per capita: 3025","Country: Lebanon<br />Population (M): 3.92<br />Life Expectancy: 72<br />Gdp per capita: 10461","Country: Oman<br />Population (M): 3.2<br />Life Expectancy: 75.6<br />Gdp per capita: 22316","Country: Mongolia<br />Population (M): 2.87<br />Life Expectancy: 66.8<br />Gdp per capita: 3096","Country: Kuwait<br />Population (M): 2.51<br />Life Expectancy: 77.6<br />Gdp per capita: 47307","Country: Bahrain<br />Population (M): 0.71<br />Life Expectancy: 75.6<br />Gdp per capita: 29796"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(33,144,140,1)","opacity":0.69999999999999996,"size":[71.811023622047244,66.331267970200471,32.669633000434082,29.111608995325685,27.746731126284608,25.958290692071074,22.755493301536205,22.187035106435133,20.536193650949933,20.046207650959818,18.094028845771181,17.92514837240746,15.604089552949251,15.105526274666035,14.880678034969902,14.863163245093681,14.381203626387496,14.096136667325258,14.071326305857303,13.885894318255705,13.520848861207575,13.299701658714087,12.12870680598726,10.061447087580115,9.8638777515259601,9.7222324146590786,9.1121714371084721,8.8718502439151585,8.8246741162782882,8.4643675610489932,8.2847681340200303,8.075660211214764,6.5996119457744395],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(33,144,140,1)"}},"hoveron":"points","name":"Asia","legendgroup":"Asia","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[32170,8458,30470,33203,28570,28821,15390,10808,36798,27538,20510,33693,22833,9787,18009,33860,36126,37506,10681,35278,18678,33207,49357,7446,14619,40676,5937,25768,9254,36181],"y":[79.400000000000006,71.799999999999997,80.700000000000003,79.400000000000006,80.5,80.900000000000006,75.599999999999994,72.5,79.799999999999997,79.5,78.099999999999994,79.400000000000006,76.5,74,73.299999999999997,80.900000000000006,79.799999999999997,81.700000000000003,73,78.299999999999997,74.700000000000003,79.299999999999997,80.200000000000003,74.900000000000006,75.700000000000003,78.900000000000006,76.400000000000006,77.900000000000006,74.5,81.799999999999997],"text":["Country: Germany<br />Population (M): 82.4<br />Life Expectancy: 79.4<br />Gdp per capita: 32170","Country: Turkey<br />Population (M): 71.16<br />Life Expectancy: 71.8<br />Gdp per capita: 8458","Country: France<br />Population (M): 61.08<br />Life Expectancy: 80.7<br />Gdp per capita: 30470","Country: United Kingdom<br />Population (M): 60.78<br />Life Expectancy: 79.4<br />Gdp per capita: 33203","Country: Italy<br />Population (M): 58.15<br />Life Expectancy: 80.5<br />Gdp per capita: 28570","Country: Spain<br />Population (M): 40.45<br />Life Expectancy: 80.9<br />Gdp per capita: 28821","Country: Poland<br />Population (M): 38.52<br />Life Expectancy: 75.6<br />Gdp per capita: 15390","Country: Romania<br />Population (M): 22.28<br />Life Expectancy: 72.5<br />Gdp per capita: 10808","Country: Netherlands<br />Population (M): 16.57<br />Life Expectancy: 79.8<br />Gdp per capita: 36798","Country: Greece<br />Population (M): 10.71<br />Life Expectancy: 79.5<br />Gdp per capita: 27538","Country: Portugal<br />Population (M): 10.64<br />Life Expectancy: 78.1<br />Gdp per capita: 20510","Country: Belgium<br />Population (M): 10.39<br />Life Expectancy: 79.4<br />Gdp per capita: 33693","Country: Czech Republic<br />Population (M): 10.23<br />Life Expectancy: 76.5<br />Gdp per capita: 22833","Country: Serbia<br />Population (M): 10.15<br />Life Expectancy: 74<br />Gdp per capita: 9787","Country: Hungary<br />Population (M): 9.96<br />Life Expectancy: 73.3<br />Gdp per capita: 18009","Country: Sweden<br />Population (M): 9.03<br />Life Expectancy: 80.9<br />Gdp per capita: 33860","Country: Austria<br />Population (M): 8.2<br />Life Expectancy: 79.8<br />Gdp per capita: 36126","Country: Switzerland<br />Population (M): 7.55<br />Life Expectancy: 81.7<br />Gdp per capita: 37506","Country: Bulgaria<br />Population (M): 7.32<br />Life Expectancy: 73<br />Gdp per capita: 10681","Country: Denmark<br />Population (M): 5.47<br />Life Expectancy: 78.3<br />Gdp per capita: 35278","Country: Slovak Republic<br />Population (M): 5.45<br />Life Expectancy: 74.7<br />Gdp per capita: 18678","Country: Finland<br />Population (M): 5.24<br />Life Expectancy: 79.3<br />Gdp per capita: 33207","Country: Norway<br />Population (M): 4.63<br />Life Expectancy: 80.2<br />Gdp per capita: 49357","Country: Bosnia and Herzegovina<br />Population (M): 4.55<br />Life Expectancy: 74.9<br />Gdp per capita: 7446","Country: Croatia<br />Population (M): 4.49<br />Life Expectancy: 75.7<br />Gdp per capita: 14619","Country: Ireland<br />Population (M): 4.11<br />Life Expectancy: 78.9<br />Gdp per capita: 40676","Country: Albania<br />Population (M): 3.6<br />Life Expectancy: 76.4<br />Gdp per capita: 5937","Country: Slovenia<br />Population (M): 2.01<br />Life Expectancy: 77.9<br />Gdp per capita: 25768","Country: Montenegro<br />Population (M): 0.68<br />Life Expectancy: 74.5<br />Gdp per capita: 9254","Country: Iceland<br />Population (M): 0.3<br />Life Expectancy: 81.8<br />Gdp per capita: 36181"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(93,200,99,1)","opacity":0.69999999999999996,"size":[21.900561725072897,20.723267509556869,19.585238367843317,19.549976658545916,19.237032570609877,16.913752906271775,16.631680820833648,13.8995504136118,12.703378520811723,11.230358326530613,11.210547388219004,11.139246197839341,11.093153596469584,11.069969427753252,11.014530637246384,10.735033311005727,10.472873206727549,10.257914525828445,10.179588570516099,9.4968490538837784,9.4888613724637647,9.4040541901495303,9.1471454647842041,9.1121714371084721,9.0857293695558621,8.9137834950518009,8.6692858810521738,7.7559740759860061,6.5605501740258969,5.8706517650344381],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(93,200,99,1)"}},"hoveron":"points","name":"Europe","legendgroup":"Europe","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[34435,25185],"y":[81.200000000000003,80.200000000000003],"text":["Country: Australia<br />Population (M): 20.43<br />Life Expectancy: 81.2<br />Gdp per capita: 34435","Country: New Zealand<br />Population (M): 4.12<br />Life Expectancy: 80.2<br />Gdp per capita: 25185"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(253,231,37,1)","opacity":0.69999999999999996,"size":[13.531037685560968,8.9184128195124366],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(253,231,37,1)"}},"hoveron":"points","name":"Oceania","legendgroup":"Oceania","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":71.790784557907841,"r":39.850560398505614,"b":86.841012868410132,"l":70.900788709007898},"font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":15.276048152760483},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-2175.9500000000003,51810.949999999997],"tickmode":"array","ticktext":["0","10000","20000","30000","40000","50000"],"tickvals":[0,10000,20000,30000,40000,50000],"categoryorder":"array","categoryarray":["0","10000","20000","30000","40000","50000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.8190120381901207,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"Arial Narrow","size":15.276048152760483},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.265670402656704,"zeroline":false,"anchor":"y","title":{"text":"gdpPercap","font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":11.955168119551683}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[37.450000000000003,84.75],"tickmode":"array","ticktext":["40","50","60","70","80"],"tickvals":[40,50,60,70,80],"categoryorder":"array","categoryarray":["40","50","60","70","80"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.8190120381901207,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"Arial Narrow","size":15.276048152760483},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.26567040265670405,"zeroline":false,"anchor":"x","title":{"text":"lifeExp","font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":11.955168119551683}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":12.220838522208389}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"12384221c0f":{"x":{},"y":{},"size":{},"colour":{},"text":{},"type":"scatter"}},"cur_data":"12384221c0f","visdat":{"12384221c0f":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code># save the widget
# library(htmlwidgets)
# saveWidget(pp, file=paste0( getwd(), &quot;/HtmlWidget/ggplotlyBubblechart.html&quot;))</code></pre>
</div>
</div>
<div id="encircling" class="section level1">
<h1>Encircling</h1>
<p>In geom_encircle(), set the data to a new data frame containing only
points (rows) or points of interest. In addition, you can expand the
curve so that it passes outside the point. The color and size
(thickness) of the curve can also be modified.</p>
<!-- 在图表中加上某些特殊的点或区域组，以便引起人们对这些特殊情况的注意。 可以使用ggalt包中的geom_encircle（）方便地完成此操作。 -->
<pre class="r"><code># install &#39;ggalt&#39; pkg
# devtools::install_github(&quot;hrbrmstr/ggalt&quot;)
options(scipen = 999)
# library(ggalt)
midwest_select &lt;- midwest[midwest$poptotal &gt; 350000 &amp; 
                            midwest$poptotal &lt;= 500000 &amp; 
                            midwest$area &gt; 0.01 &amp; 
                            midwest$area &lt; 0.1, ]

# Plot
ggplot(midwest, aes(x=area, y=poptotal)) + 
  geom_point(aes(col=state, size=popdensity)) +   # draw points
  geom_smooth(method=&quot;loess&quot;, se=F) + 
  xlim(c(0, 0.1)) + 
  ylim(c(0, 500000)) +   # draw smoothing line
  geom_encircle(aes(x=area, y=poptotal), 
                data=midwest_select, 
                color=&quot;red&quot;, 
                size=2, 
                expand=0.08) +   # encircle
  labs(subtitle=&quot;Area Vs Population&quot;, 
       y=&quot;Population&quot;, 
       x=&quot;Area&quot;, 
       title=&quot;Scatterplot + Encircle&quot;, 
       caption=&quot;Source: midwest&quot;)</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/Encircling%20for%20emphasizen-1.png" width="672" /></p>
</div>
<div id="dumbbell-plot" class="section level1">
<h1>Dumbbell Plot</h1>
<p>Dumbbell plot is used to visualize the relative position of two time
points (increase or decrease), it could also be used to compare the
distance between 2 categories. In order to get right orders of dumbbell,
the variable <span class="math inline">\(Y\)</span> should be treated as
factor with conresponding orders shown in figure.</p>
<pre class="r"><code># library(ggalt)

health &lt;- read.csv(&quot;./01_Datasets/health.csv&quot;)
health$Area &lt;- factor(health$Area, levels=as.character(health$Area))  # for right ordering of the dumbells


options(warn=-1)
# health$Area &lt;- factor(health$Area)
ggplot(health, aes(x=pct_2013, xend=pct_2014, y=Area, group=Area)) +
  geom_dumbbell(color=&quot;#a3c4dc&quot;,
                size=0.75,
                point.colour.l=&quot;#0e668b&quot;) +
  labs(x=NULL,
       y=NULL,
       title=&quot;Dumbbell Chart&quot;,
       subtitle=&quot;Pct Change: 2013 vs 2014&quot;,
       caption=&quot;Source: https://github.com/hrbrmstr/ggalt&quot;) +
  theme_classic()+
  theme(plot.title = element_text(hjust=0.5, face=&quot;bold&quot;),
        plot.background=element_rect(fill=&quot;#f7f7f7&quot;),
        panel.background=element_rect(fill=&quot;#f7f7f7&quot;),
        panel.grid.minor=element_blank(),
        panel.grid.major.y=element_blank(),
        panel.grid.major.x=element_line(),
        axis.ticks=element_blank(),
        legend.position=&quot;top&quot;,
        panel.border=element_blank())</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<pre class="r"><code>options(warn=0)</code></pre>
</div>
<div id="beeswarm-plot" class="section level1">
<h1>Beeswarm Plot</h1>
<div id="general" class="section level2">
<h2>General</h2>
<pre class="r"><code># Read excel data
# library(&quot;readxl&quot;)
Cepheid_D01 &lt;- read_excel(&quot;./01_Datasets/lab_figure.xlsx&quot;)

# Data management
Cepheid_D01 &lt;-  Cepheid_D01 %&gt;%
  mutate(ER_central = factor(ER_central, levels = c(0,1), labels = c(&quot;negative&quot;, &quot;positive&quot;)),
         PgR_central = factor(PgR_central, levels = c(0,1), labels = c(&quot;negative&quot;, &quot;positive&quot;)),
         HER2_central = factor(HER2_central, levels = c(0,1), labels = c(&quot;negative&quot;, &quot;positive&quot;)),
         Ki67_central = factor(Ki67_central, levels = c(0,1), labels = c(&quot;negative&quot;, &quot;positive&quot;)),
         Ki67_3groups = factor(Ki67_3groups, levels = c(&quot;low: &lt;=10%&quot;,&quot;intermediate: &gt;10-20%&quot;,&quot;high: &gt;=20%&quot;)),
         ER_3groups = factor(ER_3groups, levels = c(&quot;negative: 0-&lt;1%&quot;,&quot;low: 1-&lt;10%&quot;,&quot;high: &gt;=10%&quot;)),
         PgR_3groups = factor(PgR_3groups, levels = c(&quot;negative: 0-&lt;1%&quot;,&quot;low: 1-&lt;10%&quot;,&quot;high: &gt;=10%&quot;))
         )
# suppress warnings globally
options(warn=-1)

# library(&quot;ggbeeswarm&quot;)
PgR_Overall_3group &lt;- ggplot(Cepheid_D01, aes(x = PgR_3groups, y = PR_Cepheid, color = PgR_3groups)) +
  geom_beeswarm(cex = 2) +
  geom_boxplot(varwidth=T, alpha=0.1) +
  geom_hline(aes(yintercept=-3.5), color = &quot;#090226&quot;, linetype = &quot;dashed&quot;, linewidth = 0.5)+
  geom_hline(aes(yintercept=-1.7), color = &quot;#ff5050&quot;, linetype = &quot;dashed&quot;, linewidth = 0.5)+
  # annotate(&quot;text&quot;, x=0.7, y=-3.25, label=&quot;Cut Off -3.5&quot;) +
  # geom_text(aes( x=0, y=1, label = &quot;Reference value 1&quot;, hjust = 0, vjust = -1), size = 3, color = &quot;#090226&quot;) +
  theme_classic()+
  # scale_fill_manual(values=c(&quot;negative&quot;,&quot;positive&quot;))+
  theme(legend.title =element_blank(),
        legend.position = &quot;bottom&quot;)+
  labs(title=&quot;Beeswarm Plot - PgR Overall (Cutoff -3.5, Exploratory Cutoff -1.7)&quot;,
       subtitle=&quot;PgR dCt values vs. 3 grouped PgR central pathology&quot;, 
       y=&quot;PgR dCt&quot;, 
       x=&quot;PgR central pathology&quot;)
PgR_Overall_3group</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<pre class="r"><code># suppress warnings globally
options(warn=-1)

# # Beeswarm Plot ER
# png(&#39;G:/Statistik/Studien/GeparX/Cepheid TraFo/Statistical_Analysis_V2/Output/Figure/F01_Beeswarm_ER_Overall_Bin.png&#39;,width=5, height=5,unit=&quot;in&quot;, res=300)
# ER_Overall_Bin
# dev.off()

# Save as png
# png(&#39;./02_Plots/Visualization/Scatter/F01_Beeswarm_PgR.png&#39;,width=5, height=5,unit=&quot;in&quot;, res=300)
# PgR_Overall_3group
# dev.off()
 
# Save as emf
# library(devEMF)
# emf(file = &quot;./02_Plots/Visualization/Scatter/F01_Beeswarm_PgR.emf&quot;)
# PgR_Overall_3group
# dev.off()</code></pre>
</div>
<div id="by-subgroup" class="section level2">
<h2>By Subgroup</h2>
<pre class="r"><code># Beeswarm HER2 by ER Status
ER_central.labs &lt;- c(&quot;ER status: negative&quot;,&quot;ER status: positive&quot;)
names(ER_central.labs) &lt;- c(&quot;negative&quot;, &quot;positive&quot;)

HER2_Bin &lt;- ggplot(Cepheid_D01, aes(x = HER2_central, y = Her2_Cepheid, color = HER2_central)) +
  geom_beeswarm(cex = 1.5) +
  geom_boxplot(varwidth=T, alpha=0.1) +
  facet_wrap(.~ ER_central, nrow = 1, labeller = labeller(ER_central= ER_central.labs)) +
  geom_hline(aes(yintercept=-1), color = &quot;#090226&quot;, linetype = &quot;dashed&quot;, size = 0.5)+
  geom_hline(aes(yintercept=-0.25), color = &quot;#ff5050&quot;, linetype = &quot;dashed&quot;, linewidth = 0.5)+
  # geom_text(aes( x=0, y=1, label = &quot;Reference value 1&quot;, hjust = 0, vjust = -1), size = 3, color = &quot;#090226&quot;) +
  theme_classic()+
  scale_fill_manual(values=c(&quot;negative&quot;,&quot;positive&quot;))+
  theme(legend.title =element_blank(),
        legend.position = &quot;bottom&quot;)+
  labs(title=&quot;Beeswarm Plot - HER2 by ER status (Cutoff -1.0, Exploratory Cutoff -0.25)&quot;,
       subtitle=&quot;HER2 dCt values vs. binary HER2 central pathology&quot;, 
       y=&quot;HER2 dCt&quot;, 
       x=&quot;HER2 central pathology&quot;)
HER2_Bin</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
</div>
</div>
<div id="line-plot" class="section level1">
<h1>Line Plot</h1>
<div id="multi-groups-line-chart" class="section level2">
<h2>Multi groups line chart</h2>
<pre class="r"><code>library(babynames) # provide the dataset: a dataframe called babynames
# library(hrbrthemes)
# library(viridis)

# Keep only 3 names
don &lt;- babynames::babynames 
don &lt;- don %&gt;% 
  dplyr::filter(name %in% c(&quot;Ashley&quot;, &quot;Patricia&quot;, &quot;Helen&quot;)) %&gt;%
  dplyr::filter(sex==&quot;F&quot;)
  
# Plot
don %&gt;%
  ggplot( aes(x=year, y=n, group=name, color=name)) +
    geom_line() +
    scale_color_viridis(discrete = TRUE) +
    ggtitle(&quot;Popularity of American names in the previous 30 years&quot;) +
    theme_ipsum() +
    ylab(&quot;Number of babies born&quot;)</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
<div id="line-chart-annotation" class="section level2">
<h2>Line chart annotation</h2>
<pre class="r"><code># Reference: https://r-graph-gallery.com/line_chart_annotation.html
# library(plotly)
# library(hrbrthemes)

# Load dataset from github
data &lt;- read.table(&quot;./01_Datasets/TwoNumOrdered.csv&quot;, header=T)
data$date &lt;- as.Date(data$date)

# plot
data %&gt;% 
  ggplot( aes(x=date, y=value)) +
    geom_line(color=&quot;#69b3a2&quot;) +
    ylim(0,22000) +
    annotate(geom=&quot;text&quot;, x=as.Date(&quot;2017-01-01&quot;), y=20089, 
             label=&quot;Bitcoin price reached 20k $\nat the end of 2017&quot;) +
    annotate(geom=&quot;point&quot;, x=as.Date(&quot;2017-12-17&quot;), y=20089, size=10, shape=21, fill=&quot;transparent&quot;) +
    geom_hline(yintercept=5000, color=&quot;orange&quot;, size=.5) +
    theme_ipsum()</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
</div>
<div id="dual-y-axis" class="section level2">
<h2>Dual Y axis</h2>
<pre class="r"><code># library(patchwork) # To display 2 charts together
# library(hrbrthemes)

# Build dummy data
data &lt;- data.frame(
  day = as.Date(&quot;2019-01-01&quot;) + 0:99,
  temperature = runif(100) + seq(1,100)^2.5 / 10000,
  price = runif(100) + seq(100,1)^1.5 / 10
)

# Most basic line chart
p1 &lt;- ggplot(data, aes(x=day, y=temperature)) +
  geom_line(color=&quot;#69b3a2&quot;, size=2) +
  ggtitle(&quot;Temperature: range 1-10&quot;) +
  theme_ipsum()
  
p2 &lt;- ggplot(data, aes(x=day, y=price)) +
  geom_line(color=&quot;grey&quot;,size=2) +
  ggtitle(&quot;Price: range 1-100&quot;) +
  theme_ipsum()

# Display both charts side by side thanks to the patchwork package
p1 + p2</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<pre class="r"><code># Value used to transform the data
coeff &lt;- 10

# A few constants
temperatureColor &lt;- &quot;#69b3a2&quot;
priceColor &lt;- &quot;grey&quot;

ggplot(data, aes(x=day)) +
  geom_line( aes(y=temperature), size=2, color=temperatureColor) + 
  geom_line( aes(y=price / coeff), size=2, color=priceColor) +
  scale_y_continuous(
    # Features of the first axis
    name = &quot;Temperature (Celsius °)&quot;,
    # Add a second axis and specify its features
    sec.axis = sec_axis(~.*coeff, name=&quot;Price ($)&quot;)
  ) + 
  theme_ipsum() +
  theme(
    axis.title.y = element_text(color = temperatureColor, size=13),
    axis.title.y.right = element_text(color = priceColor, size=13)
  ) +
  ggtitle(&quot;Temperature down, price up&quot;)</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-22-2.png" width="672" /></p>
</div>
<div id="advanced-theme-setting" class="section level2">
<h2>Advanced Theme Setting</h2>
<pre class="r"><code># Reference https://r-graph-gallery.com/web-line-chart-with-labels-at-end-of-line.html
# Load packages
# library(ggrepel)
# library(ggtext)

# library(showtext)
font_add_google(&quot;Lato&quot;)
showtext_auto()

# Load and prepare the dataset
df_mac_raw &lt;- readr::read_csv(&#39;./01_Datasets/big-mac.csv&#39;)

df_mac &lt;- df_mac_raw %&gt;% 
  # Extract year
  mutate(year = lubridate::year(date)) %&gt;% 
  # Subset variables
  select(date, year, iso_a3, currency_code, name, dollar_price) %&gt;% 
  # If there is more than one record per year/country, use the mean 
  group_by(iso_a3, name, year) %&gt;% 
  summarize(price = mean(dollar_price)) %&gt;% 
  # Keep countries/regions with records for the last 21 years  
  # (from 2000 to 2020 inclusive)
  group_by(iso_a3) %&gt;% 
  filter(n() == 21)

# Also define the group of countries that are going to be highlighted
highlights &lt;- c(&quot;EUZ&quot;, &quot;CHE&quot;, &quot;DNK&quot;, &quot;SWE&quot;, &quot;BRA&quot;, &quot;ARG&quot;, &quot;GBR&quot;, &quot;USA&quot;)
n &lt;- length(highlights)

countries &lt;- df_mac %&gt;% 
  filter(year == 2008) %&gt;% 
  pull(iso_a3)
  
df_mac_indexed_2008 &lt;- df_mac %&gt;% 
  # Keep countries that have a record for 2008, the index year.
  group_by(iso_a3) %&gt;%
  filter(iso_a3 %in% countries) %&gt;% 
  # Compute the `price_index`
  mutate(
    ref_year = 2008,
    price_index = price[which(year == 2008)],
    price_rel = price - price_index,
    # Create &#39;group&#39;, used to color the lines.
    group = if_else(iso_a3 %in% highlights, iso_a3, &quot;other&quot;),
    group = as.factor(group)
  ) %&gt;% 
  mutate(
    group = fct_relevel(group, &quot;other&quot;, after = Inf),
    name_lab = if_else(year == 2020, name, NA_character_)
  ) %&gt;% 
  ungroup()

# Theme definition
# This theme extends the &#39;theme_minimal&#39; that comes with ggplot2.
# The &quot;Lato&quot; font is used as the base font. This is similar
# to the original font in Cedric&#39;s work, Avenir Next Condensed.
theme_set(theme_minimal(base_family = &quot;Lato&quot;))


theme_update(
  # Remove title for both x and y axes
  axis.title = element_blank(),
  # Axes labels are grey
  axis.text = element_text(color = &quot;grey40&quot;),
  # The size of the axes labels are different for x and y.
  axis.text.x = element_text(size = 20, margin = margin(t = 5)),
  axis.text.y = element_text(size = 17, margin = margin(r = 5)),
  # Also, the ticks have a very light grey color
  axis.ticks = element_line(color = &quot;grey91&quot;, size = .5),
  # The length of the axis ticks is increased.
  axis.ticks.length.x = unit(1.3, &quot;lines&quot;),
  axis.ticks.length.y = unit(.7, &quot;lines&quot;),
  # Remove the grid lines that come with ggplot2 plots by default
  panel.grid = element_blank(),
  # Customize margin values (top, right, bottom, left)
  plot.margin = margin(20, 40, 20, 40),
  # Use a light grey color for the background of both the plot and the panel
  plot.background = element_rect(fill = &quot;grey98&quot;, color = &quot;grey98&quot;),
  panel.background = element_rect(fill = &quot;grey98&quot;, color = &quot;grey98&quot;),
  # Customize title appearence
  plot.title = element_text(
    color = &quot;grey10&quot;, 
    size = 28, 
    face = &quot;bold&quot;,
    margin = margin(t = 15)
  ),
  # Customize subtitle appearence
  plot.subtitle = element_markdown(
    color = &quot;grey30&quot;, 
    size = 16,
    lineheight = 1.35,
    margin = margin(t = 15, b = 40)
  ),
  # Title and caption are going to be aligned
  plot.title.position = &quot;plot&quot;,
  plot.caption.position = &quot;plot&quot;,
  plot.caption = element_text(
    color = &quot;grey30&quot;, 
    size = 13,
    lineheight = 1.2, 
    hjust = 0,
    margin = margin(t = 40) # Large margin on the top of the caption.
  ),
  # Remove legend
  legend.position = &quot;none&quot;
)

# Basic chart
plt &lt;- ggplot(
  # The ggplot object has associated the data for the highlighted countries
  df_mac_indexed_2008 %&gt;% filter(group != &quot;other&quot;), 
  aes(year, price_rel, group = iso_a3)
) + 
  # Geometric annotations that play the role of grid lines
  geom_vline(
    xintercept = seq(2000, 2020, by = 5),
    color = &quot;grey91&quot;, 
    size = .6
  ) +
  geom_segment(
    data = tibble(y = seq(-4, 3, by = 1), x1 = 2000, x2 = 2020),
    aes(x = x1, xend = x2, y = y, yend = y),
    inherit.aes = FALSE,
    color = &quot;grey91&quot;,
    size = .6
  ) +
  geom_segment(
    data = tibble(y = 0, x1 = 2000, x2 = 2020),
    aes(x = x1, xend = x2, y = y, yend = y),
    inherit.aes = FALSE,
    color = &quot;grey60&quot;,
    size = .8
  ) +
  geom_vline(
    aes(xintercept = ref_year), 
    color = &quot;grey40&quot;,
    linetype = &quot;dotted&quot;,
    size = .8
  ) +
  # Lines for the non-highlighted countries
  geom_line(
    data = df_mac_indexed_2008 %&gt;% filter(group == &quot;other&quot;),
    color = &quot;grey75&quot;,
    size = .6,
    alpha = .5
  ) +
  # Lines for the highlighted countries.
  # It&#39;s important to put them after the grey lines
  # so the colored ones are on top
  geom_line(
    aes(color = group),
    size = .9
  )
plt</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r"><code>plt &lt;- plt + 
  annotate(
    &quot;text&quot;, x = 2008.15, y = -3.35, 
    label = &quot;2008&quot;,
    family = &quot;Lato&quot;,
    size = 8,
    color = &quot;grey40&quot;,
    hjust = 0
  ) +
  geom_text_repel(
    aes(color = group, label = name_lab),
    family = &quot;Lato&quot;,
    fontface = &quot;bold&quot;,
    size = 8,
    direction = &quot;y&quot;,
    xlim = c(2020.8, NA),
    hjust = 0,
    segment.size = .7,
    segment.alpha = .5,
    segment.linetype = &quot;dotted&quot;,
    box.padding = .4,
    segment.curvature = -0.1,
    segment.ncp = 3,
    segment.angle = 20
  ) +
  # coordinate system + scales
  coord_cartesian(
    clip = &quot;off&quot;,
    ylim = c(-4, 3)
  ) +
  scale_x_continuous(
    expand = c(0, 0),
    limits = c(2000, 2023.5), 
    breaks = seq(2000, 2020, by = 5)
  ) +
  scale_y_continuous(
    expand = c(0, 0),
    breaks = seq(-4, 3, by = 1),
    labels = glue::glue(&quot;{format(seq(-4, 3, by = 1), nsmall = 2)}$&quot;)
  )
plt </code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-23-2.png" width="672" /></p>
</div>
<div id="combined-line-plots" class="section level2">
<h2>Combined Line Plots</h2>
<div
id="disease-activiy-across-consecutive-visits-and-before-and-after-the-intervention"
class="section level3 unnumbered">
<h3 class="unnumbered">Disease activiy across consecutive visits, and
before and after the intervention</h3>
<p><em>“Mean Disease Index vs Visit” (left subplot)</em><br />
Disease activity varied widely between groups and visits, in the periods
before and after the intervention. There was a sharp rise in disease
activity in group “G” after the intervention, and a notable drop in
group “F”. However, both of these trends seemed to have started already
at visits 4 and 5.</p>
<p><em>“Change following Intervention” (right subplot)</em><br />
Nevertheless, I added a summary of mean disease index scores before and
after intervention. My assumption was that visits 1-5 were meant to
establish a baseline value, to which levels at visits 6 and 7 were to be
compared. Treatment groups are shown in the order of their change in
median values of their mean disease indices before and after
intervention, from greatest decrease (group “F”, left) to greatest
increase (group “G”, right).</p>
<pre class="r"><code># library(dplyr)        # version 1.1.4  # general grammar
# library(purrr)        # version 1.0.2  # set_names, list_rbind
# library(tidyr)        # version 1.3.1  # pivot_longer, pivot_wider
# library(ggpubr)       # version 0.6.0, includes ggplot2 3.4.0 # stat_compare_means, ggtexttable, ggarrange
# library(ggrepel)      # version 0.9.6  # geom_text_repel

exampleData &lt;- read.csv(&quot;./01_Datasets/WW_Nov2024.csv&quot;)
# exampleData &lt;- read.csv(&quot;https://raw.githubusercontent.com/VIS-SIG/Wonderful-Wednesdays/refs/heads/master/data/2024/2024-10-09/WW_Nov2024.csv&quot;)


exampleData_int &lt;- 
  exampleData %&gt;% 
  set_names(
    &quot;Treatment&quot;,
    paste(c(1:7), sep = &quot;, &quot; )
    ) %&gt;%
  
# Add a column with differences between the medians of disease activity at visits before and after the intervention
  mutate(
    Change_intervention = 
      apply(., 1, function(row) {
        median(row[c(&quot;6&quot;, &quot;7&quot;)]) -
        median(row[c(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;)])
        }
      )
    ) %&gt;% 

# Optional: replace treatment numbers with letters, to differentiate from the index for visits
  mutate(
    Treatment = LETTERS[1:8]
  ) %&gt;% 

# Re-arrange dataframe
  arrange (Change_intervention) %&gt;% 

  pivot_longer(
      cols = paste(1:7), 
      names_to = &quot;Visit&quot;,
      values_to = &quot;Mean_Disease_Index&quot;
      ) %&gt;% 
  mutate(.after = Visit,
    Visit = as.numeric(Visit),
    Intervention = ordered(
      rep(
        c(rep(&quot;before&quot;, 5), rep(&quot;after&quot;, 2)), 
        8),
      levels = c(&quot;before&quot;, &quot;after&quot;)
      ),
   Treatment = factor(
     Treatment, 
     levels = unique(Treatment) 
     )
    )
 

# Plot

p_visits &lt;- 
  exampleData_int %&gt;% 
  mutate(facet_strip = &quot;&quot;) %&gt;%   # Empty facet label for aligning the y-axis scales of the two subplots 
    ggplot(
    aes(
      x = Visit, 
      y = Mean_Disease_Index, 
      color = Treatment
      )
    ) + 
  geom_text_repel(
    data = subset(
      exampleData_int, 
      Visit == &quot;7&quot; &amp; (Treatment %in% LETTERS[1:8] )
      ),
    aes(label = Treatment),
    nudge_x = 0.5,
    color = &quot;black&quot;,
    size = 5
  ) +
  facet_grid(. 
      ~ facet_strip
      ) +
  geom_line (lwd = 1.5, alpha = 0.6) +
  scale_x_continuous(
    breaks = 1:7,
    minor_breaks = NULL,
    expand = c(0, 0), limits = c(0.5, 7.5),
    labels = c(paste(1:6), &quot;7\n&quot;)
    ) +
  scale_y_continuous(
    breaks = seq(0, 10, 2),
    minor_breaks = NULL,
    expand = c(0, 0), limits = c(0, 10.5)
    ) +
  geom_vline(
    aes( xintercept = 5.5), 
    linetype = &quot;dashed&quot;,
    col = &quot;blue&quot;
    ) +
  annotate(
    &quot;rect&quot;, 
    xmin = 5.4, xmax = 5.6, 
    ymin = -Inf, ymax=Inf, 
    fill=&quot;white&quot;, alpha=0.6) +      
  annotate(
    &quot;text&quot;, 
    x = 5.5, y = 0.5,
    label = &quot;Intervention&quot;,
    size = 4,
    color = &quot;blue&quot;    
    ) +
  theme_light() +
  theme(
    legend.position = &quot;none&quot;,
    strip.background = element_blank(),
    strip.text.x=element_text(
      colour=&quot;black&quot;,
      size = 12
      ),
    ) +
  labs(
    y = &quot;Mean Disease Index Score&quot;,
    title = &quot;Mean disease index vs visit&quot;,
    vjust = -0.1
    )


p_intervention &lt;- 
  exampleData_int %&gt;%     
  ggplot(
    aes(
      x = Intervention, 
      y = Mean_Disease_Index, 
      color = Treatment,
      )
    ) + 
  scale_y_continuous(         # Same for both subplots
    breaks = seq(0, 10, 2),
    minor_breaks = NULL,
    expand = c(0, 0), 
    limits = c(0, 10.5) 
    ) +
  scale_x_discrete(
    labels = c(&quot;before&quot;, &quot;\nafter&quot;)
    )+
  facet_grid(. 
      ~ Treatment
      ) +
  geom_point(
    size = 3
    ) +
  stat_summary(
    fun = median,
    shape = 5, 
    size = 0.8,
    color = &quot;darkgrey&quot;
    ) +
  stat_summary(
    fun = median, 
    group = 1,
    geom = &quot;path&quot;,
    color = &quot;darkgrey&quot;, alpha = 0.5,
    lwd = 1.3
    ) +
  theme_light() +
  theme(
    axis.title.y = element_blank(),
    axis.text.y = element_blank(),
    strip.background = element_blank(),
    strip.text.x=element_text(
      colour=&quot;black&quot;,
      size = 12
      ),
    legend.position = &quot;none&quot;
    ) +
  labs(
    title = &quot;Change following intervention&quot;,
    vjust = -0.1
    )

ggarrange(
   p_visits,
   p_intervention,
   ncol = 2,
   widths = c(0.6, 1)
   ) </code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div
id="disease-activiy-vs.-time-of-visits-highlighting-the-target-range"
class="section level3 unnumbered">
<h3 class="unnumbered">Disease activiy vs. time of visits, highlighting
the target range</h3>
<p>In this version of the figure, I added two parameters that were not
supplied with the example data but which might improve the figure.</p>
<p>The first was a hypothetical target range for the disease index. The
aim of treatment/intervention in this scenario would have been to keep
index scores below the values in the shaded areas of the plots. For the
assumed target here, the intervention achieved a meaningful benefit only
in group “B”, whereas group “G” became significantly worse.</p>
<p>My second additional parameter were the intervals at which the visits
were scheduled. This should give a better impression of the variability
of the disease index over time, in particular if the visits were not
evenly spaced.</p>
<pre class="r"><code># Intervals at which visits 1-7 took place (e.g. weeks)
visitIntervals &lt;- c(0, 2, 4, 8, 12, 16, 24)
interventionTime &lt;- mean (c(visitIntervals[5], visitIntervals[6]))

# Clinically meaningful target for mean disease index score
diseaseScore_target &lt;- 3.5


## Plot 

exampleData_int &lt;- 
  exampleData_int %&gt;% 
  mutate(
    Time_of_visits = rep(visitIntervals, 8)
    )

p_visits &lt;- 
  exampleData_int %&gt;% 
  mutate(facet_strip = &quot;&quot;) %&gt;%   # Empty facet label for aligning the y-axis scales of the two subplots
    ggplot(
    aes(
      x = Time_of_visits, 
      y = Mean_Disease_Index, 
      color = Treatment
      )
    ) + 
  geom_text_repel(
    data = subset(
      exampleData_int, 
      Time_of_visits == max(visitIntervals) &amp; (Treatment %in% LETTERS[1:8] )
      ),
    aes(label = Treatment),
    nudge_x = 0.5,
    color = &quot;black&quot;,
    size = 5
  ) +
  annotate(
    &quot;rect&quot;, 
    xmin = -Inf, xmax = Inf, 
    ymin = diseaseScore_target, ymax=Inf, 
    fill=&quot;lightgrey&quot;, alpha=0.2) + 
    facet_grid(. 
      ~ facet_strip
      ) +
  geom_line (lwd = 1.5, alpha = 0.6) +
  scale_x_continuous(
    breaks = visitIntervals,
    minor_breaks = NULL,
    expand = c(0, 0), 
    limits = 
      range(visitIntervals) + 
      max(visitIntervals)/14 * c(-1, 1),
    labels = c(paste(1:6), &quot;7\n&quot;)
        ) +
  scale_y_continuous(
    breaks = seq(0, 10, 2),
    minor_breaks = NULL,
    expand = c(0, 0), limits = c(0, 10.5)
    ) +
  geom_vline(
    aes(xintercept = interventionTime ), 
    linetype = &quot;dashed&quot;,
    col = &quot;blue&quot;
    ) +
  annotate(
    &quot;text&quot;, 
    x = 0.65 - max(visitIntervals)/14, 
    y = 1.8,
    label = &quot;Target range&quot;,
    size = 4,
    angle = 90,
    color = &quot;blue&quot;    
    ) +
  annotate(
    &quot;rect&quot;, 
    xmin = interventionTime - 0.1, 
    xmax = interventionTime + 0.1, 
    ymin = -Inf, ymax=Inf, 
    fill=&quot;white&quot;, alpha=0.6) +      
  annotate(
    &quot;text&quot;, 
    x = interventionTime, 
    y = 0.5,
    label = &quot;Intervention&quot;,
    size = 4,
    color = &quot;blue&quot;    
    ) +
  theme_light() +
  theme(
    legend.position = &quot;none&quot;,
    strip.background = element_blank(),
    strip.text.x=element_text(
      colour=&quot;black&quot;,
      size = 12
      ),
    ) +
  labs(
    y = &quot;Mean Disease Index Score&quot;,
    x = &quot;Time of Visits [week]&quot;,
    title = &quot;Mean disease index vs time of visit&quot;,
    vjust = -0.1
    )


p_intervention &lt;- 
  exampleData_int %&gt;%     
  ggplot(
    aes(
      x = Intervention, 
      y = Mean_Disease_Index, 
      color = Treatment,
      )
    ) + 
  annotate(
    &quot;rect&quot;, 
    xmin = -Inf, xmax = Inf, 
    ymin = 3.5, ymax=Inf, 
    fill=&quot;lightgrey&quot;, alpha=0.2) +     
  scale_y_continuous(                  # Same for both subplots
    breaks = seq(0, 10, 2),
    minor_breaks = NULL,
    expand = c(0, 0), 
    limits = c(0, 10.5) 
    ) +
  scale_x_discrete(
    labels = c(&quot;before&quot;, &quot;\nafter&quot;)
    )+
  facet_grid(. 
      ~ Treatment
      ) +
  geom_point(
    size = 3
    ) +
  stat_summary(
    fun = median,
    shape = 5, 
    size = 0.8,
    color = &quot;darkgrey&quot;
    ) +
  stat_summary(
    fun = median, 
    group = 1,
    geom = &quot;path&quot;,
    color = &quot;darkgrey&quot;, alpha = 0.5,
    lwd = 1.3
    ) +
  theme_light() +
  theme(
    axis.title.y = element_blank(),
    axis.text.y = element_blank(),
    strip.background = element_blank(),
    strip.text.x=element_text(
      colour=&quot;black&quot;,
      size = 12
      ),
    legend.position = &quot;none&quot;
    ) +
  labs(
    title = &quot;Change following intervention&quot;,
    vjust = -0.1
    )

ggarrange(
   p_visits,
   p_intervention,
   ncol = 2,
   widths = c(0.7, 1)
   ) </code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="scatter-plots-and-densities" class="section level1">
<h1>Scatter Plots and Densities</h1>
<pre class="r"><code># library(haven)
# library(dplyr)
# library(tidyr)
# library(ggplot2)
# library(grid)
# library(gridExtra)
# library(readxl)
# library(cowplot)

# Placebo

bl0 &lt;- read_csv(&quot;./01_Datasets/adsl.csv&quot;) %&gt;%
  filter(TRT01PN == 0)

base0 &lt;- ggplot(bl0) +
  geom_jitter(aes(x=AGE, y=as.numeric(BMIBL), color=factor(RACE)),  size=4, width=0.03, height=0, alpha=0.8) +
  scale_x_continuous(limits=c(50, 90), breaks=c(50, 55, 60, 65, 70, 75, 80, 85, 90)) +
  scale_y_continuous(limits=c(12, 42), breaks=c(15, 20, 25, 30, 35, 40, 45)) +
  scale_color_manual(&quot;Race&quot;, values=c(&quot;#d95f02&quot;, &quot;#7570b3&quot;)) +
  ylab(&quot;BMI at Baseline (kg/m^2)&quot;) +
  xlab(&quot;Age (yrs)&quot;) +
  ggtitle(&quot;Placebo&quot;) +
  theme_minimal() +
  theme_linedraw() +
  theme(text = element_text(size=12)) +
  theme(legend.position = &quot;none&quot;)

xdens0 &lt;- axis_canvas(base0, axis=&quot;x&quot;) +
  geom_density(data=bl0, aes(AGE))

ydens0 &lt;- axis_canvas(base0, axis=&quot;y&quot;, coord_flip = TRUE) +
  geom_density(data=bl0, aes(as.numeric(BMIBL))) +
                 coord_flip()
               
p10 &lt;- insert_xaxis_grob(base0, xdens0, position=&quot;top&quot;)
p20 &lt;- insert_yaxis_grob(p10, ydens0, position=&quot;right&quot;)

#############################################################################
# Low Dose

bl_lo &lt;- read_csv(&quot;./01_Datasets/adsl.csv&quot;) %&gt;%
  filter(TRT01PN == 54)

base_lo &lt;- ggplot(bl_lo) +
  geom_jitter(aes(x=AGE, y=as.numeric(BMIBL), color=factor(RACE)),  size=4, width=0.03, height=0, alpha=0.8) +
  scale_x_continuous(limits=c(50, 90), breaks=c(50, 55, 60, 65, 70, 75, 80, 85, 90)) +
  scale_y_continuous(limits=c(12, 42), breaks=c(15, 20, 25, 30, 35, 40, 45)) +
  scale_color_manual(&quot;Race&quot;, values=c(&quot;#d95f02&quot;, &quot;#7570b3&quot;)) +
  ylab(&quot;BMI at Baseline (kg/m^2)&quot;) +
  xlab(&quot;Age (yrs)&quot;) +
  ggtitle(&quot;Xanomeline Low Dose&quot;) +
  theme_minimal() +
  theme_linedraw() +
  theme(text = element_text(size=12)) +
  theme(legend.position = &quot;none&quot;)

xdens_lo &lt;- axis_canvas(base_lo, axis=&quot;x&quot;) +
  geom_density(data=bl_lo, aes(AGE))

ydens_lo &lt;- axis_canvas(base_lo, axis=&quot;y&quot;, coord_flip = TRUE) +
  geom_density(data=bl_lo, aes(as.numeric(BMIBL))) +
  coord_flip()

p1_lo &lt;- insert_xaxis_grob(base_lo, xdens_lo, position=&quot;top&quot;)
p2_lo &lt;- insert_yaxis_grob(p1_lo, ydens_lo, position=&quot;right&quot;)
#############################################################################
# High Dose

bl_hi &lt;- read_csv(&quot;./01_Datasets/adsl.csv&quot;) %&gt;%
  filter(TRT01PN == 81)

base_hi &lt;- ggplot(bl_hi) +
  geom_jitter(aes(x=AGE, y=as.numeric(BMIBL), color=factor(RACE)),  size=4, width=0.03, height=0, alpha=0.8) +
  scale_x_continuous(limits=c(50, 90), breaks=c(50, 55, 60, 65, 70, 75, 80, 85, 90)) +
  scale_y_continuous(limits=c(12, 42), breaks=c(15, 20, 25, 30, 35, 40, 45)) +
  scale_color_manual(&quot;Race&quot;, labels=c(&quot;AMERICAN INDIAN&quot;, &quot;BLACK OR AFRICAN AMERICAN&quot;,&quot;WHITE&quot;),values=c(&quot;#1b9e77&quot;, &quot;#d95f02&quot;, &quot;#7570b3&quot;)) +
  ylab(&quot;BMI at Baseline (kg/m^2)&quot;) +
  xlab(&quot;Age (yrs)&quot;) +
  ggtitle(&quot;Xanomeline High Dose&quot;) +
  theme_minimal() +
  theme_linedraw() +
  theme(text = element_text(size=12)) +
  theme(legend.position = &quot;bottom&quot;) +
  theme(legend.title=element_blank())

xdens_hi &lt;- axis_canvas(base_hi, axis=&quot;x&quot;) +
  geom_density(data=bl_hi, aes(AGE))

ydens_hi &lt;- axis_canvas(base_hi, axis=&quot;y&quot;, coord_flip = TRUE) +
  geom_density(data=bl_hi, aes(as.numeric(BMIBL))) +
  coord_flip()

p1_hi &lt;- insert_xaxis_grob(base_hi, xdens_hi, position=&quot;top&quot;)
p2_hi &lt;- insert_yaxis_grob(p1_hi, ydens_hi, position=&quot;right&quot;)


#############################################################################

p &lt;- grid.arrange(arrangeGrob(p20, ncol=1, nrow=1),
                  arrangeGrob(p2_lo, ncol=1, nrow=1),
                  arrangeGrob(p2_hi, ncol=1, nrow=1),
                  heights = c(1,1.1))</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<pre class="r"><code>title &lt;- ggdraw() + draw_label(&quot;BMI, Age and Race are Well Balanced Between Treatment Groups. \nParticipants Were Predominantly White.\n&quot;, size = 18)

p2 &lt;- plot_grid(title, p, ncol=1, rel_heights = c(1, 10)) 
p2</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-26-2.png" width="672" /></p>
<pre class="r"><code># ggsave(&quot;/shared/175/arenv/arwork/gsk1278863/mid209676/present_2020_01/code/baseline/baseline_SM.png&quot;, p2, width=12, height=8, dpi=300)</code></pre>
</div>
<div id="pharmacokinetic-exposure" class="section level1">
<h1>Pharmacokinetic exposure</h1>
<div id="linear-scala" class="section level2">
<h2>Linear Scala</h2>
<pre class="r"><code>my_data &lt;- read_csv(&quot;./01_Datasets/402_case2_PKdataset.csv&quot;) %&gt;%
  filter(CMT == 2 &amp; DOSE == 300 &amp; PART == 1 &amp; STUDY == 1) %&gt;%
  mutate(
    TRTACT = factor(TRTACT, levels = rev(unique(TRTACT[order(DOSE)]))),
    ETHN = factor(ETHN),
    ETHN = factor(ETHN, levels = rev(levels(ETHN)))
  )

# Plot mean and error bars (SD) on a linear scale
my_data %&gt;%
  ggplot(aes(
    x = NOMTIME,
    y = LIDV,
    group = interaction(ETHN, CYCLE)
  )) +
  stat_summary(
    geom = &quot;errorbar&quot;,
    width = 2,
    fun.data = mean_sdl,
    fun.args = list(mult = 1)
  ) +
  stat_summary(geom = &quot;line&quot;, size = 0.5,
               fun.y = mean) +
  stat_summary(
    aes(fill = ETHN),
    geom = &quot;point&quot;,
    size = 1.5,
    fun.y = mean,
    stroke = 0.5,
    shape = 21
  ) +
  scale_fill_manual(values = c(&quot;white&quot;, &quot;black&quot;)) +
  scale_x_continuous(breaks = c(0, 4, 8, 12, 24, 36, 48, 72)) +
  xlab(&quot;Time (h)&quot;) +
  ylab(&quot;Concentration (ng/mL)\nMean (SD)&quot;) +
  theme_bw(base_size = 8) +
  theme(
    legend.title = element_blank(),
    legend.position = &quot;bottom&quot;,
    legend.box.spacing = unit(0, &quot;mm&quot;)
  )</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
</div>
<div id="log-scale" class="section level2">
<h2>Log Scale</h2>
<pre class="r"><code># Mean (95% CI) error bars, log scale
my_data %&gt;%
  ggplot(aes(
    x = NOMTIME,
    y = LIDV,
    group = interaction(ETHN, CYCLE)
  )) +
  stat_summary(
    geom = &quot;errorbar&quot;,
    width = 2,
    fun.data = mean_cl_normal,
    fun.args = list(mult = 1)
  ) +
  stat_summary(geom = &quot;line&quot;, size = 0.5,
               fun.y = mean) +
  stat_summary(
    aes(fill = ETHN),
    geom = &quot;point&quot;,
    size = 1.5,
    fun.y = mean,
    stroke = 0.5,
    shape = 21
  ) +
  scale_fill_manual(values = c(&quot;white&quot;, &quot;black&quot;)) +
  scale_x_continuous(breaks = c(0, 4, 8, 12, 24, 36, 48, 72)) +
  xlab(&quot;Time (h)&quot;) + ylab(&quot;Concentration (ng/mL)\nMean (95% CI)&quot;) +
  guides(color = guide_legend(title = &quot;Dose&quot;)) +
  scale_y_log10() +
  annotation_logticks(base = 10,
                      sides = &quot;l&quot;,
                      color = rgb(0.5, 0.5, 0.5)) +
  theme_bw(base_size = 8) +
  theme(
    legend.title = element_blank(),
    legend.position = &quot;bottom&quot;,
    legend.box.spacing = unit(0, &quot;mm&quot;)
  )</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
</div>
<div id="cmax-ctrough-and-auclast" class="section level2">
<h2>Cmax, Ctrough and AUClast</h2>
<pre class="r"><code>theme_set(theme_bw(base_size = 10))

# Plot cmax, ctrough, AUClast dots (95% CI) in separate panels
Cmax &lt;- my_data %&gt;%
  filter(!is.na(LIDV))  %&gt;%
  group_by(ID, ETHN) %&gt;%
  summarize(Cmax = max(LIDV),
            Ctrough = min(LIDV))

Ctrough &lt;- my_data %&gt;%
  filter(!is.na(LIDV))  %&gt;%
  group_by(ID, ETHN) %&gt;%
  summarize(Ctrough = min(LIDV))

AUClast &lt;- my_data %&gt;%
  filter(!is.na(LIDV))

library(&quot;pracma&quot;)
AUClast &lt;-
  data.frame(stack(sapply(split(AUClast, AUClast$ID), function(df)
    trapz(df$TIME, df$LIDV))))
names(AUClast) &lt;- c(&quot;AUC&quot;, &quot;ID&quot;)

AUClast$ID &lt;- as.numeric(as.character(AUClast$ID))
AUClast &lt;- AUClast[order(AUClast$ID),]
AUClast &lt;-
  merge(AUClast, unique(my_data[c(&quot;ID&quot;, &quot;ETHN&quot;)]), by = &quot;ID&quot;)


gg1 &lt;- Cmax %&gt;%
  ggplot(aes(x = ETHN, y = Cmax, group = ETHN)) +
  stat_summary(fun.data = mean_cl_normal,
               geom = &quot;errorbar&quot;,
               width = 0) +
  stat_summary(shape = 21, fill = &quot;white&quot;, size = 0.2) +
  labs(title = &quot;Cmax (ng/mL)&quot;, subtitle = &quot;Mean (95% CI)&quot;) +
  scale_y_log10(breaks = c(0.3, 1, 3, 10, 30, 100, 300, 1000, 3000),
                limits = c(60, 300)) +   annotation_logticks(base = 10,
                                                             sides = &quot;l&quot;,
                                                             color = rgb(0.5, 0.5, 0.5)) +
  theme(
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    plot.subtitle = element_text(color = rgb(0.3, 0.3, 0.3))
  )

gg2 &lt;- gg1 %+% #Cmax %+%
  aes(x = ETHN, y = Ctrough) +
  labs(title = &quot;Ctrough (ng/mL)&quot;) +
  scale_y_log10(breaks = c(0.3, 1, 3, 10, 30, 100, 300, 1000, 3000),
                limits = c(0.6, 9))


gg3 &lt;- gg1 %+% AUClast %+% aes(x = ETHN, y = AUC) +
  labs(title = &quot;AUClast (h.(ng/mL))&quot;) +
  scale_y_log10(breaks = c(0.3, 1, 3, 10, 30, 100, 300, 1000, 3000),
                limits = c(500, 1500))

grid.arrange(arrangeGrob(gg1, gg2, gg3, nrow = 1), nrow = 1)</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<pre class="r"><code>Cmax2  &lt;- Cmax %&gt;%
  mutate(DV = Cmax,
         logDV = log(Cmax),
         LABEL = &quot;Cmax&quot;) %&gt;%
  select(c(&quot;ID&quot;, &quot;ETHN&quot;, &quot;DV&quot;, &quot;logDV&quot;, &quot;LABEL&quot;))

results &lt;- t.test(logDV ~ ETHN, Cmax2)

PKmetrics &lt;- data.frame(
  y2.5 = exp(results$conf.int[1]),
  y97.5 = exp(results$conf.int[2]),
  ymean = exp(as.numeric(results$estimate[1] - results$estimate[2])),
  var = &quot;Cmax&quot;,
  unit = &quot;ng/mL&quot;
)

Ctrough2 &lt;- Ctrough %&gt;%
  mutate(DV = Ctrough,
         logDV = log(Ctrough),
         LABEL = &quot;Ctrough&quot;) %&gt;%
  select(c(&quot;ID&quot;, &quot;ETHN&quot;, &quot;DV&quot;, &quot;logDV&quot;, &quot;LABEL&quot;))

results &lt;- t.test(logDV ~ ETHN, Ctrough2)

PKmetrics &lt;- rbind(
  PKmetrics,
  data.frame(
    y2.5 = exp(results$conf.int[1]),
    y97.5 = exp(results$conf.int[2]),
    ymean = exp(as.numeric(results$estimate[1] - results$estimate[2])),
    var = &quot;Ctrough&quot;,
    unit = &quot;ng/mL&quot;
  )
)

AUClast2 &lt;- AUClast %&gt;%
  mutate(DV = AUC,
         logDV = log(AUC),
         LABEL = &quot;AUClast&quot;) %&gt;%
  select(c(&quot;ID&quot;, &quot;ETHN&quot;, &quot;DV&quot;, &quot;logDV&quot;, &quot;LABEL&quot;))

results &lt;- t.test(logDV ~ ETHN, AUClast2)

PKmetrics &lt;- rbind(
  PKmetrics,
  data.frame(
    y2.5 = exp(results$conf.int[1]),
    y97.5 = exp(results$conf.int[2]),
    ymean = exp(as.numeric(results$estimate[1] - results$estimate[2])),
    var = &quot;AUClast&quot;,
    unit = &quot;h.ng/mL&quot;
  )
)

PKmetrics$var &lt;-
  factor(PKmetrics$var, levels = c(&quot;AUClast&quot;, &quot;Ctrough&quot;, &quot;Cmax&quot;))

PKmetrics %&gt;%
  ggplot(aes(
    x = var,
    y = ymean,
    ymin = y2.5,
    ymax = y97.5
  )) +
  paper_theme() +
  geom_hline(
    yintercept = 1,
    size = 1,
    colour = &quot;red&quot;,
    alpha = 0.1
  ) +
  scale_y_log10(breaks = c(0.25, 0.5, 1, 2, 4)) +
  geom_point() +
  geom_errorbar(width = 0) +
  xlab(&quot;&quot;) +
  scale_x_discrete(breaks = NULL, labels = NULL) +
  ylab(&quot;Ratios between Japanese and Caucasian Mean (95% CI)&quot;) +
  geom_text(aes(
    x = var,
    y = 0.175,
    label = paste0(var, &quot;\n(&quot;, unit, &quot;)&quot;)
  )) +
  theme(
    panel.grid.major.x = element_line(color = &quot;gray&quot;, size = 0.2),
    panel.grid.major.y = element_blank(),
    panel.border = element_blank(),
    axis.title.x = element_text(size = 11, vjust = -1.25),
    axis.title.y = element_blank()
  ) +
  coord_flip(ylim = c(0.15, 5)) </code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
</div>
<div id="post-hoc-subgroup-analyses" class="section level2">
<h2>Post-hoc subgroup analyses</h2>
<pre class="r"><code># Read in data and define order for factors.
# Dervie visit time in weeks from hours
# Define informative label for plotting subgroups
my_data &lt;- read.csv(&quot;./01_Datasets/PKPDdataset2.csv&quot;) %&gt;%
  filter(CMT == 3 &amp; DOSE %in% c(0, 150) &amp; PART == 1 &amp; STUDY == 1) %&gt;%
  mutate(
    TRTACT = factor(TRTACT, levels = unique(TRTACT[order(DOSE)])),
    Treatment = factor(TRTACT, levels = levels(TRTACT)),
    Visit = factor(
      plyr::mapvalues(
        round(NOMTIME),
        sort(unique(round(NOMTIME))), 
        c(101,102,103,104,105,106,107,108,199))
      ),
    NOMTIME = NOMTIME/24/7, 
    Biomarker = ifelse(subgroup == 0, &quot;Negative&quot;, &quot;Positive&quot;)
  )

# Obtain baseline measurement 
base_data &lt;- 
  my_data %&gt;% 
  filter(PROFDAY == 0) %&gt;%
  mutate(BASE = LIDV) %&gt;%
  select(ID, BASE)

# Derive change and percent change from baseline
data_to_plot &lt;- 
  my_data %&gt;%
  filter(PROFDAY != 0) %&gt;%
  left_join(base_data) %&gt;%
  mutate(
    CHG = LIDV - BASE,
    PCHG = 100 * (LIDV - BASE)/LIDV
    ) 


data_to_plot %&gt;%
  ggplot(aes(x = Visit, 
             y = PCHG, 
             group = Treatment, 
             shape = Treatment, 
             fill = Treatment)
         ) +
  theme_bw(base_size = 12) + 
  stat_summary(fun.data = &quot;mean_cl_normal&quot;, geom = &quot;errorbar&quot;) +
  stat_summary(geom = &quot;line&quot;, size = 1, fun.y = mean) + 
  stat_summary(geom = &quot;point&quot;, size = 2.5, fun.y = mean, stroke = 1) +
  scale_y_continuous(breaks = seq(-20,20,1)) +
  coord_cartesian(ylim = (c(-10, 5))) +
  labs(x = &quot;Visit&quot;, y = &quot;Weight loss (%)&quot;)</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<pre class="r"><code>data_to_plot %&gt;%
  filter(DOSE &gt; 0) %&gt;%
  ggplot(aes(x = Visit, 
             y = PCHG, 
             group = Biomarker
             )
         ) +
  theme_bw(base_size = 12) + 
  stat_summary(fun.data = &quot;mean_cl_normal&quot;, geom = &quot;errorbar&quot;) +
  stat_summary(fun.y = mean, geom = &quot;line&quot;, 
               aes(linetype = Biomarker), size = 1) + 
  stat_summary(fun.y = mean, geom = &quot;point&quot;, size = 2.5, shape = 17) +
  scale_y_continuous(breaks = seq(-20,20,1)) +
  coord_cartesian(ylim = (c(-10, 5))) +
  labs(x = &quot;Visit&quot;, 
       y = &quot;Weight loss (%)&quot;,
       linetype = &quot;Genetic marker\n(150 mg)&quot;)</code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-31-2.png" width="672" /></p>
<pre class="r"><code>data_to_plot %&gt;%
  ggplot(aes(x = NOMTIME, 
             y = PCHG, 
             group = interaction(Biomarker,Treatment),
             fill = Treatment
             )
         ) +
  theme_bw(base_size = 12) + 
  stat_summary(fun.data = &quot;mean_cl_normal&quot;, geom = &quot;errorbar&quot;, width = 0) +
  stat_summary(fun.y = mean, geom = &quot;line&quot;, 
               aes(linetype = Biomarker), size = 1) + 
  stat_summary(fun.y = mean, geom = &quot;point&quot;, size = 2.5, shape = 21) +
  scale_fill_manual(values = c(&quot;white&quot;, &quot;black&quot;)) +
  scale_y_continuous(breaks = seq(-20,20,1)) +
  scale_x_continuous(breaks = c(0,1,2,3,4,6,8,10,12), minor_breaks = NULL) +
  coord_cartesian(ylim = (c(-10, 5))) +
  labs(x = &quot;Visit&quot;, 
       y = &quot;Weight loss (%)\nMean (95% CI)&quot;,
       linetype = &quot;Genetic marker&quot;) </code></pre>
<p><img src="05-Plot-ScatterPlot_files/figure-html/unnamed-chunk-31-3.png" width="672" /></p>
</div>
</div>
<div id="interactive-plot" class="section level1">
<h1>Interactive Plot</h1>
<pre class="r"><code># load data
# library(&quot;gapminder&quot;)
data &lt;- gapminder %&gt;% filter(year==&quot;2007&quot;) %&gt;% select(-year)

# Interactive version
# library(&quot;plotly&quot;)
p &lt;- data %&gt;%
  mutate(myText=paste(&quot;This country is: &quot; ,country )) %&gt;%
  ggplot( aes(x=gdpPercap, y=lifeExp, size = pop, color = continent, text=myText)) +
    geom_point(alpha=0.7) 

ggplotly(p, tooltip=&quot;text&quot;)</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-1a1db363d34ad0c8903d" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-1a1db363d34ad0c8903d">{"x":{"data":[{"x":[6223.3674650000003,4797.2312670000001,1441.2848730000001,12569.851769999999,1217.0329939999999,430.07069159999998,2042.0952400000001,706.01653699999997,1704.0637240000001,986.14787920000003,277.55185870000003,3632.5577979999998,1544.7501119999999,2082.4815669999998,5581.1809979999998,12154.089749999999,641.36952359999998,690.80557590000001,13206.48452,752.74972649999995,1327.6089099999999,942.6542111,579.23174300000005,1463.249282,1569.3314419999999,414.5073415,12057.49928,1044.7701259999999,759.34991009999999,1042.581557,1803.151496,10956.991120000001,3820.1752299999998,823.68562050000003,4811.0604290000001,619.67689240000004,2013.9773049999999,7670.122558,863.08846389999997,1598.4350890000001,1712.4721360000001,862.54075609999995,926.14106830000003,9269.6578079999999,2602.3949950000001,4513.4806429999999,1107.482182,882.96994380000001,7092.9230250000001,1056.3801209999999,1271.211593,469.70929810000001],"y":[72.301000000000002,42.731000000000002,56.728000000000002,50.728000000000002,52.295000000000002,49.579999999999998,50.43,44.741,50.651000000000003,65.152000000000001,46.462000000000003,55.322000000000003,48.328000000000003,54.790999999999997,71.337999999999994,51.579000000000001,58.039999999999999,52.947000000000003,56.734999999999999,59.448,60.021999999999998,56.006999999999998,46.387999999999998,54.109999999999999,42.591999999999999,45.677999999999997,73.951999999999998,59.442999999999998,48.302999999999997,54.466999999999999,64.164000000000001,72.801000000000002,71.164000000000001,42.082000000000001,52.905999999999999,56.866999999999997,46.859000000000002,76.441999999999993,46.241999999999997,65.528000000000006,63.061999999999998,42.567999999999998,48.158999999999999,49.338999999999999,58.555999999999997,39.613,52.517000000000003,58.420000000000002,73.923000000000002,51.542000000000002,42.384,43.487000000000002],"text":["This country is:  Algeria","This country is:  Angola","This country is:  Benin","This country is:  Botswana","This country is:  Burkina Faso","This country is:  Burundi","This country is:  Cameroon","This country is:  Central African Republic","This country is:  Chad","This country is:  Comoros","This country is:  Congo, Dem. Rep.","This country is:  Congo, Rep.","This country is:  Cote d'Ivoire","This country is:  Djibouti","This country is:  Egypt","This country is:  Equatorial Guinea","This country is:  Eritrea","This country is:  Ethiopia","This country is:  Gabon","This country is:  Gambia","This country is:  Ghana","This country is:  Guinea","This country is:  Guinea-Bissau","This country is:  Kenya","This country is:  Lesotho","This country is:  Liberia","This country is:  Libya","This country is:  Madagascar","This country is:  Malawi","This country is:  Mali","This country is:  Mauritania","This country is:  Mauritius","This country is:  Morocco","This country is:  Mozambique","This country is:  Namibia","This country is:  Niger","This country is:  Nigeria","This country is:  Reunion","This country is:  Rwanda","This country is:  Sao Tome and Principe","This country is:  Senegal","This country is:  Sierra Leone","This country is:  Somalia","This country is:  South Africa","This country is:  Sudan","This country is:  Swaziland","This country is:  Tanzania","This country is:  Togo","This country is:  Tunisia","This country is:  Uganda","This country is:  Zambia","This country is:  Zimbabwe"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":0.69999999999999996,"size":[6.7752717325492302,5.5989004118630001,5.2403533070783466,4.4039576839973833,5.7356199392207996,5.2690143958143745,5.9564773609874049,4.8422259478740974,5.4285263116604412,4.1516985016395616,7.9562662998770968,4.7671332830722601,5.9761166381701099,4.0630571938388131,8.4363687173296391,4.0881362755000454,4.9086539137274148,8.32592567062337,4.3626259687113649,4.4145446751277628,6.2577023306009796,5.4044519713261234,4.366601197011196,6.8764961358924266,4.4803007102230001,4.6801077545067349,5.0369392016926247,6.0461636385333,5.6651779774839266,5.5697344023561026,4.6914832316617332,4.3131500431206629,6.7943767241052386,6.0925324617448933,4.4884533308975465,5.6338762963755968,9.8227139332733113,4.1821590023924538,5.3111594952501031,3.7795275590551185,5.5874769596414557,5.0484803839022625,5.3338208539114369,7.2238082937782924,7.156106546896897,4.282361176813005,6.9852002740989851,5.0002880392083817,5.4315910179617095,6.5807690784340016,5.5479846257867891,5.5907437114111733],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"Africa","legendgroup":"Africa","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[12779.379639999999,3822.137084,9065.8008250000003,36319.235009999997,13171.638849999999,7006.5804189999999,9645.06142,8948.1029230000004,6025.3747519999997,6873.262326,5728.3535140000004,5186.0500030000003,1201.637154,3548.3308459999998,7320.8802619999997,11977.57496,2749.3209649999999,9809.1856360000002,4172.8384640000004,7408.9055609999996,19328.709009999999,18008.509239999999,42951.65309,10611.46299,11415.805689999999],"y":[75.319999999999993,65.554000000000002,72.390000000000001,80.653000000000006,78.552999999999997,72.888999999999996,78.781999999999996,78.272999999999996,72.234999999999999,74.994,71.878,70.259,60.915999999999997,70.197999999999993,72.566999999999993,76.194999999999993,72.899000000000001,75.537000000000006,71.751999999999995,71.421000000000006,78.745999999999995,69.819000000000003,78.242000000000004,76.384,73.747],"text":["This country is:  Argentina","This country is:  Bolivia","This country is:  Brazil","This country is:  Canada","This country is:  Chile","This country is:  Colombia","This country is:  Costa Rica","This country is:  Cuba","This country is:  Dominican Republic","This country is:  Ecuador","This country is:  El Salvador","This country is:  Guatemala","This country is:  Haiti","This country is:  Honduras","This country is:  Jamaica","This country is:  Mexico","This country is:  Nicaragua","This country is:  Panama","This country is:  Paraguay","This country is:  Peru","This country is:  Puerto Rico","This country is:  Trinidad and Tobago","This country is:  United States","This country is:  Uruguay","This country is:  Venezuela"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(163,165,0,1)","opacity":0.69999999999999996,"size":[7.0752836928954501,5.333853876564663,10.949722028706249,6.7778440362522812,5.8668180179899734,7.2328291141492445,4.8118234074533222,5.5226039735491259,5.3512237886724172,5.69571313317988,5.1306777542305024,5.6102133034773436,5.2791910995855069,5.1841532973733377,4.6155666029278022,9.2006306129298405,4.9973754404969783,4.687331723294788,5.1030785274449162,6.5567034863678497,4.7864012116365817,4.2613288143832744,12.807919245623044,4.7174623155002786,6.4273871341173354],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(163,165,0,1)"}},"hoveron":"points","name":"Americas","legendgroup":"Americas","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[974.58033839999996,29796.048340000001,1391.253792,1713.7786860000001,4959.1148540000004,39724.978669999997,2452.210407,3540.6515639999998,11605.71449,4471.0619059999999,25523.277099999999,31656.068060000001,4519.4611709999999,1593.06548,23348.139729999999,47306.989780000004,10461.05868,12451.6558,3095.7722709999998,944,1091.359778,22316.192869999999,2605.94758,3190.4810160000002,21654.83194,47143.179640000002,3970.0954069999998,4184.5480889999999,28718.276839999999,7458.3963270000004,2441.5764039999999,3025.3497980000002,2280.769906],"y":[43.828000000000003,75.635000000000005,64.061999999999998,59.722999999999999,72.960999999999999,82.207999999999998,64.697999999999993,70.650000000000006,70.963999999999999,59.545000000000002,80.745000000000005,82.602999999999994,72.534999999999997,67.296999999999997,78.623000000000005,77.587999999999994,71.992999999999995,74.241,66.802999999999997,62.069000000000003,63.784999999999997,75.640000000000001,65.483000000000004,71.688000000000002,72.777000000000001,79.971999999999994,72.396000000000001,74.143000000000001,78.400000000000006,70.616,74.248999999999995,73.421999999999997,62.698],"text":["This country is:  Afghanistan","This country is:  Bahrain","This country is:  Bangladesh","This country is:  Cambodia","This country is:  China","This country is:  Hong Kong, China","This country is:  India","This country is:  Indonesia","This country is:  Iran","This country is:  Iraq","This country is:  Israel","This country is:  Japan","This country is:  Jordan","This country is:  Korea, Dem. Rep.","This country is:  Korea, Rep.","This country is:  Kuwait","This country is:  Lebanon","This country is:  Malaysia","This country is:  Mongolia","This country is:  Myanmar","This country is:  Nepal","This country is:  Oman","This country is:  Pakistan","This country is:  Philippines","This country is:  Saudi Arabia","This country is:  Singapore","This country is:  Sri Lanka","This country is:  Syria","This country is:  Taiwan","This country is:  Thailand","This country is:  Vietnam","This country is:  West Bank and Gaza","This country is:  Yemen, Rep."],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,125,1)","opacity":0.69999999999999996,"size":[6.7092983513552849,4.1508288847181953,10.158865608179935,5.7221180107506537,22.677165354330711,5.1347534580541501,21.120368095307143,11.557396830375804,8.1105713155374861,6.4987952406877376,5.0782402616746616,9.6507758736364799,5.0386912985713304,6.2810035011451255,7.4168446506103951,4.569838394810894,4.7835439230220365,6.3619616591074761,4.6306565167244802,7.368763875897594,6.5677527377566554,4.6817536552960464,10.5466615830696,8.7408659686259185,6.5038406176847667,4.8654178527954128,6.1173758740791646,6.0549352830716545,6.2740949140912097,7.9711999339905422,8.5795132943757064,4.7965509761407246,6.2212794811128056],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,191,125,1)"}},"hoveron":"points","name":"Asia","legendgroup":"Asia","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[5937.0295260000003,36126.492700000003,33692.605080000001,7446.2988029999997,10680.792820000001,14619.22272,22833.308509999999,35278.418740000001,33207.0844,30470.0167,32170.37442,27538.41188,18008.944439999999,36180.789190000003,40675.996350000001,28569.719700000001,9253.896111,36797.933319999996,49357.190170000002,15389.92468,20509.64777,10808.47561,9786.5347139999994,18678.314350000001,25768.257590000001,28821.063699999999,33859.748350000002,37506.419070000004,8458.2763840000007,33203.261279999999],"y":[76.423000000000002,79.828999999999994,79.441000000000003,74.852000000000004,73.004999999999995,75.748000000000005,76.486000000000004,78.331999999999994,79.313000000000002,80.656999999999996,79.406000000000006,79.483000000000004,73.337999999999994,81.757000000000005,78.885000000000005,80.546000000000006,74.543000000000006,79.762,80.195999999999998,75.563000000000002,78.097999999999999,72.475999999999999,74.001999999999995,74.662999999999997,77.926000000000002,80.941000000000003,80.884,81.700999999999993,71.777000000000001,79.424999999999997],"text":["This country is:  Albania","This country is:  Austria","This country is:  Belgium","This country is:  Bosnia and Herzegovina","This country is:  Bulgaria","This country is:  Croatia","This country is:  Czech Republic","This country is:  Denmark","This country is:  Finland","This country is:  France","This country is:  Germany","This country is:  Greece","This country is:  Hungary","This country is:  Iceland","This country is:  Ireland","This country is:  Italy","This country is:  Montenegro","This country is:  Netherlands","This country is:  Norway","This country is:  Poland","This country is:  Portugal","This country is:  Romania","This country is:  Serbia","This country is:  Slovak Republic","This country is:  Slovenia","This country is:  Spain","This country is:  Sweden","This country is:  Switzerland","This country is:  Turkey","This country is:  United Kingdom"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,176,246,1)","opacity":0.69999999999999996,"size":[4.7393036097654502,5.2515712457990968,5.4410784978691735,4.8653167028921844,5.1685528258485842,4.8579469438752234,5.4276996527368331,4.9741078643628294,4.9477814048195228,7.8404337662196868,8.498091237446733,5.4664828069929365,5.4051430840065446,3.9460291298414996,4.8085649745634003,7.7413040551619607,4.1420303205279438,5.8852844160763711,4.8747213942514058,7.0011551525914504,5.4613810121458615,6.2248439161044908,5.421238450332476,4.9717681273532666,4.4796425578879777,7.0812884751230953,5.3261618194654057,5.1909724557450065,8.1635636391520627,7.8301599085784517],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,176,246,1)"}},"hoveron":"points","name":"Europe","legendgroup":"Europe","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[34435.367440000002,25185.009109999999],"y":[81.234999999999999,80.203999999999994],"text":["This country is:  Australia","This country is:  New Zealand"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(231,107,243,1)","opacity":0.69999999999999996,"size":[6.1206139909462598,4.8094443919586789],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(231,107,243,1)"}},"hoveron":"points","name":"Oceania","legendgroup":"Oceania","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":25.298464092984645,"r":6.6417600664176026,"b":36.529680365296812,"l":33.872976338729771},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":13.283520132835205},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-2176.4300568650001,51811.172085565006],"tickmode":"array","ticktext":["0","10000","20000","30000","40000","50000"],"tickvals":[0,10000,20000,29999.999999999996,40000,50000],"categoryorder":"array","categoryarray":["0","10000","20000","30000","40000","50000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.3208800332088013,"tickwidth":0.60379636967432737,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":10.62681610626816},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.60379636967432737,"zeroline":false,"anchor":"y","title":{"text":"gdpPercap","font":{"color":"rgba(0,0,0,1)","family":"","size":13.283520132835205}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[37.463499999999996,84.752499999999998],"tickmode":"array","ticktext":["40","50","60","70","80"],"tickvals":[40,50,60,70,80],"categoryorder":"array","categoryarray":["40","50","60","70","80"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.3208800332088013,"tickwidth":0.60379636967432737,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":10.62681610626816},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.60379636967432737,"zeroline":false,"anchor":"x","title":{"text":"lifeExp","font":{"color":"rgba(0,0,0,1)","family":"","size":13.283520132835205}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.60379636967432737,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.7179670722977816,"font":{"color":"rgba(0,0,0,1)","family":"","size":10.62681610626816},"title":{"text":"pop<br />continent","font":{"color":"rgba(0,0,0,1)","family":"","size":13.283520132835205}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"427d7b70b60e":{"x":{},"y":{},"size":{},"colour":{},"text":{},"type":"scatter"}},"cur_data":"427d7b70b60e","visdat":{"427d7b70b60e":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="reference" class="section level1">
<h1>Reference</h1>
<p><a href="https://doi.org/10.1136/bmj.323.7321.1123">Statistics notes:
Analysing controlled trials with baseline and follow up
measurements.</a><br />
Vickers AJ, Altman DG. BMJ. 2001 Nov 10;323(7321):1123-4.</p>
<p>SIG (2024, Nov. 13). VIS-SIG Blog: Wonderful Wednesdays November
2024. Retrieved from <a
href="https://graphicsprinciples.github.io/posts/2024-12-01-wonderful-wednesdays-november-2024/"
class="uri">https://graphicsprinciples.github.io/posts/2024-12-01-wonderful-wednesdays-november-2024/</a></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
